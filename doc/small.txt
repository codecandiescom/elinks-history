Tips to obtain a very small static elinks binary suitable for mini distributions:

Use dietlibc (http://www.fefe.de/dietlibc/) or similar stuff (uClibc, ...):
export CC='diet gcc'

Use compilers flags to optimize for size:
export CFLAGS='-Os -s -fno-inline -nostdinc -march=i386 -fomit-frame-pointer \
               -malign-functions=1 -malign-jumps=1 -malign-loops=1 -mpreferred-stack-boundary=2'

Disable some compile-time options:
./configure --disable-ipv6 --disable-backtrace --disable-nls --enable-fastmem \
--without-zlib --without-bzlib --without-xbel --without-lua --without-gnutls \
--without-openssl --without-x --enable-small

You can disable bookmarks, globhist and more too if you want to.

Notes:
--disable-backtrace disables internal backtrace code
--disable-nls disables i18n support
--enable-fastmem disables internal malloc() debugging, and use alloca() wherever possible.
--enable-small forces to remove some text descriptions in options and keybind stuff (regain 30Kb)

Dependencies over external libs must be removed using related configure options.
--without-zlib		removes libz dependency (compression)
--without-bzlib		removes libbz2 dependency (compression)
--without-xbel		removes libxml dependency (xbel bookmarks support)
--without-lua		removes liblua dependency (lua scripting)
--without-gnutls	removes libtls dependency (ssl support)
--without-openssl	removes libssl dependency (ssl support)
--without-x 		removes libx11 dependency (setting terminal title)

With these, using gcc 3.2, CFLAGS='-Os -s -fno-inline', dietlibc 0.23 and elinks 0.5pre7 from cvs,
I obtain a small static binary with the following features:
Standard, Fastmem, No Backtrace, Bookmarks, Cookies, Global History, Mailcap, Mimetypes files, Forms memory

and a size of:
-rwxr-xr-x    1 zas      zas        453412 2003-10-19 12:50 src/elinks

It seems gcc 2.95.x do not generate as small binaries than gcc 3.2.x with
same flags.

Not so bad :)



/* $Id: small.txt,v 1.4 2003/10/20 08:49:27 zas Exp $ */
