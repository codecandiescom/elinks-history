Wed May 11 07:37:16 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cache/cache.c:

	Put back the check removed in revision 1.207, which check also saves 
	a little work when there is a gap between the first two fragments.  

Wed May 11 03:51:17 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/session.c:

	Do not call pre-format-html hooks if the cache entry cannot be
	defragmented.  

Wed May 11 03:28:44 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cache/cache.c:

	Small comment tweak.  

Wed May 11 03:26:19 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cache/cache.c:

	Rename local variable overlay to gap.  

Wed May 11 03:25:25 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cache/cache.c:

	Change the error message "fragments overlay" to "fragments overlap".  

Wed May 11 03:22:50 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cache/cache.c:

	Fix the comment for the loop where we look for the first gap.  

Wed May 11 03:21:20 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cache/cache.c:

	Explain get_cache_fragment.  

Wed May 11 02:49:10 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cache/cache.c:

	Perform that check sooner.  

Wed May 11 02:48:35 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cache/cache.c:

	Use list_is_singleton in get_cache_fragment to check whether the
	cache entry is fragmented.  

Tue May 10 21:46:39 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	maybe_pre_format_html(): Simplify checking. get_cache_fragment()
	checks if there are any fragments.  

Tue May 10 21:25:09 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Fix a cut-and-paste error in l_bind_key's conversion to handle_ref, 
	spotted by Jonas.  

Tue May 10 19:52:27 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Report errors calling the function in eval_function. From Jon
	Shapcott.  

Tue May 10 19:51:44 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Factor out the lua_pcall in handle_ref_on_stack into the new
	eval_function. From Jon Shapcott.  

Tue May 10 19:31:55 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Fix one last use of lua_unref.  

Tue May 10 19:29:05 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Use lua_rawgeti and luaL_unref instead of obsolete lua_getref and
	lua_unref.  From Jon Shapcott.  

Tue May 10 19:27:56 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Factor code to call Lua functions into the new handle_ref and
	handle_ref_on_stack. Initial patch by Jon Shapcott.  

Tue May 10 17:43:45 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Use lua_setglobal to set elinks_home instead of using some
	long-winded lua_dostring, lua_getglobal, lua_call weirdness. From
	Jon Shapcott.  

Tue May 10 17:39:36 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/kbdbind.c, config/kbdbind.h, scripting/lua/core.c:

	Rename bind_scripting_func to bind_key_to_event_name.  

Tue May 10 17:31:23 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Use the Lua 5 APIs to load the base, table, IO, string, and math
	libraries. From Jon Shapcott.  

Tue May 10 17:25:18 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	A few blank lines, from Jon Shapcott.  

Tue May 10 17:20:47 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* AUTHORS, src/scripting/lua/core.c:

	Use luaL_ref instead of lua_ref, which is obsolete with Lua 5.  Idea
	by Jon Shapcott.  

Tue May 10 13:28:29 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	skip_space_end(),skip_nonspace_end(): match against space only not
	all white-space characters.  

Tue May 10 13:14:43 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	No need to skip space until we fully support NetWare listings.  

Tue May 10 13:11:33 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	Group code related to type setting.  

Tue May 10 13:08:58 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	Drop useless @pos initialization.  

Tue May 10 13:07:28 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	Fix a bad paste in ftp_unix_responses[].  

Tue May 10 12:56:05 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	parse_month(): Only skip three chars if the month is correctly
	parsed. Fixes issue with ftp://freebsd.isc.org/ reported by zas.  

Tue May 10 09:30:51 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/: parse.c, parse.h:

	Add ftp parser debugging stuff for ftp://ftp.freebsd.org/ 

Tue May 10 04:20:59 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Revert 1.85 and 1.84 changes.  

Tue May 10 03:36:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/dcigettext.c:

	_nl_find_message(): Fix strict aliasing warning. It would however be
	great to remove some of all the casts in that function.  

Tue May 10 03:31:19 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	check_number(): Fix strict aliasing warning.  

Tue May 10 03:30:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/snprintf.h:

	vasprintf(): Fix strict aliasing warning.  

Tue May 10 02:56:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/memory.h:

	mem_free_set(): Do not use local variable. It removes warnings about
	strict aliasing and the compiler can now warn when it is not passed
	a pointer reference.  

Tue May 10 02:02:53 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Really fix the quotes this time.  I forgot to escape the
	parenthesis.  

Tue May 10 01:58:03 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Sometimes there's a semi-colon, sometimes there's not.  Anyway, now
	it doesn't matter.  The demoronizer handles dumb-quotes properly
	now.  

Tue May 10 00:02:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: manual.html, manual.txt, book/introduction.xml,
	man/man1/elinksmanual.1:

	Add information about the LED status indicators.  

Mon May  9 21:47:21 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/: guile/hooks.c, lua/hooks.c, perl/hooks.c,
	ruby/hooks.c:

	Propagate mem_free_set.  

Mon May  9 21:41:32 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/: guile/hooks.c, lua/hooks.c, perl/hooks.c,
	ruby/hooks.c:

	Change the get-proxy hooks to free any old proxy string before
	assigning the new one to eliminate leaks reported by Jonas.  

Mon May  9 19:37:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/finger/finger.c:

	Remove empty line.  

Mon May  9 11:52:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	Doh, typo in --with-xterm patch.  

Mon May  9 11:17:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/rules:

	Configure --with-xterm="x-terminal-emulator -e".  

Mon May  9 11:16:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/setup.h, src/osdep/newwin.c:

	Add --with-xterm configure option to specify how the X terminal
	emulater is to be invoked. Useful for package maintainers.  

Mon May  9 10:42:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Normalize indentation.  

Mon May  9 10:40:10 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: manual.html, manual.txt, book/book.xml,
	man/man1/elinksmanual.1:

	Remove stuff which is mostly related to the doc/ directory.  

Mon May  9 10:34:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: Makefile.am, manual.html:

	Fix UTF-8 issues with Latin-1 chars in Josés name.  

Mon May  9 10:11:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: manual.html, manual.txt, man/man1/elinksmanual.1:

	Sync with current manual version. Looks like it wasn't generated
	after the typo and spell fixes made it in.  

Sat May  7 11:12:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.h:

	Describe enum retval entries.  

Sat May  7 11:11:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/cmdline.c:

	Try to clearify the internal use of RET_COMMAND. Requested by
	Miciah.  

Sat May  7 10:48:16 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Comment out bogus option alias. Spotted by Miciah.  

Fri May  6 23:34:41 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	In alert_lua_error, pass a copy of the message instead of the
	original to info_box. This avoids a problem reported by Jon Shapcott
	of garbled messages caused by the use of the message in the BFU code
	after it has been freed elsewhere.  

Fri May  6 11:27:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/smb/smb.c:

	Pass pointer ref to mem_free_set(). Fixes bug 670.  

Fri May  6 09:34:49 2005  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Make struct screen_state matches struct screen_char, and improve
	related macros.  

Thu May  5 23:37:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/viewer/text/view.c:

	Fix handling of key presses turning up as key prefixes. Debuged and
	fix proposed by Peder Stray.  

Thu May  5 15:47:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/book/: introduction.xml, mailcap.xml, mime.xml, tabs.xml,
	terminals.xml:

	Fix spelling and typos. Patch by Alexey Tourbin.  

Wed May  4 13:19:38 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/Makefile.am:

	Cleanup the update-manpages rule.  

Wed May  4 13:16:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/Makefile.am:

	Add update-manual to the dist target and lets see what happens.  

Wed May  4 13:08:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/Makefile.am:

	Distribute the doc/tools scripts. This will make it possible to now
	maintain manual.txt and manual.html in cvs but still generate them
	for the tarball.  

Wed May  4 10:30:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: manual.html, manual.txt, book/.cvsignore, book/book.xml,
	book/introduction.xml, book/mailcap.xml, book/terminals.xml,
	book/urlshortcuts.xml, man/man1/elinksmanual.1:

	Fix the artwork.  

Tue May  3 23:49:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: man/man1/elinksmanual.1, man/man5/elinks.conf.5,
	tools/help2doc, man/man5/elinkskeys.5:

	Reference the new elinksmanual.1 man page.  

Tue May  3 23:48:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/book/: Makefile.am, config/.cvsignore, config/.vimrc,
	config/elinks.conf.xml, config/examples.xml, config/syntax.xml:

	Readd the config/ XML files. Forgot they are used by help2doc.  

Tue May  3 23:31:49 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/Makefile.am:

	Remove the crufty messages.  

Tue May  3 23:27:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/Makefile.am:

	Cleanup space.  

Tue May  3 23:15:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: Makefile.am, manual.html, manual.txt,
	man/man1/elinksmanual.1:

	Cleanup the makefile. Make the 'Revision' info be that of the
	book.xml file.  

Tue May  3 23:14:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/tools/xml2rfc:

	Make the script generate nroff output if the extension is .1.  

Tue May  3 22:39:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/book/book.xml:

	Do not specify the month. xml2rfc does that automatically.  

Tue May  3 22:33:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: Makefile.am, manual.html, manual.txt, man/man1/Makefile.am,
	man/man1/elinksmanual.1:

	Add the manual in man page format.  

Tue May  3 21:05:32 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* po/pl.po:

	Dropped old, commented out entries 

Tue May  3 20:12:38 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* po/pl.po:

	Polish translation was updated 

Tue May  3 18:21:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Tue May  3 18:01:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/: .cvsignore, control, control.in, rules:

	Merge bits from the debian package.  

Tue May  3 17:48:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/changelog:

	Merge bits from the debian changelog.  

Tue May  3 17:30:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/index.txt:

	Hmm, looks like I forgot to remove the mime.html which is now part
	of the manual.  

Mon May  2 20:29:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, main.h, config/cmdline.c, config/cmdline.h:

	Really fix the exit code issue from last patch by introducng
	RET_COMMAND that will like the previous version exit if the command
	line handler requested it.  

Mon May  2 20:20:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Do not exit with RET_SYNTAX code when a command line handler returns
	the empty string.  

Mon May  2 13:23:49 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon May  2 12:58:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, doc/Makefile.am:

	Make configure check if tclsh is present.  

Mon May  2 12:32:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, doc/book/manpages/Makefile.am:

	Readd the doc/book dirs + minor makefile fix.  

Mon May  2 12:16:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: manual.html, manual.txt:

	Update the manual.  

Mon May  2 12:15:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: Makefile.am, book/Makefile.am, book/manpages/Makefile.am:

	Fixup automake files so the new stuff gets into EXTRA_DIST etc.  

Mon May  2 12:11:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: manual.txt, mime.html, book/book.xml, book/mime.xml:

	Convert Jose's MIME guide.  

Mon May  2 12:10:20 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/tools/xml2rfc:

	Add license info from the tarball.  

Mon May  2 12:04:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/Makefile.am:

	Revert last patch.  

Mon May  2 11:58:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/Makefile.am:

	Fail if the .txt version cannot be made.  

Mon May  2 11:41:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: bookmarks.txt, exmode.txt, introduction.txt, mailcap.txt,
	marks.txt, remote.txt, tabs.txt, terminal.txt, urlprefixes.txt:

	Remove files which are now maintain in RFC 2629 XML format.  

Mon May  2 11:40:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/index.txt:

	Point to the manual.  

Mon May  2 11:36:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: manual.html, manual.txt:

	Run make update-manual and add the result.  

Mon May  2 11:36:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/Makefile.am:

	Add build rule.  

Mon May  2 11:26:36 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/tools/xml2rfc:

	Add tclsh script for converting the manual. I didn't write it, just
	working on some modifications to make it spit out txt files in
	another format.  

Mon May  2 11:24:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/book/config/: .cvsignore, .vimrc:

	Remove fairies.  

Mon May  2 11:23:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/book/: book.xml, bookmarks.xml, exmode.xml, introduction.xml,
	mailcap.xml, marks.xml, remote.xml, tabs.xml, terminals.xml,
	urlshortcuts.xml:

	Add new style manual XML. Use xml2rfc to convert it.  

Mon May  2 11:21:05 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/book/: Makefile.doc, TODO, book.xml, config.ent.in,
	elinksbook.dtd, config/elinks.conf.xml, config/envvars.xml,
	config/examples.xml, config/files.xml, config/mime.xml,
	config/syntax.xml:

	Remove the DocBook stuff. May you rest in peace.  

Mon May  2 07:33:34 2005  Laurent Monin <zas@norz.org>:

	* src/config/options.inc:

	dissallow -> disalow.  

Mon May  2 02:48:17 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/conf.c:

	Don't leak dumbstring on invalid include directives.  

Sun May  1 23:27:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Change the allow_dark_on_black option yet again. Idea by miernik.
	Text by rrowan.  

Sun May  1 23:11:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/features.m4:

	Oops, readd eval removed in last patch.  

Sun May  1 22:38:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Oops, max-age= cache control should set the top-level expires
	varibale.  

Sun May  1 20:58:51 2005  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Hungarian translation updates, keyboard shortcut fixes.  

Sun May  1 20:55:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, config/m4/features.m4:

	Looks like sh on old solaris systems don't like ='s in the list to
	for loops.  

Sun May  1 18:57:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/Makefile.am:

	Looks like .awk.in version doesn't end up in the tarball.  

Sun May  1 14:34:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Fix formatting.  

Sun May  1 14:28:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Fix comment.  

Sun May  1 13:58:36 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Fix comment.  

Sun May  1 13:27:19 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	up -> hope 

Sun May  1 13:05:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Fix form positioning bug on www.bookshare.org. Reported by
	Christopher Moore.  

Sun May  1 13:04:03 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/forms.c:

	Simplify assertion. I feel like I did this patch before and failed.
	Hmm.  

Sun May  1 12:47:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/node.h:

	Cleanup macro.  

Fri Apr 29 18:14:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/generic.h:

	Add file permission bits not available on win32.  

Fri Apr 29 18:13:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/hardio.c:

	Compile fix for win32.  

Fri Apr 29 15:54:55 2005  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/timers.c, lowlevel/timers.h, util/conv.c,
	util/conv.h, util/snprintf.c, util/time.c, util/time.h:

	long|short int -> long|short.  

Fri Apr 29 07:40:51 2005  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/backend/xbel.c, protocol/smb/smb.c,
	scripting/lua/core.c:

	int -> size_t, ssize_t.  

Thu Apr 28 12:53:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/generic.h:

	Oops, fix #define for fseeko() to fseek() and not ftell(). Reported
	by arcatan.  

Thu Apr 28 08:19:30 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: progress.c, progress.h, progress.h:

	int -> off_t.  

Thu Apr 28 08:14:56 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: progress.h, connection.h:

	int -> off_t.  

Thu Apr 28 08:09:22 2005  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	int -> ssize_t.  

Wed Apr 27 22:49:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, download.h:

	struct type_query: Comment out the frame member. Looks like it is
	never assigned anything. Is this a bug? 

Wed Apr 27 22:39:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, download.h:

	struct file_download: Make block member boolean.  

Wed Apr 27 22:30:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, download.h:

	struct file_download: Rename last_pos to seek and store in off_t.  

Wed Apr 27 22:24:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	get_filesize_from_RETR(): Return off_t.  

Wed Apr 27 22:23:10 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: progress.c, progress.h:

	struct progress: Store pos and seek members in off_t. Change the
	callchain to reflect this.  

Wed Apr 27 22:18:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.h, progress.c, progress.h:

	struct connection: Store est_length member in off_t. Change the
	callchain to reflect this.  

Wed Apr 27 22:12:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.c, connection.h, progress.c, progress.h:

	struct connection: Store start member in off_t. Change the callchain
	to reflect this.  

Wed Apr 27 21:53:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Make loading_callback() static, really :P.  

Wed Apr 27 21:51:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: task.c, task.h:

	Make loading_callback() static.  

Wed Apr 27 21:41:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.c, connection.h:

	change_connection(): Make newpri arg a connection_priority enum.  

Wed Apr 27 18:36:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/hardio.c:

	Oops, fix (1.16 -> 1.17) 

Wed Apr 27 18:31:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: hardio.c, hardio.h:

	hard_read(), head_write(): Take datalen as size_t.  

Wed Apr 27 18:26:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/hardio.c:

	Tiny reformatting.  

Wed Apr 27 18:24:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/hardio.c:

	hard_read(), head_write(): t -> total, r -> read, w -> written 

Wed Apr 27 18:18:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/hardio.c:

	p -> data, l -> datalen 

Wed Apr 27 18:12:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Use size_t for read and write counters.  

Wed Apr 27 18:04:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Check both Pragma and Cache-Control.  

Wed Apr 27 17:55:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: parser.c, parser.h, renderer.c:

	Add support for parsing cache control info from http-equiv meta
	headers in HTML documents.  

Wed Apr 27 15:49:59 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	load_textarea_file(), textarea_edit(): use fseeko(),ftello(),off_t
	and size_t.  

Wed Apr 27 15:29:05 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/intl/gettext/libintl.h:

	Back to good looking version.  

Wed Apr 27 15:27:31 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* configure.in:

	Do not show gcc-4.* warnings.  

Wed Apr 27 15:15:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/conf.c, intl/gettext/loadmsgcat.c,
	lowlevel/connect.c, lowlevel/dns.c, osdep/os2/os2.c,
	protocol/ftp/ftp.c, sched/download.c, ssl/connect.c, ssl/connect.h,
	terminal/event.c, terminal/hardio.c, terminal/hardio.h,
	terminal/kbd.c, viewer/text/form.c:

	Use ssize_t to hold value returned from safe_read() and
	safe_write().  

Wed Apr 27 15:08:20 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/intl/gettext/libintl.h:

	Kill two gcc-4 warningns.  

Wed Apr 27 14:57:39 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/: cache.c, cache.h:

	Make truncate_entry() static.  

Wed Apr 27 14:53:28 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/generic.h:

	safe_write(), safe_read(): Use local ssize_t variable.  

Wed Apr 27 14:33:03 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/osdep/generic.h:

	Add checks for off_t, ssize_t, ftello() and fseeko().  

Tue Apr 26 19:40:09 2005  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	Fix forgotten OS/2 code, |prg| -> |progress|.  

Tue Apr 26 19:20:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: refresh.c, refresh.h:

	Introduce a workaround for document refreshing leading to
	neverending file download. It adds a restart member to struct
	document_refresh which is cleared when the refresh is not reloading
	the current document. It should do the right thing in most cases and
	the remaining ones users will just have to reload themselves to
	restart the refreshing. Reported by Neuromancer, and there is even a
	debian bug I wrongfully closed.  

Tue Apr 26 18:51:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/download.c:

	draw_file_download(): Check if download->progress still exists.
	Fixes crash with refreshing downloads and mailcap asking disabled.  

Tue Apr 26 15:21:31 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/document.c:

	add_link_info_to_string(): reduce indentation level.  

Tue Apr 26 15:19:29 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/document.c:

	add_link_info_to_string(): minor clarification.  

Tue Apr 26 15:11:36 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/document.c:

	Move code from document_info_dialog() to new
	add_link_info_to_string().  

Tue Apr 26 14:50:18 2005  Laurent Monin <zas@norz.org>:

	* src/sched/progress.c:

	Do not convert elapsed time to milliseconds anymore, use
	timeval_div_int() and drop progress_elapsed_in_ms() macro.  

Tue Apr 26 10:05:22 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: leds.c, leds.h:

	Drop useless number__ field of struct led.  

Tue Apr 26 10:01:29 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/leds.c:

	register_led(): cleanup.  

Tue Apr 26 09:56:28 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/leds.c, bfu/leds.h, dialogs/status.c,
	document/renderer.c, ecmascript/spidermonkey.c:

	Introduce (set|unset)_led_value() and a value_changed_flag to struct
	led, it permits to drop leds_backup array. No direct access to
	struct led fields are done outside leds.c.  

Sun Apr 24 22:51:45 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/leds.h:

	Make struct led use only 32 bits.  

Sun Apr 24 22:40:53 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: leds.c, leds.h:

	Fix previous patch, leds and leds_backup have to be of same type...
	Not perfect yet.  

Sun Apr 24 22:18:31 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/leds.c:

	sync_leds(): move clock test before leds test. Suggested by Jonas.  

Sun Apr 24 22:05:59 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/leds.c:

	Rework sync_leds() in an attempt to fix bug 649: always update when
	clock is enabled, not perfect yet; change order of tests to make
	this a last resort, and simplify leds backup code.  

Sun Apr 24 17:42:08 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	Introduce timeval_div_int() that divide an integer by a timeval_T,
	returning an integer value.  

Sun Apr 24 17:08:28 2005  Laurent Monin <zas@norz.org>:

	* src/sched/progress.c:

	has_progress(): drop use of progress_elapsed_in_ms(), since it
	converts timeval_T to milliseconds. timeval_to_milliseconds() will
	disappear in near future.  

Sat Apr 23 16:51:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/Makefile.am:

	Oops, nntp/codes.o is no longer required.  

Sat Apr 23 16:34:35 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/util/Makefile.am:

	Fix conditional building of util/scanner.o. HTML highlighting also
	uses it. Alphabetize conditionals.  

Sat Apr 23 15:58:54 2005  Laurent Monin <zas@norz.org>:

	* src/: cache/dialogs.c, cookies/cookies.c, cookies/cookies.h,
	cookies/dialogs.c, globhist/globhist.c, globhist/globhist.h,
	protocol/date.c, protocol/date.h, protocol/http/http.c,
	sched/download.h, util/conv.c, util/conv.h, util/time.h:

	Drop time_T and just use time_t.  

Sat Apr 23 15:43:00 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: connection.c, connection.h:

	add_keepalive_connection(), init_keepalive_connection(): time_T
	timeout -> long timeout_in_seconds.  

Sat Apr 23 13:32:32 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/leds.c, config/dialogs.c, config/kbdbind.c,
	lowlevel/connect.c, lowlevel/select.c, protocol/finger/finger.c,
	sched/connection.c, sched/download.c, sched/session.c,
	viewer/text/search.c:

	Whitespaces cleanup.  

Sat Apr 23 11:38:41 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Apr 23 11:01:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Sat Apr 23 10:58:35 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Try to further improve allow_dark_on_black description: Make it
	explicit that vice versa is bright on bright (should it be white?),
	remove strange '(!)' token and move the inlined ensure_contrast
	comment to self-hosted note.  

Fri Apr 22 15:54:59 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Apr 22 01:57:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Try to fix or rather work around bug 647. It looks like the table
	parsing can pick up forms twice, remove the form when it is added
	the second time and avoid the assertion failure.  

Fri Apr 22 01:25:15 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	Drop useless macros and make timeval_now() cleaner.  

Fri Apr 22 01:20:23 2005  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/select.c, util/time.c, util/time.h:

	limit_timeval_to_zero() -> timeval_limit_to_zero().  

Fri Apr 22 01:15:10 2005  Laurent Monin <zas@norz.org>:

	* src/: cache/cache.c, lowlevel/dns.c, lowlevel/select.c,
	lowlevel/timers.c, protocol/http/http.c, sched/connection.c,
	sched/progress.c, sched/session.c, util/time.c, util/time.h:

	get_timeval() -> timeval_now().  

Fri Apr 22 01:11:36 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	double_to_timeval() -> timeval_from_double().  

Fri Apr 22 01:07:11 2005  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/dns.c, protocol/http/http.c, sched/connection.c,
	sched/progress.c, util/time.c, util/time.h:

	seconds_to_timeval() -> timeval_from_seconds().  

Fri Apr 22 01:03:03 2005  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/timers.c, sched/progress.c, util/time.c,
	util/time.h:

	milliseconds_to_timeval() -> timeval_from_milliseconds().  

Fri Apr 22 00:55:52 2005  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/timers.c, sched/progress.c, util/time.h:

	Introduce timeval_copy() and use it instead of direct call to
	copy_struct().  

Thu Apr 21 22:45:39 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Disable the overly non-aggressive caching. It is hurting usability
	too much.  

Thu Apr 21 15:16:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/dialog.c:

	select_widget_by_id(): Be a little defensive and check the widget
	ID.  

Thu Apr 21 15:16:13 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Fix widget focusing in the type query dialog after the block
	terminal radio button was added. Also fix to correctly focus in
	anonymous mode.  

Thu Apr 21 11:50:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/elinks.conf, doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Thu Apr 21 11:50:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: cmdline.c, conf.c, conf.h:

	Add --config-dump which dump a configuration file with default
	options to stdout. Helpfull for packagemaintainers when providing an
	example config file and it costs nearly nothing.  

Thu Apr 21 02:36:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/nntp/: Makefile.am, codes.c, codes.h:

	Remove NNTP code device.  

Thu Apr 21 02:35:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.h, bfu/menu.c:

	Simplify header and fix compilation.  

Thu Apr 21 02:31:12 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/nntp/connection.c, sched/error.c, sched/state.h:

	Simplify the NNTP error reporting to just use the internal one.  

Thu Apr 21 01:56:13 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/nntp/connection.c:

	A few fixes.  

Thu Apr 21 01:29:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.h, dialogs/menu.c, osdep/generic.h,
	protocol/http/codes.c, protocol/nntp/codes.c:

	Introduce sizeof_array() and use it where possible.  

Thu Apr 21 01:00:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Make it possible to change the block flag so that apps will be
	correctly run.  

Thu Apr 21 00:59:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, download.h:

	struct type_query, file_download: external_handler_flags -> block 

Wed Apr 20 22:17:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: file/cgi.c, http/http.c:

	Fix CGI's usage of init_http_connection_info().  

Wed Apr 20 20:15:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	read_select(): Use S_TRANS instead of S_SSL_NEG. Fixes the download
	progress bar for HTTPS transfers. This is one place where the
	passing of connection states to socket functions is a little
	constructed and doesn't fix well to the old code.  

Wed Apr 20 14:35:19 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	status -> download 

Wed Apr 20 10:31:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Make open-...-in-background descriptions more readable. Idea by
	miernik.  

Wed Apr 20 10:20:48 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Do not access directly to timeval_T fields. Rewrite code so it does
	not use time_T, str_to_time_T(), nor timeval_T sec field.  

Wed Apr 20 10:12:01 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	Returns timeval_T * when possible.  

Wed Apr 20 10:04:47 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	Let get_timeval() returns a pointer to timeval_T.  

Wed Apr 20 02:15:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/dialogs.c:

	Show info about cache entry expiration.  

Wed Apr 20 02:00:36 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, protocol/http/http.c:

	Try to add support for less aggressive caching strategy. Disable
	document.cache.ignore_cache_control to try it. On the flip side
	maybe there are too many strange thing I don't understand about the
	caching policy that this patch is just plain wrong. Let's give it a
	try and either improve or disable if it turns out too wrong.  

Tue Apr 19 23:49:41 2005  Laurent Monin <zas@norz.org>:

	* src/util/time.h:

	Finally, drop warning about possible time_T overflow.  

Tue Apr 19 23:32:42 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: progress.c, progress.h:

	Do not export macro progress_elapsed_in_ms() anymore.  

Tue Apr 19 23:29:56 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/progress.c, sched/progress.c, sched/progress.h:

	Calculate average_speed,current_speed,estimated_time in
	update_progress(), saving the results in struct progress.  

Tue Apr 19 23:06:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inphist.c, bookmarks/backend/common.c,
	cookies/cookies.c, document/html/renderer.c, formhist/formhist.c,
	globhist/globhist.c, intl/gettext/localcharset.c,
	intl/gettext/localealias.c, mime/backend/mailcap.c,
	mime/backend/mimetypes.c, util/file.c, util/secsave.c,
	viewer/text/textarea.c:

	Add 'b' to mode string in fopen()-calls. More portable on win32
	platform and it is ignored on Unix-platforms.  

Tue Apr 19 22:44:10 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/progress.c:

	add_time_to_string() -> add_timeval_to_string().  

Tue Apr 19 22:43:10 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: progress.c, progress.h:

	progress_estimated_time() now returns a pointer to a timeval_T.
	Temporary move.  

Tue Apr 19 22:42:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* Unicode/cp1250.cp, Unicode/cp1257.cp, src/intl/codepage.inc:

	Use 0x0000 value for undefined codepage entries. More portable I
	think. Idea from links2.1pre16.  

Tue Apr 19 22:35:25 2005  Laurent Monin <zas@norz.org>:

	* src/util/: conv.c, conv.h:

	Replace add_time_to_string() by add_timeval_to_string().  

Tue Apr 19 22:22:26 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	Introduce timeval_to_seconds().  

Tue Apr 19 22:16:32 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: progress.c, progress.h:

	Convert struct progress elapsed field to timeval_T and modify
	update_progress() to reflect that change.  

Tue Apr 19 22:08:05 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: progress.c, progress.h:

	Convert struct progress dis_b field to timeval_T and modify
	update_progress() to reflect that change.  

Tue Apr 19 22:00:34 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	Introduce timeval_add_interval().  

Tue Apr 19 21:48:51 2005  Laurent Monin <zas@norz.org>:

	* src/sched/progress.c:

	update_progress(): regroup related lines, cleanup.  

Tue Apr 19 14:48:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	init_http_connection_info(): Blacklisting uses proxied URIs so get
	flags using conn->proxied_uri. Bug introduced in (1.412 -> 1.413)
	made links2 site inaccessible over proxy. Reported by rrowan. (bug
	658) 

Tue Apr 19 11:58:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/response.c:

	read_buffer->len -> read_buffer->length 

Mon Apr 18 23:06:44 2005  Laurent Monin <zas@norz.org>:

	* src/sched/progress.c:

	Oops, not seconds.  

Mon Apr 18 22:53:25 2005  Laurent Monin <zas@norz.org>:

	* src/sched/progress.c:

	start_update_progress(): make copy of old fields in a way where type
	of fields not such important.  

Mon Apr 18 22:45:10 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: progress.c, progress.h:

	Clarify units used.  

Mon Apr 18 22:18:00 2005  Laurent Monin <zas@norz.org>:

	* src/sched/progress.c:

	Drop unneeded parenthesis.  

Mon Apr 18 22:15:24 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: progress.c, progress.h:

	Move SPD_DISP_TIME and CURRENT_SPD_AFTER in c file instead of
	exporting them through header.  

Mon Apr 18 22:13:12 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: progress.c, progress.h:

	Convert progress_*() macros to functions.  

Mon Apr 18 22:07:16 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/progress.c, sched/progress.h:

	average_speed(),current_speed(),estimated_time() ->
	
	progress_average_speed(),progress_current_speed(),progress_estimated_time().

Mon Apr 18 22:00:27 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/progress.c, sched/progress.h:

	Use a macro to wrap access to @elapsed field of struct progress.
	Temporary move.  

Mon Apr 18 17:41:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/progress.h:

	Wrap prototype.  

Mon Apr 18 17:35:32 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/progress.c:

	draw_progress_bar(): @current -> @percent.  

Mon Apr 18 17:34:33 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/progress.c:

	draw_progress_bar(): @percent,@percent_len -> @s, @slen.  

Mon Apr 18 17:31:56 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/progress.c:

	draw_progress_bar(): @progress_ -> @progress.  

Mon Apr 18 17:31:13 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/progress.c:

	draw_progress_bar(): @progress -> @current.  

Mon Apr 18 17:27:37 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/: download.c, progress.c, progress.h, status.c:

	Pass a struct progress * to draw_progress_bar().  

Mon Apr 18 17:19:37 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/: download.c, progress.c, progress.h, status.c,
	status.h:

	Move draw_progress_bar() to dialogs/progress.  

Mon Apr 18 17:13:03 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/progress.h, dialogs/status.c, dialogs/status.h,
	sched/download.c, sched/download.h:

	Move download_is_progressing() to sched/download.  

Mon Apr 18 17:01:46 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.c:

	get_download_msg(): partly revert last patch and make it call
	get_progress_msg().  

Mon Apr 18 17:00:25 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/: Makefile.am, progress.c, progress.h:

	Copy code from get_download_msg() to new get_progress_msg(),
	introducing dialogs/progress.{c,h}.  

Mon Apr 18 16:57:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/download.c:

	Drop unneded parantheses.  

Mon Apr 18 16:37:02 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.c:

	Test for download progress outside get_download_msg(). Temporary
	move.  

Mon Apr 18 16:29:13 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.c:

	Simplify get_download_msg().  

Mon Apr 18 16:23:18 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/status.c, sched/progress.h:

	Finally drop significant_progress() since it looks like it has not
	much impact on display.  

Mon Apr 18 16:05:59 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/download.c, dialogs/status.c, sched/progress.h:

	Introduce has_progress() to fix bad move to significant_progress().  

Mon Apr 18 14:46:39 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: setup.h, protocol/auth/auth.c, protocol/auth/auth.h,
	protocol/auth/dialogs.c, protocol/http/http.c:

	HTTP_AUTH_{USER,PASSWORD}_MAXLEN -> AUTH_{USER,PASSWORD}_MAXLEN 

Mon Apr 18 14:32:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/auth/digest.c, util/md5.h:

	Move the MD5 system header including to our own MD5 header so it
	should be easier to use.  

Mon Apr 18 14:29:29 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/md5.h:

	2 cleanups and a fix.  

Mon Apr 18 12:53:50 2005  Laurent Monin <zas@norz.org>:

	* src/: setup.h, sched/progress.h:

	Move constants definitions from setup.h to progress.h since they are
	not subject to change.  

Mon Apr 18 12:46:35 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: connection.c, progress.c, progress.h:

	Initialize progress timer callback function and data through
	start_update_progress() and save them in struct progress().  

Mon Apr 18 12:28:47 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.c:

	Indentation fix.  

Mon Apr 18 12:28:09 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/status.c, sched/progress.h:

	Move progress related macros to progress.h.  

Mon Apr 18 12:26:41 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/download.c, dialogs/status.c, sched/progress.h:

	Introduce and use new macro significant_progress().  

Mon Apr 18 12:20:33 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/: download.c, status.c:

	Replace progress->elapsed / 100 by progress->elapsed >=
	CURRENT_SPD_AFTER * SPD_DISP_TIME to a more explicit one.  

Mon Apr 18 07:43:47 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Apr 17 23:23:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Use connection_state enum.  

Sun Apr 17 23:10:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	Use connection_state enum instead of int.  

Sun Apr 17 23:10:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: encoding/encoding.c, encoding/encoding.h,
	sched/Makefile.am, sched/download.h, sched/session.h,
	sched/state.h:

	Move connection enums to own file.  

Sun Apr 17 23:07:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	Fix some more includes.  

Sun Apr 17 23:03:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/renderer.c, protocol/nntp/response.h,
	sched/connection.h, sched/task.c:

	Fix some more includes.  

Sun Apr 17 22:26:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/location.h:

	Fix include.  

Sun Apr 17 21:38:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/http/http.h, protocol/nntp/connection.c,
	sched/connection.c, ssl/connect.c:

	Remove the void pointer parameter from all socket operations. This
	means less casting, shorter lines and should hopefully be more safe.  

Sun Apr 17 21:05:13 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: connection.c, progress.c, progress.h:

	Move progress related code from connection.c to progress.c.  

Sun Apr 17 20:41:42 2005  Laurent Monin <zas@norz.org>:

	* src/: sched/connection.h, sched/download.h, sched/location.h,
	sched/session.h, viewer/dump/dump.c:

	Move struct download to sched/download.h.  

Sun Apr 17 20:32:31 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/download.c, dialogs/status.c, protocol/ftp/ftp.c,
	protocol/http/http.c, sched/connection.c, sched/connection.h,
	sched/download.c:

	Fix progress.h inclusions.  

Sun Apr 17 20:18:57 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: connection.c, progress.c, progress.h:

	Reduce abstraction level, suggested by Jonas.  

Sun Apr 17 18:54:51 2005  Laurent Monin <zas@norz.org>:

	* src/: protocol/ftp/ftp.c, protocol/http/http.c,
	sched/connection.c, sched/connection.h:

	Make @progress a pointer to a struct progress in struct connection.  

Sun Apr 17 18:46:04 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: progress.c, progress.h:

	Introduce (init|done)_progress().  

Sun Apr 17 18:17:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	conn_info -> connect_info 

Sun Apr 17 18:11:53 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: connection.h, progress.h:

	Move struct progress to progress.h.  

Sun Apr 17 18:08:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	struct socket: Have separate members for read and write buffers.  

Sun Apr 17 18:08:00 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: Makefile.am, progress.c, progress.h:

	Add progress.{c,h}.  

Sun Apr 17 16:38:33 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.c:

	Typo fix.  

Sun Apr 17 16:37:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/conf.c:

	Only sleep after config errors when the text viewer is started. Use
	'\a' instead of 7.  

Sun Apr 17 16:36:30 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.c:

	No need to include this header now.  

Sun Apr 17 16:34:28 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/hierbox.c, dialogs/download.c, dialogs/download.h:

	Make download_browser static.  

Sun Apr 17 16:30:38 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/hierbox.c, bfu/hierbox.h, dialogs/download.c:

	Add a field do_not_save_state to struct hierbox_browser, and move
	FIXME to download_manager().  

Sun Apr 17 16:22:05 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/: download.c, download.h:

	Cleanup includes.  

Sun Apr 17 16:16:53 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/download.c, dialogs/download.h, sched/download.c:

	Introduce (init|done)_download_display().  

Sun Apr 17 16:03:31 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/: download.c, status.c, status.h:

	download_progress_bar() -> draw_progress_bar().  

Sun Apr 17 15:59:54 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/: download.c, download.h, status.c, status.h:

	Move download_progress_bar() from dialogs/download.{c,h} to
	dialogs/status.{c,h}.  

Sun Apr 17 14:10:34 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Fixed the fortune generator's prejudicial ignorance of the final
	entry in the fortune file.  

Sun Apr 17 13:31:29 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/elinks.fortune:

	I had no idea that 'z' stopped a connection.  Sounds like a good tip
	to me.  

Sun Apr 17 03:25:51 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Check for failure to register the hook and report any such failure.  

Sun Apr 17 03:22:56 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/kbdbind.c, config/kbdbind.h, scripting/lua/core.c:

	Register the hook in l_bindkey instead of in bind_scripting_func.  

Sun Apr 17 03:16:47 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/kbdbind.c, config/kbdbind.h, scripting/lua/core.c:

	Return the error message from bind_scripting_func by reference and
	actually return the event id.  

Sun Apr 17 03:09:52 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/kbdbind.c:

	In bind_scripting_func, move the hook registration after the check 
	whether the event was successfully registered.  

Sun Apr 17 01:59:05 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	This yummi patch removes struct connection usage from the socket
	interface. Cast away! 

Sun Apr 17 01:28:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, protocol/ftp/ftp.c:

	get_pasv_socket(): Take struct socket. Trims # of parameters.  

Sun Apr 17 01:15:20 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	make_connection(): Don't take connection pointer. ;) 

Sat Apr 16 21:25:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	rewrite_urig(): Simplify now that URI encoding is length-based.  

Sat Apr 16 21:22:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	encode_file_uri_string(): Simplify now that URI encoding is
	length-based.  

Sat Apr 16 21:21:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, protocol/uri.h, protocol/file/file.c,
	protocol/gopher/gopher.c, protocol/rewrite/rewrite.c,
	viewer/text/form.c:

	encode_uri_string(): Add magic namelen parameter.  

Sat Apr 16 15:36:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/Makefile.am:

	Distribute babelfish.lua.  

Sat Apr 16 14:46:18 2005  Laurent Monin <zas@norz.org>:

	* src/sched/connection.c:

	struct keepalive_connection: @add_time -> @creation_time.  

Sat Apr 16 14:41:50 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	Drop timeval_diff().  

Sat Apr 16 14:41:01 2005  Laurent Monin <zas@norz.org>:

	* src/sched/connection.c:

	Use timeval_T instead of double.  

Sat Apr 16 14:23:54 2005  Laurent Monin <zas@norz.org>:

	* src/: setup.h, lowlevel/dns.c:

	Use timeval_T instead of double.  

Sat Apr 16 09:22:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Remove CONFIG_DEBUGs around assertion. Miciah thinks it is stupid.  

Sat Apr 16 05:04:40 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Add to the todo on regex compilation error reporting.  

Sat Apr 16 05:03:33 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Use search_for_pattern in get_searched_regex.  

Sat Apr 16 05:00:11 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Move a TODO.  

Sat Apr 16 04:58:33 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Factor code out of is_in_range_regex into the new
	search_for_pattern.  

Sat Apr 16 04:47:38 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Add s2 to common_ctx.  

Sat Apr 16 04:46:28 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Use common_ctx.s1 where possible.  

Sat Apr 16 04:43:08 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Put the search pattern in common_ctx.  

Sat Apr 16 04:37:03 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	On second thought, make found common.  

Sat Apr 16 04:32:27 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Group the common_ctx initialisation and the ctx initialisation.  

Sat Apr 16 04:31:20 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Move stuff from the common struct regex_match_context to the
	specific contexts struct is_in_range_regex_context and struct
	get_searched_regex_context.  

Sat Apr 16 04:21:36 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Rename struct regex_match_context variables from ctx to common_ctx.  

Sat Apr 16 01:46:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Regroup.  

Sat Apr 16 01:44:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Describe conn_info.  

Sat Apr 16 01:38:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.h:

	D-scribe.  

Sat Apr 16 01:20:03 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	Make struct conn_info private.  

Sat Apr 16 01:13:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/http/http.c, ssl/connect.c:

	complete_connect_socket(): Provide functionality needed by HTTPs
	CONNECT implementation. It is a bit ugly, well hella ugly but it
	will make it possible to privatize conn_info.  

Sat Apr 16 00:40:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Call the conn_info callback from complete_connect_socket().  

Sat Apr 16 00:34:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	done_connection_info(): Make static.  

Sat Apr 16 00:31:49 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	Move conn_info->need_ssl to socket->need_ssl.  

Sat Apr 16 00:28:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, ssl/connect.c:

	Make the SSL-layer use complete_connect_socket() instead of
	done_connection_info().  

Sat Apr 16 00:15:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Only set the socket protocol family on success.  

Sat Apr 16 00:14:12 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	connect_socket(): Make the error handling the default path when the
	connect() loop terminates.  

Sat Apr 16 00:12:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	connect_socket(): Remove block variable and use function equivalent.  

Sat Apr 16 00:10:13 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	connect_socket(): Move the successful connection handling deeper.  

Sat Apr 16 00:03:27 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Move connect_socket() completion to complete_connect_socket().  

Fri Apr 15 23:31:45 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Improve comment.  

Fri Apr 15 23:25:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, sched/connection.h, sched/error.c:

	Introduce S_NO_FORCED_DNS used when all addresses for http6:// type
	URIs fails. The error message is a slightly modified version of
	S_NO_DNS: 'No host in the specified IP family was found'.  

Fri Apr 15 23:09:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Bitch about the irregularity of the world.  

Fri Apr 15 23:08:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	done_connection(): Ensure that connection always is in result state
	before notifying connection callbacks the last time. So set the
	state to S_INTERNAL if we have to. Should fix random crashes but
	there are still some corner case that should be fixed.  

Fri Apr 15 23:03:48 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	done_connection() notifies callbacks so remove commented out calls.  

Fri Apr 15 22:41:48 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	connect_socket(): Retry with the connection_state state it was
	passed. Fixes problem reported by Quazgaa when connecting fails, but
	the connection is not properly removed due to ending with non-result
	state.  

Fri Apr 15 22:34:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Connections should _always_ end in result state, that is either
	-errno or internal result state, so insert assertion but only for
	debug builds because I am not sure if it safely can be assumed that
	errno is always non-zero. This assertion will currently fail when
	connect_socket() runs out of addresses to try.  

Fri Apr 15 21:30:58 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Move the ctx setup in get_searched_regex.  

Fri Apr 15 21:27:39 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Put y1 in struct regex_match_context and use that instead of local 
	variables in is_in_range_regex_match and get_searched_match.  

Fri Apr 15 21:26:10 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Use ctx.y2 instead of y2 in is_in_range_regex.  

Fri Apr 15 21:23:57 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Fix something that was somehow lost earlier: Use ctx.textlen, not
	just textlen, in get_searched_match.  

Fri Apr 15 21:20:04 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Group and comment the fields in regex_match_context to explain which
	callback needs which. Later, I should split this into one common
	context and two callback-specific contexts.  

Fri Apr 15 21:17:48 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Factor code from that last loop in is_in_range_regex into the new 
	is_in_range_regex_match.  

Fri Apr 15 21:13:34 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Add y, y2, min, and max to struct regex_match_context for 
	is_in_range_regex_match's sake.  

Fri Apr 15 21:04:37 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Move local variable find from is_in_range_regex to struct
	regex_match_context.  

Fri Apr 15 21:01:11 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Use struct regex_match_context in is_in_range_regex.  

Fri Apr 15 20:58:14 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Factor code out of that last loop in get_searched_regex into the new 
	get_searched_regex_match, utilising struct regex_match_context.  

Fri Apr 15 20:51:06 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Introduce struct regex_match_context and move some of 
	get_searched_regex's local variables into it.  

Fri Apr 15 20:36:48 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	print_error_dialog(): Decode the URI.  

Fri Apr 15 19:53:41 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Rename parameter l to textlen in get_searched_regex.  

Fri Apr 15 19:52:32 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Make another loop in is_in_range_regex more like the corresponding
	loop in get_searched_regex.  

Fri Apr 15 19:51:38 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Throw some more whitespace in there, eh? 

Fri Apr 15 19:48:31 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Reform a loop in is_in_range_regex to better resemble the
	corresponding loop in get_searched_regex.  

Fri Apr 15 19:47:08 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Rename yy to y2.  

Fri Apr 15 19:45:56 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Continue making is_in_range_regex more resemble get_searched_regex 
	by adding the local variable y1 to is_in_range_regex.  

Fri Apr 15 19:40:16 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Move doclen calculation to get_search_region_from_search_nodes.  

Fri Apr 15 19:35:54 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Pass doclen to get_search_region_from_search_nodes by reference 
	instead of by value.  

Fri Apr 15 19:27:37 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Factor init_regex out of is_in_range_regex and get_search_regex.  

Fri Apr 15 18:25:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/info.c, lowlevel/select.c, lowlevel/timers.c,
	lowlevel/timers.h:

	Introduce timers_info() which replaces count_timers().  

Fri Apr 15 18:15:24 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/: babelfish.lua, config.lua, hooks.lua.in:

	Drop the bb, bb_en_fr, and bb_fr_en smartprefixes. Replace it with a
	new, more powerful URL-rewrite rule! 

Fri Apr 15 17:51:28 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Add short_desc_type=allwordssubstr to the Bugzilla URL-rewrite rule.  
	Without this, Bugzilla seems to ignore the search_desc argument, 
	returning every stinking bug it has.  

Fri Apr 15 17:48:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/hacking.txt:

	Reformat a bit.  

Fri Apr 15 16:24:43 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/timers.c:

	@interval: double -> timeval_T.  

Fri Apr 15 16:19:50 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/timers.c:

	Tidy up.  

Fri Apr 15 16:19:00 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/timers.c:

	check_timers(): use foreachsafe().  

Fri Apr 15 16:16:38 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	Introduce timeval_sub_interval().  

Fri Apr 15 15:18:38 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Remove unneeded SSL header.  

Fri Apr 15 15:03:48 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/: hooks.lua.in, md5check.lua:

	Move file_exists from md5check.lua to hooks.lua. Use it for the new 
	routine, dofile_if_fileexists. Use dofile_if_fileexists to load 
	config.lua so as to avoid annoying error messages on start-up.  

Fri Apr 15 15:01:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Move up connected() so no prototype is needed. Describe it.  

Fri Apr 15 14:55:22 2005  Laurent Monin <zas@norz.org>:

	* src/util/time.c:

	Fix buggy get_timeval().  

Fri Apr 15 14:48:54 2005  Laurent Monin <zas@norz.org>:

	* configure.in:

	Detect some useful functions.  

Fri Apr 15 14:45:19 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Define hooks_file in hooks.lua so that reload() will work even when
	there is no config.lua.  

Fri Apr 15 14:45:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/time.c:

	timeval_cmp(): Minor simplification.  

Fri Apr 15 14:42:08 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Drop whitespace from otherwise empty lines.  

Fri Apr 15 14:40:47 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Use _ALERT instead of print in do_ so that one sees any errors when
	from dofile or dostring.  

Fri Apr 15 14:21:46 2005  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/timers.c, util/time.c, util/time.h:

	Invert double_to_timeval() parameters to be consistent with other
	*_to_timeval() functions.  

Fri Apr 15 14:18:04 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	Introduce seconds_to_timeval().  

Fri Apr 15 14:14:48 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h:

	Introduce timeval_cmp() to compare timeval_T values.  

Fri Apr 15 13:32:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	get_pasv_socket(): Close the socket on error.  

Fri Apr 15 13:14:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	Remove get_pasv6_socket().  

Fri Apr 15 13:14:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, protocol/ftp/ftp.c:

	get_pasv_socket(): Support IPv6.  

Fri Apr 15 13:03:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	get_pasv_socket(): Use local struct sockaddr variables and addrlen
	size_t.  

Fri Apr 15 12:57:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	get_pasv_socket(): sa -> addr, sb -> bind_addr4.  

Fri Apr 15 08:09:29 2005  Laurent Monin <zas@norz.org>:

	* src/util/: conv.c, conv.h:

	Split add_time_to_string() to new add_duration_to_string(). It makes
	more obvious it displays duration and uses milliseconds.  

Fri Apr 15 04:42:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Dammit, patch fix part 2.  

Fri Apr 15 04:38:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Oops: A few sizeof() fixes for last patch.  

Fri Apr 15 04:11:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, protocol/ftp/ftp.c:

	get_pasv_socket(): Take sockaddr_storage pointer instead of hackish
	addr/port string.  

Fri Apr 15 03:47:27 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	Use ftp_data_accept() as a select handler; requires less state info.  

Fri Apr 15 03:30:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	ftp_retr_file(): Make sa local.  

Fri Apr 15 03:06:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	c_i -> ftp 

Fri Apr 15 02:50:27 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	close_socket() calls clear_handlers() so simplify.  

Fri Apr 15 02:49:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Remove assertion.  

Fri Apr 15 02:39:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, dns.c, dns.h:

	Change the DNS lookup memory management so that the DNS callback has
	to allocate the passed address array. This simplifies things a lot
	because the allocation is one place instead of currently two. Also
	it allows for better error reporting. Finally the error path of
	done_dns_lookup() is much simpler. The patch is quite big but I've
	tried to make up for it by adding comments.  

Fri Apr 15 02:09:05 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	done_dns_lookup(): Remove unneeded update of DNS result; the done
	label ain't using it.  

Fri Apr 15 01:27:19 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	async_dns_reader(): Move duplicate read loops to read_dns_data().  

Fri Apr 15 01:20:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	async_dns_writer(): Move duplicate write loops to write_dns_data().  

Fri Apr 15 01:00:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, lowlevel/connect.c, lowlevel/dns.c,
	lowlevel/dns.h:

	Introduce dns_result enum. Rename result variables to @result to get
	a feeling of all users.  

Fri Apr 15 00:13:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	done_async_dns_lookup(): Reduce indentation.  

Fri Apr 15 00:11:20 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	async_dns_{reader,error}(): Take dnsquery arg.  

Fri Apr 15 00:09:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	init_async_dns_lookup(): Ensure dnsquery->h is -1 if async DNS is
	disabled so done_async_dns_lookup() won't do crazy things.  

Fri Apr 15 00:08:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	init_async_dns_lookup(): Reduce indentation.  

Fri Apr 15 00:00:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	lookup_fn() -> async_dns_writer(), end_real_lookup() ->
	async_dns_reader(), failed_dns_lookup() -> async_dns_error().  

Thu Apr 14 23:52:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	add_to_dns_cache(): Do all the allocation before filling the
	dnsentry.  

Thu Apr 14 22:43:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	find_host_no_cache() -> init_dns_lookup().  

Thu Apr 14 22:40:42 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.h:

	Change LUA_ALERT from "alert" to "_ALERT" so that l_alert will be 
	correctly registered and errors will be reported. LUA_ALERT has been 
	"alert" since revision 1.13, which is mystifying as AFAICT, "alert" 
	has never been the correct value.  

Thu Apr 14 22:29:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Fix (1.101 -> 1.102) and only add_to_dns_cache() when @res(ult) is
	success.  

Thu Apr 14 22:27:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Regroup functions. Add labels.  

Thu Apr 14 22:14:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	done_dns_lookup(): Split out DNS caching to add_to_dns_cache().  

Thu Apr 14 15:45:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	kill_dns_request(): Call done_dns_lookup() directly.  

Thu Apr 14 15:39:51 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	Initialize @now using get_timeval(). Thanks to Jonas for catching
	this one.  

Thu Apr 14 15:39:12 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	kill_dns_request(): No need to NULLify queryref. We do it elsewhere.  

Thu Apr 14 15:34:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: dns.c, dns.h:

	query_p -> queryref -- takes me back to SML.  

Thu Apr 14 15:32:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Assert that we always have the query_p thingy.  

Thu Apr 14 15:29:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Oops, still set query_p to NULL when failing.  

Thu Apr 14 15:25:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	done_dns_lookup(): Fix bug from (1.84 -> 1.85) 'find_host(): Do not
	take address and address length references ...' Since query->addr is
	no longer a pointer reference do not check it. Fixes the error path
	when lookup fails.  

Thu Apr 14 14:57:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Always set query->qyery_p to NULL when freeing.  

Thu Apr 14 14:50:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Fix space, add an assertion and set dnsquery->h to -1 after closing
	it.  

Thu Apr 14 14:14:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	done_dns_lookup(): Fix mem_free_set() bug reported by zas.
	mem_free_set() checks if NULL so simplify logic.  

Thu Apr 14 14:06:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/dialogs.c, cookies/cookies.c, cookies/cookies.h,
	dialogs/download.c, document/html/frames.c,
	document/html/renderer.c, ecmascript/ecmascript.h,
	globhist/globhist.c, globhist/globhist.h, lowlevel/dns.c,
	lowlevel/select.c, lowlevel/timers.c, lowlevel/timers.h,
	protocol/date.c, protocol/date.h, protocol/ftp/parse.c,
	sched/connection.c, sched/connection.h, sched/download.c,
	sched/download.h, sched/session.c, util/Makefile.am, util/conv.c,
	util/conv.h, util/time.c, util/time.h, util/ttime.c, util/ttime.h:

	util/ttime.* -> util/time.* 

Thu Apr 14 13:11:58 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	Drop get_time(), finally.  

Thu Apr 14 13:07:48 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: connection.c, connection.h:

	More timeval_T usage. Add some FIXME about milliseconds.  

Thu Apr 14 13:03:03 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c:

	connection_timeout(): Move code to new timeout_socket().  

Thu Apr 14 12:50:29 2005  Laurent Monin <zas@norz.org>:

	* src/sched/connection.c:

	Use timeval_T in struct keepalive_connection and make needed
	changes.  

Thu Apr 14 12:41:35 2005  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	Drop get_time()/time_T, use get_timeval(),timeval_T instead.  

Thu Apr 14 12:33:46 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	Introduce timeval_to_milliseconds().  

Thu Apr 14 12:15:00 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	delta -> age.  

Thu Apr 14 12:11:32 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	get_time -> creation_time.  

Thu Apr 14 12:09:55 2005  Laurent Monin <zas@norz.org>:

	* src/: setup.h, lowlevel/dns.c:

	DNS_TIMEOUT -> DNS_CACHE_TIMEOUT.  

Thu Apr 14 11:07:01 2005  Laurent Monin <zas@norz.org>:

	* src/: setup.h, lowlevel/dns.c:

	Use timeval_T for dns cache timeouts, convert DNS_TIMEOUT from
	milliseconds to seconds. Please check if changes are correct.  

Thu Apr 14 10:52:00 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	select_loop(): @tv -> @t (timeval_T).  

Thu Apr 14 10:50:30 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/: timers.c, timers.h:

	get_next_timer_time(): use timeval_T.  

Thu Apr 14 10:48:17 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/: timers.c, timers.h:

	Make @interval a double and use timeval_T.  

Thu Apr 14 10:46:12 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/timers.c:

	Make @interval a double.  

Thu Apr 14 10:43:57 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	select_loop(): @last_time is now a timeval_T. Use get_timeval()
	instead of get_time().  

Thu Apr 14 10:41:59 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	Introduce double_to_timeval().  

Thu Apr 14 10:40:14 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	Introduce timeval_sub() and timeval_add().  

Thu Apr 14 10:37:55 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	Introduce timeval_diff().  

Thu Apr 14 10:36:24 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	Introduce get_timeval(), that retrieve current time.  

Thu Apr 14 10:34:43 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	limit_timeval_to_zero() now uses timeval_T.  

Thu Apr 14 10:33:40 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	timeval_is_positive() now uses timeval_T.  

Thu Apr 14 10:32:22 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	milliseconds_to_timeval() now uses timeval_T.  

Thu Apr 14 10:30:54 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	Drop timeval_subtract().  

Thu Apr 14 10:30:02 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.h, ttime.h:

	Introduce our own timeval_T and two conversion macros.  

Thu Apr 14 10:25:19 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c:

	Introduce done_socket() and move away code from
	free_connection_data().  

Thu Apr 14 10:18:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Compile fix ;) 

Thu Apr 14 10:13:29 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c:

	connect_socket(): It already clear_handlers() and most callers
	already close_socket() and close_socket() clear_handlers() so
	close_socket() before reconnecting.  

Thu Apr 14 03:05:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, sched/connection.c:

	Revert last patch. close_socket() is called between connect_socket()
	calls and we need the conn_info.  

Thu Apr 14 02:59:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, sched/connection.c:

	Move socket->conn_info freeing code from free_connection_data() to
	close_socket().  

Thu Apr 14 02:53:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	add_keepalive_connection(): Explicitly clear handlers and set the
	socket fd to -1 so it is safe to call close_socket() in
	free_connection_data().  

Thu Apr 14 02:32:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c,
	ssl/connect.c:

	connect_socket(): Take connection_state parameter.  

Thu Apr 14 01:28:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_send_header(): Remove set_connection_timeout() because it will
	eventually be set by by write_to_socket().  

Thu Apr 14 01:25:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	connect_socket(): conn_socket -> csocket, to make lines shorter.  

Thu Apr 14 01:02:39 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, protocol/ftp/ftp.c,
	protocol/http/http.c:

	read_select(): Set connection timeout and remove
	set_connection_timeout() calls in the start of read handlers.  

Thu Apr 14 00:40:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, protocol/about.c, protocol/data.c,
	protocol/file/cgi.c, protocol/file/file.c,
	protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c, protocol/smb/smb.c, sched/connection.c,
	sched/connection.h:

	{abort,retry}_conn_with_state() -> {abort,retry}_connection(). I
	hope this is acceptable.  

Thu Apr 14 00:34:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.c, connection.h:

	Merge {abort,retry}_connection() with
	{abort,retry}_conn_with_state().  

Thu Apr 14 00:31:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	connection_timeout(): Reformat.  

Thu Apr 14 00:28:10 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	connection_timeout(): Use ..._conn_with_state() functions.  

Thu Apr 14 00:24:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_end_request(): Use abort_conn_with_state().  

Thu Apr 14 00:17:49 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/finger/finger.c:

	finger_end-request(): Use abort_conn_with_state() and reformat.  

Thu Apr 14 00:11:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c:

	init_socket(): Move to lowlevel/.  

Wed Apr 13 23:58:16 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	init_socket(): Take pointer to operations.  

Wed Apr 13 23:44:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Prefer casting select handlers so they have the expected type.  

Wed Apr 13 22:12:48 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Update comments.  

Wed Apr 13 21:45:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, dns.c, dns.h:

	find_host(): Do not take address and address length references but
	pass the allocated variables via the dns_callback_T.  

Wed Apr 13 21:22:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, dns.c, dns.h:

	dns_callback_T: Pass address array and array length via the
	callback.  

Wed Apr 13 21:13:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.h:

	Describe the DNS interface.  

Wed Apr 13 20:42:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.h:

	Restructure the types.  

Wed Apr 13 20:40:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	More connect_socket() usage.  

Wed Apr 13 20:13:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c,
	ssl/connect.c:

	Create dns_found() wrapper named connect_socket(), which doesn't
	take state variable.  

Wed Apr 13 18:34:22 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Add some comments that (if we're lucky) describe the operation of
	get_range.  

Wed Apr 13 18:21:58 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Babelfish now requires the protocol portion of the URL to be
	specified.  

Wed Apr 13 17:32:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/renderer.c, ecmascript/spidermonkey.c,
	protocol/auth/dialogs.c, sched/task.c, scripting/lua/core.c,
	scripting/lua/hooks.c, scripting/perl/hooks.c,
	scripting/ruby/hooks.c, viewer/text/draw.c, viewer/text/vs.c:

	Add location header and fix compile errors.  

Wed Apr 13 17:31:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: action.c, history.c, history.h, session.h:

	Move go_back() and go_unback() wrappers to history header. Uninline
	because they are only called two places.  

Wed Apr 13 17:27:20 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Use table.insert, not table.tinsert. This typo-fix fixes the cvs
	rewrite hook and makes sure that the temporary file for the Mutt
	routine will be added to the tmp_files table for later deletion.  

Wed Apr 13 17:16:10 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/history.h:

	Declare struct location instead of including the evil location
	header.  

Wed Apr 13 17:14:49 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: history.c, history.h:

	Uninline and move add_to_history() and del_from_history away from
	the header. I hope it won't hurt performance too much but it really
	is entangling the built dependencies.  

Wed Apr 13 17:08:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/: cgi.c, cgi.h:

	More include cleanups.  

Wed Apr 13 16:53:10 2005  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/select.c, util/time.c, util/time.h, util/ttime.c,
	util/ttime.h:

	Introduce limit_timeval_to_zero() and use it in select_loop().  

Wed Apr 13 16:46:49 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	@a -> @tv.  

Wed Apr 13 16:46:14 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	Add timeval_is_positive() function.  

Wed Apr 13 16:35:02 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/: timers.c, timers.h:

	install_timer(): time_T time -> long int delay_in_milliseconds.  

Wed Apr 13 16:29:49 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	select_loop(): move get_next_timer_time() call after
	program.terminate test.  

Wed Apr 13 16:28:29 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	select_loop(): add a @timeout variable and check that we do not have
	negative delay.  

Wed Apr 13 16:20:17 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/timers.c:

	get_next_timer_time(): drop that +1 that does not make sense to
	anybody.  

Wed Apr 13 16:10:04 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	Drop useless static.  

Wed Apr 13 16:08:11 2005  Laurent Monin <zas@norz.org>:

	* src/util/: time.c, time.h, ttime.c, ttime.h:

	Introduce timeval_subtract() and milliseconds_to_timeval() to
	manipulate struct timeval.  

Wed Apr 13 15:34:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/: status.c, status.h:

	download_is_progressing(): Make it a real function. Speed up
	building by declaring used structs in the header.  

Wed Apr 13 15:29:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/gzip.c:

	No need to include sched/connection.h in the gzip code.  

Wed Apr 13 14:48:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, dns.c, dns.h:

	find_host(): Take no_cache boolean and make _no_cache version
	static.  

Wed Apr 13 14:40:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Use dns_callback_T.  

Wed Apr 13 14:35:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	done_dns_lookup(): Minor cleanup.  

Wed Apr 13 14:19:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/dns.c, protocol/file/cgi.c:

	close_pipe_read(): Takes data_socket because we might have used it
	as a callback for writing post data.  

Wed Apr 13 14:16:10 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Split out async DNS setup and teardown to
	{init,done}_async_dns_lookup(). #define them so the compiler will
	remove associated code when async lookup is disabled.  

Wed Apr 13 13:22:22 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/: select.c, timers.c, timers.h:

	Revert last patch: too big.  

Wed Apr 13 13:06:40 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/: select.c, timers.c, timers.h:

	Use struct timeval instead of time_T for timers. Some helper
	functions were added to do timeval calculations.  

Wed Apr 13 12:55:10 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	More DNS struct descriptions.  

Wed Apr 13 12:37:35 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	do_queued_lookup(): Simplify.  

Wed Apr 13 12:33:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Space tidyup.  

Wed Apr 13 12:28:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	struct dnsentry: Tidyup.  

Wed Apr 13 12:20:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	struct dnsquery: Only include @h thread descriptor member #ifndef
	NO_ASYNC_LOOKUP.  

Wed Apr 13 12:10:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Minor tidyup.  

Wed Apr 13 12:04:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Move end_real_lookup() inside #ifdef NO_ASYNC_LOOKUP. Fixes compile
	warning.  

Wed Apr 13 12:01:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	done_dns_lookup(): Also take care of clearing query->h handlers and
	closing the descriptor. It should be safer.  

Wed Apr 13 11:48:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	|&*query->addr| -> |query->addr|.  

Wed Apr 13 11:44:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	del_dns_cache_entry(): Move up and remove duplicate code.  

Wed Apr 13 11:42:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	|&*query->addr| -> |query->addr|.  

Wed Apr 13 11:39:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	shrink_dns_cache(): Use foreachsafe() and simplify
	del_dns_cache_entry().  

Wed Apr 13 11:25:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	struct http_connection_info: http_code -> code.  

Wed Apr 13 11:24:16 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Rename struct http_connection_info variables from info to http.  

Wed Apr 13 11:17:45 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Order macros by name.  

Wed Apr 13 11:16:03 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Fix unused POST_HTTP_1_1() macro.  

Wed Apr 13 10:50:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	get_http_code(): Take read_buffer arg.  

Wed Apr 13 10:29:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Guard CGI related code with #ifdef CONFIG_CGI.  

Wed Apr 13 04:41:05 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.h:

	Update socket->read_done description.  

Wed Apr 13 04:28:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	read_from_socket(): Take and set connection state. It simplifies
	things a bit and should make the code a little more responsive
	because connection callbacks will be run more often. It might be a
	bit too much so lets give it a few days.  

Wed Apr 13 03:48:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.h:

	Fix includes.  

Wed Apr 13 03:47:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: http.c, http.h:

	Move private HTTP types away from the public HTTP header.  

Wed Apr 13 03:44:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: file/cgi.c, http/http.c, http/http.h:

	init_http_connection_info(): Introduced.  

Wed Apr 13 02:48:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	request_from_socket(): Introduced to provide generic
	request/response connections. Removes lots of duplicated code.  

Wed Apr 13 02:28:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	Move read_buffer->state to socket->state.  

Wed Apr 13 02:17:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	Introduce socket_{write,connect}_operation_T.  

Wed Apr 13 01:27:20 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/nntp/codes.c:

	Give the NTTP error code dialog the sound of the generic error
	dialog.  

Wed Apr 13 00:58:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/nntp/codes.c:

	Remove obsolete comment.  

Wed Apr 13 00:42:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/http/http.h, protocol/nntp/connection.c:

	socket_read_operation_T: Also have socket parameter.  

Wed Apr 13 00:08:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.h, protocol/ftp/ftp.c:

	Introduce socket_read_operation_T and remove socket->read_done
	stupidity.  

Tue Apr 12 22:53:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c,
	ssl/connect.c:

	Introduce socket_operations. Reduces the size of struct socket a
	bit.  

Tue Apr 12 22:39:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c,
	ssl/connect.c:

	Use socket_handler_T for all socket handlers even though it leads to
	passing a few unused parameters.  

Tue Apr 12 22:09:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, ssl/connect.c:

	dns_exception(): Make it explicit that it takes socket parameter
	because it is exported.  

Tue Apr 12 21:54:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.h:

	Rearrange type declarations.  

Tue Apr 12 21:49:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c,
	sched/connection.h, ssl/connect.c, ssl/connect.h, ssl/ssl.c,
	ssl/ssl.h:

	connection_socket -> socket 

Tue Apr 12 21:24:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Oops, compile fix.  

Tue Apr 12 21:18:45 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	read_http_data(): Move S_HTTP_ERROR failing to default label and
	assert the @ret value.  

Tue Apr 12 21:11:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, ssl/connect.c:

	SOCKET_WANT_READ -> SOCKET_SSL_WANT_READ.  

Tue Apr 12 20:41:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, protocol/file/cgi.c,
	protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	read_from_socket(): Reset the connection timout. Remove unneeded
	calls to set_connection_timeout().  

Tue Apr 12 20:32:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_send_header(): Use http_end_request() instead of
	abort_conn_with_state().  

Tue Apr 12 20:27:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	write_to_socket(): Take connection_state varible which will be set
	if write is successfully started. This is much safer since
	write_to_socket() on error could have removed the @conn variable
	from under all callers.  

Tue Apr 12 20:16:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, protocol/file/cgi.c,
	protocol/ftp/ftp.c, protocol/nntp/connection.c:

	Make write_to_connection() reset the connection timout. Remove
	unneeded calls to set_connection_timeout().  

Tue Apr 12 20:08:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	gopher_protocol_handler(): Move code from default port label to be
	rather the fallback code.  

Tue Apr 12 20:05:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, protocol/finger/finger.c,
	protocol/ftp/ftp.c, protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	Make make_connection() take care of resetting the connection timout.
	Move a few set_connection_timeout() calls closer to the action.  

Tue Apr 12 18:31:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/select.h:

	m33p.  

Tue Apr 12 18:29:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/select.c:

	More select_handler_T usage.  

Tue Apr 12 18:26:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/select.c, lowlevel/select.h, terminal/kbd.c:

	enum select_handler_type: H_ -> SELECT_HANDLER_.  

Tue Apr 12 18:21:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: select.c, select.h:

	Move H_* types to enum select_handler_type.  

Tue Apr 12 18:12:10 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: select.c, select.h:

	get_handler(): Return select_handler_T.  

Tue Apr 12 18:08:13 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/select.h:

	Describe the select interface.  

Tue Apr 12 17:50:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/select.h, osdep/os2/os2.c,
	osdep/unix/unix.c, protocol/ftp/ftp.c, protocol/smb/smb.c,
	ssl/connect.c, terminal/kbd.c, terminal/terminal.c:

	Introduce select_handler_T so make casts more readable.  

Tue Apr 12 17:37:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	SSL don't need DNS header.  

Tue Apr 12 17:34:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c:

	ssl_want_read(): Simplify but add assertion in
	done_connection_info() to be save.  

Tue Apr 12 17:13:38 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.h, sched/connection.h:

	struct connection: Rearrange a few members. Use connection_state
	also for prev_error member.  

Tue Apr 12 16:58:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/http/http.c, ssl/ssl.c, ssl/ssl.h:

	get_ssl_connection_cipher(): Take connection_socket.  

Tue Apr 12 16:53:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.h, sched/connection.h, ssl/ssl.c:

	Move connection_socket to lowlevel/connect.h. The split is not very
	clean.  

Tue Apr 12 16:47:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/cgi.c, protocol/finger/finger.c,
	protocol/ftp/ftp.c, protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c, protocol/smb/smb.c, sched/connection.c,
	sched/connection.h, ssl/ssl.c:

	Make connection socket members allocated.  

Tue Apr 12 16:01:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/ftp/ftp.c, sched/connection.h:

	Move connection->read_func to connection_socket->read_done.  

Tue Apr 12 15:48:29 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	get_resp(): Reset the connection timeout like all other similar
	functions do. Make it explicit that we should retry on close. (it's
	enum value is zero and alloc_read_buffer() uses calloc() but better
	not depend on that).  

Tue Apr 12 15:38:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.h:

	Make socket_error descriptions more readable.  

Tue Apr 12 15:35:19 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Minor simplification. The branch returns after the #endif.  

Tue Apr 12 14:45:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	free_connection_data(): close_socket() clears handlers so simplify.  

Tue Apr 12 14:43:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Initialize both conn->socket and conn->data_socket.  

Tue Apr 12 14:25:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, ssl/connect.c:

	Merge {read,write}_buffer_state to socket_error enum.  

Tue Apr 12 14:21:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.h:

	A litl reformatting.  

Tue Apr 12 14:07:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	read_buffer_close -> socket_state, s/READ_BUFFER/SOCKET/,
	s/SOCKET_END/SOCKET_CLOSED/.  

Tue Apr 12 13:51:28 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: file/cgi.c, http/http.h:

	Make the HTTP header not include crazy stuff so the spidermonkey
	code won't have to recompile so often.  

Tue Apr 12 13:29:18 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	find_host_no_cache(): simplification.  

Tue Apr 12 13:26:08 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	@s -> @query_p.  

Tue Apr 12 13:13:24 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	qp, d, e -> query_p, dnsentry, dnsentry_p.  

Tue Apr 12 12:09:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	alloc_read_buffer(): Take connection_socket instead of connection.  

Tue Apr 12 08:11:05 2005  Laurent Monin <zas@norz.org>:

	* AUTHORS, src/viewer/text/search.c:

	Fix build error by including modules/module.h. Patch by Alexander
	Zschach.  

Tue Apr 12 00:41:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.h:

	Remove unneeded includes.  

Tue Apr 12 00:40:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c, ssl/connect.h:

	Change the socket reading interface and centralize the read_buffer
	access.  

Tue Apr 12 00:32:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Handle ssl_write()s using the new generic error handling.  

Tue Apr 12 00:31:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, ssl/connect.c:

	Introduce read_buffer_state enum to make handling of read()s in
	read_select() more centralized.  

Tue Apr 12 00:09:45 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Introduce generic_read() taking same variables as ssl_read().  

Mon Apr 11 23:56:36 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, ssl/connect.c:

	Introduce write_buffer_state enum to make handling of write()s in
	write_select() more centralized.  

Mon Apr 11 23:50:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Fix last patch.  

Mon Apr 11 23:32:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Introduce generic_write() taking same variables as ssl_write().  

Mon Apr 11 23:32:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	write_select(): f -> done.  

Mon Apr 11 23:12:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.h:

	struct conn_info: Oops, need_ssl is boplean.  

Mon Apr 11 23:09:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	struct read_buffer, write_buffer: Remove connection_socket member.
	It is automatically available.  

Mon Apr 11 23:07:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c:

	More simplifications.  

Mon Apr 11 23:04:48 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	write_select(): wb->socket -> socket.  

Mon Apr 11 22:59:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	struct conn_info: The connection_socket member is no longer needed.  

Mon Apr 11 22:57:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	read_select(): rb->socket -> socket.  

Mon Apr 11 22:55:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, ssl/connect.c:

	Change all select handlers to expect a connection_socket struct.  

Mon Apr 11 22:50:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c, ssl/connect.h:

	ssl_read(): No need to pass connection struct.  

Mon Apr 11 22:39:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c:

	write_to_socket(): No need to pass struct connection.  

Mon Apr 11 22:34:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c, protocol/ftp/ftp.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c, ssl/connect.c:

	read_from_socket(): No need to pass struct connection.  

Mon Apr 11 22:23:12 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.c:

	More connection_socket handler usage.  

Mon Apr 11 22:16:39 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, sched/connection.c, sched/connection.h:

	struct connection_socket: Add set_timeout() handler. Use in
	write_select().  

Mon Apr 11 21:58:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, sched/connection.c, sched/connection.h:

	Move the void *buffer member from struct connection to
	connection_socket.  

Mon Apr 11 21:44:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	dns_exception(): Use connection_socket handlers and minor cleanup.  

Mon Apr 11 21:39:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	Oops, dns_found() now takes connection_socket parameter.  

Mon Apr 11 21:37:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/smb/smb.c, sched/connection.c, ssl/connect.c:

	More close_socket() changes related to last patch.  

Mon Apr 11 21:35:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, protocol/ftp/ftp.c:

	close_socket(): No need to take connection parameter. I am a little
	puzzled about whether conn = NULL is some hidden feature or simply
	remains from the introduction of GNU TLS in version 1.21 from July 5
	2002. It is committed at 03:59 so it could be due to pasky's late
	night hacking frenzy. ;) 

Mon Apr 11 21:20:49 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c:

	dns_found(): Take connection_socket instead of connection.  

Mon Apr 11 21:15:39 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, protocol/http/http.c, ssl/connect.c,
	ssl/connect.h:

	ssl_connect(): No need to pass struct connection.  

Mon Apr 11 21:10:19 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	struct conn_info: Add boolean need_ssl member.  

Mon Apr 11 21:04:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Fix comment: s/conn/conn_socket/.  

Mon Apr 11 21:03:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: connect.c, connect.h:

	struct conn_info: Add a ip_family member initialized from
	uri->ip_family.  

Mon Apr 11 20:55:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	struct dnsquery: Remove xfn callback member. Rename end_dns_lookup()
	-> done_dns_lookup(). Call done_dns_lookup() directly instead of
	using dnsquery->xfn() in *_lookup() functions.  

Mon Apr 11 20:51:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: dns.c, dns.h:

	Introduce dns_callback_T. struct dnsquery: fn -> done.  

Mon Apr 11 20:28:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/http/http.c, sched/connection.c, sched/connection.h,
	ssl/connect.c:

	Move conn->conn_info to connection_socket. A few hacks which will
	have to be cleaned up was needed.  

Mon Apr 11 20:22:36 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	done_connection_info(): Use mem_set_free() again when NULLifying but
	pass the right pointer.  

Mon Apr 11 20:20:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	done_connection_info(): Don't mem_set_free() when NULLifying.  

Mon Apr 11 19:32:49 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	done_connection_info(): Use mem_set_free() when NULLifying.  

Mon Apr 11 19:30:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	dns_exception(): Access conn->socket directly when calling
	close_socket().  

Mon Apr 11 19:22:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	dns_found(): Use connection_socket handlers.  

Mon Apr 11 19:17:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	dns_found(): Use retry_conn_with_state(). I am not entirely sure the
	new code is equivalent to the old but I am pretty sure it is not far
	from. ;) 

Mon Apr 11 19:03:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	Make dns_cache static.  

Mon Apr 11 18:31:49 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, protocol/ftp/ftp.c, sched/connection.c,
	sched/connection.h:

	Move the boolean conn->protocol_family to the connection_socket
	struct.  

Mon Apr 11 18:26:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Compile fix.  

Mon Apr 11 18:23:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	dns_found(): Use local connection_socket variable. Assert that
	conn_info->socket is always set.  

Mon Apr 11 18:09:35 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	find_in_dns_cache(): e -> dnsentry.  

Mon Apr 11 18:07:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c,
	sched/connection.h:

	Move the conn->dnsquery pointer to the conn_info struct.  

Mon Apr 11 17:56:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	find_in_dns_cache(): Return the found dnsentry or NULL instead of
	error code.  

Mon Apr 11 17:16:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/dns.c, lowlevel/select.h,
	osdep/os2/os2.c, osdep/unix/unix.c, protocol/ftp/ftp.c,
	protocol/smb/smb.c, sched/connection.c, terminal/kbd.c,
	terminal/terminal.c:

	Introduce a clear_handlers() macro equivalent to
	set_handlers(socket->fd, NULL, NULL, NULL, NULL) calls.  

Mon Apr 11 16:45:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	dns_found() is already declared in the header so remove.  

Mon Apr 11 16:35:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.c, sched/connection.h, ssl/connect.c:

	Introduce set_state() handler for the connection_socket. Use it in
	the SSL code.  

Mon Apr 11 16:23:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	ssl_connect(): Always use the connection_socket variable instead of
	accessing it via connection or conn_info struct.  

Mon Apr 11 16:21:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c, ssl/connect.h:

	No need to passs struct connection parameter to ssl_write().  

Mon Apr 11 16:18:13 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/: connect.c, connect.h:

	No need to passs struct connection parameter to ssl_close().  

Mon Apr 11 16:15:35 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.h:

	Improve the socket done handler description.  

Mon Apr 11 16:14:38 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	Use socket->conn instead of conn parameter.  

Mon Apr 11 16:13:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	More socket operation usage.  

Mon Apr 11 16:05:02 2005  Laurent Monin <zas@norz.org>:

	* src/ssl/connect.c:

	ssl_write(): fix comment.  

Mon Apr 11 16:04:04 2005  Laurent Monin <zas@norz.org>:

	* src/ssl/connect.c:

	ssl_write(): try to make code more explicit.  

Mon Apr 11 15:58:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.c, sched/connection.h, ssl/connect.c:

	struct connection_socket: Add a data member and done() + retry()
	handlers. Use it in the SSL code.  

Mon Apr 11 15:40:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.h:

	Revert chunk which should not have been in last patch.  

Mon Apr 11 15:39:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.h, ssl/connect.c:

	ssl_write(), ssl_read(): Store the connection_state and use
	{abort,retry}_conn_with_state() instead of set_connection_state() +
	{abort,retry}_connection() combo.  

Mon Apr 11 15:31:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.h, ssl/connect.c:

	Move the no_tls boolean variable from struct connection to struct
	connection_socket.  

Mon Apr 11 08:10:07 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Apr 10 20:49:48 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Cleanup mess from last patch.  

Sun Apr 10 20:48:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Introduce a GOPHER_UNKNOWN entity type which works as a fall-back
	when no entity is available in the Gopher URI. Reported by Rowan.  

Sat Apr  9 16:48:19 2005  Jonas Fonseca <fonseca@diku.dk>:

	* test/href_tests.html:

	m33p.  

Sat Apr  9 14:30:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/auth/digest.c, util/md5.h:

	Move the MD5_DIGEST_LENGTH #define and the md5_digest_(bin|hex)_T
	typedefs so they can be used by others.  

Sat Apr  9 14:28:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	md5_(bin|hex)_digest -> md5_digest_(bin|hex)_T 

Sat Apr  9 14:26:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	Change the md5_(bin|hex)_digest types to not have room for NUL char.
	Makes it possible to use sizeof() when adding them to the response
	strings.  

Sat Apr  9 14:12:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/generic.h, protocol/uri.c:

	Move to IP_ADDRESS_BUFFER_SIZE #define near the INET[6]_ADDRSTRLEN
	stuff. 'Twill be needed by BitTorrent.  

Fri Apr  8 20:58:14 2005  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Update document.colors.allow_dark_on_black to explain that it allows
	light on white too.  

Fri Apr  8 14:44:36 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser.c:

	Only set a link's accesskey if the accesskey attribute's value is
	not an empty string.  

Fri Apr  8 13:13:35 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	Redo revision 1.274 without the copy-and-paste error.  

Fri Apr  8 11:32:42 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Fixed the bugzilla prefix when used to search for bugs.  

Fri Apr  8 09:15:10 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Revert 1.273 -> 1.274 patch, buggy.  

Fri Apr  8 07:54:43 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Apr  8 06:40:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	Do not honour NBSP_CHAR when skipping. I cut'n'pasted from the wrong
	code.  

Fri Apr  8 06:37:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	Skip non-link chars from attribute values. Fixes HTML highlighting
	of hrefs links with newlines etc in the value.  

Fri Apr  8 05:59:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/document.c:

	Also show link image info in the document dialog.  

Fri Apr  8 05:45:03 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: viewer/text/link.c, dialogs/status.c:

	Make sure get_current_link_title() only returns title string if it
	is non-empty. It is already checked by the status message handling
	but should also be checked for the document dialog which is
	currently showing empty link titles.  

Fri Apr  8 03:04:39 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: scripting/lua/core.c, config/kbdbind.c, config/kbdbind.h:

	Move the code to register the event from l_bind_key to
	bind_key_to_event.  

Thu Apr  7 23:34:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op(): Minor cleanup of insert mode handling.  

Thu Apr  7 23:25:58 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	Reintroduce blank line accidentally dropped in last patch. Sorry.  

Thu Apr  7 23:23:13 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	print_error_dialog(): Try to improve i18n.  

Thu Apr  7 23:14:56 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	Use a trampoline function named textarea_op() to reduce code
	redundancy among textarea_op_*(). Specific code from these were
	moved to do_op_*() new functions.  

Thu Apr  7 22:49:44 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/kbdbind.c:

	Rename bind_scripting_func to bind_key_to_event and introduce a
	wrapper with the old name.  

Thu Apr  7 22:47:32 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* configure.in:

	Add the builddir variable, initialised to "`pwd`".  
	
	Source $builddir/features.conf after sourcing $srcdir/features.conf.  
	
	This allows one to have a specific features.conf file for each build
	tree and to change compile-time settings without modifying a file
	that is tracked by CVS.  

Thu Apr  7 22:17:41 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/marks.c:

	Introduce free_mark_by_index() to reduce code redundancy.  

Thu Apr  7 20:47:35 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Change the wordings of print_error_dialog() to better suit the many
	failure reasons.  

Thu Apr  7 15:34:46 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* configure.in, src/scripting/lua/core.c:

	No support for Lua 4 in 0.11 (patch by fonesca).  

Thu Apr  7 15:01:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/generic.h, protocol/uri.c:

	Move INET[6]_ADDRSTRLEN #defines to better place.  

Thu Apr  7 14:09:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* test/refresh.html:

	Small refresh test.  

Thu Apr  7 13:53:45 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* po/pl.po:

	Polish translation was updated.  

Thu Apr  7 13:43:38 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* src/scripting/lua/core.c:

	Use lua_pushboolean() only when we have LUA5 or better. This fixes
	build with LUA 4 (foreported from REL_0_10 branch).  

Thu Apr  7 13:42:07 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* configure.in:

	Argh, wrong patch commited. This is a foreport from REL_0_10 branch.  

Thu Apr  7 13:39:31 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* configure.in:

	Check if we have LUA 5 or betterm so that we can use
	lua_pushboolean() in src/scripting/lua/core.c::l_get_option().  

Thu Apr  7 12:01:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Make find_uri_protocol() also check for '@' if it found ':' before
	it assumes that it found user/passwd part of an FTP URI. Fixes error
	reporting when entering garbage like 'ttp://.../' for recently added
	handling of <host>:<port> kind of URIs.  

Thu Apr  7 11:32:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, modules/module.c, viewer/text/search.c,
	viewer/text/search.h:

	Introducing search_history_module. And remove unneeded includes from
	main.c 

Thu Apr  7 11:26:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/urlhist.c:

	... and do not (un)register any event hooks.  

Thu Apr  7 11:25:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/urlhist.c:

	Capitalize the H in history.  

Thu Apr  7 11:23:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/urlhist.c, config/urlhist.h,
	modules/module.c:

	Introducing goto_url_history_module.  

Thu Apr  7 11:16:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, lowlevel/timer.c, lowlevel/timer.h,
	modules/module.c:

	Introducing timer_module.  

Thu Apr  7 11:06:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Move done_timer() to init_b block.  

Thu Apr  7 10:48:47 2005  Laurent Monin <zas@norz.org>:

	* src/: main.c, main.h, dialogs/menu.c, intl/gettext/loadmsgcat.c,
	lowlevel/home.c:

	Rename |path_to_exe| struct program field to |path| as
	|program.path| is sufficiently explicit.  

Thu Apr  7 10:45:42 2005  Laurent Monin <zas@norz.org>:

	* src/: main.c, main.h, dialogs/menu.c, intl/gettext/loadmsgcat.c,
	lowlevel/home.c, lowlevel/select.c, lowlevel/signals.c,
	terminal/event.c, terminal/terminal.c, viewer/dump/dump.c:

	Move globals @terminate, @retval and @path_to_exe to a struct named
	@program. It makes more obvious that these are global, and let us
	have eg. program.terminate = 1 ;).  

Thu Apr  7 10:23:20 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/leds.c:

	char -> unsigned char 

Thu Apr  7 10:00:54 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/leds.c:

	draw_timer(): timerlen -> length.  

Thu Apr  7 09:58:51 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/leds.c:

	Keep term->leds_length outside draw_clock().  

Thu Apr  7 09:50:38 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/leds.c:

	Move code from draw_leds() to new draw_timer() and draw_clock().  

Thu Apr  7 09:09:43 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/leds.c:

	draw_leds(): set @s array size to 64, which more than enough for
	timer and clock.  

Thu Apr  7 09:08:33 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/leds.c:

	draw_leds(): use sizeof() instead of hardcoded size of array.  

Wed Apr  6 22:33:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/: Makefile.am, guile/guile.h, lua/lua.h,
	perl/perl.h, ruby/ruby.h:

	Fix scripting sub module linking: Use extern for header declarations
	of struct module and link in the newly added
	scripting/<backend>/<backend>.o files.  

Wed Apr  6 22:30:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	struct keybinding: func_ref -> event.  

Wed Apr  6 21:31:29 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Ditto for the local variable int func_ref in send_kbd_event.  

Wed Apr  6 21:23:35 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/: kbdbind.c, kbdbind.h:

	Rename the int func_ref parameters of add_keybinding, kbd_action, 
	kbd_ev_lookup, and bind_scripting_func to event to reflect the
	current usage.  

Wed Apr  6 21:13:13 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/dialogs.c:

	In really_really_add_keybinding, pass EVENT_NONE to add_keybinding
	for the event argument instead of 0. This should have no practical
	effect as the event is ignored unless the action is
	ACT_MAIN_SCRIPTING_FUNC, which will not be the case from the 'Really
	add keybinding?' box.  

Wed Apr  6 17:29:05 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, protocol/protocol.c, sched/session.c,
	sched/session.h, sched/task.c:

	Improve error reporting via print_error_dialog() to also display the
	URI when possible.  

Wed Apr  6 17:02:00 2005  Petr Baudis <pasky@ucw.cz>:

	* doc/perl.pod:

	Ideas about some simple dialogs.  

Wed Apr  6 15:50:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	File under 0.10.4 

Wed Apr  6 15:08:14 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/kbdbind.c, config/kbdbind.h, lowlevel/timer.c:

	Drop the func_ref parameter from kbd_nm_lookup since nothing uses it
	or is likely to need it.  

Wed Apr  6 13:45:41 2005  Petr Baudis <pasky@ucw.cz>:

	* doc/perl.pod:

	Fixed tiny mistake in the ELinks::conf_eval() description.  

Wed Apr  6 13:41:55 2005  Petr Baudis <pasky@ucw.cz>:

	* doc/: Makefile.am, index.txt, perl.pod:

	First sketch of the Perl->ELinks scripting interface.  

Wed Apr  6 09:59:18 2005  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/lua/core.c:

	Scripting console TODO.  

Tue Apr  5 21:02:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/spidermonkey.c:

	Remove ; after if statement.  

Tue Apr  5 20:26:29 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/changelog:

	Merge Gervais changelog entry from 0.10.2-2.  

Tue Apr  5 20:18:07 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* debian/changelog:

	Clarify that keyboard accelerators for buttons _have_ _been_
	defined, not merely that they _can_ _be_ defined.  

Tue Apr  5 20:09:40 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Elaborate on keyboard accelerators.  

Tue Apr  5 20:02:48 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/changelog:

	Close some more debian bugs.  

Tue Apr  5 19:48:49 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/changelog:

	Close some more debian bugs.  

Tue Apr  5 19:47:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	Normalize and add button shortcuts.  

Tue Apr  5 19:47:16 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: Makefile.am, faq.html, index.txt:

	Add FAQ from homepage. (debian bug 301861) 

Tue Apr  5 15:41:12 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_vms_permissions(): reduce code redundancy.  

Tue Apr  5 12:45:16 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	parse_year() assumes the epoch is starting at 1.1.1970 so no need
	for that in parse_ftp_winnt_response(). Sloppy me.  

Tue Apr  5 12:42:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.h:

	s/ftp/FTP/ in last patch.  

Tue Apr  5 12:37:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.h:

	Describe the FTP parser testing #define.  

Tue Apr  5 12:35:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Fix garbage VMS-style line to have correct line end. Use
	parse_year() in parse_ftp_winnt_response().  

Tue Apr  5 12:01:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/: ftp.c, parse.c, parse.h:

	Add FTP parser testing infrastructure.  

Tue Apr  5 11:52:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	parse_month(): Fix buffer end guarding bug.  

Tue Apr  5 07:53:39 2005  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	By default should warnings too.  

Mon Apr  4 12:33:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	free_connection_data(): Move up active_connections decrementing so
	assertion failures won't get triggered because conn->running is
	already zero. Not likely with the current setup but just you wait.
	;) 

Mon Apr  4 12:30:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/changelog:

	I believe both /dev/stdin related debian bugs was squahed with the
	recent introduction of better !isatty(STDIN_FILENO) handling in
	check_stdio().  

Mon Apr  4 12:28:27 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.c:

	Make it possible to not use the scanner table.  

Mon Apr  4 12:18:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Remove DBG() calls.  

Mon Apr  4 12:16:10 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	parse_ftp_vms_response(): Use parse_date().  

Mon Apr  4 12:15:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, protocol/date.c, protocol/date.h,
	sched/download.c:

	Change parse_date() so it is more generally usable. However it is
	now butt ugly as well.  

Sun Apr  3 18:21:29 2005  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	html_dd(): minor code simplification.  

Sat Apr  2 05:41:03 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Minor cleanup to the random URL generator.  

Sat Apr  2 00:52:19 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Minor cleanup to bugmenot prefix.  

Fri Apr  1 23:18:08 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/document.c:

	Add a space between size and (incomplete) in document info dialog.  

Fri Apr  1 23:11:15 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	If Google Groups search string is contained in < and >, assume it's
	a message ID.  

Fri Apr  1 23:11:05 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/header.c:

	Fix redirection issues on newsnow.co.uk due to single quotes
	enclosing of URL. Please review carefully.  

Fri Apr  1 22:45:58 2005  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	process_head(): code simplification by dropping @saved_url, and
	using @joined_url declared in inner block.  

Fri Apr  1 17:50:52 2005  Laurent Monin <zas@norz.org>:

	* src/scripting/scripting.c:

	Drop #ifdef/#endif guards.  

Fri Apr  1 17:42:56 2005  Laurent Monin <zas@norz.org>:

	* src/scripting/: scripting.c, guile/hooks.h, lua/core.h,
	lua/hooks.h, perl/core.h, perl/hooks.h, ruby/hooks.h, ruby/ruby.h:

	Headers cleanup.  

Fri Apr  1 17:36:46 2005  Laurent Monin <zas@norz.org>:

	* src/scripting/: scripting.c, guile/Makefile.am, guile/core.c,
	guile/core.h, guile/guile.c, guile/guile.h, guile/hooks.h:

	Move guile_scripting_module to its own file, introducing
	guile.{c,h}, it permits to drop hooks/core interdependency.  

Fri Apr  1 17:29:41 2005  Laurent Monin <zas@norz.org>:

	* src/scripting/scripting.h:

	Just declare struct module.  

Fri Apr  1 17:27:18 2005  Laurent Monin <zas@norz.org>:

	* configure.in, config/m4/ruby.m4:

	Fix Guile and Ruby detection, it was a quoting issue. Thanks to
	Jonas.  

Fri Apr  1 17:20:59 2005  Laurent Monin <zas@norz.org>:

	* src/scripting/ruby/: Makefile.am, core.c, core.h, ruby.c, ruby.h:

	Move ruby_scripting_module to its own file, introducing ruby.c, it
	permits to drop hooks/core interdependency.  

Fri Apr  1 16:56:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	parse_ftp_unix_response(): Use parse_time() if memchr() finds a ':'
	in the time token.  

Fri Apr  1 16:54:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	parse_time(): Fix logic for testing buffer room, update the @time
	pointer when returning after HH:MM has been parsed and make s1, s2
	local.  

Fri Apr  1 16:25:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	parse_date(): Remove use of char variable.  

Fri Apr  1 16:21:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	Assume the epoch is starting at 1.1.1970 like Wget.  

Fri Apr  1 16:18:05 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	Try to make it a bit more obvious what bit flags are getting tested.
	Maybe a bit over-macroized.  

Fri Apr  1 15:36:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS:

	Add Sergey E. Galanov who added Lua-support for setting and getting
	Elinks options.  

Fri Apr  1 15:22:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/dialog.c:

	clear_dialog(): Comment the focus resetting introduced in (1.200 ->
	1.201).  

Fri Apr  1 15:17:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/dialogs.c:

	test_search(): De-compress start brace.  

Fri Apr  1 15:01:20 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/lists.h:

	Tidyup space.  

Fri Apr  1 09:47:28 2005  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/: Makefile.am, core.c, core.h, perl.c, perl.h:

	Move perl_scripting_module to its own file, introducing perl.c, it
	permits to drop hooks/core interdependency.  

Fri Apr  1 09:41:37 2005  Laurent Monin <zas@norz.org>:

	* src/scripting/lua/: Makefile.am, core.c, core.h, lua.c, lua.h:

	Move lua_scripting_module to its own file, introducing lua.c, it
	permits to drop hooks/core interdependency.  

Fri Apr  1 09:11:37 2005  Laurent Monin <zas@norz.org>:

	* src/scripting/: guile/core.c, lua/core.c, lua/hooks.c,
	perl/hooks.c, ruby/core.c:

	Do not include scripting.h.  

Thu Mar 31 10:24:18 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	frame_ev(): simplify code.  

Thu Mar 31 09:54:14 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	Do not even display () when accesskey attribute is present but
	empty.  

Thu Mar 31 09:44:49 2005  Laurent Monin <zas@norz.org>:

	* src/: viewer/text/link.c, config/kbdbind.c:

	Fix display of access key in status bar when accesskey attribute is
	set to "".  

Thu Mar 31 08:21:36 2005  Laurent Monin <zas@norz.org>:

	* src/scripting/lua/core.c:

	Add two new functions available from Lua scripts: set_option(name,
	value) and and get_option(name). Patch by Sergey and me. Please test
	and review.  

Wed Mar 30 21:10:30 2005  Laurent Monin <zas@norz.org>:

	* src/document/dom/renderer.c:

	Use mem_free_if().  

Wed Mar 30 20:57:28 2005  Laurent Monin <zas@norz.org>:

	* src/document/dom/navigator.c:

	Use mem_free_if().  

Wed Mar 30 20:25:11 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/: config.pl, hooks.pl:

	Add "email" to the sample configs.  

Wed Mar 30 20:20:53 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	The "bug" prefix now goes to the bugzilla main page or a list of the
	user's own bugs if "email" is specified in config.pl.  

Wed Mar 30 15:25:09 2005  Laurent Monin <zas@norz.org>:

	* src/: cache/cache.c, document/document.c,
	document/html/renderer.c, lowlevel/dns.c, terminal/screen.c,
	util/hash.c, util/lists.h:

	Introduce move_to_top_of_list() macro and use it where applicable.
	Please review.  

Wed Mar 30 13:12:29 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_unix_permissions(): minor cleanup.  

Wed Mar 30 13:00:45 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_unix_permissions(): returns 0 instead of -1 in case of
	parsing error.  

Wed Mar 30 12:54:46 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	display_dir_entry(): improve display of permissions (support for
	s/S/t/T).  

Wed Mar 30 12:42:33 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/backend/common.c:

	Simplify code a bit and add a warning about backends addition.  

Wed Mar 30 10:45:07 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	clear_dialog(): after clearing dialog fields move cursor to first
	widget, it helps with bookmark search dialog (and others).  

Wed Mar 30 10:30:44 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Move search related code to a better place.  

Wed Mar 30 10:28:13 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/: bookmarks.c, dialogs.c, dialogs.h:

	Introduce free_last_searched_bookmark() and make
	@bm_last_searched_title and @bm_last_searched_url static to
	dialog.c.  

Wed Mar 30 10:21:37 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Move code from bookmark_search_do() to new
	memorize_last_searched_bookmark().  

Wed Mar 30 10:11:32 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	@name -> @title, @foldername.  

Wed Mar 30 10:09:03 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/: bookmarks.c, dialogs.c, dialogs.h:

	Be coherent: @bm_last_searched_name -> @bm_last_searched_title.  

Wed Mar 30 10:01:39 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	bookmark_search_do(): drop redundant @title and @url.  

Wed Mar 30 09:59:42 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	@search_title -> @title, @search_url -> @url.  

Wed Mar 30 09:55:40 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	struct bookmark_search_ctx: @ofs -> @offset.  

Wed Mar 30 09:52:37 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	test_search(): assert ctx->search_title && ctx->search_url instead
	of testing them, this case should not occur.  

Wed Mar 30 09:49:58 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	test_search(): move @ctx->found test to else branch.  

Wed Mar 30 09:48:55 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	test_search(): move @bm declaration inside else branch.  

Wed Mar 30 09:47:35 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	test_search(): drop @m, use @ctx->found instead.  

Wed Mar 30 09:38:46 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	bookmark_search_do(): cleanup, drop useless initializations, reorder
	code a bit.  

Tue Mar 29 15:25:19 2005  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_cursor_move_to_string(): enlarge @code buffer by one, safer.  

Tue Mar 29 10:39:15 2005  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_cursor_move_to_string(): use ulongcat() and drop useless @ret
	variable.  

Tue Mar 29 03:47:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	parse_date(): Use skip_time_sep() for skipping year/time separator.  

Tue Mar 29 03:35:48 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: date.c, date.h, ftp/parse.c:

	Export parse_day() and use for FTP ls parsing.  

Tue Mar 29 03:29:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	Make parse_day() take optional end pointer.  

Tue Mar 29 03:19:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	parse_date(): Cleanup skip_time_sep().  

Tue Mar 29 03:07:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: date.c, date.h, ftp/parse.c:

	Make parse_month() take optional end pointer.  

Tue Mar 29 02:59:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Use generic parse_month(). It introduces some ugly casts, tho.  

Tue Mar 29 02:59:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: date.c, date.h:

	Bloat parse_month() and make it modify the string pointer.  

Tue Mar 29 02:44:45 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Use generic parse_year(). It introduces some ugly casts, tho.  

Tue Mar 29 02:44:12 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: date.c, date.h:

	Make parse_year() modify the string pointer on success and make it
	take end of string pointer. Export it.  

Tue Mar 29 02:33:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	Simplify parse_year().  

Tue Mar 29 01:16:20 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Fix spacing, part two.  

Tue Mar 29 01:04:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Fix spacing.  

Tue Mar 29 01:03:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Use generic parse_time(). It introduces some ugly casts, tho.  

Tue Mar 29 01:03:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	Cleanup parse_time().  

Tue Mar 29 01:02:29 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.h:

	Add comments to exported functions.  

Tue Mar 29 00:35:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	Make parse_time() modify the string pointer on success and make it
	take end of string pointer.  

Tue Mar 29 00:21:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	Make parse_date() accept hh:mm[:ss] and hh:mm[AP]M.  

Mon Mar 28 23:24:11 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_unix_response(): minor code simplification.  

Mon Mar 28 23:21:28 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_unix_permissions(): replace C++ style comments by C style
	comments.  

Mon Mar 28 23:20:00 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	Drop trailing spaces.  

Mon Mar 28 23:19:00 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_unix_permissions(): borrow code from lftp and improve
	things a lot regarding recognized permissions and handling of parse
	errors.  

Mon Mar 28 22:26:29 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_unix_response(): go the safe way, test the length before
	anything.  

Mon Mar 28 22:23:01 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_unix_response(): minor simplification.  

Mon Mar 28 22:19:58 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_winnt_response(): make that 39 more obvious.  

Mon Mar 28 22:18:27 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_file_info(): assert parameters.  

Mon Mar 28 22:17:19 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/parse.c:

	parse_ftp_file_info(): minor simplification.  

Mon Mar 28 19:09:19 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Safeguard EPLF parsing; if no more fact separators are found set
	@pos to @end.  

Sun Mar 27 23:01:07 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Completed the documentation clarification.  

Sun Mar 27 22:59:41 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/: bm.lua, hooks.lua.in, md5check.lua, remote.lua:

	Update some scripts to use the proper function and table names for
	Lua 5.  
	
	Add dostring and read from Lua's compat.lua to hooks.lua.in.  

Sun Mar 27 22:44:05 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/: bm.lua, md5check.lua:

	Drop some uses of upval now that we've moved to Lua 5.  

Sun Mar 27 22:36:46 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/config.lua:

	Add a reminder to copy any scripts that one wishes to use to one's
	home directory.  

Sun Mar 27 22:35:46 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/config.pl:

	Properly comment config.pl so it's readable.  

Sun Mar 27 22:31:16 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/config.lua:

	Delete another reference to bookmark_addon.  

Sun Mar 27 22:30:05 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/config.lua:

	Update the section for the bookmarks addon to reflect that it is now 
	enabled by loading bm.lua rather than by enabling bookmark_addon and
	it the section with the other load commands.  

Sun Mar 27 22:27:08 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/config.lua:

	Update the section for highlighting to reflect that one now must
	load highlight.lua instead of enabling highlight_enable and move it
	with the other load commands.  

Sun Mar 27 22:25:04 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/config.lua:

	Fix some grammar and spelling errors in the description for
	highlight_enable.  

Sun Mar 27 22:21:58 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/config.lua:

	Drop the comments about enable_systems_functions, which has been
	removed.  

Sun Mar 27 22:20:27 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/config.pl:

	And here's config.pl.  

Sun Mar 27 22:20:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/elinks.fortune:

	Mention the history auto-completion.  

Sun Mar 27 22:18:02 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/Makefile.am:

	Added a sample config.pl containing the default values for hooks.pl.  

Sun Mar 27 22:01:28 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Clarified the language of the opening documentation.  

Sun Mar 27 21:58:11 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: osdep/os2/os2.c, scripting/lua/core.c:

	Use sanitize_title in Lua's l_current_title and the implementation 
	of set_window_title for OS/2. Besides shortening the code, this also 
	will cause the whitespace to be trimmed from the start and the end 
	of the title.  

Sun Mar 27 21:57:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	display_dir_entry(): Zas will probably don't like this, but remove
	local @is_dir variable and check ftp_info->type ==
	FTP_FILE_DIRECTORY instead.  

Sun Mar 27 21:55:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	add_dom_link(): Use convert_string() to get the decode entities in
	references.  

Sun Mar 27 21:51:29 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/util/conv.c:

	In sanitize_title, check explicitly for NBSP_CHAR (altho currently 
	NBSP_CHAR is defined at 1, so it will be caught when we check < '
	').  

Sun Mar 27 21:43:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	display_dir_entry(): Remove unused @is_file variable.  

Sun Mar 27 21:15:20 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Sun Mar 27 21:07:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS:

	Remove authors of the recently purged ftpparse code.  

Sun Mar 27 19:39:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS:

	Mention code snatching from other projects in AUTHORS. Idea by
	Miciah.  

Sun Mar 27 18:32:07 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/ftp/parse.c:

	Stop including ftpparse's header file now that ftpparse is gone.  

Sun Mar 27 18:14:27 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/event.c:

	Use snprintf instead of strcpy and strcat in check_terminal_name.  

Sun Mar 27 18:06:12 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/auth/dialogs.c:

	Use the value returned by snprintf to save recalculating the length 
	of the string.  

Sun Mar 27 18:04:38 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/auth/dialogs.c:

	Check the return value of snprintf in do_auth_dialog.  

Sun Mar 27 17:39:29 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/file/file.c:

	Use encode_uri_string to add the base href when generating file
	listings. This closes bug 358.  

Sun Mar 27 14:59:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/Makefile.am:

	Purge the ftpparse code (part II).  

Sun Mar 27 14:58:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/: Makefile.am, ftpparse.c, ftpparse.h:

	Purge the ftpparse code. It has been replaced by Wget-based code.
	Fixes license problem with ftpparse.{c,h} (debian bug #300889). Now
	it needs to be ported back to 0.10. ~CCMAIL:
	300889-forwarded@bugs.debian.org, grin@grin.hu~ 

Sun Mar 27 14:53:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Fall-back to use the Un*x-style parser if nothing else is
	recognized. The ftpparse code is no longer needed.  

Sun Mar 27 14:51:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Add a FTP directory parser for the MSDOS/WinNT format. It is based
	on the wget code but uses the ftpparse files method for determining
	which parser to use.  

Sun Mar 27 14:50:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Fix month mapping bug in the FTP parser for VMS-style listing.  

Sun Mar 27 14:27:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Move the FTP permission parsers near the line response parser.  

Sun Mar 27 14:25:35 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	Oops, last patch was poisoned by my testing hacks. Revert.  

Sun Mar 27 14:24:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/: ftp.c, parse.c:

	Add a FTP directory parser for the VMS format. It is based on the
	wget code but uses the ftpparse files method for determining which
	parser to use.  

Sun Mar 27 13:36:18 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Reduce indentation level in follow_url_hook().  

Sun Mar 27 13:35:49 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Reindent some if conditions.  

Sun Mar 27 13:33:57 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Oops, fix the Collapse XBEL Folders quit_hook() missing from the
	pod.  

Sun Mar 27 13:23:28 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	POD documentation of the mapping functions.  

Sun Mar 27 13:02:39 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Sticked short Developer's usage section near each hook.  

Sun Mar 27 12:44:26 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Short note about why the name->URL mapping won't be PODized.  

Sun Mar 27 12:43:01 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	quit_hook() PODized.  

Sun Mar 27 12:39:14 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	proxy_for_hook() PODized.  

Sun Mar 27 12:29:38 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	PODize pre_format_html_hook().  

Sun Mar 27 12:21:28 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Document the follor_url_hook() by POD.  

Sun Mar 27 12:14:57 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	PREFIXES -> GOTO URL REWRITES and some short introduction for it.  

Sun Mar 27 12:11:55 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Massive compilation fix. The stupid Perl can't handle pods inside of
	expressions! 

Sun Mar 27 11:30:52 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Moved sub loadrc() near the CONFIG FILE section.  

Sun Mar 27 11:26:23 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	NAME, DESCRIPTION, SEE ALSO, AUTORS sections. Short notice in the
	header regarding how to squeeze the documentation from the file.
	Changes in the CONFIGURATION FILE section.  

Sun Mar 27 11:12:38 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	The joy of literate programming. Make the documentation of various
	prefixes pod-clean and nicely intertwinned with the hashes.  

Sun Mar 27 07:23:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Add a FTP directory parser for the Un*x format. It is based on the
	wget code but uses the ftpparse files method for determining which
	parser to use.  

Sun Mar 27 07:11:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Oops, forgot to include the ELinks master header.  

Sun Mar 27 07:10:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Use a switch when determining what parser to use.  

Sun Mar 27 07:09:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Introduce parse_ftp_number() helper.  

Sun Mar 27 07:05:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	Minor cleanup to use the type char from the ftp_file_info struct.  

Sun Mar 27 04:12:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/parse.c:

	Add a FTP directory parser for the EPLF format.  

Sun Mar 27 04:05:20 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Further improved the documentation section for perldoc.  

Sun Mar 27 02:20:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: Makefile.am, ftp/Makefile.am, ftp/ftp.c,
	ftp/parse.c, ftp/parse.h:

	Introduce gluecode that will ease the transition from using ftpparse
	to using the modified wget parser.  

Sun Mar 27 02:19:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/: ftpparse.c, ftpparse.h:

	Add vms member to the ftpparse struct to make it possible to know
	how to parse the permission string.  

Sun Mar 27 01:54:30 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Lined up a whole lot of => as suggested by pasky.  

Sun Mar 27 01:33:09 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	A little more brace expansion.  Also the comment over BBC referred
	to Google.  

Sun Mar 27 01:17:53 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	I forgot to list the Dialectizer at the top.  

Sun Mar 27 00:51:40 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Uncompact braces in pre_format_html_hook.  

Sun Mar 27 00:49:19 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Return the actual URL rather than $url.  

Sun Mar 27 00:35:10 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Return the actual URL rather than $url as per Pasky's example.  

Sun Mar 27 00:24:10 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Return the actual URL rather than $url as per Pasky's example.  

Sat Mar 26 23:53:35 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Strip training spaces from URLs.  Useful when ELinks is launched by
	another application.  

Sat Mar 26 23:42:26 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Added a new prefix: the Dialectizer.  

Sat Mar 26 23:25:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Markup button shortcuts.  

Sat Mar 26 23:05:51 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Drop the trailing underscore from hash names.  

Sat Mar 26 23:03:04 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	De-compressed some braces.  

Sat Mar 26 22:48:31 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	Provided what I believe to be clearer comment grouping.  

Sat Mar 26 22:34:56 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	The weather prefix was broken.  There was no need to check for
	jeeves, and it wasn't falling back to the default.  

Sat Mar 26 22:05:45 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	config options with a space in them ("ask jeeves", for example) work
	again 

Sat Mar 26 21:42:36 2005  Russ Rowan <rrowan@dandy.net>:

	* contrib/perl/hooks.pl:

	search works with quotes again 

Sat Mar 26 19:08:33 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Move the more-or-less normal locators to a special array etc, you
	know the rest of the story.  

Sat Mar 26 18:06:52 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Make the news servers goto prefixes matching data-driven.  

Sat Mar 26 17:49:17 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Fixed search(), now it actually appends the query to the URI.  

Sat Mar 26 17:48:33 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Kill the now-obsolete %news_, $news_.  

Sat Mar 26 17:48:06 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	The news servers were thrown to %news_servers_ with sub news as an
	accessor (similar to search()).  

Sat Mar 26 17:23:03 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	loadrc() now by default returns an empty string. Fixes nonsensical
	behaviour in many cases where this was assumed but 'no' was in fact
	returned.  

Sat Mar 26 17:19:25 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Separate the weather locators to own hash.  

Sat Mar 26 15:39:00 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Moved news and locators just behind search engines.  

Sat Mar 26 14:44:20 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Make the search engine prefix matching in goto_url_hook()
	data-driven.  

Sat Mar 26 14:35:07 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Oops, fix the totally broken broken search(). Forgot the home/search
	distinction. ;-) 

Sat Mar 26 14:33:59 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	In the search engines processing of goto_url_hook(), make the search
	query regexp more whitespace-tolerant.  

Sat Mar 26 14:33:09 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	In the search engines processing of goto_url_hook(), separate the
	special cases from the common ones.  

Sat Mar 26 14:21:28 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Be more tolerant to whitespaces in the config file.  

Sat Mar 26 14:20:50 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Make the SAMPLE CONFIGURATION FILE not look like crap in the perldoc
	view.  

Sat Mar 26 14:14:04 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	In the rc file, allow even comments which don't start at the line
	beginning.  

Sat Mar 26 13:47:10 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Fix the 'last empty fortune' to be sometimes printed out.  

Sat Mar 26 13:45:38 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	quit_hook() quotations, whitespace, parenthesis etc cleanup and
	consistency insurance.  

Sat Mar 26 13:40:09 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Handle the case when file cannot be opened and don't prohibit
	special files being $configperls.  

Sat Mar 26 13:38:59 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Quotation cleanups in loadrc().  

Sat Mar 26 13:37:58 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Reduce loadrc()'s indentation level.  

Sat Mar 26 13:36:02 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Cleaned up search()'s bork handling. Much more efficient and
	everything now.  

Sat Mar 26 13:35:22 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Rewritten search() to be data-driven instead.  

Sat Mar 26 13:26:46 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Reindentations, curlies compression, consistency changes and stuff.
	Didn't bother with some code which is so awful that I will probably
	need to rewrite it completely.  

Sat Mar 26 13:13:42 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Killed the custom vim settings, now the file is presented as the
	ELinks coding standards dictate! ;-) 

Sat Mar 26 13:11:48 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/perl/hooks.pl:

	Random whitespace cleanup, comments sanitization, some first skims
	of pod, an $Id$ tag, copyright notice and such.  

Sat Mar 26 13:07:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	This was triggered when downloading adobes pdf reader v7 via ftp.
	First it didn't stop even though it had reached 100% and then the
	assertion failed.  

Sat Mar 26 12:50:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* test/href_tests.html:

	Add mailto: links which is not handled very gracefully. Reported by
	Renato Botelho <freebsd@galle.com.br>.  

Sat Mar 26 12:03:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/: elinks.fortune, perl/hooks.pl:

	Apparently Pasky liked the *pimp slap* remark, so I added it to 
	elinks.fortune.  
	
	The fortune bit in hooks.pl can now handle a fortune file with
	either a beginning or ending %.  
	                                                                    
	Russ

Sat Mar 26 11:56:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/user.c:

	Decode the subject when handling mailto: links. There is still a
	problem with using add_shell_safe... which is the same as it was for
	URI passing.  

Fri Mar 25 19:29:38 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/Makefile.am:

	Distribute highlight.lua.  

Fri Mar 25 19:25:06 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in, src/scripting/lua/core.c:

	Drop enable_systems_functions and enable pipe_read, execute,
	tmpname, and the Lua IO library by default.  
	
	Other languages don't have this silliness of disabling functions
	until one calls another function, and if one really wants them
	disabled, one can still do so by assigning them nil -- and now they
	can't be re-enabed simply by calling that function again, which
	makes it pointless to have disabled them in the first place.  

Fri Mar 25 19:02:48 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/highlight.lua:

	Simplify by returning from the loop once the code has been
	highlighted.  

Fri Mar 25 19:00:46 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/highlight.lua:

	Use a table and a loop to greatly reduce code redundancy.  

Fri Mar 25 18:58:58 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/highlight.lua:

	Clean up the indentation.  

Fri Mar 25 18:41:12 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/highlight.lua:

	Don't check highlight_enable and just assume that if the file was
	loaded that the user intends for source-code to be highlighted.  

Fri Mar 25 18:40:15 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/: highlight.lua, hooks.lua.in:

	Move source-code highlighting to its own file.  

Fri Mar 25 18:30:03 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Pass goto-url hooks the current URI.  

Fri Mar 25 18:29:33 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/: bm.lua, hooks.lua.in:

	Return the unmodified URI rather than nil from the goto-url and
	follow-url hooks to match the new semantics.  

Fri Mar 25 05:37:20 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Whoops, drop an extra little bit that snuck in.  

Fri Mar 25 05:36:58 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Change the semantics of follow_url_hook and goto_url_hook: nil from
	a hook does not mean no change, but rather that the URL should be
	changed to nil. Things are almost working again.  

Fri Mar 25 05:13:40 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/: bm.lua, hooks.lua.in:

	Move bookmarks code from hooks.lua to bm.lua.  

Fri Mar 25 05:11:33 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Fix a syntax error from the last patch.  

Fri Mar 25 05:08:49 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Fix a logic error in bookmarks_follow_url_hook so as not to prevent 
	other hooks from running when no change is made to the URL.  

Fri Mar 25 05:00:13 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move tmp-file clean-up from quit_hook_ to its own hook.  Delete
	quit_hook_.  

Fri Mar 25 04:59:09 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move the bookmarks code from quit_hook_ to its own hook.  

Fri Mar 25 04:57:48 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move the bookmarks code from follow_url_hook_ to its own hook.  
	Delete follow_url_hook_.  

Fri Mar 25 04:54:54 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Change some occurences of 1 to true in hook return values.  

Fri Mar 25 04:53:49 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move dumbprefixes and smartprefixes from goto_url_hook_ into their
	own hook and delete goto_url_hook_.  

Fri Mar 25 04:50:37 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move the localhost code from goto_url_hook_ to its own hook.  

Fri Mar 25 04:47:25 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move tilde expansion from goto_url_hook_ into its own hook.  

Fri Mar 25 04:44:27 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Fix a logic error in the hook functions: table.foreachi (as well as 
	table.foreach) breaks when the function returns a _non-nil_ value.  

Fri Mar 25 04:42:47 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Use table.foreachi instead of table.foreach in the hooks.  

Fri Mar 25 04:13:11 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	In l_xdialog, check lua_ses before dereferencing it.  

Thu Mar 24 21:50:09 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move the gzip decompression code from pre_format_html_hook_ to its
	own hook.  Remove pre_format_html_hook_.  

Thu Mar 24 21:45:28 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move the allmusic.com mangler from pre_format_html_hook_ to its own
	hook.  

Thu Mar 24 21:43:01 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move the dictionary.com mangler from pre_format_html_hook_ to its
	own hook.  

Thu Mar 24 21:38:04 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move the linuxtoday.com mangler from pre_format_html_hook_ to its
	own hook.  

Thu Mar 24 21:33:14 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move the unclosed-a tags mangler from pre_format_html_hook_ to its
	own hook.  

Thu Mar 24 21:31:06 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move the unclosed-input tags mangler from pre_format_html_hook_ to
	its own hook.  

Thu Mar 24 21:28:33 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Move the blank img alt mangler from pre_format_html_hook_ to its own
	hook.  

Thu Mar 24 21:23:59 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Hook highlight directly from pre_format_html_hooks.  

Thu Mar 24 21:18:11 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Add Lua hooks to call hooks. Convert the old hooks into hooks for
	the new hooks.  

Thu Mar 24 16:52:53 2005  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_cursor_move_to_string(): simplify and handle oversized numbers
	in a gentle way.  

Thu Mar 24 16:03:40 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/text.c:

	dlg_format_text(): shorten lines using a temporary variable for
	height.  

Thu Mar 24 15:49:45 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/listbox.c:

	dlg_format_listbox(): simplify code.  

Thu Mar 24 15:33:12 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Thu Mar 24 15:23:47 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/inpfield.c:

	Define few constants for input fields formatting and use them
	instead of hardcoded stuff.  

Thu Mar 24 15:10:11 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/checkbox.c:

	Define CHECKBOX_HEIGHT, make dlg_format_checkbox() works correctly
	even without label to display, and fix its box (off by one).  

Thu Mar 24 14:56:31 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/button.c:

	Define BUTTON_HEIGHT, make code clearer.  

Thu Mar 24 14:49:33 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/button.c:

	display_button(): shorten lines a bit.  

Thu Mar 24 11:44:42 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/group.c:

	dlg_format_group(): rewrite it using explicit variables names, drop
	base_group_width(), clarify calculations.  

Thu Mar 24 10:03:59 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/group.c:

	dlg_format_group(): drop @width, and make clearer we handle only
	checkboxes and inputfields.  

Thu Mar 24 09:39:07 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/inpfield.c:

	field_next_history(): fix last patch.  

Thu Mar 24 09:33:55 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/group.c:

	dlg_format_group(): try to clarify even more.  

Thu Mar 24 09:21:16 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/group.c:

	dlg_format_group(): expand code a bit.  

Thu Mar 24 09:15:07 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/group.c:

	base_group_width(),dlg_format_group(): clarifications and comments.  

Thu Mar 24 08:42:41 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/inpfield.c:

	Reduce code redundancy introducing field_prev_history() and
	field_next_history().  

Thu Mar 24 08:12:11 2005  Laurent Monin <zas@norz.org>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po, sk.po,
	sv.po, tr.po, uk.po:

	Po files were resynced, french translation was updated.  

Wed Mar 23 22:48:13 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Use os.remove instead of remove to fix the code2html hook.  

Wed Mar 23 22:30:32 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Add a LEO smartprefix.  

Wed Mar 23 22:28:28 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Use math.mod instead of just mod.  

Wed Mar 23 22:28:05 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Improve the 'bug' smartprefix to allow 'bug' for 
	<http://bugzilla.elinks.or.cz>, 'bug [0-9]+' to get a bug by the ID, 
	or 'bug foo' to search for bugs with 'foo' in the sort description.  

Wed Mar 23 16:33:12 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/auth/dialogs.c:

	Drop the accelerators from the text fields in the auth box;
	accelerators are not yet supported for fields.  

Wed Mar 23 15:53:17 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Mar 23 15:52:37 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Initialise the _OUTPUT global used by write and writeto.  

Wed Mar 23 15:49:06 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Use table.remove instead of tab.remove in the write function.  

Wed Mar 23 15:43:41 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/hierbox.c, bfu/msgbox.c, cache/dialogs.c,
	config/dialogs.c, cookies/dialogs.c, dialogs/download.c,
	dialogs/edit.c, dialogs/info.c, dialogs/menu.c, dialogs/options.c,
	formhist/dialogs.c, formhist/formhist.c, globhist/dialogs.c,
	mime/dialogs.c, protocol/protocol.c, protocol/auth/dialogs.c,
	sched/download.c, sched/session.c, sched/task.c,
	scripting/lua/core.c, terminal/tab.c, viewer/text/search.c:

	Add accelerators to buttons.  

Wed Mar 23 15:41:09 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Mar 23 15:26:08 2005  Laurent Monin <zas@norz.org>:

	* po/Makefile.am:

	Also check for missing keyboard accelerators using
	--check-accelerators option in check-po rule.  

Wed Mar 23 14:28:41 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	Fix i18n code, reported by Jonas.  

Wed Mar 23 14:26:42 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: inpfield.c, msgbox.c:

	Add keyboard accelerators to some Ok and Cancel buttons.  

Wed Mar 23 14:16:13 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/hierbox.c, bfu/inpfield.c, bfu/inpfield.h,
	bookmarks/dialogs.c, config/dialogs.c, dialogs/menu.c,
	scripting/lua/core.c, viewer/text/view.c:

	Introduce input_dialog() that wraps input_field(). I18n is always
	on, and OK/Cancel buttons always there.  

Wed Mar 23 14:00:54 2005  Laurent Monin <zas@norz.org>:

	* src/config/dialogs.c:

	push_kbdbind_add_button(): i18n improvement and code simplification.  

Wed Mar 23 13:40:34 2005  Laurent Monin <zas@norz.org>:

	* src/: sched/session.c, scripting/lua/core.c,
	scripting/ruby/core.c, viewer/text/draw.c, viewer/text/form.c,
	viewer/text/search.c, viewer/text/textarea.c, viewer/text/view.c:

	Use info_box() instead of direct call to msg_box() where it is
	possible.  

Wed Mar 23 11:41:00 2005  Laurent Monin <zas@norz.org>:

	* src/: formhist/dialogs.c, protocol/user.c, protocol/nntp/codes.c,
	sched/download.c:

	Use info_box() instead of direct call to msg_box() where it is
	possible.  

Wed Mar 23 11:28:39 2005  Laurent Monin <zas@norz.org>:

	* src/: dialogs/document.c, dialogs/info.c,
	ecmascript/spidermonkey.c:

	Use info_box() instead of direct call to msg_box() where it is
	possible.  

Wed Mar 23 11:24:27 2005  Laurent Monin <zas@norz.org>:

	* src/config/dialogs.c:

	Use info_box() instead of direct call to msg_box() where it is
	possible.  

Wed Mar 23 11:19:13 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: hierbox.c, inpfield.c, leds.c:

	Use info_box() instead of direct call to msg_box() where it is
	possible.  

Wed Mar 23 11:18:08 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: msgbox.c, msgbox.h:

	info_box() was introduced, it wraps msg_box() call, and will help to
	reduce code size.  

Wed Mar 23 10:57:56 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, button.h:

	Add code to find missing keyboard accelerators in buttons. Enable it
	by defining DEBUG_BUTTON_HOTKEY in bfu/button.h, it will emit
	messages through DBG() at runtime.  

Wed Mar 23 10:42:44 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Mar 23 10:10:38 2005  Laurent Monin <zas@norz.org>:

	* NEWS, configure.in, src/scripting/lua/core.c,
	src/scripting/lua/core.h, src/scripting/lua/hooks.c:

	Support for Lua4.x was dropped in favor of support for Lua5.x.
	Configure script Lua detection was improved, C code was modified to
	use Lua 5.x functions (lua_pcall() is always available, lua_open()
	has no parameter). NEWS file was updated.  

Wed Mar 23 09:19:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/perl/hooks.pl:

	Tons of cleanup this time.  
	
	Added some prefixes.  They are all documented at the top along with 
	a sample config.pl.  
	
	Fixed a bug that resulted from *having* a config.pl but *not* having 
	a particular option in it.  
	
	Patch by Russ.  

Wed Mar 23 05:40:41 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	In pre_format_html_hook, add |or nil| to |return ret and html| to
	avoid the error about an invalid return value.  

Wed Mar 23 05:18:09 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	Oops. While that will make the error message go away, it is not a
	particularly bright fix, rendering all rewrite rules ineffective.  

Wed Mar 23 04:53:02 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in:

	In pre_format_html_hook, initialise html to nil to avoid an error
	about an return value.  

Wed Mar 23 04:48:48 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in, src/scripting/lua/core.c:

	Move to Lua 5.  
	
	 - In the C code, explicitely include the table library 
	
	 - Use the new table-based function names in hooks.lua 
	
	 - Drop % for upval references, which are no longer necessary 
	   with Lua 5's scoping rules 
	
	 - Add compatibility routines from Lua's compat.lua 

Tue Mar 22 16:05:03 2005  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_text():Detect attempts to read outside valid memory, it may be
	caused by wrong calculations. Only active when CONFIG_DEBUG is
	defined.  

Tue Mar 22 15:18:43 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/button.c:

	Typo fix, hidden bug introduced by 1.86 -> 1.87.  

Tue Mar 22 14:56:23 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, group.c, inpfield.c, widget.h:

	Revert patch "Width and height fields were added to struct
	widget...", bad move.  

Tue Mar 22 11:41:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Tue Mar 22 11:11:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/changelog:

	Close a few bugs.  

Tue Mar 22 05:25:54 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/options.inc, util/secsave.c:

	Introduce the option infofiles.secure_save_fsync, which allows one 
	to configure whether secure file saving calls fsync(3).  
	
	Idea by Russ Rowan.  

Tue Mar 22 05:09:39 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Add a change-hook for bookmarks.folder_state that marks the
	bookmarks dirty when folder_state is disabled. This ensures that the
	bookmarks will be saved, thereby ensuring that folders really will
	be collapsed.  

Tue Mar 22 04:43:44 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/backend/xbel.c:

	Minor simplification in write_bookmarks_list concerning folder_state
	logic.  

Tue Mar 22 00:49:31 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/options.c:

	Do not display terminal options help text when terminal height is
	too low. User should be able to change the options even with small
	terminal. It is just a fast hack, a better solution resides in
	scrollable dialog boxes...  

Mon Mar 21 11:29:51 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Mar 21 11:26:16 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/checkbox.c, config/options.inc:

	Add dialog.checkbox-selected color to options and fix bug 644.  

Mon Mar 21 11:20:31 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, group.c, inpfield.c, widget.h:

	Width and height fields were added to struct widget, it will help to
	move display dimensions calculations to proper widget file. Drop
	base_group_width().  

Mon Mar 21 09:14:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Only add /dev/stdin to the URL list when no URLs was given on the
	command line. Allow special files when /dev/stdin is added. (debian
	bug #296976) 

Mon Mar 21 09:09:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	... and now revert part of last patch that was not part of revert of
	1.234->1.235.  

Mon Mar 21 09:06:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Revert 1.234->1.235, the quit hook has to happen before the
	scripting modules are shut down. Doh.  

Mon Mar 21 00:37:56 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/encoding/encoding.c:

	Use get_opt_bool for protocol.file.allow_special_files.  

Sun Mar 20 17:40:35 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/button.c:

	add_dlg_button_do(): code cleanup.  

Sun Mar 20 11:50:07 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Mar 20 11:05:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Use find_uri_protocol() when the URI looks ok but has unknown
	protocol. This fixes URIs like blah.com:9090 on the command line
	while 127.0.0.1:80 and files with ':' in them should still work.
	(bug 639) 

Sun Mar 20 10:57:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	find_uri_protocol(): Uninline. Return PROTOCOL_UNKNOWN if nothing is
	matched and handle that specially in the translate_url() goto
	looping.  

Sun Mar 20 10:40:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/: bookmarks.c, backend/default.c, backend/xbel.c:

	Add option to control whether (expanded) folder states should be
	stored when saving bookmarks (bookmarks.folder_state). Defaults to
	on; the current behavior. (bug 642) 

Sun Mar 20 10:20:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Move the triggering of the quit hook after builtin modules has been
	terminated. (bug 641) 

Sun Mar 20 10:13:45 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/proxy.c:

	get_proxy_worker(): Use strip_proxy_protocol() to remove http:// and
	ftp:// from scripting proxies. (bug 640) 

Sun Mar 20 10:12:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/proxy.c:

	get_protocol_proxy(): Factor out the protocol stripping to new
	strip_proxy_protocol().  

Sun Mar 20 08:19:05 2005  Laurent Monin <zas@norz.org>:

	* doc/bookmarks.txt:

	Update: we now support separators.  

Sat Mar 19 17:49:40 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Reorder code.  

Sat Mar 19 17:46:44 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	do_add_special_bookmark() -> do_add_bookmark().  

Sat Mar 19 17:45:31 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Merge do_add_special_bookmark() and bookmark_add_add().  

Sat Mar 19 09:40:13 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/perl/hooks.pl:

	It's bigger, yes, but, I believe, much cleaner.  
	
	You can now enter "search terms" (with the quotes) in the goto box
	and it will use your default search engine (or Google).  Use ', `,
	or ".  
	
	New config.pl option: "language".  Set this and you no longer have
	to enter the "to language" (although you still can) when translating 
	a page.  
	
	Added eff, wired, and slashdot as "news" sources.  Set the config
	option "news: eff" and the prefixes "news" and "n" will use this.  
	
	There are more config options, and they are now documented towards
	the bottom of the script in a commented sample config.pl.  
	
	                                                                    Russ 

Sat Mar 19 09:39:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/elinks.fortune:

	One bit from #elinks that I found quite funny, and a tip about
	moving bookmarks that I learned yesterday when you told me to check
	the docs.  
	
	Patch by Russ.  

Sat Mar 19 00:45:53 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Mar 19 00:37:21 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/button.h:

	Typo fixes, thanks to Jonas.  

Sat Mar 19 00:33:22 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Use hotkeys for bookmarks manager buttons.  

Sat Mar 19 00:31:52 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, button.h, dialog.c:

	Add support for hotkeys marked by ~ character in buttons.  

Fri Mar 18 23:56:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Fri Mar 18 23:35:46 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Mar 18 23:25:42 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Drop the [ Clear ] button, this one is too dangerous, so let the
	user deletes the bookmarks file instead, if needed.  

Fri Mar 18 23:21:01 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Add a new button to bookmarks manager to add a separator.  

Fri Mar 18 14:41:12 2005  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/dialogs.c, config/dialogs.c:

	Drop old #define for hierbox number of buttons.  

Fri Mar 18 14:39:06 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Reorder buttons in bookmarks manager.  

Fri Mar 18 13:39:16 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/backend/xbel.c:

	Add a newline after <separator/>.  

Fri Mar 18 13:30:53 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/listbox.c, bfu/listbox.h, bookmarks/bookmarks.c,
	bookmarks/backend/default.c, bookmarks/backend/xbel.c:

	Add support for bookmarks separators. To insert one enter "-" as
	title and no url.  

Fri Mar 18 13:26:01 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	Code cleanup.  

Thu Mar 17 10:45:05 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	init_dom_renderer(): Always use the decoded buffer. This was causing
	a garbage cache entry fragment to be used when no fragments was
	available in the cache entry.  

Thu Mar 17 09:55:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/perl/hooks.pl:

	Added five more search engines.  
	
	BORKing is now optional and defaults to off.  
	
	It reads a config file now, if it exists.  ~/.elinks/config.pl (just 
	like hooks.lua).  Mine looks like: bork:       yep googlebeta: hell
	no weather:    google 
	
	You can search BBC News, Reuters, MSNBC, CNN, FOXNews, Google news,
	and Yahoo! News now.  
	
	Remember Deep Thoughts by Jack Handey?  Type "jack" or "handey" into
	the goto box.  
	
	Added a few other searchy things: IMDB, US ZIP codes, IP address -> 
	location, WHOIS, Google or Yahoo! weather, RFC, stock ticker search,
	and urban legends.  
	
	A few other strange things were added/changed too.  
	
	Patch by Russ Rowan.  

Wed Mar 16 20:39:52 2005  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Updated hungarian translation.  

Mon Mar 14 22:46:27 2005  Petr Baudis <pasky@ucw.cz>:

	* src/terminal/color.c:

	Corrected blue on red background contrast correction.  

Sat Mar 12 00:25:43 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	get_ftp_data_socket(): describe it.  

Sat Mar 12 00:17:25 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	get_ftp_data_socket(): re-arrange and simplify code.  

Sat Mar 12 00:08:02 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	add_file_cmd_to_str(): do the conn->uri->data test before anything
	else.  

Sat Mar 12 00:06:28 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	add_file_cmd_to_str(): Move ftp data socket related code to new
	get_ftp_data_socket().  

Fri Mar 11 23:35:43 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	got_something_from_data_connection(): minor code redundancy
	reduction.  

Fri Mar 11 23:22:44 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	display_dir_entry(): simplify code.  

Fri Mar 11 15:13:30 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	add_file_cmd_to_str(): abort connection on ftp data sockets creation
	failure.  

Fri Mar 11 15:11:14 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	add_file_cmd_to_str(): simplify code.  

Fri Mar 11 15:08:39 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	add_file_cmd_to_str(): re-arrange code a bit and 2 FIXMEs.  

Fri Mar 11 15:05:25 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	add_file_cmd_to_str(): re-arrange code a bit.  

Thu Mar 10 15:30:13 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/timers.h:

	Update comment to reflect last change.  

Thu Mar 10 13:47:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/timers.h:

	Use struct timer instead of void pointer. It help when debugging.  

Wed Mar  9 18:24:05 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Prevent possible double freeing of conn->info.  

Wed Mar  9 17:59:06 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* .cvsignore:

	Revert ignoring missing and install-sh. Their place is config/.  

Wed Mar  9 17:58:54 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: connection.c, connection.h:

	Revert attempt to fix ftp root directory issue (PWD). Last bits.  

Wed Mar  9 17:56:12 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Revert attempt to fix ftp root directory issue (PWD).  

Wed Mar  9 17:34:27 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* .cvsignore:

	Ignore missing and install-sh.  

Tue Mar  8 15:51:56 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/ftp/ftp.c:

	Remove the loop in get_ftp_response and use memchr instead.  

Tue Mar  8 15:34:00 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Add a note about the fact that we require unix-like paths to handle
	PWD response.  

Tue Mar  8 15:25:20 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Add a FIXME about double quotes handling.  

Tue Mar  8 15:21:39 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/ftp/ftp.c:

	Repeat.  

Tue Mar  8 15:20:29 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/ftp/ftp.c:

	Simplify some code in get_ftp_response.  

Tue Mar  8 13:56:28 2005  Laurent Monin <zas@norz.org>:

	* src/: protocol/ftp/ftp.c, sched/connection.c, sched/connection.h:

	Send PWD and parse its response to get base directory sent by ftp
	server, and prepend it to URIs used to retrieve directories and
	files. It fixes bug reported on #elinks by pasky about
	ftp://tron.homeunix.org/. Please review and improve if needed.  

Mon Mar  7 09:45:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/.cvsignore:

	Remove unrelated part of last patch.  

Mon Mar  7 09:44:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/: .cvsignore, Makefile.am:

	Change to .awk script. Spotted by zas.  

Mon Mar  7 09:23:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/conv/.cvsignore:

	m00p.  

Mon Mar  7 09:03:15 2005  Laurent Monin <zas@norz.org>:

	* src/: setup.h, document/html/parser.c:

	Set maximum refresh delay in setup.h using HTTP_REFRESH_MAX_DELAY.  

Sun Mar  6 17:20:05 2005  Laurent Monin <zas@norz.org>:

	* doc/hacking.txt:

	Add a note about _T postfix for defined types.  

Sun Mar  6 12:53:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/leds.c, dialogs/status.c:

	This is just a small change, but I figured that since 
	document.browse.forms.insert_mode now defaults to 1, that 'I' in the 
	LEDs should mean "insert mode" and 'i' should mean "insert mode, 
	modeless".  
	
	Patch by Russ Rowan.  

Sun Mar  6 12:49:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, contrib/conv/w3m2links.awk.in,
	contrib/conv/w3m2links.gawk:

	Make w3m2links use the installed awk. Patch by Russ Rowan.  

Sat Mar  5 22:14:31 2005  Laurent Monin <zas@norz.org>:

	* src/: cookies/cookies.c, cookies/cookies.h, cookies/dialogs.c,
	globhist/globhist.c, globhist/globhist.h, lowlevel/dns.c,
	lowlevel/select.c, lowlevel/timers.c, lowlevel/timers.h,
	protocol/date.c, protocol/date.h, sched/connection.c,
	sched/connection.h, sched/download.h, sched/session.c, util/conv.c,
	util/conv.h, util/time.c, util/time.h, util/ttime.c, util/ttime.h:

	ttime -> time_T.  

Sat Mar  5 22:08:22 2005  Laurent Monin <zas@norz.org>:

	* Unicode/gen-cp:

	Fix tail/head update.  

Sat Mar  5 21:49:29 2005  Laurent Monin <zas@norz.org>:

	* Unicode/: gen, gen-7b, gen-cp, gen-ent, tr7bit.awk:

	Add $Id$ to scripts.  

Sat Mar  5 21:47:21 2005  Laurent Monin <zas@norz.org>:

	* Unicode/gen-cp:

	Recent head/tail warns about obsolete -<number>/+<number> options,
	use -n <number> instead.  

Sat Mar  5 21:41:41 2005  Laurent Monin <zas@norz.org>:

	* Unicode/gen-7b, Unicode/gen-ent, src/intl/charsets.c,
	src/intl/charsets.h, src/intl/entity.inc, src/intl/uni_7b.inc,
	src/terminal/event.c:

	unicode_val -> unicode_val_T. Scripts in Unicode/ were updated.  

Sat Mar  5 21:34:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/style.c, config/cmdline.c, config/options.h,
	config/opttypes.c, document/document.h, document/options.h,
	document/css/property.h, document/dom/renderer.c,
	document/html/parser.c, document/html/parser.h,
	document/html/renderer.c, document/html/renderer.h,
	document/html/tables.c, document/html/parser/link.c,
	document/html/parser/table.c, document/html/parser/table.h,
	document/plain/renderer.c, terminal/color.c, util/color.c,
	util/color.h, viewer/text/link.c:

	color_t -> color_T.  

Sat Mar  5 21:28:52 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: event.c, event.h:

	event_hook -> event_hook_T.  

Sat Mar  5 21:21:27 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/menu.c, sched/session.c, terminal/tab.c,
	terminal/tab.h, terminal/window.c, terminal/window.h:

	window_handler -> window_handler_T.  

Sat Mar  5 21:18:10 2005  Laurent Monin <zas@norz.org>:

	* src/sched/action.c:

	frame_action -> frame_action_T.  

Sat Mar  5 21:16:06 2005  Laurent Monin <zas@norz.org>:

	* src/util/: hash.c, hash.h:

	hash_func -> hash_func_T.  

Sat Mar  5 21:14:38 2005  Laurent Monin <zas@norz.org>:

	* src/util/: hash.c, hash.h:

	hash_value -> hash_value_T.  

Sat Mar  5 21:11:03 2005  Laurent Monin <zas@norz.org>:

	* src/: sched/connection.h, sched/download.c, sched/session.c,
	sched/task.c, viewer/dump/dump.c:

	download_callback -> download_callback_T.  

Sat Mar  5 21:08:11 2005  Laurent Monin <zas@norz.org>:

	* src/document/css/: stylesheet.c, stylesheet.h:

	css_stylesheet_importer -> css_stylesheet_importer_T.  

Sat Mar  5 21:06:35 2005  Laurent Monin <zas@norz.org>:

	* src/document/css/property.h:

	css_property_value_parser -> css_property_value_parser_T.  

Sat Mar  5 21:04:49 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/about.h, protocol/data.h, protocol/protocol.c,
	protocol/protocol.h, protocol/user.h, protocol/file/file.h,
	protocol/finger/finger.h, protocol/ftp/ftp.h,
	protocol/gopher/gopher.h, protocol/http/http.h,
	protocol/nntp/connection.h, protocol/smb/smb.h, sched/connection.c,
	sched/task.c:

	protocol_handler -> protocol_handler_T, protocol_external_handler ->
	protocol_external_handler_T.  

Sat Mar  5 21:04:25 2005  Laurent Monin <zas@norz.org>:

	* src/document/css/apply.c:

	Rename css_applier_t type to css_applier_T.  

Sat Mar  5 21:02:15 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/exmode.c:

	Rename exmode_handler type to exmode_handler_T.  

Sat Mar  5 20:59:13 2005  Laurent Monin <zas@norz.org>:

	* src/config/options.h:

	Rename change_hook type to change_hook_T.  

Sat Mar  5 20:50:34 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, button.h, common.h, hierbox.h, inpfield.c,
	inpfield.h, widget.h:

	Rename t_widget_handler type to widget_handler_T.  

Sat Mar  5 20:46:46 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/common.h, bfu/dialog.c,
	bfu/dialog.h, bfu/hierbox.c, bfu/hierbox.h, bfu/inpfield.c,
	bfu/inpfield.h, bfu/listbox.c, bfu/text.c, bookmarks/dialogs.c,
	config/dialogs.c, cookies/dialogs.c, dialogs/download.c,
	dialogs/edit.c, dialogs/options.c, formhist/dialogs.c,
	globhist/dialogs.c, sched/download.c, viewer/text/search.c:

	Rename t_handler_event_status type to widget_handler_status_T.  

Sat Mar  5 20:41:04 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: inpfield.c, inpfield.h:

	Use t_widget_handler * type for input_field() check parameter.  

Sat Mar  5 20:40:01 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/common.h:

	Make enum anonymous when used with typedef.  

Sat Mar  5 20:31:10 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/inphist.c, bfu/menu.c, bfu/menu.h, dialogs/menu.c,
	dialogs/menu.h, dialogs/options.c, mime/dialogs.c, sched/task.c,
	viewer/text/form.c, viewer/text/textarea.c:

	Rename menu_func type to menu_func_T.  

Sat Mar  5 20:22:45 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, viewer/text/search.c:

	Rename input_line_handler type to input_line_handler_T.  

Sat Mar  5 20:19:19 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: dialog.c, dialog.h:

	Rename dialog_refresh_handler type to dialog_refresh_handler_T.  

Sat Mar  5 20:14:24 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/button.h, bfu/dialog.c, bfu/msgbox.c,
	dialogs/edit.c, dialogs/edit.h, sched/download.c:

	Rename type t_done_handler to done_handler_T.  

Sat Mar  5 01:20:31 2005  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Try to improve Refresh parsing, ignore negative/erroneous values,
	and limit delay to 2 days.  

Sat Mar  5 00:13:08 2005  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Reduce indentation level.  

Fri Mar  4 21:14:26 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/: timers.c, timers.h:

	Since timer id is now timer address, simplify kill_timer(), it can
	have direct access to timer to kill, so the loop is now useless.  

Fri Mar  4 18:54:03 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/: timers.c, timers.h:

	Little hack: drop id field of struct timer, just use timer
	allocation address as identifier, and set TIMER_ID_UNDEF to be NULL.  

Fri Mar  4 18:33:24 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/leds.c, document/refresh.c,
	lowlevel/timer.c, lowlevel/timers.c, lowlevel/timers.h,
	sched/connection.c, sched/session.c, terminal/kbd.c:

	Pass timer_id_T * to install_timer() instead of returning the id.  

Fri Mar  4 17:55:36 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/leds.c, document/refresh.c,
	lowlevel/timer.c, lowlevel/timers.c, lowlevel/timers.h,
	sched/connection.c, sched/session.c, sched/task.c, terminal/kbd.c:

	Pass a timer_id_T pointer to kill_timer(), and always undefine it
	after kill. It simplifies code and is safer. Performance impact
	should not be that great.  

Fri Mar  4 17:36:29 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/dialog.h, bfu/leds.c,
	document/document.c, document/refresh.c, document/refresh.h,
	lowlevel/timer.c, lowlevel/timers.c, lowlevel/timers.h,
	sched/connection.c, sched/connection.h, sched/session.c,
	sched/session.h, sched/task.c, terminal/kbd.c:

	Define a type timer_id_T and TIMER_ID_UNDEF. Populate code with
	them.  

Fri Mar  4 15:08:29 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/ecmascript/spidermonkey.c:

	Remove the braces, which are unneeded without the variable
	declarations.  

Fri Mar  4 14:53:03 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/ecmascript/spidermonkey.c:

	Eliminate the local counter variables that were made unnecessary 
	thru the usage of list_size in revision 1.202.  

Fri Mar  4 14:01:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: timers.c, timers.h:

	Move struct timer declaration to .c file. It should only be used
	internally.  

Fri Mar  4 13:25:32 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/leds.c, lowlevel/timer.c, lowlevel/timer.h:

	Access to |timer_duration| through new get_timer_duration(), and
	make it static to timer.c.  

Fri Mar  4 13:19:37 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/leds.c, document/refresh.c,
	lowlevel/Makefile.am, lowlevel/select.c, lowlevel/timer.c,
	lowlevel/timer.h, lowlevel/timers.c, lowlevel/timers.h,
	sched/connection.c, sched/session.c, sched/task.c, terminal/kbd.c:

	Move code from timer.{c,h} to new timers.{c,h} since this code has
	nothing to do with "Internal inactivity timer", header includes were
	updated to reflect the change.  

Fri Mar  4 10:21:12 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, document/refresh.c, lowlevel/select.c,
	lowlevel/select.h, lowlevel/timer.c, lowlevel/timer.h,
	sched/connection.c, sched/session.c, sched/task.c, terminal/kbd.c:

	Move all timers related code from lowlevel/select.{c,h} to
	lowlevel/timer.{c,h} and make |timers| static. Fix headers
	inclusions to reflect that change.  

Fri Mar  4 10:08:48 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	Reintroduce count_timers(), needed to move all timers related code
	to timer.{c,h} and make |timers| static to it.  

Fri Mar  4 03:39:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	abort_background_connections(): Use foreachsafe().  

Fri Mar  4 02:14:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/spidermonkey.c:

	Some more list_size() usage for the form hooks.  

Fri Mar  4 02:05:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, dialogs/info.c, document/document.c,
	lowlevel/select.c, sched/connection.c, util/lists.h:

	Introduce list_size() as a generalized version of count_timers()
	added in lowlevel/select.c (1.59 -> 1.60). It is declared as static
	inline which is unusual for the list library. I hope it won't be a
	problem. Also it should maybe use struct xlist_head.  

Fri Mar  4 01:23:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/select.c:

	kill_timer(): Use foreachsafe() to simplify the deletion.  

Fri Mar  4 01:18:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/select.c:

	Remove ending ';' from while loop introduced in 1.53 -> 1.54.  

Thu Mar  3 17:18:59 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	TODO: move timers related code to lowlevel/timer.h.  

Thu Mar  3 17:16:47 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	Move timers related code from select_info() to new count_timers().  

Thu Mar  3 17:13:26 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	Make |timer_id| static to install_timer().  

Thu Mar  3 17:10:00 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	Pass ttime * to check_timers() and make last_time static to
	select_loop().  

Thu Mar  3 17:05:54 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	Move code from select_loop() to new get_next_timer_time().  

Thu Mar  3 16:18:26 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	kill_timer(): @tm -> @timer, @tt -> @tmp_timer.  

Thu Mar  3 16:10:21 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	install_timer(): @t -> @time, @tm -> @new_timer, @tt -> @timer.  

Thu Mar  3 15:54:54 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	Simplify check_bottom_halves() code.  

Thu Mar  3 15:49:43 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/: select.c, select.h:

	Rename do_check_bottom_halves() to check_bottom_halves(), moving
	test from macro of the same name, and make |bottom_halves| static to
	lowlevel/select.c.  

Thu Mar  3 15:43:26 2005  Laurent Monin <zas@norz.org>:

	* src/: config/options.c, sched/connection.c, sched/connection.h:

	Wrap call to register_bottom_half(check_queue, NULL) in new
	register_check_queue() and make check_queue() static.  

Thu Mar  3 15:31:57 2005  Laurent Monin <zas@norz.org>:

	* src/: config/options.c, dialogs/download.c, dialogs/menu.c,
	ecmascript/spidermonkey.c, lowlevel/select.c, lowlevel/select.h,
	lowlevel/signals.c, sched/connection.c, terminal/kbd.c:

	Rename register_bottom_half() to register_bottom_half_do(), and use
	a macro named register_bottom_half() to wrap the call and to do
	needed type casting.  

Thu Mar  3 15:14:20 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: connection.c, connection.h:

	Make |connection_queue| static to sched/connection.c.  

Thu Mar  3 15:11:44 2005  Laurent Monin <zas@norz.org>:

	* src/: cache/cache.c, sched/connection.c, sched/connection.h:

	Move is_entry_used() from cache/cache.c to sched/connection.{c,h}.  

Thu Mar  3 15:06:50 2005  Laurent Monin <zas@norz.org>:

	* src/: cache/cache.c, sched/connection.c, sched/connection.h:

	Rename |queue| to |connection_queue|.  

Thu Mar  3 12:21:12 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Prepare indentation for the bittorrent_protocol_handler.  

Thu Mar  3 12:19:45 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/backend/default.c:

	Prepare indentation for .torrent <-> application/x-bittorrent
	association.  

Thu Mar  3 11:39:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/document.c:

	Center the nowhere box text.  

Thu Mar  3 10:48:00 2005  Laurent Monin <zas@norz.org>:

	* po/README:

	README was updated, plural forms handling is now described.  

Thu Mar  3 00:09:44 2005  Laurent Monin <zas@norz.org>:

	* src/intl/gettext/libintl.h:

	Introduce intl_set_charset() to reduce code redundancy. As a side
	effect it fixes a compilation issue when DEBUG_IT is defined.  

Wed Mar  2 23:59:33 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation cleanup.  

Wed Mar  2 23:15:01 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated (plural forms for info dialogs).  

Wed Mar  2 23:11:19 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/info.c:

	Rework get_resource_info() to make it more i18n compliant, and use
	plural forms through n_().  

Wed Mar  2 23:02:35 2005  Laurent Monin <zas@norz.org>:

	* src/intl/gettext/libintl.h:

	Introduce n_() as a wrapper for ngettext().  

Wed Mar  2 23:01:25 2005  Laurent Monin <zas@norz.org>:

	* po/Makefile.am:

	Add keyword n_ for xgettext, to be used for plural forms.  

Wed Mar  2 18:00:27 2005  Laurent Monin <zas@norz.org>:

	* src/: sched/connection.c, sched/connection.h, sched/download.c,
	sched/session.c, sched/task.c, viewer/dump/dump.c:

	Introduce type download_callback to ease casts.  

Wed Mar  2 17:35:38 2005  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	Drop useless initialization to NULL.  

Wed Mar  2 17:29:35 2005  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	Use memcpy() to copy struct session_task.  

Wed Mar  2 16:37:50 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: download.c, history.c, session.c, session.h, task.c:

	Use an inlined struct for target in struct session_task.  

Wed Mar  2 16:31:03 2005  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	Use struct session_task field in struct task.  

Wed Mar  2 16:06:31 2005  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	Move test from do_move() to do_redirect().  

Wed Mar  2 15:59:55 2005  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	Move code from do_move() to new do_redirect() and drop a goto.  

Wed Mar  2 15:39:12 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/task.c:

	Remove a superfluous |mem_free_if(task)|.  

Wed Mar  2 15:17:54 2005  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	Typo fix in comment.  

Wed Mar  2 15:11:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Oops. Finalize last patch.  

Wed Mar  2 15:09:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	do_move(): Return a do_move enum which maps current 0 ->
	DO_MOVE_ABORT, 1 -> DO_MOVE_DISPLAY and 2 -> DO_MOVE_DONE. Patch by
	Miciah, zas and me.  

Wed Mar  2 14:30:05 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: download.c, download.h, session.c, task.c:

	Rename ses_chktype() to setup_download_handler().  

Wed Mar  2 13:55:39 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	Drop inline keyword for link_in_view_x(), let's trust the compiler.  

Wed Mar  2 13:50:02 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: link.c, link.h, search.c, view.c:

	Rename next_link_in_view() to next_link_in_view_() and make it
	static. Introduce two wrappers named next_link_in_view() and
	next_link_in_view_y() and make link_in_view(), link_in_view_y()
	static.  

Wed Mar  2 13:22:38 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, listbox.c, text.c:

	When block cursor terminal option is set, keep cursor at lower right
	of screen in dialogs too. It fixes bug 583.  

Wed Mar  2 09:36:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/encoding/encoding.c:

	Fix reading from /dev/stdin on Mac OS X. Patch by <otto@duke.edu>.
	(bug 616) 

Tue Mar  1 22:04:27 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Fix hotkey clashes.  

Tue Mar  1 16:59:58 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, inpfield.c, listbox.c, text.c,
	widget.h:

	Tidy up.  

Tue Mar  1 16:30:05 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/checkbox.c, bfu/checkbox.h, dialogs/options.c,
	viewer/text/search.c:

	Make obvious that add_dlg_radio() and add_dlg_checkbox() last
	parameter is a pointer to an integer.  

Tue Mar  1 16:29:31 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/widget.h:

	Remove a superfluous incomplete declaration of struct widget_data.  

Tue Mar  1 11:08:40 2005  Laurent Monin <zas@norz.org>:

	* src/: osdep/osdep.c, terminal/kbd.c, viewer/text/search.c:

	In C, sizeof(char) == sizeof(unsigned char) == 1, so simplify code.  

Mon Feb 28 20:15:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/: Makefile.am, elinks.fortune, perl/hooks.pl:

	This update by Russ Rowan has 4 parts: 
	
	1) This part includes some cleanups.  The random URL generator now
	   looks in more places for words, including ~/.elinks/elinks.words, if
	it exists.  
	
	2) This part adds the new fortune quit hook.  It will now look in
	   several locations for "elinks.lines" (/etc/elinks, ~/.elinks, the
	   docs directory) in standard fortune format.  If found, it will
	   output a random tip or bit of humor from #elinks.  If not, it will
	fall back to the previous behavior.  
	
	3) This part adds a new smart prefix.  xyzzy.  Just try it a few
	   times.  Ah, the Good Old Days.  
	
	4) This part adds a new follow_url_hook.  All Usenet links now
	   become links to the Google Groups archive for that group.  The hook
	   defaults to the "old style".  If you, for some reason, prefer Google
	   Groups Beta, just touch a file called "beta" in ~/.elinks and it
	will use that.  

Mon Feb 28 20:11:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/elinks.fortune:

	file elinks.fortune was initially added on branch REL_0_10.  

Mon Feb 28 15:57:07 2005  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Fix trailing spaces.  

Mon Feb 28 15:55:13 2005  Laurent Monin <zas@norz.org>:

	* doc/hacking.txt:

	Please write sizeof(something) instead of sizeof something.  

Mon Feb 28 15:52:24 2005  Laurent Monin <zas@norz.org>:

	* src/: intl/gettext/dcigettext.c, intl/gettext/localealias.c,
	osdep/os2/os2.c, scripting/lua/core.c:

	sizeof smt -> sizeof(smt).  

Mon Feb 28 15:35:49 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: link.c, marks.c, search.c, vs.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 15:32:36 2005  Laurent Monin <zas@norz.org>:

	* src/: bfu/hierbox.c, bfu/inpfield.c, bfu/listmenu.c,
	config/opttypes.c, lowlevel/interlink.c, osdep/osdep.c,
	sched/connection.c, sched/session.c, viewer/dump/dump.c,
	viewer/text/form.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 15:02:44 2005  Laurent Monin <zas@norz.org>:

	* src/util/file.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 14:57:19 2005  Laurent Monin <zas@norz.org>:

	* src/terminal/: event.c, kbd.c, screen.c, tab.c, terminal.c,
	terminal.h, window.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 14:33:14 2005  Laurent Monin <zas@norz.org>:

	* src/scripting/lua/core.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 14:29:39 2005  Laurent Monin <zas@norz.org>:

	* src/sched/: connection.c, download.c, error.c, event.c,
	location.c, session.c, task.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 14:19:24 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/: nntp/codes.c, nntp/connection.c, smb/smb.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 14:16:17 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/: uri.c, auth/auth.c, auth/digest.c, file/cgi.c,
	ftp/ftp.c, ftp/ftpparse.c, gopher/gopher.c, http/blacklist.c,
	http/codes.c, http/http.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 14:03:28 2005  Laurent Monin <zas@norz.org>:

	* src/osdep/: beos/beos.c, os2/os2.c, unix/unix.c, win32/win32.c,
	getifaddrs.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 13:56:12 2005  Laurent Monin <zas@norz.org>:

	* src/mime/: dialogs.c, backend/common.c, backend/mailcap.c,
	backend/mimetypes.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 13:51:10 2005  Laurent Monin <zas@norz.org>:

	* src/lowlevel/: connect.c, dns.c, interlink.c, select.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 13:24:03 2005  Laurent Monin <zas@norz.org>:

	* src/intl/charsets.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 13:13:04 2005  Laurent Monin <zas@norz.org>:

	* src/globhist/globhist.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 13:10:03 2005  Laurent Monin <zas@norz.org>:

	* src/: encoding/bzip2.c, encoding/encoding.c, formhist/formhist.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 13:06:33 2005  Laurent Monin <zas@norz.org>:

	* src/ecmascript/: ecmascript.c, spidermonkey.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 11:25:15 2005  Laurent Monin <zas@norz.org>:

	* doc/hacking.txt:

	Add a note about sizeof(*item) instead of sizeof(struct
	item_struct_name)).  

Mon Feb 28 11:18:16 2005  Laurent Monin <zas@norz.org>:

	* src/document/: html/parser.c, html/renderer.c, html/tables.c,
	html/parser/forms.c, html/parser/link.c, html/parser/parse.c,
	html/parser/stack.c, html/parser/table.c, plain/renderer.c,
	sgml/parser.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 11:14:57 2005  Laurent Monin <zas@norz.org>:

	* src/document/: document.c, forms.c, options.c, refresh.c,
	renderer.c, css/parser.c, css/stylesheet.c, dom/navigator.c,
	dom/node.c, dom/renderer.c, html/frames.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 10:24:46 2005  Laurent Monin <zas@norz.org>:

	* src/: cookies/cookies.c, cookies/dialogs.c, cookies/parser.c,
	dialogs/info.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 10:21:10 2005  Laurent Monin <zas@norz.org>:

	* src/config/: dialogs.c, kbdbind.c, options.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 10:15:01 2005  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/bookmarks.c, bookmarks/backend/xbel.c,
	cache/cache.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 10:10:09 2005  Laurent Monin <zas@norz.org>:

	* src/bfu/: inpfield.c, inphist.c, listbox.c, menu.c, style.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 10:06:57 2005  Laurent Monin <zas@norz.org>:

	* src/: util/hash.c, util/scanner.c, util/scanner.h,
	util/secsave.c, util/string.c, bfu/dialog.c, bfu/hierbox.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Mon Feb 28 09:48:58 2005  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Use sizeof(*item) instead of sizeof(struct item_struct_name)
	whenever possible.  

Sun Feb 27 22:56:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	doc_loading_callback(): Minor optimization.  

Sun Feb 27 22:52:19 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Fix some fuzzy logics.  

Sun Feb 27 22:07:36 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/spidermonkey.c:

	Fix for bug 611.  

Sun Feb 27 15:50:13 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	cookies.save is boolean.  

Fri Feb 25 18:40:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/finger/finger.h:

	Normalize the header guards.  

Fri Feb 25 17:05:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: renderer.c, html/renderer.c, plain/renderer.c:

	Fix honouring of the Refresh-header when the loaded document is
	empty. The fix requires assertions to be removed in the renderers.
	It also fixes things like document->bgcolor not being set for empty
	documents. Reported by Daniel on elinks-users. (bug 625) 

Fri Feb 25 16:55:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	process_head(): Tidy up.  

Fri Feb 25 16:53:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Oops. Fix last patch. A little rusty. ;) 

Fri Feb 25 16:52:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	According to http://wp.netscape.com/assist/net_sites/pushpull.html a
	missing URL parameter to the Refresh HTTP-equiv indicates the
	current document should be refreshed.  

Thu Feb 24 21:51:51 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	Fix the comment Jonas added in his last patch.  

Thu Feb 24 12:07:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Fix displaying of ordered lists when <li> is not directly nested in
	<ol>-elements. Reported by Michal Kwiatkowski.  

Thu Feb 24 12:05:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Revert bad part of the patch that fixes the what-to-do dialog.
	Thanks Zas.  

Wed Feb 23 23:42:12 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser.c, sched/download.c:

	Fix the what-to-do dialog fixed so that the input box does not get
	focus.  

Wed Feb 23 22:02:36 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/: bookmarks.c, dialogs.c:

	Fix opening of either single bookmarks or folders by using
	get_translated_uri() instead of get_uri(). The problem occurs for
	URLs without a slash at the end. Reported by Michal Kwiatkowski.  

Wed Feb 23 21:52:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, protocol/about.c,
	protocol/data.c, protocol/file/file.c, protocol/finger/finger.c,
	protocol/ftp/ftp.c, protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c, protocol/smb/smb.c, sched/session.c:

	Introduce normalize_cache_entry() that should be called when
	completion the creation of a cache entry. Fixes a truncating bug in
	the NNTP backend.  

Wed Feb 23 20:05:34 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In try_form_insert_mode, check first whether the current link is a
	text input field. This fixes the problem reported by Jonas and
	resulting from my previous changes whereby a link had to be
	activated twice before it would do anything.  

Wed Feb 23 19:09:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.h:

	Add the parameter names in the declarations.  

Tue Feb 22 21:11:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/changelog:

	Merge changelog changes from the recently uploaded 0.10.2 package.  

Tue Feb 22 15:53:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/perl/hooks.pl:

	Added two smart prefixes.  Coral cache and Babelfish.  To use the 
	babelfish prefix, goto "babelfish german english" (or "bf de en") to 
	translate the current page from German to English.  It recognizes
	all languages supported by babelfish.  
	
	Patch by Russ Rowan.  

Tue Feb 22 14:39:03 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/Makefile.am:

	Doh. Add elinks.docs to EXTRA_DIST.  

Mon Feb 21 23:31:47 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Again, move the call up the call-chain, this time to frame_ev_kbd.  

Mon Feb 21 23:29:34 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: form.c, view.c:

	Move the call to try_form_insert_mode up the call-chain, from
	field_op to try_form_action.  

Mon Feb 21 23:26:33 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	Clean up try_form_insert_mode.  

Mon Feb 21 23:25:33 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	Factor the code to toggle insert mode out from field_op into the new
	try_form_insert_mode.  

Mon Feb 21 22:52:34 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	De-localise |link| in frame_ev_kbd.  

Mon Feb 21 22:50:23 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Move the check for whether |link| is NULL from try_form_action to
	frame_ev_kbd and assert |link| in try_form_action.  

Mon Feb 21 22:46:17 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Move the call to try_form_action from frame_ev to frame_kbd_ev.  

Mon Feb 21 18:07:38 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/spidermonkey.c:

	Added comment.  

Sun Feb 20 23:04:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/spidermonkey.c:

	Try to add support for history.go(...) borrowing code from the
	history menuing.  

Sun Feb 20 22:45:05 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/spidermonkey.c:

	Use go_unback() and idea from history_back() to implement
	history.forward().  

Sun Feb 20 22:29:24 2005  Laurent Monin <zas@norz.org>:

	* test/ecmascript/history.html:

	Add javascript history test file.  

Sun Feb 20 21:48:37 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/parse.c:

	A truer translation of Czechlish 'a special care' is 'special care', 
	not 'a special case'.  

Sun Feb 20 21:41:14 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/parse.c:

	Nicen up the comments in struct element_info.  

Sun Feb 20 20:24:50 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/spidermonkey.c:

	onClick="history.back" special treatment's comment.  

Sun Feb 20 20:07:24 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/spidermonkey.c:

	It's strange, but it must be so.  

Sun Feb 20 19:52:18 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/spidermonkey.c:

	Yeah! 

Sun Feb 20 00:33:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	Apparently the attribute string can be removed from under us (when
	accessing google news) so check before applying CSS the second time.  

Sun Feb 20 00:12:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Add a <base href="cwd" /> element to the generate directory listing.  

Sat Feb 19 21:51:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	The caching of the CSS selector is broken, since t can lead to wrong
	styles being applied to following elements, so disabled for now.  

Thu Feb 17 17:35:57 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	More punctuation fixes.  

Thu Feb 17 10:43:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	Try to detect missing punctuation with --enable-debug. It might
	produce false warnings for languages with very different
	punctuation.  

Thu Feb 17 10:16:51 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Punctuations fixes, thanks to Fonseca.  

Thu Feb 17 07:20:25 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* po/pl.po:

	Missing ending punctuation, replaced ? with . at some places.  

Wed Feb 16 23:49:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	More of dem punctiation fixings.  

Wed Feb 16 22:58:38 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	.*[^.]\)"$/\1."/gc to check.  

Wed Feb 16 20:29:40 2005  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Usual post-Witek cleanups. ;-) 

Wed Feb 16 20:18:30 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/spidermonkey.c:

	history.back() impemented.  

Wed Feb 16 17:35:08 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	Add toggle html/plain to right click menu, and make it to not
	display reload/bookmark when no document is available.  

Wed Feb 16 16:46:06 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* po/pl.po:

	Polish translation was updated 

Tue Feb 15 21:02:46 2005  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Translation updated.  

Fri Feb 11 22:38:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/: be.po, bg.po, ca.po, cs.po, de.po, el.po, es.po, et.po,
	fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po, lt.po,
	nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po, sk.po, sv.po,
	tr.po, uk.po:

	Update .po files.  

Fri Feb 11 22:33:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Fri Feb 11 20:09:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	--dump is a boolean option.  

Fri Feb 11 20:04:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, osdep/osdep.c, osdep/win32/win32.c:

	Move setlocale() to the recently added init_osdep(). Fixes gettext
	declaration clashes on SunOS. Big fat note left near the <locale.h>
	include. Reported by Stephane Chazelas.  

Fri Feb 11 19:07:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/stub.c:

	Fix issue with missing includes reported by Stephane Chazelas and
	s/inet_ntop4/elinks_inet_ntop4/ (how was it even possible to compile
	this crap I merged). Spiced up with a little cleanups to make Miciah
	happy.  

Fri Feb 11 19:04:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/Makefile.am:

	Only create .../lib directory if the gettext code is going to
	install a new charset.alias file.  

Wed Feb  9 09:42:20 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Feb  9 09:32:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c:

	Defer displaying of the download dialog until after the external
	handler has been set up. Use this info to avoid adding the 'Abort
	and delete file' button when dealing with downloads scheduled to
	open in external handlers.  

Tue Feb  8 23:22:15 2005  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Updated hungarian translation 

Tue Feb  8 17:42:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/error.c:

	Try to improve the proxy error message. Patch by Morten and me.  

Tue Feb  8 03:13:32 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/perl/hooks.pl:

	Neuromancer says that one can't return undef; just return from
	proxy_for_hook.  

Tue Feb  8 02:18:06 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/perl/hooks.pl:

	Add a SourceForge ad smasher and a Google dehelpfuliser, because we
	are geeks, and geeks don't like ads or need helpful tips. Code from
	Neuromancer.  

Tue Feb  8 02:07:16 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/perl/hooks.pl:

	Some new prefixes from Neuromancer: Slashdot, elgooG, BOFH, and
	torrent searching with Google.  

Tue Feb  8 02:02:02 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/perl/hooks.pl:

	Two inconsequential regex-escaping fixes from Neuromancer.  

Tue Feb  8 01:59:35 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/perl/hooks.pl:

	Do not use a proxy for local files. Code from Neuromancer.  

Tue Feb  8 01:57:22 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/perl/hooks.pl:

	Eliminate $proxy_url; this will look better in the end...  

Tue Feb  8 01:54:04 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/perl/hooks.pl:

	Change the default proxy_for_hook to return undef so that the
	configured proxy will be used.  

Tue Feb  8 01:50:29 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/perl/hooks.c:

	Fix the get-proxy hook so that an undef return value from the PERL
	hook results in the default proxy being used, as is supposed to be
	the case with get-proxy hooks.  
	
	Many thanks to Neuromancer for testing.  

Tue Feb  8 01:03:38 2005  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	With tender sound... I don't know what it was zas was trying to do
	in 1.482, but he broke it for me. ;-) Reverted, _now_ just single
	square brackets are again shown to me as they should. ...of silence! 

Sun Feb  6 09:42:04 2005  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	I personally consider the default '_' and 'w' keybindings harmful
	since they aren't that difficult to reach in menus and they occupy
	lucrative keybinding positions which aren't worth their IMHO
	extremely small frequency of use.  

Sat Feb  5 22:36:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: intl/gettext/dcigettext.c, lowlevel/interlink.c,
	lowlevel/signals.c, osdep/osdep.c, util/time.c, util/ttime.c:

	Some more compile fixes revealed on MingW. In get_address() port is
	always > 65535.  

Sat Feb  5 20:04:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Consolidate changes discussed on the Danish language team mailing
	list. Update to remove all fuzziness and translate all messages.
	Patch by Morten Bo Johansen and me.  

Sat Feb  5 18:14:29 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/win32/overrides.c:

	Unix'fy and ELinksify the code.  

Sat Feb  5 17:43:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/win32/overrides.h:

	Convert to unix newlines and make the code conform to the hacking
	guidelines.  

Sat Feb  5 17:37:36 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Oops, revert bad part of last patch.  

Sat Feb  5 17:36:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po, src/osdep/win32/win32.c:

	Make the win32 code conform to the hacking guidelines.  

Sat Feb  5 17:27:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/win32.m4:

	Convert to unix newlines.  

Sat Feb  5 06:27:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/win32/: overrides.c, win32.c:

	Move IDN init code to init_osdep(), so these ugly constructors and
	deinit hooks can be removed. Make the tracing appear only when
	--verbose 2.  

Sat Feb  5 05:54:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/getifaddrs.c, util/secsave.c:

	Fix two compile errors.  

Sat Feb  5 05:26:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/Makefile.am, osdep/generic.h, osdep/osdep.c,
	osdep/system.h, osdep/win32/Makefile.am, osdep/win32/overrides.c,
	osdep/win32/overrides.h, osdep/win32/sysinfo.h,
	osdep/win32/win32.c, osdep/win32/win32.h, terminal/screen.c,
	util/error.c:

	Add remaining glue code so that the win32 should theoretically
	compile (I will test when I wake up) and the resulting binary can
	dump data.  

Sat Feb  5 05:22:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/osdep/stub.c, src/osdep/stub.h:

	Add a stub for inet_ntop(). It is quite big, but WTH. Patch by Paul
	Vixie, Gisle Vanem and me.  

Sat Feb  5 04:47:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/getifaddrs.c:

	Guard getifaddrs2() by a thick wall of macro checks so it only gets
	compiled in when it is actually used.  

Sat Feb  5 04:35:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, osdep/osdep.c, osdep/osdep.h:

	Add init_osdep() hook. Only win32 will use it for now. It will be
	added later.  

Sat Feb  5 04:20:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.c:

	lookup_fn(): Wrap in #ifndef NO_ASYNC_LOOKUP because do_lookup()
	will only call it if ... Patch by Gisle Vanem.  

Sat Feb  5 04:15:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	dns_found(): Check also EWOULDBLOCK (if available on win32) after
	calling connect(). Patch by Gisle Vanem.  

Sat Feb  5 04:08:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.h:

	Prepare for handling winsock errors by moving the internal error
	numbers so they start at -100000. Patch by Gisle Vanem.  

Sat Feb  5 03:35:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/lowlevel/signals.c:

	Check not only sigaction.h but also sigaction() and fall back to use
	signal() interface if it is not available. Not I am on thin ice
	here. From the MingW/win32 port but I think I made the original
	patch sometime I was visiting my father in Jutland.  

Sat Feb  5 03:22:39 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/select.c, lowlevel/signals.c, osdep/osdep.c:

	Various signal compile checks/fixes needed by mingw/win32 port.
	Patch by Gisle Vanem and me.  

Sat Feb  5 03:07:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/loadmsgcat.c:

	Fix compile warning.  

Sat Feb  5 03:03:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/gettext.h:

	Tidyup.  

Sat Feb  5 03:00:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/osdep/osdep.c, src/osdep/osdep.h,
	src/terminal/kbd.c:

	Check for termios.h and wrap includes.  

Sat Feb  5 02:56:28 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, config/m4/win32.m4:

	Add win32 specific configuration.  

Fri Feb  4 21:49:26 2005  Petr Baudis <pasky@ucw.cz>:

	* src/cookies/dialogs.h:

	Declare @cookie_queries as extern in the .h file. It was probably
	utterly broken until now. Also fixes compilation with outrageous
	CFLAGS like some of the Gentoo people like to have
	(http://bugs.gentoo.org/show_bug.cgi?id=80226).  

Fri Feb  4 21:45:51 2005  Petr Baudis <pasky@ucw.cz>:

	* contrib/ruby/.cvsignore:

	A fairy.  

Fri Feb  4 00:41:28 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* po/pl.po:

	Polish translation was updated.  

Fri Feb  4 00:21:49 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* src/protocol/file/cgi.c:

	One more casting fix 

Thu Feb  3 23:36:58 2005  Adam Golebiowski <adamg@pld-linux.org>:

	* src/: bfu/listmenu.c, dialogs/info.c, dialogs/options.c,
	document/html/renderer.c, protocol/http/codes.c, sched/session.c,
	scripting/lua/core.c, terminal/kbd.c, terminal/terminal.c,
	util/error.c, viewer/text/form.c:

	- some casting improvements (fixes build with --enable-debug on
	  amd64): 
	(int) -> (long) 
	  (void *) -> (void *) (long) 

Thu Feb  3 22:28:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Improve the type query dialog so that the program can now be edited.
	Also the 'Show header' button will no longer close the type query
	dialog but open the cache header dialog on top of the type query
	dialog. Finally the 'Show header' button is only added when there is
	a header to show (which is not the case for local files).  

Thu Feb  3 12:40:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/perl/hooks.pl:

	Shift the current URL argument so people know it is available.
	s/NIL/''/.  

Wed Feb  2 17:33:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, sched/connection.c, protocol/proxy.c,
	protocol/proxy.h, sched/connection.h, sched/error.c:

	Try to detect errors in the proxy configuration and pop up an
	appropriate error message instead of OOM.  

Wed Feb  2 12:58:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, debian/changelog, debian/watch:

	Update changelog to close bug 293298 (infinite refresh download).
	Add debian/watch file by Hugo Haas.  

Wed Feb  2 01:01:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/README:

	Advice to check-po. Rewrap.  

Tue Feb  1 23:51:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/Makefile.am:

	Don't print the shell code and echo the language code.  

Tue Feb  1 23:47:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/Makefile.am:

	Make a special check-po rule so not to b0rk when generating the
	catalogs.  

Tue Feb  1 23:38:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/Makefile.am:

	Allways perform a verbose check when compiling .po into .gmo files
	to catch errors.  

Tue Feb  1 01:01:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/perl/hooks.pl:

	This revision adds a "mirrordot" or "md" url prefix in addition to
	fixing the nil|" "|"" return issue that reared it's head since you
	made the proxy hooks actually work. Patch by Russ Rowan.  

Tue Feb  1 00:11:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/ruby/hooks.rb:

	s/Qnil/nil/ 

Mon Jan 31 23:14:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* SITES:

	Remove non-official (and now closed) Debian package archive.  

Mon Jan 31 22:28:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	A few fixes.  

Mon Jan 31 18:35:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Mon Jan 31 18:32:36 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Fix a conflicting hotkey.  

Mon Jan 31 13:21:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	'14:16 < rtega> you can use debuild -uc -us too' when building a
	Debian package.  

Mon Jan 31 13:12:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	Propose to run 'fakeroot dpkg-buildpackage -uc -us' when building a
	Debian package.  

Mon Jan 31 10:28:20 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Jan 30 23:42:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/forms.c:

	The HTML specification at 
	http://www.w3.org/TR/REC-html40/interact/forms.html#h-17.3 states 
	that the behavior of an empty action attribute should be undefined.  
	Mozilla handles action="" as action="<current-URI>" which seems 
	reasonable. (bug 615) 

Sun Jan 30 22:41:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/Makefile.am:

	Oops, no README file.  

Sun Jan 30 22:03:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	Add 0.10.2 entries.  

Sun Jan 30 21:11:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/: Makefile.am, ruby/hooks.rb:

	A useless ruby hooks file.  

Sun Jan 30 13:44:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/pl.po:

	This one translates one untranslated msgid. Patch by Adam
	Golebiowski.  

Sat Jan 29 12:08:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Sat Jan 29 00:48:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/Makefile.am:

	Add user.css to EXTRA_DIST.  

Fri Jan 28 19:00:16 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/options.c:

	Add a little help text to the terminal options dialog, which also
	indicates the value of the TERM environment variable. Idea by
	Miciah.  

Fri Jan 28 14:56:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Fix the root of bug 613. Don't mirror the default stylesheet if CSS
	is disabled.  

Fri Jan 28 14:45:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/forms.c:

	get_form_control_link() Miciah is so smart. Return if FC_HIDDEN.  

Fri Jan 28 14:40:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Eureka, bug 613 CSS leak fixed.  

Fri Jan 28 14:19:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/user.css:

	Add Id tag.  

Fri Jan 28 14:10:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	When the first form is added make sure it takes up the whole form
	(offset) range. Fixes bug 613.  

Fri Jan 28 13:13:48 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/forms.c:

	Hidden form fields are not attached to links. Fixes bug 614.  

Fri Jan 28 12:50:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/screen.c:

	Fix underline rendering when using 256 colors. Now, the char
	'outputter' is more similar to the one used for 16 colors. Hmm, this
	has only bugged the last year or so.  

Fri Jan 28 01:46:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Fixes from Morten.  

Wed Jan 26 22:36:01 2005  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	updated and fixed hungarian translation 

Wed Jan 26 16:16:38 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/ruby.m4:

	Change Ruby configuration to use --with... interface so the path to
	the ruby binary can be supplied. As with Perl configuration also try
	to link a simple program to see if the ruby archive is installed.  

Wed Jan 26 15:20:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Try to link a simple program against -lperl during configuration
	before enabling perl. This was reported by Miciah and I can
	reproduce it, but question is if it is Debian specific.  

Wed Jan 26 14:43:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Sync and fix a few translations.  

Tue Jan 25 15:27:02 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Mon Jan 24 13:03:36 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Jan 23 20:54:28 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Danish translation got aspell'ed and a few typos were fixed.  

Sat Jan 22 17:47:18 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	A few fixes.  

Sat Jan 22 14:01:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Opdater den danske oversættelse.  

Sat Jan 22 13:54:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/leds.c, ecmascript/ecmascript.c,
	ecmascript/spidermonkey.c, sched/session.c, sched/session.h:

	Introduce a very simple ECMAScript pop-up window blocking mechanism.
	Will show a 'P' in the LED indicators. Off by default.  

Fri Jan 21 19:58:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	A few fixes after discussing the merge with Morten Bo Johansen.  

Fri Jan 21 14:27:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/ruby.m4:

	Try fix Ruby configuration (again) reported by zas (again ;). 'Twas
	caused by a nameclash in a local variable. Use CONFIG_RUBY instead;
	we 0wn that.  

Fri Jan 21 14:23:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/hooks.c:

	Fix ruby logic in last patch. Spotted by Miciah.  

Fri Jan 21 14:11:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/: lua/hooks.c, perl/hooks.c, ruby/hooks.c:

	Fix get-proxy event hooks. @new_proxy_url is initialized to NULL so
	don't check for that. Instead be defensive and sanity check
	pointers.  

Fri Jan 21 14:05:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/core.c:

	erb_module_message(): Rename variables. Fix so that
	ELinks::message() can also be called from the quit hook.  

Fri Jan 21 11:24:12 2005  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Revert patch 1.184->1.185 (what was its purpose?), it breaks
	progress display in download dialog. It fixes bug 610.  

Thu Jan 20 18:31:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/core.c:

	Rearrange module functions a bit. Fix ELinks::message(). Export
	Kernel::p() hook also as ELinks::p().  

Thu Jan 20 16:40:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/core.c:

	Improve comments. Remove unneded code.  

Thu Jan 20 16:16:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/ruby.m4:

	Fix a stupid error that was causing m4 to complain about EOF in
	string.  

Thu Jan 20 13:12:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/core.c:

	erb_stdout_p(): Use own string lib and remove quotes from printed
	ruby strings. Pass the resulting string to usrerror() if no
	terminals can be hijacked. usrerror() will output "ELinks: " first
	so prefix messages a "[Ruby]" token.  

Thu Jan 20 12:31:16 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/ruby.m4:

	Fix ruby configuration logics reported by zas.  

Thu Jan 20 09:44:45 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/core.c:

	Fix exporting of elinks_home. Rename to ELinks::HOME because
	constants should be all upcased.  

Wed Jan 19 16:15:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/core.c:

	Export elinks_home as ELinks::home.  

Wed Jan 19 14:50:36 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/document.c:

	Simplify cached_header_dialog() and fix a potential memleak.  

Wed Jan 19 14:45:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Improve and fix a few translations.  

Wed Jan 19 12:52:22 2005  Laurent Monin <zas@norz.org>:

	* src/config/dialogs.c:

	Fix potential memleak.  

Wed Jan 19 11:19:22 2005  Laurent Monin <zas@norz.org>:

	* src/config/: dialogs.c, dialogs.c:

	Minor cleanup.  

Wed Jan 19 11:11:44 2005  Laurent Monin <zas@norz.org>:

	* src/config/dialogs.c:

	Reduce code redundancy.  

Wed Jan 19 08:55:12 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Jan 18 22:54:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Tue Jan 18 22:39:04 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Fix a few hotkeys and a typo.  

Tue Jan 18 22:32:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/: changelog, rules:

	Install the desktop file in /usr/share/applications/. Indent
	comments because it looks more spiffy.  

Tue Jan 18 22:25:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* Makefile.am:

	acinclude.m4 requires autogen.sh to be run, which depends on special
	tools, so only add it to MAINTAINERCLEANFILES.  

Tue Jan 18 22:20:40 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/hooks.c:

	Invoke quit_hook like the other hooks.  

Tue Jan 18 15:12:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/hooks.c:

	... and then also invokel ELinks.quit_hook().  

Tue Jan 18 15:09:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/hooks.c:

	Check for quit_hook in the ELinks module, since I decided that it
	was much more perty to use ELinks.{hook method}.  

Tue Jan 18 15:07:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/: core.c, core.h, hooks.c:

	Use the session event parameter so error messages has a better
	chance at showing up the right place.  

Tue Jan 18 10:51:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/ruby.m4:

	Fix ruby configuratino.  

Tue Jan 18 10:30:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/ruby/: .cvsignore, .vimrc:

	m33p 

Tue Jan 18 10:29:39 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, config/m4/ruby.m4, src/scripting/Makefile.am,
	src/scripting/scripting.c, src/scripting/ruby/Makefile.am,
	src/scripting/ruby/core.c, src/scripting/ruby/core.h,
	src/scripting/ruby/hooks.c, src/scripting/ruby/hooks.h,
	src/scripting/ruby/ruby.h:

	Add support for ruby scripting. Needs more work but the basics are
	there.  

Mon Jan 17 14:28:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/introduction.txt:

	Drop a note about menu searching.  

Sat Jan 15 22:12:48 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/edit.c:

	In my_cancel_dialog, use the given widget_data instead of using a
	hardwired offset into the dialog's array of widgets.  

Sat Jan 15 21:42:36 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/protocol.c:

	In generic_external_protocol_handler, do not localise the title and
	the label of the OK button for the unsupported-protocol error box
	twice.  

Sat Jan 15 20:24:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Sat Jan 15 20:16:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/fi.po:

	I added several translations, removed some entirely incorrect fuzzy
	translations, and changed some translations for hopefully better
	consistency.  
	
	I also converted the file to ISO-8859-15, in order to translate 
	"Czech" correctly.  
	
	I haven't seen any response from Ilkka Karvinen.  
	
	-- Kalle Olavi Niemitalo 

Sat Jan 15 20:00:41 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/inpfield.c:

	Insert a blank line.  

Sat Jan 15 19:59:42 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/inpfield.c:

	Return the return value of cancel_dialog from input_field_cancel.  

Sat Jan 15 18:15:18 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/dialog.c, bfu/dialog.h, bfu/inpfield.c,
	dialogs/options.c, viewer/text/search.c:

	Drop the unused parameter widget_data from update_dialog_data.  

Fri Jan 14 18:47:46 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jan 14 18:45:22 2005  Laurent Monin <zas@norz.org>:

	* src/config/options.inc:

	Drop superfluous newline at end of option description.  

Fri Jan 14 18:42:34 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jan 14 15:47:00 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Rewrite the description for document.browse.accesskey.  

Fri Jan 14 15:40:55 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Any link can have an access key, not just 'active links', whatever
	those might be.  

Thu Jan 13 15:55:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/Makefile.am:

	SSL headers are needed for auth/digest.c, reported by Zas.  

Thu Jan 13 14:14:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/ecmascript/Makefile.am, src/osdep/Makefile.am,
	src/scripting/guile/Makefile.am, src/scripting/lua/Makefile.am,
	src/scripting/perl/Makefile.am, src/ssl/Makefile.am:

	Add certain compile flags only when needed to decrease the build
	output.  

Thu Jan 13 14:13:05 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Jan 13 14:12:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	The tabindex can be atmost 32767.  

Thu Jan 13 13:30:39 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/lua/Makefile.am:

	Add lua.h to EXTRA_DIST.  

Thu Jan 13 13:29:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/: scripting.c, lua/core.h, lua/lua.h:

	Like the recent Perl change, never include scripting library headers
	in the main module.  

Thu Jan 13 13:26:21 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Only add the 'Pass URI ...' option to the tab menu if the session
	has a location so that the '>>' won't be misleading since no submenu
	can be opened.  

Thu Jan 13 13:24:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, mime/backend/mailcap.c:

	More clarification of option descriptions.  

Thu Jan 13 13:23:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Fix off by one error in cursor routing.  

Thu Jan 13 13:21:35 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Should be the final merging of Danish Translation: 159
	insertions(+), 161 deletions(-).  

Thu Jan 13 13:20:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/elinks-lua.texi:

	Fix nodes so makeinfo don't choke on it.  

Wed Jan 12 16:50:29 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Jan 12 16:37:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	More Danish translation merging.  

Wed Jan 12 16:32:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/dialogs.c, config/kbdbind.c, dialogs/menu.c:

	A few clarifications. Use 'Open new window' to better match 'Open
	new tab'.  

Wed Jan 12 15:18:53 2005  Laurent Monin <zas@norz.org>:

	* .cvsignore, Makefile.am, autogen.sh:

	Revert http://www.nitro.dk/~jonas/no_need_for_acinlude.patch. It
	fixes autogen.sh with old autotools.  

Wed Jan 12 14:55:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/Makefile.am:

	Remove conffiles.  

Wed Jan 12 03:46:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Fix a few hotkey conflicts.  

Wed Jan 12 03:19:41 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/elinks.desktop:

	Spice up the .desktop file.  

Wed Jan 12 02:46:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/rules:

	Only export CFLAGS if required, so configure can set it properly.  

Wed Jan 12 02:44:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Follow up patch for the last one. Fix a few comments. Remove
	unnecessary usage of foreachsafe() iterator.  

Wed Jan 12 02:35:20 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: forms.c, forms.h, html/renderer.c,
	html/renderer.h, html/tables.c, html/parser/forms.c:

	Rearrange form items so they are added to the correct forms after
	table rendering. The bug occurs because tables are rendered
	column-wise which leads to problems when a form element is in a
	columns greater than its form items. It was introduced in the recent
	form changes. I am unsure if it the changed usage of form->form_num
	is a problem for code that is relying on sequencial values. The 
	patch fixes bug 602.  

Tue Jan 11 21:32:03 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/: changelog, control, control.in, rules:

	A few fixes for errors reported by lintian. Pass pwd prepended
	DEB_ROOT, doh! 

Tue Jan 11 19:33:38 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/conf.c:

	Show 'File saving disabled by option' error when saving and -no-home
	was given. Assert that the term to write_config() is always set. We
	get called from do_action() and places passing dlg_data->win->term
	so it should be ok to be less defensive.  

Tue Jan 11 17:39:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/: changelog, elinks.prerm:

	Remove www-browser alternative based on patch by Andreas Metzler.
	Add changelog entries for some of the debian bugs that has been
	fixed.  

Tue Jan 11 15:59:35 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/conffiles:

	Remove empty conffiles. All files in the etc/ directory in a package
	will automatically be flagged as conffiles by dh_installdeb.  

Tue Jan 11 15:51:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* README:

	Translation stuff pointer update: s/intl/po/.  

Tue Jan 11 15:45:28 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/: changelog, mime:

	Pass -force-html in the debian/mime mailcap entries so problems with
	viewing files without an extension is fixed. Update changelog also
	with entries for last commit.  

Tue Jan 11 15:34:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/rules:

	Remove now obsolete -XChangeLog.orig switch to dh_clean. Don't touch
	install-stamp it is never used. Re-enable dh_installman, it does
	some checks it seems. Remove obsolete outcommented
	dh_{testversion,undocumented,suidregister}. Finally blast some more
	unused dh_*.  

Tue Jan 11 15:29:28 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/elinks.docs:

	Install all the doc/ files since they are tied together in
	index.txt. Besides we don't have that much that we can afford to be
	choosy. ;) 

Tue Jan 11 14:57:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/rules:

	Use DH_ALWAYS_EXCLUDE to avoid CVS, .cvsignore, .vimrc and Makefile*
	files to ever be packaged.  

Tue Jan 11 14:36:47 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/: Makefile.am, rules:

	Move the build-stamp file to debian/. Make distclean remove the
	build-stamp and the build tree directory.  

Tue Jan 11 14:35:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/.cvsignore:

	Sort.  

Tue Jan 11 13:35:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/: changelog, rules:

	Add support for DEB_BUILD_OPTIONS. Cleanup.  

Tue Jan 11 08:02:29 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/: changelog, elinks.docs, rules:

	Introduce elinks.docs file and exclude example files using -X
	switch. Makefile and *.patch files doesn't seem to be handled by
	that.  

Tue Jan 11 03:36:06 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/rules:

	LEDS are enabled by default so remove configure comment. Cleanup
	failure handling. dh_installmanpage is deprecated and it doesn't
	seem to be necessary to call dh_installman, so left commented out.  

Tue Jan 11 03:19:27 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/: changelog, rules:

	Fix deletion of unrelevant files from contrib/.  

Tue Jan 11 02:26:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Tue Jan 11 01:07:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/rules:

	Stupid me. Prepend doc/ to documentation files. ;) 

Tue Jan 11 00:50:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/changelog:

	Add entry bumping up the version.  

Tue Jan 11 00:38:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* Makefile.am, configure.in:

	Integrate debian/ with the build system.  

Tue Jan 11 00:37:05 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/rules:

	Install the elinks.conf from contrib/.  

Tue Jan 11 00:32:03 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/rules:

	Install doc/ files relevant to using ELinks.  

Tue Jan 11 00:05:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/Makefile.am:

	The elinks.conf file was moved.  

Tue Jan 11 00:04:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/rules:

	Only remove CVS directories from the packaging directory
	debian/elinks/.  

Tue Jan 11 00:02:54 2005  Jonas Fonseca <fonseca@diku.dk>:

	* debian/: .cvsignore, .vimrc:

	m33p 

Tue Jan 11 00:02:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, debian/Makefile.am, debian/README.Debian,
	debian/changelog, debian/conffiles, debian/control,
	debian/control.in, debian/copyright, debian/elinks.desktop,
	debian/elinks.postinst, debian/elinks.preinst, debian/elinks.prerm,
	debian/menu, debian/mime, debian/rules:

	Add debian/ files from the official debian package by Peter Gervai.
	Only change is to install elinks.conf example from contrib/ instead
	of debian/.  

Mon Jan 10 23:54:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/: Makefile.am, elinks.conf:

	Add example configuration file.  

Mon Jan 10 12:56:57 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	More merging of Danish translations by Morten Bo Johansen.  

Mon Jan 10 12:55:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/pl.po:

	Update by Adam Golebiowski.  

Mon Jan 10 03:30:26 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/dump/dump.c:

	Use get_opt_codepage for document.dump.codepage.  

Sun Jan  9 22:36:54 2005  Petr Baudis <pasky@ucw.cz>:

	* THANKS:

	Zdenek Burda donated the elinks.cz domain (reg in progress).  

Sun Jan  9 10:35:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/Makefile.am:

	Only install anything when NLS is enabled, so use *-local-(no|yes)
	targets.  

Sun Jan  9 08:28:36 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Jan  9 01:50:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/Makefile.am:

	Describe the PO weirdness.  

Sun Jan  9 01:36:22 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/: Makefile.am, Makefile.in:

	Move this sucker up the foodchain. Atleast now it is partially
	readable, well if vim would only handle that shell-GNUism.  

Sat Jan  8 23:08:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/Makefile.in:

	Create $(datadir)/locale dir instead of just $(datadir). Reported by
	Russ Rowan.  CCMAIL: rrowan@dandy.net 

Sat Jan  8 21:45:28 2005  Jonas Fonseca <fonseca@diku.dk>:

	* .cvsignore, Makefile.am, autogen.sh:

	Who needs acinclude.m4 for generating aclocal.m4 when you can tell
	aclocal where to get the .m4 files.  

Sat Jan  8 21:39:42 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Fix wrong comment spotted by Miciah.  

Sat Jan  8 21:25:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/.cvsignore:

	Uhm, and now that there are Makefiles in config/ ignore the
	generated ones.  

Sat Jan  8 21:23:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* Makefile.am, configure.in, config/Makefile.am:

	Fix issues with make dist. Now all the lovely files in config/
	needed by configure will be added. Cleanup the top-level Makefile.am
	a bit.  

Sat Jan  8 21:20:11 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/Makefile.in:

	This convenient shortcut doesn't seem to be needed. Anyway I expect
	this to fix the 'dist' rule that depends on elinks.pot which was
	first created later.  

Sat Jan  8 04:08:08 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In move_cursor, scroll the document as many rows or columns as
	necessary rather than only be one row or one column.  

Sat Jan  8 03:17:49 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: link.c, view.c, view.h:

	In jump_to_link_number, when in cursor-routing mode, call
	move_cursor to position the cursor on the newly selected link.  
	
	This should fix bug 607, "goto link number doesn't move cursor if
	cursor already moved".  

Fri Jan  7 22:47:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* Makefile.am:

	Oops. Distribute the config/m4/ files.  

Fri Jan  7 22:42:20 2005  Jonas Fonseca <fonseca@diku.dk>:

	* .cvsignore, config/.cvsignore:

	Ignore properly.  

Fri Jan  7 22:24:59 2005  Jonas Fonseca <fonseca@diku.dk>:

	* autogen.sh, config/m4/.vimrc:

	Move m4 macros to new config/ directory.  

Fri Jan  7 22:06:03 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/: .cvsignore, .vimrc:

	m33p 

Fri Jan  7 22:04:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config.guess, config.sub, configure.in:

	Use the newly added config/ dir for keeping files for the
	buildsystem.  

Fri Jan  7 21:53:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	More merging of Danish translations by Morten Bo Johansen. Diff down
	to ~600 lines.  

Fri Jan  7 21:51:46 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, viewer/text/form.c:

	3 small improvements.  

Fri Jan  7 01:51:07 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	More merging of Danish translations by Morten Bo Johansen.  

Fri Jan  7 00:47:55 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Don't hyphenate ELinks-version.  

Fri Jan  7 00:46:20 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Just give the codenames without prefacing each one with 'codename'.  

Fri Jan  7 00:44:32 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Move some colons around.  

Fri Jan  7 00:42:10 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Correction: Modal text editing is enabled, not disabled, by default.  

Fri Jan  7 00:41:14 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	s/ELinks-now/ELinks-0.10.0/ 

Thu Jan  6 21:59:00 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Include bfu/led.s.h for menu_leds_info.  

Thu Jan  6 16:32:25 2005  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/ftp/ftp.c:

	Could you check ftp download resume? 

Thu Jan  6 16:24:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	More merging of Danish translations by Morten Bo Johansen.  

Thu Jan  6 15:32:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Second batch of merged Danish translations by Morten Bo Johansen.  

Thu Jan  6 13:19:58 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/dcigettext.c:

	Try to declare alloca() with proper types. Should fix problems on
	OpenBSD and NetBSD systems. Reported by Nelson H. F. Beebe.  

Thu Jan  6 13:13:55 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	INET_ADDRSTRLEN is not available on some IRIX systems, so define
	them if needed. Reported by Nelson H. F. Beebe.  

Thu Jan  6 09:00:12 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Display led indicators help dialog when these are clicked.  

Thu Jan  6 08:55:18 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Drop |bars| variable and only check for mouse tabs navigation if
	tabs bar is displayed.  

Thu Jan  6 08:47:44 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Revert 1.666->1.667 patch. It will be reintroduced in smaller parts.
	Idea by Miciah.  

Wed Jan  5 23:55:01 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po, AUTHORS:

	First batch of merged Danish translations by Morten Bo Johansen.  

Wed Jan  5 23:17:44 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Jan  5 19:54:29 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, viewer/text/view.c:

	Add support for disabling this extended horizontal scheme we
	currently have, so it works more like vertical scrolling. Requested
	by Russ Rowan and he shall have it because he made so many good
	error reports lately ;).  

Wed Jan  5 18:27:29 2005  Jonas Fonseca <fonseca@diku.dk>:

	* THANKS:

	m33p.  

Wed Jan  5 18:02:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/gettext.m4, po/Makefile.in:

	Fix build issue reported by zas.  

Wed Jan  5 16:54:58 2005  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	Fix some get_opt_*() calls.  

Wed Jan  5 16:48:55 2005  Laurent Monin <zas@norz.org>:

	* doc/introduction.txt:

	Minor typo fixes (that i hope correct, Miciah will proof-read at
	some time).  

Wed Jan  5 16:26:37 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/introduction.txt:

	Write a little about searching.  

Wed Jan  5 16:25:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Wire in the search history also for incremental link text searching.
	With the improved error handling it works quite well, but it also
	reveals some redrawing bugs.  

Wed Jan  5 14:53:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* THANKS:

	Make it a bit more readable.  

Wed Jan  5 14:37:43 2005  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/gettext.m4, po/Makefile.in, src/main.c,
	src/bfu/hotkey.c, src/bfu/hotkey.h, src/bfu/menu.c, src/bfu/menu.h,
	src/config/cmdline.c, src/config/options.c, src/config/opttypes.c,
	src/dialogs/menu.c, src/dialogs/options.c,
	src/ecmascript/spidermonkey.c, src/intl/Makefile.am,
	src/intl/gettext/libgettext.h, src/intl/gettext/libintl.h,
	src/protocol/file/cgi.c, src/protocol/http/http.c:

	Just use CONFIG_NLS instead of USE_NLS and ENABLE_NLS. Simplify
	Makefile so the 'all' target depends directly on CATALOGS which are
	only defined to something when NLS is enabled.  

Wed Jan  5 13:56:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, config/m4/os2.m4:

	Only check OS/2 stuff if CONFIG_OS2=yes.  

Wed Jan  5 12:37:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Wed Jan  5 11:00:06 2005  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Display leds info dialogp when leds (at bottom right of screen) are
	clicked. Cleanup send_mouse_event() a bit.  

Wed Jan  5 10:09:06 2005  Laurent Monin <zas@norz.org>:

	* src/bookmarks/bookmarks.c:

	Drop trailing spaces.  

Wed Jan  5 10:07:02 2005  Laurent Monin <zas@norz.org>:

	* configure.in:

	Display [=DIR] instead of =DIR since specifying directory is
	optionnal for --with-gnutls and --with-openssl. Configure help
	output looks better.  

Wed Jan  5 09:54:57 2005  Laurent Monin <zas@norz.org>:

	* configure.in:

	LEDs are now enabled by default, so let configure script display
	--disable-leds instead of --enable-leds.  

Wed Jan  5 09:48:34 2005  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	Fix compilation when --disable-leds is used.  

Wed Jan  5 09:42:37 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Jan  5 05:08:25 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/user.css:

	Add an example user style-sheet.  

Wed Jan  5 04:32:58 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	In delete_bookmark, delete the bookmark from the hash table before
	triggering the bookmark-delete event.  

Wed Jan  5 03:33:55 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/leds.c:

	Minor fixes in the 'LED indicators' help text.  

Wed Jan  5 03:02:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/apply.h, html/parser/parse.c:

	Make css_apply() functionality available as a two-step execution, so
	that applying CSS in start_element() will only require the
	assembling of an element style selector once. Patch by Miciah and
	me.  

Wed Jan  5 02:13:20 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser.c:

	In init_html_parser, swap the arguments to mirror_css_stylesheet so
	that the default stylesheet is copied to the HTML context. This
	fixes a bug where the stylesheet referenced by
	document.css.stylesheet was not used.  

Wed Jan  5 00:51:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/leds.c, bfu/leds.h, bfu/widget.h, dialogs/menu.c:

	An info dialog for LED indicators. Dunno if that ASCII art is to
	ugly and we should instead just number the LEDs. That would also
	make it possible to elaborate a bit more; mention relevant options
	and so.  

Tue Jan  4 10:08:28 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Jan  4 01:49:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/spidermonkey.c:

	The MSGBOX_FREE_TEXT flag will keep the text from being gettexted
	here, right zas? 

Mon Jan  3 23:43:26 2005  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update. Safe head-start to hu and de.  

Mon Jan  3 23:29:47 2005  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	O\ne0, Jonas :-). Fixed UTF-8 I/O.  

Mon Jan  3 23:10:24 2005  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Typo fix.  

Mon Jan  3 22:41:00 2005  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po, sk.po,
	sv.po, tr.po, uk.po:

	.po files were resynced.  

Mon Jan  3 22:23:26 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jan  3 22:16:32 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Danish translation zeroed.  

Mon Jan  3 21:51:40 2005  Petr Baudis <pasky@ucw.cz>:

	* doc/: bookmarks.txt, color-model.txt, marks.txt:

	Play a writing style carrion crawler.  

Mon Jan  3 21:51:07 2005  Petr Baudis <pasky@ucw.cz>:

	* doc/hacking.txt:

	Too many blank lines hurt.  

Mon Jan  3 21:50:05 2005  Petr Baudis <pasky@ucw.cz>:

	* doc/hacking.txt:

	We code in C89.  

Mon Jan  3 21:22:34 2005  Petr Baudis <pasky@ucw.cz>:

	* src/README:

	Id est exempli gratia.  

Mon Jan  3 21:16:31 2005  Petr Baudis <pasky@ucw.cz>:

	* src/README:

	Rewritten, updated, elaborated. Attention has been paid to
	explaining what is dialogs/ good for, what viewer/ really is and
	their interactions with bfu/, so that those evil and dangerous
	plagues like ui/ or <core>/dialogs.c are hopefully prevented and
	avoided. ;-) 

Mon Jan  3 21:08:36 2005  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/edit.c:

	TODO: Move to bfu/.  

Mon Jan  3 21:03:43 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/tabs.txt:

	Rewrite the first paragraph in the section on saving and restoring
	tabs.  

Mon Jan  3 20:48:51 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/hacking.txt:

	Add some whitespace to the example for commenting a structure to
	match current practice and encourage readability.  

Mon Jan  3 20:47:25 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/hacking.txt:

	Warn against using C++'s //-style comments.  

Mon Jan  3 20:45:49 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/introduction.txt:

	Refer to listbox items as items, not boxes.  

Mon Jan  3 20:38:29 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/introduction.txt:

	Change 'The hierarchic boxes' to 'Each hierarchic box'.  

Mon Jan  3 20:34:19 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/introduction.txt:

	Mention the Home and End keys in the list of listbox keybindings.  

Mon Jan  3 17:58:33 2005  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/protocol/rewrite/rewrite.c:

	In src/protocol/rewrite/rewrite.c (87 line) there is a string
	(starting with "Replacement URI for this smartprefix") that contains
	'%'. It looks like it lacks 
	        /* xgettextize:no-c-format */ line just before it (as is
	done 10 lines above with dumbprefix.  
	
	Patch by Adam Golebiowski.  

Mon Jan  3 16:01:46 2005  Laurent Monin <zas@norz.org>:

	* doc/introduction.txt:

	Some stuff was added about how forms are displayed.  

Mon Jan  3 16:00:55 2005  Laurent Monin <zas@norz.org>:

	* po/pl.po:

	Polish translation was updated. Patch by Adam Golebiowski.  

Mon Jan  3 15:15:04 2005  Laurent Monin <zas@norz.org>:

	* po/pl.po:

	Polish translation was updated. Patch by Adam Golebiowski.  

Mon Jan  3 14:39:52 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jan  3 14:24:17 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	8 miles left.  

Mon Jan  3 14:02:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	But this is HTML so I shouldn't care about wrapping.  

Mon Jan  3 14:00:26 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	Dammit the other thing cause weird wrapping.  

Mon Jan  3 13:58:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	Trim down more of pasky's ramblings. It could probably be trimmed
	down even further.  

Mon Jan  3 13:40:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Clarifications. Missed this one.  

Mon Jan  3 13:39:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, ecmascript/spidermonkey.c,
	formhist/dialogs.c:

	Clarifications.  

Mon Jan  3 13:38:23 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/formhist/formhist.c:

	Sound a little less like uncle Danny.  

Mon Jan  3 12:26:15 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libintl.h:

	When NLS is disabled make _() a static inline'd dummy function so
	warnings about unused local @term variables are removed. Reported by
	Russ with fixing patch by Miciah.  

Mon Jan  3 08:52:36 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jan  3 08:28:51 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/mailcap.txt:

	Change the paragraph explaining why one would use mailcap when one
	has ELinks' internal MIME-handler configuration.  

Mon Jan  3 08:25:13 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/mailcap.txt:

	Change 'thou shall find' to 'thou wilt find'.  

Mon Jan  3 08:23:11 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/remote.txt:

	Rewrite the little bit about ELinks extensions.  

Mon Jan  3 08:22:55 2005  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	When looking for the --> inside of <script> (do_html_script()),
	check if we didn't go past eof. Probably fixes crash on
	intellectualconservative.com reported by Apu.  

Mon Jan  3 08:21:00 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/urlprefixes.txt:

	Mention that dumb-prefixes support '%c'.  

Mon Jan  3 08:14:01 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/feedback.txt:

	Update the maintainer E-mail address.  

Mon Jan  3 08:12:57 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/: bookmarks.txt, color-model.txt, ecmascript.txt, events.txt,
	exmode.txt, feedback.txt, hacking.txt, introduction.txt,
	mailcap.txt, marks.txt, remote.txt, small.txt, tabs.txt,
	terminal.txt, urlprefixes.txt:

	Add some articles and delete some others.  

Mon Jan  3 07:41:01 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/util/string.h:

	Let add_bytes_to_string__ know about this change.  

Mon Jan  3 07:28:48 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/util/: string.c, string.h:

	Mark the source parameter for add_to_string constant to fix a
	compilation error with SpiderMonkey.  Do the same to
	add_to_string_list for consistency.  

Mon Jan  3 07:12:20 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/: bookmarks.txt, color-model.txt, ecmascript.txt, events.txt,
	exmode.txt, feedback.txt, hacking.txt, index.txt, introduction.txt,
	mailcap.txt, marks.txt, remote.txt, small.txt, tabs.txt,
	terminal.txt, urlprefixes.txt:

	Punctuation, whitespace, and capitalisation fixes.  

Mon Jan  3 06:02:09 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/: bookmarks.txt, color-model.txt, ecmascript.txt, exmode.txt,
	hacking.txt, marks.txt, urlprefixes.txt:

	Latin fixes.  

Mon Jan  3 05:49:18 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/bookmarks.txt:

	Missed one.  

Mon Jan  3 05:47:31 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/: bookmarks.txt, color-model.txt, ecmascript.txt, exmode.txt,
	marks.txt, urlprefixes.txt:

	Mood and tense fixes.  

Mon Jan  3 05:45:48 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/man/man1/elinks.1.in:

	-dump dumps a document, not a URI.  

Mon Jan  3 04:20:08 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Small fix.  

Mon Jan  3 04:03:48 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	1358 translated messages, 29 untranslated messages.  

Mon Jan  3 04:02:38 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Remove double used 'used'.  

Mon Jan  3 03:59:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/spidermonkey.c:

	Fix i18n braindead error messaging.  

Mon Jan  3 03:40:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/: scripting.c, perl/Makefile.am, perl/core.h,
	perl/perl.h:

	Stupid perl headers define _() which causes compile errors when
	included after libintl.h, so put the perl module declaration in its
	own header file. Reported by Russ Rowan.  

Mon Jan  3 03:22:51 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/osdep.c:

	Fix building by including dummy mouse handlers when CONFIG_MOUSE=no
	and CONFIG_GPM=yes. Reported by miernik.  

Mon Jan  3 02:11:56 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Factor some code out from add_bookmark into the new init_bookmark.  

Mon Jan  3 02:05:30 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Yay only 41 left.  

Mon Jan  3 02:04:34 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Fixes for improvements by Miciah.  

Mon Jan  3 02:01:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	A few improvements.  

Mon Jan  3 01:59:57 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Use add_listbox_item in add_bookmark. Besides saving a fair amount 
	of code, this fixes redraw bug where adding a bookmark in a bookmark 
	manager box in one terminal would not update boxes in other
	terminals.  

Mon Jan  3 01:00:09 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Delete a very stale comment.  

Mon Jan  3 00:31:27 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Move hash-table maintenance from add_bookmark to
	add_bookmark_item_to_bookmarks.  

Mon Jan  3 00:30:02 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Shorten pasky's long late night ramblings about use of document
	colors.  

Mon Jan  3 00:29:54 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	In add_bookmark, delete the bookmark if unable to allocate the
	listbox item.  

Mon Jan  3 00:26:59 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Factor some code out from add_bookmark into the new
	add_bookmark_item_to_bookmarks.  

Sun Jan  2 23:45:09 2005  Petr Baudis <pasky@ucw.cz>:

	* src/util/hash.c:

	Squashed another stupid non-functional inlining (get_hash_item()
	this time) introduced by who-knows-who who-knows-when.  

Sun Jan  2 22:47:56 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Sorry for flipflopping zas ;) this extra cheese really doesn't make
	sense.  

Sun Jan  2 22:21:29 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Jan  2 19:31:50 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Hopefully last batch of updates for command line option
	descriptions.  
	
	- Use \t instead of tabs in strings. Dunno how portable that is.  
	
	- Elaborate more in the lookup description.  
	
	- Tone down Mozilla compliant'ness for -remote it is mentioned in
	  the remote.txt docs. Try to clarify the passing of method +
	parameters.  
	
	- "... used in s/connection/conjunction/ with ..." since google has 
	  2,380,000 hits for the latter while only 802,000 for the former.  

Sun Jan  2 18:32:44 2005  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/protocol/uri.h:

	If I try "links -dump www.tromsø.no" it finds the correct ACE-name 
	("www.xn--troms-zua.no"), but the virtual-server this domain is
	hosted on 
	(venus.gan.no), requires the ACE-name in the "Host:" header. Elinks
	incorrectly sets this header to www.tromsø.no.  
	
	This patch by Gisle Vanem solves the issue.  

Sun Jan  2 15:55:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	On route 66.  

Sun Jan  2 15:28:48 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Jan  2 15:23:36 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	More cookie option description modifiction commiction m33piction.  

Sun Jan  2 14:21:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Make cookies.paranoid_security self contained.  

Sun Jan  2 14:11:14 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/dialogs.c:

	Introduce add_cookie_info_to_string() which adds everything except
	the server attribute. Use it for accept dialogs to increase the
	reuse of i18n strings.  

Sun Jan  2 14:07:00 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	Normalize multi-state options.  

Sun Jan  2 12:54:24 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Another clarification by the Miciah Patch Watchers.  

Sun Jan  2 12:38:29 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/terminal.txt:

	Add hints from Miciah's reply to 'How do I enable the pretty line
	graphics and colors under gnu/screen'.  

Sun Jan  2 12:21:25 2005  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: index.txt, introduction.txt, terminal.txt:

	Split out terminal setup docs to terminal.txt like pasky requested.  

Sat Jan  1 18:11:51 2005  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Jan  1 17:38:38 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Keep the EVENT_MOUSE case even if mouse is disabled.  

Sat Jan  1 16:37:53 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, forms.c, html/renderer.c:

	Make done_form() also free the form struct.  

Sat Jan  1 16:37:09 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/table.c:

	Limit long lines.  

Sat Jan  1 14:38:52 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Reformat comments.  

Sat Jan  1 13:54:31 2005  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Only handle clicks outside the input line (introduced in 1.189 ->
	1.190) if CONFIG_MOUSE.  

Sat Jan  1 13:15:27 2005  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/info.c:

	'appy naw yer *hick* 

Sat Jan  1 05:44:02 2005  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.c:

	In update_options_visibility, use get_opt_bool instead of
	get_opt_rec.  

Fri Dec 31 12:29:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/osdep.c:

	Fix bug introduced in (1.98->1.99) when OS/2 code was split out and
	yet again allow OS shell to be opened under the xwin environment.  

Fri Dec 31 12:26:41 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Dec 31 12:06:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Fri Dec 31 11:44:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: file/file.c, ftp/ftp.c:

	Some fixes for protocol related option descriptions.  

Fri Dec 31 11:22:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/backend/: mailcap.c, mimetypes.c:

	Some fixes for MIME-related option descriptions.  

Fri Dec 31 09:24:22 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Dec 31 09:17:06 2004  Laurent Monin <zas@norz.org>:

	* src/: dialogs/options.c, protocol/http/http.c:

	Compilation fixes.  

Fri Dec 31 03:11:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Fri Dec 31 02:43:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Fri Dec 31 02:40:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/select.c:

	In the name of not so many freaking i18n strings use format string
	introduced in last patch.  

Fri Dec 31 02:37:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/interlink.c:

	Make generic i18n string for reporting interlinking failures.  

Fri Dec 31 02:30:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/ecmascript.c:

	Abbreviations in captions are ugly.  

Fri Dec 31 01:39:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, protocol/http/http.c, protocol/http/http.h:

	done_http(): Cleanup also proxy auth and blacklist.  

Fri Dec 31 00:44:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libintl.h:

	Fix bug where _() was not defined as a noop when NLS was disabled.
	Reported by Russ Rowan after the recent patch for not overpopulating
	@current_charset by Kalle Olavi Niemitalo.  

Fri Dec 31 00:36:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/gettext.m4:

	EL_ARG_ENABLE() usage requires the preset value to be set.  

Fri Dec 31 00:11:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/gettext.m4:

	Make NLS configuration value show up in features.log 

Thu Dec 30 23:50:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/options.c, dialogs/info.c, dialogs/status.c,
	document/renderer.c, document/html/renderer.c,
	protocol/file/file.c, protocol/ftp/ftp.c, protocol/http/http.c,
	sched/connection.c, sched/download.c, scripting/lua/core.c,
	viewer/dump/dump.c:

	Alphabetize #includes.  

Thu Dec 30 23:42:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	dialogs/options.c, dialogs/options.h, sched/action.c:

	Make it possible to open resize terminal dialog using keybindings.
	Cleanup and rename dialog function to resize_terminal_dialog().  

Thu Dec 30 21:58:33 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Dec 30 20:40:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Thu Dec 30 20:39:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Minor fix.  

Thu Dec 30 20:28:31 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Revert patch 1.179->1.180, it breaks focus on bugzilla query form.  

Thu Dec 30 20:28:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Normalize multi-state option descriptions and make one more generic.  

Thu Dec 30 20:09:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	The search 'show not found' option is no long typeahead only. Rewrap
	a long option text.  

Thu Dec 30 13:57:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/introduction.txt:

	14:52 < Neuromancer_> s/does not use/uses/.  

Thu Dec 30 12:57:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/introduction.txt:

	Write about configuration of terminals so I can RTFM cga, who just
	asked on elinks-users.  

Thu Dec 30 11:35:00 2004  Laurent Monin <zas@norz.org>:

	* src/document/css/stylesheet.c:

	Reduce code redundancy, introducing add_selector_property().  

Thu Dec 30 10:36:00 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated: minor fix.  

Thu Dec 30 10:33:44 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated: typo fix.  

Thu Dec 30 10:31:36 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Dec 30 04:04:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Unfuzz a translation.  

Thu Dec 30 04:00:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Normalize tristate option description.  

Thu Dec 30 03:55:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Thu Dec 30 01:33:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Fix PO-Revision-Data header.  

Thu Dec 30 00:04:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Wed Dec 29 23:28:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Wed Dec 29 22:58:25 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Dec 29 22:52:11 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Dec 29 22:42:30 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Dec 29 22:38:27 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Dec 29 22:35:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, dialogs/options.c:

	More or less sync terminal option captions and text used in the
	terminal dialog.  

Wed Dec 29 22:30:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/modules/version.c:

	Always put build info in the full static version. We compile it in
	anyway.  

Wed Dec 29 22:29:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Do not print feature summary when printing --help.  

Wed Dec 29 22:07:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Review command line option captions and descriptions.  

Wed Dec 29 21:30:47 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	Fix potential bug: memset() the size of the struct not the size of
	the pointer.  

Wed Dec 29 20:32:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	Use copy_struct().  

Wed Dec 29 19:58:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Remove all fuzziness and start on untranslated strings.  

Wed Dec 29 19:54:02 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Dec 29 19:37:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	-dump works for multiple URLs.  

Wed Dec 29 19:25:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Improve i18n in favour of a bit more complicated
	code.  

Wed Dec 29 18:34:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Unify 'could not create file' dialog text.  

Wed Dec 29 18:29:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/user.c:

	s/User/\1 protocols/ as module name.  

Wed Dec 29 18:23:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/nntp/codes.c:

	s/Ok/OK/ which is what we use for other OK buttons.  

Wed Dec 29 18:14:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, protocol/file/file.c:

	Purge DISABLED variations of options. It makes no sense to increase
	the size of the binary unnecessarily.  

Wed Dec 29 17:24:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/formhist/formhist.c:

	s/Forms History/Form History/ 

Wed Dec 29 17:00:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/: Makefile.in, README:

	Make both PO=<lang> and PO=<lang>.po possible. Update README to
	reflect that. Also remove the newly added TIP that is already
	mentioned below and note to maintainer.  

Wed Dec 29 16:49:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/formhist/formhist.c:

	s/forms {history,memory}/form history/.  

Wed Dec 29 16:35:05 2004  Laurent Monin <zas@norz.org>:

	* po/README:

	Update README and mention make update-po PO=<lang>.po.  

Wed Dec 29 16:17:32 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Dec 29 15:59:29 2004  Laurent Monin <zas@norz.org>:

	* src/document/css/parser.c:

	Use copy_struct().  

Wed Dec 29 15:46:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/document.c:

	s/Artificial/Internal/ probably is easier to understand.  

Wed Dec 29 15:43:30 2004  Laurent Monin <zas@norz.org>:

	* src/document/: css/apply.c, html/internal.h, html/parser.c,
	html/parser.h, html/renderer.c, html/tables.c, html/parser/forms.c,
	html/parser/link.c, html/parser/parse.c:

	Rename struct text_attrib_beginning to struct text_attrib_style and
	use it in struct text_attrib. It helps to clean things a bit. Note
	that format.(fg|bg|attr) becomes format.style.(fg|bg|attr).  

Wed Dec 29 15:13:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/Makefile.in:

	Make it possible to update only one .po file by running 'make
	update-po PO=<lang>.po'.  

Wed Dec 29 15:09:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/generic.h:

	Wrap copy_struct() macro body in do { /* ... */ } while(0). Improve
	comment.  

Wed Dec 29 15:04:21 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/task.c, terminal/event.c, terminal/kbd.c, util/box.h,
	viewer/text/view.c, viewer/text/vs.c:

	Use copy_struct().  

Wed Dec 29 14:59:34 2004  Laurent Monin <zas@norz.org>:

	* src/: document/options.c, document/html/frames.c,
	document/html/renderer.c, document/sgml/parser.c,
	lowlevel/connect.c:

	Use copy_struct().  

Wed Dec 29 14:51:49 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/hierbox.c, bfu/menu.c, config/dialogs.c,
	document/html/parser/stack.c:

	Use copy_struct().  

Wed Dec 29 14:48:06 2004  Laurent Monin <zas@norz.org>:

	* src/osdep/generic.h:

	Make copy_struct() definition cleaner.  

Wed Dec 29 14:41:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: intl/gettext/dcigettext.c, osdep/generic.h:

	Also move alignof() to the compiler area.  

Wed Dec 29 14:39:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/listbox.c, document/css/stylesheet.c, osdep/generic.h:

	Introduce copy_struct() macro wrapping '*a = *b' style copying. Use
	relevant places.  

Wed Dec 29 14:25:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	Oops, last part of previous patch.  

Wed Dec 29 14:25:44 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/listbox.c:

	Use = instead of memcpy(). Safer and more efficient, idea by Pasky.  

Wed Dec 29 14:24:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/: Makefile.am, math.c, math.h:

	Simplify generic swap_value() to be a macro. It might fix a problem
	on MacOS X reported by Phillip Pi and I never did like the previous
	cast-abusing implementation.  

Tue Dec 28 23:04:47 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	document.browse.accesskey.auto_follow is a boolean option.  

Tue Dec 28 16:57:41 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Dec 28 16:53:09 2004  Laurent Monin <zas@norz.org>:

	* src/osdep/osdep.c:

	resize_window(): use double while calculating new width and heigth
	to increase precision, it prevents that multiple resize terminal
	without changing original values to resize the terminal to a smaller
	size. Not totally perfect since we calculate terminal size in
	characters and window size in pixels.  

Tue Dec 28 13:24:13 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/options.c:

	x,y -> width,height. Use ulongcat() instead of sprintf(), and add
	labels to input fields.  

Tue Dec 28 13:10:10 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/group.c:

	group_layouter(): set minimal width of dialog to at least the length
	of title.  

Tue Dec 28 12:26:30 2004  Laurent Monin <zas@norz.org>:

	* README:

	Update README, please improve. ELinks is now more that an
	experimental Links imho.  

Tue Dec 28 10:03:20 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Dec 28 07:02:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update translation. Many fixes pointed out by Miciah.  

Tue Dec 28 01:43:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Some more updates mostly deleting the fuzziness in the end.  

Tue Dec 28 01:30:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Inspired by Zas' translations, these command line option
	descriptions needed improvements.  

Tue Dec 28 00:07:33 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Dec 27 23:39:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/da.po:

	Update Danish translation.  

Mon Dec 27 23:13:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/dialogs.c:

	Fix internationalized strings.  

Mon Dec 27 21:59:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/leds.c:

	Ditch #else part of '#if 1'. Slowly this is becoming the norm.  

Mon Dec 27 19:35:24 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Revert last patch it breaks tests from test/ecmascript/ontest.html.
	Why? 

Mon Dec 27 19:23:41 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	window_get_property(): call undef_to_jsval().  

Mon Dec 27 13:42:14 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	document_get_property(): call undef_to_jsval(ctx, vp).  

Mon Dec 27 13:39:32 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	forms_namedItem(): call undef_to_jsval() before loop.  

Mon Dec 27 13:20:32 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	forms_item(): call undef_to_jsval() before loop.  

Mon Dec 27 10:51:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/: libintl.c, libintl.h:

	el_gettext_current_charset -> current_charset and move to after the
	#includes. Should make pasky happy.  

Mon Dec 27 10:49:27 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Drop last bits of struct jsval_property stuff: set_prop_*(),
	value_to_jsval() and related stuff are now totally replace by
	*_to_jsval().  

Mon Dec 27 10:41:36 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	document_write(), location_get_property(): use *_to_jsval().
	set_prop_astring() is no more used.  

Mon Dec 27 10:38:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/osdep.c:

	resize_window(): Miciah was right. Fix
	Copy-and-paste-and-mindlessly-hack-upon error when HAVE_X11 is not
	defined.  

Mon Dec 27 10:37:16 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	document_get_property(): use *_to_jsval(). set_prop_object() is not
	needed anymore.  

Mon Dec 27 10:34:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/screen.c:

	get_screen_driver(): Still use memcmp() but fix the bug by comparing
	'len + 1' bytes. Idea by Miciah.  

Mon Dec 27 10:31:37 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	forms_item(), forms_namedItem(), forms_get_property(): use
	*_to_jsval(). set_prop_int() is not needed anymore.  

Mon Dec 27 10:26:43 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	form_(reset|submit)(): use boolean_to_jsval().  

Mon Dec 27 10:24:22 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	form_get_property(): use *_to_jsval().  

Mon Dec 27 10:02:50 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	window_get_property(): undef before switch() and simplify code.  

Mon Dec 27 01:25:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	free_uri_list(): Just in case, zero the uri_list->size.  

Mon Dec 27 01:16:03 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Use *_to_jsval() in form_elements_namedItem().  

Mon Dec 27 01:14:18 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Use *_to_jsval() in form_elements_item().  

Mon Dec 27 01:11:45 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Use *_to_jsval() in form_elements_get_property().  

Mon Dec 27 01:09:28 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Use boolean_to_jsval() in input_focus().  

Mon Dec 27 01:07:36 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Use boolean_to_jsval() in input_click().  

Mon Dec 27 01:05:56 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Introduce (string|int)_to_jsval() and use *_js_val() in
	input_get_property().  

Mon Dec 27 00:51:57 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Use (boolean|undef)_to_jsval() in window_open().  

Mon Dec 27 00:48:36 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Use undef_to_jsval() in window_alert().  

Mon Dec 27 00:46:03 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Introduce (object|boolean|undef)_to_jsval(), it will help to get rid
	of struct jsval_property. The main goal is to drop stuff related to
	struct jsval_property: set_prop_*(), value_to_jsval(),
	*_prop_magic(), and every struct jsval_property *prop among the
	code.  

Mon Dec 27 00:02:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/screen.c:

	Fix terminal driver comparison triggered when comparing 'xterm'
	against 'xterm-color'. This would cause no driver to be initialized
	and more important the term->spec->change_hook to be NULL.  

Sun Dec 26 23:44:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/options.c:

	Hurrah for snprintf(). Terminal resizing should be a lot safer now.  

Sun Dec 26 23:36:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/options.c, osdep/osdep.c, osdep/osdep.h,
	osdep/os2/os2.c, terminal/kbd.c:

	Make this useless terminal resizing available for the X terminal
	environment.  The old terminal width and height needs to be send
	along too in order to scale using the right font size.  

Sun Dec 26 20:26:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libintl.c:

	Remove extern keywords causing warnings.  

Sun Dec 26 20:14:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/intl/gettext/libintl.c, src/intl/gettext/libintl.h:

	This patch fixes a bug where the static current_charset variable of
	the static function _() was duplicated in every translation unit
	that called it, resulting in unnecessary or possibly skipped calls
	to bind_textdomain_codeset.  
	
	I also renamed the variable, in order to avoid clashes; but perhaps
	that was too paranoid: libintl.c already defines current_language,
	which is just as likely to clash.  
	
	Patch by Kalle Olavi Niemitalo.  

Sun Dec 26 19:56:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/fi.po:

	More translation updates by Kalle Olavi Niemitalo.  

Sun Dec 26 19:11:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS:

	Hmm, thought I commited this. Kalle Olavi Niemitalo updates the
	Finnish translation.  

Sun Dec 26 18:58:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/backend/default.c, protocol/rewrite/rewrite.c:

	Mark gettexted strings containing internal c-format fragments with
	/* xgettext:no-c-format */. Fix by Kalle Olavi Niemitalo.  

Sat Dec 25 23:39:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/introduction.txt:

	Elaborate a bit about the Title, Tab and Status bar.  

Sat Dec 25 20:42:45 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/msgbox.c, bfu/msgbox.h, ecmascript/spidermonkey.c,
	sched/session.c, scripting/lua/core.c:

	Rename MSGBOX_INTL_TITLE_ONLY to more appropriate
	MSGBOX_NO_TEXT_INTL, and use it instead of MSGBOX_NO_INTL to
	simplify code.  

Sat Dec 25 19:05:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/introduction.txt:

	Write about navigation.  

Sat Dec 25 17:51:13 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Space fix.  

Sat Dec 25 17:36:41 2004  Laurent Monin <zas@norz.org>:

	* test/ecmascript/ontest.html:

	Improve a bit.  

Sat Dec 25 17:28:30 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Fix stupid error introduced in last patch.  

Sat Dec 25 15:25:37 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	jsval_to_string() always return a string (even empty) but never
	NULL. It simplifies things a bit more.  

Sat Dec 25 15:15:09 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	It makes for sense for jsval_to_boolean() to return an int.  

Sat Dec 25 15:11:27 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Modify jsval_to_string() to return an unsigned char *, and simplify
	code a lot.  

Sat Dec 25 14:51:12 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Let jsval_to_boolean() return a JSBool and simplify code.  

Sat Dec 25 14:40:14 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Introduce some wrappers for jsval_to_value(): jsval_to_string(),
	jsval_to_boolean(), jsval_to_number().  

Sat Dec 25 14:29:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/introduction.txt:

	Write about managers.  

Sat Dec 25 14:19:21 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/msgbox.c, bfu/msgbox.h, ecmascript/spidermonkey.c:

	Add a new flag for msg_box() to indicate i18n of title only. It
	helps to fix an i18n issue with window_alert().  

Sat Dec 25 14:00:00 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Add some sanity checks macros for struct jsval_property.  

Sat Dec 25 13:19:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/fi.po:

	I have been using ELinks from CVS and fixing up its fi.po every now
	and then.  Here are the changes I have made so far.  Not all menu
	items currently have hot keys (~).  That will have to be corrected
	later.  
	
	Update by Kalle Olavi Niemitalo.  

Fri Dec 24 23:28:13 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	window_get_property(): tidy up.  

Fri Dec 24 23:24:42 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	input_get_property(): test |id| before anything else, and simplify
	code.  

Fri Dec 24 23:21:04 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Test |id| before anything else.  

Fri Dec 24 23:19:05 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Minor tidy up.  

Fri Dec 24 23:13:02 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Drop goto/label |convert|.  

Fri Dec 24 17:20:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.11.CVS 

Fri Dec 24 17:01:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10.0 

Fri Dec 24 16:58:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po, sk.po,
	sv.po, tr.po, uk.po:

	Update .po files 

Fri Dec 24 14:55:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Moved draw_table_bad_html() before rendering the table itself. This
	makes the tables with out-of-order bad html appear normal again
	(mostly it's at the start of the table and it's drawn so now) and
	fixes the issue with broken forms on some pages (<table><form><tr>).
	OTOH it reopens bug 432 (<caption> handling), which is less grave
	than this, though. It's not like I do it this way just because we
	are a little in hurry now - I have no clue how to fix up this all
	without rewriting the whole table processing to be non-perverse and
	in-order with the rest of the HTML parsing. This commit should
	unblock 0.10.0 release.  

Fri Dec 24 14:09:11 2004  Petr Baudis <pasky@ucw.cz>:

	* features.conf:

	CONFIG_LEDS by default on now. Minimal overhead, useful stuff.  

Fri Dec 24 14:07:32 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS, contrib/perl/hooks.pl:

	Some meaningful Perl hooks by Apu aka Russ Rowan <rrowan@dandy.net>.  

Fri Dec 24 13:59:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	Reverted Miciah's 1.515 adding a link's numeric prefix as normal
	link text. It induces some link offsets weirdness requiring complex
	(and quite horribly-seeming) fixes all over the map and so.
	Hopefully, you will meet with it in 0.10.1.  

Fri Dec 24 13:54:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/README:

	LXR is not keen on README headlines in README files. README -> Guide 

Fri Dec 24 02:41:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libintl.c, configure.in, po/leet.po:

	Remove unmaintained leet translation. Requested by zas.  

Fri Dec 24 02:37:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	Fix bad usage of _() in ERROR() messages. Instead use gettext().
	This and last patch by Gisle Vanem.  

Fri Dec 24 02:34:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.h, terminal/color.c:

	Workaround namespace clashes with Windows headers.  

Fri Dec 24 02:33:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/util/lists.h:

	Remove ending ';' for debug version of LIST_HEAD() that caused a
	parse error in MSVC. Patch by Gisle Vanem.  

Thu Dec 23 21:50:50 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Get rid of these awful macros and drop all these gotos: code is now
	cleaner imho.  

Thu Dec 23 02:45:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10rc3.CVS 

Thu Dec 23 02:26:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10rc3 

Thu Dec 23 02:25:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	Sync .po files.  

Thu Dec 23 02:23:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Thu Dec 23 02:21:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/introduction.txt:

	A few ideas added.  

Wed Dec 22 23:04:23 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Many minor fixes.  

Wed Dec 22 21:37:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	This is kind of a history file, so adding the codenames for branches
	seem appropriate.  

Wed Dec 22 21:29:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/README:

	Some ecmascript is done. ELusive is and will be supplied by
	document/.  

Wed Dec 22 20:36:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/introduction.txt:

	Add a hints section where command prefixing can be mentioned.  

Wed Dec 22 12:49:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/conf.c:

	Change an else-if after an if-block that ends in a return to an if.  

Wed Dec 22 12:47:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/conf.c:

	Delete a superfluous NULL-pointer check in parse_set.  

Wed Dec 22 04:01:13 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/http/http.c:

	Fix some indentation that was messed up by the last
	commit/reversion.  

Tue Dec 21 23:38:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: Makefile.am, index.txt:

	Advertize the introduction.  

Tue Dec 21 23:34:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/introduction.txt:

	Some general entry point for new users. Still a work in progress.
	Please add ideas for things to document after the b33p.  

Tue Dec 21 22:44:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/file/cgi.c:

	Chain local CGI scripts' stderr to ELinks' implicit stderr. Enables
	i.e. logging of mangle hexcodes and whatever else.  

Tue Dec 21 22:38:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/dcigettext.c:

	Only declare alloca() #ifndef HAVE_ALLOCA instead of #ifndef alloca.
	Fixes warning on FreeBSD.  

Tue Dec 21 21:45:22 2004  Laurent Monin <zas@norz.org>:

	* src/intl/gettext/loadmsgcat.c:

	Fix a typo introduced in last patch by Jonas.  

Tue Dec 21 21:11:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/pl.po:

	Update by Witold.  

Tue Dec 21 15:11:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/localealias.c:

	Include util/memory.h 

Tue Dec 21 15:08:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/localealias.c:

	Use fmem_(alloc|free) instead of alloca directly. Fixes warning on
	FreeBSD.  

Tue Dec 21 15:05:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/plural.c:

	Oops. Revert stupid locally generated plural.c updates.  

Tue Dec 21 15:04:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/: loadmsgcat.c, plural.c:

	Use fmem_(alloc|free) instead of alloca directly. Fixes warning on
	FreeBSD.  

Tue Dec 21 14:07:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/index.txt:

	elinks.keys -> elinkskeys 

Tue Dec 21 13:58:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/index.txt:

	Fixups.  

Tue Dec 21 13:55:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/index.txt:

	Squeeze in the man pages after the user guide.  

Tue Dec 21 13:29:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/README:

	Make README only a README.  

Tue Dec 21 13:18:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: Makefile.am, index.txt, mailcap.html, mailcap.txt:

	mailcap.html -> mailcap.txt, and update it a bit. It still needs
	heavy rewrite.  

Tue Dec 21 13:13:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man1/elinks.1.in:

	The data protocol is not a remote protocol so remove it. Requested
	by Miciah.  

Tue Dec 21 07:34:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	Factor code out from add_global_history_item to the new
	add_item_to_global_history.  

Tue Dec 21 07:30:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	Factor code out from add_global_history_item into the new
	cap_global_history.  

Tue Dec 21 07:26:17 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	Factor code out from delete_global_history_item into the new
	done_global_history_item.  

Tue Dec 21 07:24:36 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	Factor code out from delete_global_history_item into the new
	remove_item_from_global_history.  

Tue Dec 21 07:22:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	Consistently use the name history_item for parameters and local
	avariables of the type struct global_history_item.  

Tue Dec 21 01:53:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/table.c:

	Do those nice exponential table allocations (bug 571 of Jonas) only
	up to 256kb and then go on only in steps of 256kb in the
	reallocations - well, you get the idea. This commit is officially
	dedicated to Ms. Thelma, future master coder of ELinks, currently
	entering the apprentice status. Let's hope it doesn't contain much
	bugs (the commit, not our new apprentice).  

Mon Dec 20 23:52:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	When settings the colors for active link, invert the colors (if
	applicable) even if custom colors were specified. Hopefully fixes
	bug 586 as reported by Apu.  

Mon Dec 20 23:51:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/: Makefile.am, math.c, math.h:

	Introduced swap_values() macro, which does exactly that.  

Mon Dec 20 21:21:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Bahh. Dumb dump.  

Mon Dec 20 21:19:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Revert (1.384 -> 1.385). lindi- reported that setting the user agent
	string to something involving "Mozilla/X.0" makes the server return
	a different page that is correctly renderered.  

Mon Dec 20 20:38:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	The -dump cmdline option is boolean. Reported by lindi-.  

Mon Dec 20 20:24:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	The SSL and gzip combination is a killer for big documents, you just
	always get a load of garbage. It is triggerable at 
	https://www.christianbook.com/Christian/Books/place_order and filed 
	as bug 592 and bug 524. For now work around the problem by never
	accepting gzip for HTTPS connections.  

Mon Dec 20 13:40:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Change an assertion to a normal bounds-check to prevent an assertion 
	failure with _^H_.  

Mon Dec 20 13:13:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Oops. s/default_clink/default_link/ 

Mon Dec 20 12:12:39 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/document.h:

	Document the struct color_pair color member of struct link.  

Mon Dec 20 12:06:28 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Altho it makes absolutely no difference, initialise the link's 
	foreground colour to the normal link colour instead of the vlink
	colour in add_document_link.  

Mon Dec 20 12:03:06 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In print_document_link, drop the local variable color and use 
	link->color instead, giving the link the proper colours as a
	side-effect. (The correct colours were being put on the canvas, the
	link structure just did not reflect this.) 

Mon Dec 20 11:59:19 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In print_document_link, save the link returned by check_link_word.  

Mon Dec 20 11:56:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Minor simplification.  

Mon Dec 20 11:56:04 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Fix a major typo in the last commit.  

Mon Dec 20 11:55:21 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Change check_link_word to return the link returned by
	add_document_link or NULL instead of an integer.  

Mon Dec 20 11:50:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Simplify check_link_word by re-arranging some checks.  

Mon Dec 20 11:48:12 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Return 0 from check_link_word if add_document_link fails.  

Mon Dec 20 11:41:22 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Use doc_opts->default_(v|bookmark_|)link instead of get_opt in
	print_document_link.  

Mon Dec 20 11:22:11 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/: options.c, options.h, html/parser.c,
	html/parser.h, html/parser/link.c:

	Add color_t default_image_link to struct document_options and
	color_t image_link to struct text_attrib and use them instead of
	calling get_opt in the middle of the HTML parser.  

Mon Dec 20 11:07:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/: options.c, options.h, dom/renderer.c,
	html/parser.c, html/parser.h, html/parser/link.c:

	Add color_t default_bookmark_link to struct document_options and
	color_t bookmark_link to struct text_attribute and use them instead
	of calling get_opt in the different document parsers.  

Mon Dec 20 08:49:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/renderer.c:

	Add a link's numeric prefix as normal link text. Now, a given link's 
	prefix is included in its points.  
	
	This involves changing put_link_number not to hide from put_chars 
	the fact that it is currently adding a link and changing put_chars 
	not to fall into infinite recursion with it calling put_link_number 
	and put_link_number calling put_chars.  
	
	User-visible effects: 
	
	 - Clicking a link's prefix will now select the link.  
	 - Selecting a link will now highlight its prefix.  

Mon Dec 20 00:29:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Compilation fixes for FreeBSD related to is_ip_address().  

Mon Dec 20 00:08:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/html/html.c:

	Remove unused variable.  

Sun Dec 19 23:38:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10rc2.CVS 

Sun Dec 19 23:23:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10rc2 

Sun Dec 19 23:21:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/: cs.po, da.po, de.po, el.po, es.po, et.po, fi.po, fr.po,
	gl.po, hr.po, hu.po, id.po, is.po, it.po, leet.po, lt.po, nl.po,
	no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po, sk.po, sv.po, tr.po,
	uk.po:

	Sync .po files.  

Sun Dec 19 23:16:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/: be.po, bg.po, ca.po:

	Sync .po files.  

Sun Dec 19 22:32:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	If ECMAScript, auto-linkify pair elements which have the onClick
	property.  

Sun Dec 19 19:28:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Plug another security hole. Let the script look only at frames whose
	security context (that is, hostname) is same as his.  

Sun Dec 19 18:04:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, document/renderer.c,
	document/css/css.c, sched/session.c:

	Introduce follow_cached_redirects() and get_redirected_cache_entry()
	which based on Miciahs MAX_REDIRECT restricted cache redirect
	looping will chase the list of cache entries to find the resulting
	one.  
	
	Replace potentially bad while (cache->redirect) loops to use 
	get_redirected_cache_entry() and make check_incomplete_redirects()
	use follow_cached_redirects() as a backend.  

Sun Dec 19 17:46:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	My explanation of bug 533.  

Sun Dec 19 17:15:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Sun Dec 19 17:09:56 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Dec 19 17:02:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Zas' fix for bug 558 is correct.  

Sun Dec 19 17:01:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man1/elinks.1.in:

	Some hopefully finishing touches of this years elinks(1).  

Sun Dec 19 16:53:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Serve navigator.language only if ENABLE_NLS. Spotted by Apu.  

Sun Dec 19 16:47:25 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.h:

	Kill trailing whitespaces.  

Sun Dec 19 16:43:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Fixed document.cookie accessing leak.  

Sun Dec 19 16:42:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man1/elinks.1.in, src/config/cmdline.c:

	Fix description of -no-home.  

Sun Dec 19 16:23:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: renderer.c, tables.c, parser/stack.c:

	Fix bug 578 (invalid accesses of html_context.part in
	kill_html_stack_item(), as reported by Apu Nahasapeemapetilon's
	Valgrind). We must make sure that before done_html_parser*()
	html_context.part is still alive and correct.  

Sun Dec 19 16:15:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	Fixed showing of checkbox/radio value in get_form_info().  

Sun Dec 19 16:06:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man1/elinks.1.in:

	I never did like that :// entangling. Elaborate more freely about
	supported protocol and mention even the new ones.  

Sun Dec 19 16:06:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	It's nice not to let any malicious webmaster retrieve any file from
	client's machine readable by the user. Fixed this tiny security
	issue by not letting ECMAScript change file inputs' input.value.  

Sun Dec 19 16:05:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Let input.checked value be touched only when input is checkbox or
	radio. When changing input.value, set fs->state only if it's text,
	password or file.  

Sun Dec 19 16:03:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	Another fierce attempt to destabilize. Even checkboxes, radios,
	submits, images, resets, buttons and hiddens have allocated value
	now. That enables ECMAScript to meaningfully change it.  

Sun Dec 19 15:55:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man1/elinks.1.in:

	Add new options since 23th Dec 2003 ;) and improve the highlighting.  

Sun Dec 19 15:54:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Alphabetize cmdline options. Improve the description of -no-home.  

Sun Dec 19 15:54:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Surprisingly, some people don't compile ECMAScript in.  

Sun Dec 19 14:56:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Fixed current_link_evhook() to always return a value.  

Sun Dec 19 14:50:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	When setting input.value, set fs->state to its length instead of
	tinkering with vpos and vypos, which will be (hopefully) adjusted
	automagically.  

Sun Dec 19 14:49:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: ecmascript/ecmascript.c, ecmascript/ecmascript.h,
	ecmascript/spidermonkey.c, ecmascript/spidermonkey.h,
	viewer/text/link.c:

	Introduced ecmascript_eval_boolback(), used for event handlers and
	handled for onClick event evaluation.  

Sun Dec 19 14:37:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/error.c:

	S_NO_JAVASCRIPT -> JavaScript support is not enabled.  

Sun Dec 19 14:31:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Zero vpos and vypos when changing input value.  

Sun Dec 19 14:24:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	mem_free_set() takes an address of the first pointer. Right.  

Sun Dec 19 14:13:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: ecmascript/spidermonkey.c, protocol/http/http.c:

	Only set navigator.language if protocol.http.accept_ui_language.  

Sun Dec 19 13:59:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Fixed user-agent string leaking.  

Sun Dec 19 13:53:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	That diabolic thing's full name is Microsoft Internet Explorer.  

Sun Dec 19 13:53:02 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Fixed few other tiny mistakes. Did I really make the last compile
	test so long ago? 

Sun Dec 19 13:50:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Killed another unused variable.  

Sun Dec 19 13:50:10 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	Check explicitly for $no_x value not being yes. I feel better that
	way. Inspired by ugenn.  

Sun Dec 19 13:49:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Woohoo. Newlines.  

Sun Dec 19 13:47:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Basic implementation of the navigator object.  

Sun Dec 19 13:10:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	input.value is string, not boolean.  

Sun Dec 19 13:09:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Introduced form_elements class, which contains form.elements. Very
	similar to document.forms. Perhaps we could do with some generic way
	to handle these collections, we'll need more soon.  

Sun Dec 19 12:32:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, protocol/protocol.c:

	Guard you grill, because the last protocol options is hereby placed
	in protocol land.  

Sun Dec 19 12:25:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, protocol/protocol.c, protocol/user.c,
	protocol/user.h:

	Modularaize the User protocol thingy and move options to the new
	module.  

Sun Dec 19 12:17:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Implemented form.length.  

Sun Dec 19 12:17:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: file/file.c, http/http.c:

	Make HTTP and File option info static.  

Sun Dec 19 12:08:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, protocol/file/file.c:

	Move file options to the file module.  

Sun Dec 19 12:04:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, file/file.c, file/file.h:

	Modularize the file protocol.  

Sun Dec 19 11:42:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Fold forms.<moo> resolving code to forms_namedItem() call.  

Sun Dec 19 11:32:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Oops, remove forgottten debug print.  

Sun Dec 19 11:31:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	DARN. Implement value_to_jsval() for JSPT_INT. I was debugging this
	for half an hour and it just isn't getting converted! 

Sun Dec 19 11:27:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	input.max_length -> input.maxLength 

Sun Dec 19 11:26:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Bah. Define properties of objects form and forms.  

Sun Dec 19 11:26:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Support for document.forms[0], making forms to behave like a real
	array.  

Sun Dec 19 11:19:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/vs.c:

	gcc needs an AI 

Sun Dec 19 11:18:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/vs.c:

	Handle srcfs->form_view being NULL in copy_vs() properly. Fixed
	crashes i.e. on marks.  

Sun Dec 19 11:17:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/vs.c:

	Simpliy 

Sun Dec 19 10:41:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.c:

	Killed evil inlines.  

Sun Dec 19 10:38:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.h:

	Predeclare squeezastring() as static.  

Sun Dec 19 10:05:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Make @accept_charset regular normally allocated pointer. Fixed case
	of failed allocation.  

Sun Dec 19 10:04:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.h:

	Introduced squeezastring() which does memacpy(string->source,
	string->length).  

Sun Dec 19 04:46:21 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/http/http.c:

	Use memcpy instead of strcpy in init_accept_charset as we already 
	have the length of the source string.  

Sun Dec 19 02:51:22 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/http/http.c:

	Remove a stale comment that accept_charset is not freed until
	exit().  

Sun Dec 19 02:49:29 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/http/http.c:

	Reduce indentation in init_accept_charset.  

Sun Dec 19 02:46:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/http/http.c:

	Add a module de-initialisation hook that frees accept_charset.  
	
	This should make Valgrind happy--no longer do we 'leak' that one
	string.  

Sun Dec 19 02:38:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/http/http.c:

	Factor the initialisation of accept_char out from http_send_header 
	into the new init_accept_charset.  

Sun Dec 19 02:32:01 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/http/http.c:

	Move static unsigned char *accept_char from http_send_header to the
	global scope.  

Sun Dec 19 02:27:33 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/options.inc, protocol/http/http.c:

	Move HTTP option definitions to the HTTP module.  

Sun Dec 19 02:21:13 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/: protocol.c, http/http.c, http/http.h:

	Give HTTP a struct module.  

Sun Dec 19 02:08:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Remove another old MIME related compatibility alias added 2003-05-06
	in 0.5pre1.CVS.  

Sun Dec 19 02:04:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	The forms array is numbered from 0, not 1 

Sun Dec 19 01:51:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/ecmascript.c:

	In ecmascript_reset_state(), set all the cached ecmascript objects
	to NULL too. Fixes crash on Google reload.  

Sun Dec 19 01:47:17 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bookmarks/bookmarks.c, mime/backend/default.c,
	mime/backend/mimetypes.c, protocol/protocol.c,
	protocol/finger/finger.c:

	Include modules/module.h.  

Sun Dec 19 01:41:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Fixed invalid usage of get_form_object() which would make form to
	have forms as its parent, not document. Bugzilla now doesn't crash
	it and the quick search form gets autofocus.  

Sun Dec 19 01:27:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Support for document.forms.<formname>. Bugzilla now gets autofocus
	on the quick search form. It crashes along the way, but that's life.  

Sun Dec 19 01:24:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Get rid of an extremely suspicious DOUBLE_TO_JSVAL().  

Sun Dec 19 01:20:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/backend/mailcap.c:

	Remove old mailcap compatibility aliases added 2003-05-07 during
	0.5pre0.CVS. Suggested by pasky an Miciah.  

Sun Dec 19 01:15:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/forms.h, document/html/renderer.c,
	viewer/text/form.c, viewer/text/form.h, viewer/text/vs.c:

	Bind struct form and struct form_view together by form_num instead
	of direct reference. This makes it waste more time and eliminates
	some crashing possibilities.  

Sun Dec 19 01:10:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Really fixed that horrible thing which has irritated me since long
	but I never really got to do it.  

Sun Dec 19 01:01:53 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Call write_bookmarks at the end of bookmark_write_hook.  

Sun Dec 19 00:57:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/cookies/cookies.c, src/protocol/uri.c,
	src/protocol/uri.h:

	Introduce is_ip_address() that uses inet_pton() as backend.  Use it
	in is_domain_security_ok() to reject evil plots where the alias
	127.1 domain-matches 99.54.127.1. Idea from Mozilla.  

Sun Dec 19 00:51:34 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/hacking.txt:

	Few words on document vs document_view vs view_state.  

Sun Dec 19 00:17:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/forms.h, ecmascript/spidermonkey.c,
	viewer/text/form.c, viewer/text/form.h, viewer/text/vs.c,
	viewer/text/vs.h:

	Introduced struct form_view, which is document_view-specific
	equivalent for struct form. Moved ECMAScript objects to struct
	form_view and struct form_state.  

Sat Dec 18 23:05:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c, test/malicious_uris.html:

	check_malicious_uri(): Chop trailing dots before checking the TLD.
	Now the whole thing doesn't go up in flames anymore.  

Sat Dec 18 22:42:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/malicious_uris.html:

	Test cases for malicious URIs.  

Sat Dec 18 21:43:42 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.inc:

	Typo fix.  

Sat Dec 18 21:38:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/task.c:

	Minor style touches on the malicious URI warning.  

Sat Dec 18 21:37:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/task.c:

	unambiguous_uri -> malicious_uri 

Sat Dec 18 20:45:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, sched/task.c:

	Try to fix bug 382 by alerting the user about misleading and
	maliciously crafted URIs. It is optional via
	document.browse.links.warn_malicious; on by default.  

Sat Dec 18 20:36:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	input's parent is form, not input ;-) 

Sat Dec 18 20:31:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/forms.c, document/forms.h,
	ecmascript/spidermonkey.c:

	Implemented HTMLInputElement DOM object (covers few original
	JavaScript objects). Reachable through form.<inputname> only now.  

Sat Dec 18 19:53:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Just kill document.html.expand_table_columns.  

Sat Dec 18 19:46:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	s/typeahead text searching/incremental searching/ as someone
	suggested on #elinks.  

Sat Dec 18 19:22:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, sched/session.c,
	sched/task.c:

	Replace the fix for bug 559 with a more localized one, since it
	caused problems with displaying download errors, reported by zas.
	Now session_is_loading() will use a new cache_entry_is_valid()
	function to explicitly check if download->cached can be used before
	passing it to check_incomplete_redirects().  Hella ugly but I don't
	want to waste more valuable time debugging this load of crap. I
	might end up starting to rewrite it and I don't think that will be 
	´ealthy at this point.  

Sat Dec 18 19:12:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	More is_in_progress_state() usage.  

Sat Dec 18 17:47:09 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Dec 18 16:17:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.h:

	Add table->caption_height member that is calculated when calling
	get_table_heights() by new get_table_caption_height() which is a
	crude duplication of draw_table_caption(). Fixes bug 572.  

Sat Dec 18 15:54:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/forms.c:

	Some trailing space.  

Sat Dec 18 15:33:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: Makefile.am, index.txt, tabs.txt:

	Document the wonders of tabbed browsing.  

Sat Dec 18 15:13:02 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/forms.h, ecmascript/spidermonkey.c:

	Generate the form object only once per form, caching it in
	form.ecmascript_obj.  

Sat Dec 18 14:25:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	The form object has now the document object as its parent and its
	methods behave accordingly to that. Fixes unstability on Google
	News.  

Sat Dec 18 12:38:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	html_special_form_control(): Somehow by cleaning up paskys ugly code
	this fixes issues bugging at |add_to_list(part->document->forms,
	init_form())| reported by Neuromancer on #elinks.  

Sat Dec 18 10:53:03 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/document.c:

	Include util/error.h.  

Sat Dec 18 02:33:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	free_task(): Clear ses->loading, so there are no dangling pointers
	left behind. Fixes the test case in bug 559.  

Sat Dec 18 02:33:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: ecmascript/spidermonkey.c, viewer/text/form.c,
	viewer/text/form.h:

	Eliminate code duplication in SM's form_submit() and
	auto_submit_form() by introducing submit_given_form(), which takes a
	form pointer and submits that form.  

Sat Dec 18 02:22:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	html_(tag|form*) -> html_special_\1, to naming prevent conflicts
	with HTML element handlers. As suggested by Jonas.  

Sat Dec 18 02:17:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/forms.c:

	Actually free the form controls in done_form().  

Sat Dec 18 02:17:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	Cope with NULL fc->form in new_link(). It's a correct condition and
	we can just take the last encountered form in that case. Explained
	in a comment. Fixes those nice assertion failures.  

Sat Dec 18 01:48:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	Oops. Actually attach form to new form_control.  

Sat Dec 18 01:44:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/forms.c:

	Fixed has_form_submit() so that it actually works - it was returning
	always 1 since zas' viewer/text/form.c:1.41.  

Sat Dec 18 01:42:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/document.c, document/document.h, document/forms.c,
	document/forms.h, document/html/internal.h, document/html/parser.c,
	document/html/parser.h, document/html/renderer.c,
	document/html/parser/forms.c, document/html/parser/forms.h,
	ecmascript/spidermonkey.c, formhist/formhist.c,
	formhist/formhist.h, viewer/text/form.c, viewer/text/form.h,
	viewer/text/link.c:

	Introducted {struct form}, which now groups {struct form_control}s
	together based on what form they are members of and it occupies the
	document.forms list itself. Some redundant fields were removed from
	form_control, ctrl_num was blasted (it was unused now) and form_num
	was transformed to {struct form} pointer form. Usage of couple of
	functions was simplified etc.  

Sat Dec 18 00:45:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/: form.c, form.h:

	Remove now-unused form_state.ctrl_num. form_control.ctrl_num still
	survives just because it's inconvenient for me to remove it right
	now, but it will disappear soon.  

Sat Dec 18 00:43:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	fc->form_num + fc->ctrl_num == fc->position 

Sat Dec 18 00:28:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Reformat a comment.  

Sat Dec 18 00:27:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/Makefile.am, document/document.c,
	document/forms.c, document/forms.h, document/html/parser/forms.c,
	ecmascript/spidermonkey.c, formhist/dialogs.c, formhist/formhist.c,
	formhist/formhist.h, viewer/text/form.c, viewer/text/form.h,
	viewer/text/link.c, viewer/text/textarea.c, viewer/text/textarea.h:

	Moved struct form_control, has_form_submit() and done_form_control()
	generic form routines from viewer/text/form.h to document/forms.h.  

Sat Dec 18 00:18:33 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	In add_global_history_item, check whether init_global_history_item 
	returns NULL.  

Sat Dec 18 00:11:06 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* test/: Makefile.am, backspaces.txt:

	New test-case for backspaces and ASCII mark-up.  

Sat Dec 18 00:06:32 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	Whoops, that is _struct_ global_history_item.  

Sat Dec 18 00:04:02 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	Factor the actually allocation and initialisation of the new history
	item out to the new init_global_history_item.  

Fri Dec 17 23:58:06 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	Group the allocation of the new history item's listbox item with the
	rest of the history item initialisation code.  

Fri Dec 17 23:55:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/forms.c:

	find_form_for_input(): Killed commented out form.num. The number is
	just offset of the <form> tag start in the HTML part and we can get
	that anytime easily from html_context.last_form_tag, so no need to
	carry it around in a struct.  

Fri Dec 17 23:53:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	In add_global_history_item, add the new history item to the hash
	table even if we cannot allocate the box item for it.  

Fri Dec 17 23:52:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/forms.c:

	find_form_for_input(): Description.  

Fri Dec 17 23:51:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/forms.c:

	find_form_for_input(): Sprinkled by few comments.  

Fri Dec 17 23:50:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/globhist/globhist.c:

	In add_global_history_item, drop local variable text, which has been 
	unused since add_listbox_item stopped taking an argument for the
	listbox item's label in src/bfu/hierbox.c revision 1.163 (and we
	stopped passing it, in revision 1.75), which it hadn't used since
	src/bfu/hierbox.c revision 1.161 when listbox_item->text was
	superseded by the get_text listbox operation.  

Fri Dec 17 23:49:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/forms.c:

	find_form_for_input(): Killed sa and end_parse label by converting
	the main stuff to an explicit loop.  

Fri Dec 17 23:47:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/forms.c:

	find_form_for_input(): Changed my mind. Reintroduced end_parse
	label.  

Fri Dec 17 23:46:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/forms.c:

	find_form_for_input(): Eliminated end_parse label.  

Fri Dec 17 23:44:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/forms.c:

	find_form_for_input(): @i -> @stop_pos.  

Fri Dec 17 23:43:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/forms.c:

	find_form_for_input(): Eliminated sp label.  

Fri Dec 17 23:42:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/forms.c:

	find_form_for_input(): @s -> @pos, @ss -> @tag_start_pos, @lf ->
	@last_form_tag, @la -> @last_form_attr.  

Fri Dec 17 23:23:52 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/inpfield.c:

	When an input line is open and the user clicks outside of it, close
	the input line and pass the event on to the next window.  

Fri Dec 17 23:20:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/document.h:

	Explain the content of those mysterious lists in struct document.  

Fri Dec 17 23:15:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	FORM_CONTROL -> FORM 

Fri Dec 17 23:14:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Support for form.encoding.  

Fri Dec 17 22:59:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, document/renderer.c, protocol/uri.c,
	protocol/uri.h, protocol/gopher/gopher.c, sched/download.c,
	viewer/text/link.c:

	Introduce decode_uri_{string_,}for_display() which removes
	non-printable and control chars from decoded URIs, even when the
	decoded URI is going to be used for a filename. Fixes bug 573.  

Fri Dec 17 22:45:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	The right fix for the bugzilla crash. forms' parent is document, but
	the vs is private of window, document's parent.  

Fri Dec 17 22:40:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cookies/: cookies.c, cookies.h:

	Unexport get_cookie_server().  

Fri Dec 17 21:54:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/events.txt, src/bookmarks/bookmarks.c,
	src/bookmarks/dialogs.c, src/config/options.inc:

	Introduce periodic snapshotting of all tabs in all terminals.  
	
	Add the events bookmark-delete, bookmark-move, and bookmark-update.  
	
	Auto-sort the ui.sessions as the bookmarks module is now adding an
	option thereunder.  
	
	Add the new routines and event hooks to perform the snapshotting.  

Fri Dec 17 20:26:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Do not use the trailing underscores lightly. property__ ->
	jsval_property.  

Fri Dec 17 20:24:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Reverted relevant part of 1.98, moving initializations back to the
	declaration part and thus fighting the evil clutter ;-).  

Fri Dec 17 16:19:08 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	document.browse.search.case is boolean.  

Fri Dec 17 15:59:01 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Dec 17 15:52:10 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Reformat JavaScript Emergency message, and fix a memleak
	(MSGBOX_FREE_TEXT needed).  

Fri Dec 17 15:48:50 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Use a struct for property, and make union anonymous.  

Fri Dec 17 15:25:53 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Introduce P_UNDEF() macro, and drop prop_type = JSPT_UNDEF. Note
	that VALUE_TO_JSVAL_START always call it.  

Fri Dec 17 15:00:00 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Add macros to set @p and use them.  

Fri Dec 17 14:37:00 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	error_reporter(): attempt to make things readable.  

Fri Dec 17 14:10:14 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	If we go for macros, then use them.  

Fri Dec 17 14:06:39 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Make @doc_view, @ses more local. Minor typo fix.  

Fri Dec 17 13:59:43 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Drop temporary variable and minor typo fix.  

Fri Dec 17 13:58:06 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Put spaces around = operator.  

Fri Dec 17 13:56:00 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Make @doc_view declaration more local.  

Fri Dec 17 13:48:47 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Tidy up.  

Fri Dec 17 13:32:09 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Reduce indentation level and tidy up.  

Fri Dec 17 13:26:40 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Reduce indentation level and tidy up.  

Fri Dec 17 13:24:02 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Drop useless temporary variable.  

Fri Dec 17 13:22:33 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Tidy up.  

Fri Dec 17 13:19:51 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/: spidermonkey.c, spidermonkey.c:

	Drop useless {}.  

Fri Dec 17 11:09:34 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	JSVAL_TO_VALUE_START macro declares some variables, so stick it to
	declaration block.  

Fri Dec 17 11:05:55 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	VALUE_TO_JSVAL_START macro declares some variables, so stick it to
	declaration block.  

Fri Dec 17 11:02:50 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Only get document if needed, it fixes crash when accessing bugzilla.
	Pasky, please review.  

Fri Dec 17 08:53:09 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	document.browse.forms.auto_submit option is boolean.  

Fri Dec 17 08:48:37 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: form.c, link.c:

	document.browse.accesskey.display option is boolean.  

Fri Dec 17 05:06:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/link.c:

	Describe init_link_drawing, draw_current_link, and clear_link.  

Fri Dec 17 04:40:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/view.h:

	Guess at the purpose of struct link_bg *link_bg and int link_bg_n in
	struct document_view.  

Fri Dec 17 03:21:17 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/renderer.c:

	s/non accessible/inaccessible/ 

Fri Dec 17 03:19:35 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/renderer.c:

	Never add inaccessible links, regardless of whether we are numbering
	them.  

Fri Dec 17 01:33:54 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Stop searching a document when the first zero-length match is found.  
	This avoids long freezes while ELinks finds and highlights every
	zero-length match on the page, which can take a while.  

Fri Dec 17 01:22:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/hierbox.c:

	When the generic hierbox search handler finds no matches, mark all
	items visible.  
	
	This fixes bug 567: 'all listbox items made invisible when result of
	search is not found' 

Fri Dec 17 01:11:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Oh these compilers...  

Fri Dec 17 00:49:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Extensive cleanup of the 'form' object methods.  

Fri Dec 17 00:46:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Treat option as boolean.  

Fri Dec 17 00:39:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Extensive cleanup of the 'forms' object methods.  

Fri Dec 17 00:25:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Internally, call the object 'form' instead of 'form_control' in our
	symbol names. Less confusing, I think.  

Fri Dec 17 00:21:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Trivial reindentation.  

Fri Dec 17 00:20:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Factored out form_control class instance generation to
	get_form_control_object(), and made the object to have the 'forms'
	object as its parent.  

Fri Dec 17 00:05:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Cleanup parts of document_get_property() relevant to forms. Also,
	document.forms is not generated under each property lookup as a new
	object anymore, but initialized single time by JS_InitClass(). I
	hope it actually works.  

Thu Dec 16 23:53:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Try to un-mess the code again by logically reordering the forms code
	added by witekfl.  

Thu Dec 16 23:48:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/renderer.c, ecmascript/ecmascript.h:

	Introduce ecmascript_interpreter.onload_snippets_owner containing
	document id of the final document structure the snippets come from -
	and if that changed from before when about to process snippets,
	reset the state and process them from scratch. Fixes bug 516 where
	the current document got reloaded in another tab and then some
	smart*** pressed ^L to redraw it in the current one.  

Thu Dec 16 23:10:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cache/cache.c:

	Initialize cache entries id_counter to 1 instead of 0. I need 0 for
	special stuff.  

Thu Dec 16 21:28:46 2004  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	Enhanced documentation.  

Thu Dec 16 21:06:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/file/file.c:

	Pah, fixed annoying warning about
	get_opt_int(document.browse.links.color_dirs) instead of
	get_opt_bool(). Like it matters.  

Thu Dec 16 19:47:36 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/remote.txt:

	Few style and grammar touches.  

Thu Dec 16 19:42:01 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/index.txt:

	Aesthetical touches.  

Thu Dec 16 19:39:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/: leds.c, leds.h:

	Respect identifiers namespaces and use led.used__ insted of
	led.__used.  

Thu Dec 16 16:05:22 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Typo fix.  

Thu Dec 16 15:56:54 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/session.c, util/secsave.c:

	More get_opt_*() fixes.  

Thu Dec 16 15:42:58 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/task.c, viewer/text/form.c:

	More get_opt_*() fixes.  

Thu Dec 16 15:34:02 2004  Laurent Monin <zas@norz.org>:

	* src/: cache/cache.c, dialogs/options.c, protocol/ftp/ftp.c:

	More get_opt_*() fixes.  

Thu Dec 16 15:23:20 2004  Laurent Monin <zas@norz.org>:

	* src/: config/conf.c, dialogs/status.c:

	More get_opt_*() fixes.  

Thu Dec 16 15:19:23 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.c:

	More get_opt_*() fixes.  

Thu Dec 16 15:17:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Treat options as booleans.  

Thu Dec 16 15:14:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Treat options as booleans.  

Thu Dec 16 15:13:30 2004  Laurent Monin <zas@norz.org>:

	* src/: config/options.c, config/opttypes.c, lowlevel/dns.c:

	More get_opt_*() fixes.  

Thu Dec 16 15:10:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/http/http.c, document/options.c,
	lowlevel/connect.c, viewer/text/view.c:

	Treat options as booleans.  

Thu Dec 16 15:05:12 2004  Laurent Monin <zas@norz.org>:

	* src/: document/renderer.c, intl/gettext/libintl.h:

	Those options are of codepage type.  

Thu Dec 16 15:03:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Get -dump and -source cmdline options as booleans.  

Thu Dec 16 14:55:30 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.h:

	Add get_opt_codepage() and get_cmd_opt_codepage().  

Thu Dec 16 14:43:41 2004  Laurent Monin <zas@norz.org>:

	* src/config/: options.c, options.h, opttypes.c, opttypes.h:

	When CONFIG_DEBUG is defined, check for wrong get_opt_*() calls
	regarding option type.  

Thu Dec 16 13:52:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Oops forgot this one when updating elinks.conf(5) yesterday in my
	release tree.  

Thu Dec 16 13:51:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/remote.txt:

	s/"g elinks"/g:elinks/ which pasky prefers.  

Thu Dec 16 13:36:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: ecmascript.txt, hacking.txt, index.txt, marks.txt,
	remote.txt, urlprefixes.txt:

	Aspell all .txt files.  

Thu Dec 16 13:11:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/lua/elinks-remote, doc/Makefile.am, doc/index.txt,
	doc/remote.txt:

	Elaborate a bit about managing remote ELinks instances with -remote.
	Plant a note about -remote in the elinks-remote hack.  

Thu Dec 16 11:44:03 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/: index.txt, urlprefixes.txt:

	The tracts of URI rewriting.  

Thu Dec 16 10:54:33 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/index.txt:

	I guess ex-mode is advanced.  

Thu Dec 16 10:54:01 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.c:

	A new debug_check_option_syntax() that wraps calls to
	check_caption() and check_description().  

Thu Dec 16 10:49:32 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/bookmarks.txt:

	Slightly reordered the sample bookmarks hierarchy for marginal
	increase in instructiveness.  

Thu Dec 16 10:47:16 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.c:

	When CONFIG_DEBUG is defined, check for bad chars at end of option
	description, it will warn if spaces, tabs or newlines are found.  

Thu Dec 16 10:46:29 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/bookmarks.txt:

	Hopefully completed the bookmarks documentation by details on the
	bookmarks formats.  

Thu Dec 16 10:38:33 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.c:

	check_caption() -> static.  

Thu Dec 16 10:34:42 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Dec 16 10:31:23 2004  Laurent Monin <zas@norz.org>:

	* src/config/: cmdline.c, options.inc:

	Drop extra newline at end of option description.  

Thu Dec 16 10:29:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	end_of_dir(): Drop the now obsoleted struct uri parameter.  

Thu Dec 16 10:22:48 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated and some typos were fixed.  

Thu Dec 16 09:58:05 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Dec 16 09:56:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix encoding of file:// URIs so that the query is not also encoded.
	This patch has some issues raise by Miciah, mostly related to the
	way check_file_uri() works, but it fixes support for passing query
	URI components to local CGI scripts. Maybe it would be more
	elegantly fixed by adding query members to struct uri.  

Thu Dec 16 09:52:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix detection of end_of_dir() by allowing (again) query URI
	components in file:// URIs. Fix the bad logic when checking and
	initializing the fragment URI components of file:// URIs.  

Thu Dec 16 09:44:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bookmarks/bookmarks.c:

	The native ELinks format IS NOT compatible with the Links 0.9x
	bookmarks format.  

Thu Dec 16 09:33:23 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/: bookmarks.txt, color-model.txt, ecmascript.txt, exmode.txt,
	feedback.txt, marks.txt:

	Some Id tags.  

Thu Dec 16 09:31:29 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/: Makefile.am, README, index.txt:

	Added grandiose introduction+table of contents index.txt file.  

Thu Dec 16 08:46:37 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/events.txt:

	Some introduction to what's up with this events thing.  

Thu Dec 16 08:16:34 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/hacking.txt:

	This sentence has bothered me in my dreams for a long time.  

Thu Dec 16 01:53:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/pl.po:

	Updates to polish translation - fixing 9 fuzzies/untranslated
	msgids. Patch by Adam Golebiowski <adamg@pld-linux.org>.  

Thu Dec 16 00:15:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Survive if SM doesn't provide JSOPTION_COMPILE_N_GO. It's a popular
	cause of compile failures and it's only informative, not strictly
	required.  

Wed Dec 15 23:11:41 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/: Makefile.am, exmode.txt:

	More crazy raving, exmode is the topic this time.  

Wed Dec 15 22:25:16 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS:

	More pride for me! 

Wed Dec 15 22:20:46 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/: Makefile.am, marks.txt:

	Some raving blabbery on marks, per Miciah's request.  

Wed Dec 15 21:52:23 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/README:

	Make this file less confusing for the part of mankind not closely
	following the (lack of) ELinks development in the area of
	documentation, pointing out the existence of humble text and HTML
	files in the doc/ directory, aside the intrisically invisible
	docbook manual.  

Wed Dec 15 19:25:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10rc1.CVS 

Wed Dec 15 19:18:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10rc1 

Wed Dec 15 19:14:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	Update .po files.  

Wed Dec 15 19:10:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Wed Dec 15 19:05:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, document/html/parser/link.c:

	Alias document.browse.images.file_tags to
	document.browse.images.filename_maxlen since that is what it has
	most in common with. Place an XXX near the use of the new
	filename_maxlen option that it can potentially return a negative
	number. Gently teach vim that .inc files are infact .c files.  

Wed Dec 15 18:48:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Some how them 'Max.' abbreviations don't look right, so maximize
	them.  

Wed Dec 15 16:05:06 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Dec 15 15:41:40 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Treat label=="" as label==NULL.  

Wed Dec 15 15:21:26 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Code cleanup in get_image_label() and get_image_filename_from_src().  

Wed Dec 15 15:15:46 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.inc:

	Comment out now obsolete option document.browse.images.file_tags:
	what should we do ?.  

Wed Dec 15 15:11:55 2004  Laurent Monin <zas@norz.org>:

	* src/: config/options.inc, document/html/parser/link.c:

	A new option was added: document.browse.images.filename_maxlen It
	replaces document.browse.images.file_tags which is now obsolete.  
	Users should use combination of display_style and filename_maxlen
	instead.  

Wed Dec 15 15:06:57 2004  Laurent Monin <zas@norz.org>:

	* src/: config/options.inc, document/html/parser/link.c:

	A new option was added: document.browse.images.display_style Its
	value controls how to display image tags.  0     means always
	display IMG 1     means always display filename 2     means display
	alt/title attribute if possible, IMG if not 3     means display
	alt/title attribute if possible, filename if not 

Wed Dec 15 14:53:41 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/parser/link.c, config/options.inc:

	A new option named document.browse.images.label_maxlen was added to
	control maximum length of label extracted from alt/title attributes.
	It acts independently of document.browse.images.file_tags.  

Wed Dec 15 13:53:46 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Revert patch 1.64->1.65 for now. It should be optionnal, and off by
	default. This should perhaps be reintroduced later, we have too much
	image tags options yet.  

Wed Dec 15 10:32:44 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Truncate filename if needed in get_image_filename_from_src().  

Wed Dec 15 10:10:38 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Be clever, use value of id attribute if no title nor alt is
	available as image label.  

Wed Dec 15 09:47:11 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Simplify code and display IMG by default when no other label is
	available, with brackets if needed.  

Wed Dec 15 09:32:34 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Cleanup comments.  

Wed Dec 15 08:55:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	HTML highlighting is not so experimental. IMO and in Miciahs too.  

Tue Dec 14 19:16:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Use function wrappers to eliminate that clandestine argument passing 
	between html_embed, html_iframe, html_img, and html_object using the
	global object_src as a drop box.  

Tue Dec 14 18:48:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/dialogs.c:

	Flip the conditions and swap the respective then and else
	expressions in the same two ternary-operator expressions.  

Tue Dec 14 18:45:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/dialogs.c:

	Remove some superfluous parentheses from a ternary-operator
	expression.  

Tue Dec 14 18:38:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/dialogs.c:

	Use the ternary operator instead of an if-else block.  

Tue Dec 14 18:36:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/dialogs.c:

	Rewrite the comment describing do_move_bookmark to be accurate.  

Tue Dec 14 18:32:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/dialogs.c:

	Move the comment describing do_move_bookmark from the caller to the
	definition of do_move_bookmark.  

Tue Dec 14 18:29:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/dialogs.c:

	Clean up the whitespace in do_move_bookmark.  

Tue Dec 14 18:25:18 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/dialogs.c:

	In do_move_bookmark, assert that arguments destb and desti are
	either both NULL or neither NULL.  
	
	Drop local variable blind_insert, which was assigned the boolean
	destb && desti.  
	
	Check whether destb or desti is NULL where we used to check whether
	blind_insert was 0.  
	
	Assign desti = destb = NULL where we used to set blind_insert = 0.  

Tue Dec 14 17:35:28 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Factor the loop that performs the bookmarking out from
	bookmark_terminal_tabs and into the new bookmark_terminal.  
	bookmark_terminal_tabs now is a wrapper that adds the folder and 
	gives it to bookmark_terminal.  

Tue Dec 14 17:08:56 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	In delete_folder_by_name, check whether the bookmark is a folder 
	before checking whether the title matches, as the former operation 
	should be much faster.  

Tue Dec 14 17:07:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Factor the folder deletion code out from bookmark_auto_save_tabs and
	into the new delete_folder_by_name.  

Tue Dec 14 17:01:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	In bookmark_terminal_tabs, use local variable ses instead of 
	tab->data, the value of which is already assigned to ses.  

Tue Dec 14 17:00:29 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Include util/lists.h.  

Tue Dec 14 16:59:32 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Sort the inclusions.  

Tue Dec 14 01:58:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/dialogs.c:

	In do_move_bookmark, use foreachsafe instead of re-implementing it 
	with a while loop.  

Tue Dec 14 01:55:03 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/session.c:

	Just put a hard limit on the number of successive redirects.  

Mon Dec 13 18:48:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/session.c:

	Try again, but this time, do not dereference the given pointer if it
	is NULL.  

Mon Dec 13 18:46:54 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/session.c:

	Revert that.  

Mon Dec 13 06:15:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/session.c:

	Improve the infinite-loop check in check_incomplete_redirects to
	catch loops that involve more than one page.  

Mon Dec 13 04:49:43 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Remove a stale comment in truncate_label: because the memcpy no
	longer will copy the NUL, the line that adds the NUL terminator is
	no longer just for 'great safety'.  

Mon Dec 13 04:22:02 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Do _not_ free map_url after assigning it to format.link.  This
	should fix the crashes caused by the bad memory handling introduced
	in revision 1.52.  

Mon Dec 13 04:19:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Free the the value returned by join_urls once it is no longer
	needed.  

Mon Dec 13 04:18:00 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Check whether join_urls returns NULL.  

Mon Dec 13 04:16:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Introduce local variable joined_urls.  

Mon Dec 13 04:12:01 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	html_img: Rename local variable url to map_url in the image-map
	code.  

Fri Dec 10 18:20:35 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): mem_free*() only when needed.  

Fri Dec 10 18:16:33 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): use mem_free_set().  

Fri Dec 10 18:14:50 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): drop another FIXME, please check if correct.  

Fri Dec 10 18:12:20 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): reorganize code and drop a FIXME.  

Fri Dec 10 18:05:17 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): empty lines and comments cleanup. Two FIXME were added.  

Fri Dec 10 18:00:27 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): drop goto and obsolete comments.  

Fri Dec 10 17:51:32 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): move code to new put_image_label().  

Fri Dec 10 17:44:44 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): simplify code.  

Fri Dec 10 17:39:25 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): @al -> @usemap_attr,@label ; @tmp -> @new_label.  

Fri Dec 10 17:31:23 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): @u -> @url, free @al asap.  

Fri Dec 10 17:28:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): get image source once only, code cleanup.  

Wed Dec  8 18:29:52 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	truncate_title() was renamed get_image_label() and slightly
	modified.  

Wed Dec  8 18:23:12 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Move code from truncate_title() to reworked truncate_label().  

Wed Dec  8 17:27:56 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	get_image_text() was renamed get_image_filename_from_src(). Comments
	were added.  

Sun Dec  5 22:19:40 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	In truncate_title, swap an if statement's then and else blocks to
	put the shorter one first.  

Sun Dec  5 22:15:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Use memcpy and direct assignments instead of sprintf in
	truncate_string.  

Sun Dec  5 21:59:54 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Use a goto in truncate_title to reduce indentation.  

Sun Dec  5 21:54:20 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Drop the truncation code from get_image_text and let html_img
	truncate it using truncate_title as it does for an image's alt and
	title text.  

Sun Dec  5 21:48:03 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Finish last change.  

Sun Dec  5 21:43:08 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Drop local variable max_real_len from get_image_text.  

Sun Dec  5 21:41:18 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Move a TODO comment from get_image_text to truncate_title.  

Fri Dec  3 22:51:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	query_file(): Order input_field() to check_nonempty() improving the
	IQ of the resulting error message. On the other hand maybe empty
	input should just close the dialog.  

Fri Dec  3 17:12:33 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c, AUTHORS:

	This is a patch to link.c that will shorten the alt or title
	attribute of an image just as the filename is already done.  
	
	Patch by Russ Rowan <rrowan@dandy.net>.  Added to AUTHORS.  

Fri Dec  3 10:26:12 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	Be stricter in print_delete_error(), let it produce an internal
	error if @err is not a valid error code.  

Fri Dec  3 10:06:56 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	Use EVENT_PROCESSED where it is appropriated.  

Thu Dec  2 16:34:01 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/inphist.c, bookmarks/bookmarks.c, cookies/cookies.c,
	dialogs/exmode.c, dialogs/menu.c, dialogs/options.c,
	formhist/formhist.c, globhist/globhist.c, lowlevel/timer.c,
	protocol/file/file.c, sched/action.c, sched/download.c,
	scripting/lua/core.c, viewer/text/form.c, viewer/text/link.c:

	Be more coherent, use get_cmd_opt_bool("anonymous") everywhere
	instead of mixed get_cmd_opt_bool()/get_cmd_opt_int(). This option
	has the boolean type, though since bool==int from get_cmd_opt_*()
	POV, this is just a cosmetic change.  

Wed Dec  1 17:54:22 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated: typo fix and cleanup.  

Wed Dec  1 17:52:12 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Dec  1 03:37:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/dialogs.c:

	Indicate in the options manager and the option info box whether an
	option has been modified since the configuration was last saved.  
	
	Inspired by bug 357: Show default values for selected option in Info 
	dialog from Options manager.  

Tue Nov 30 17:47:11 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: inpfield.c, inpfield.h:

	Fix bug related to input field label display, introduced by me few
	days ago, spotted by Miciah. Drop @float_label field in favor of a
	more general @flags field, using new enum inpfield_flags.
	add_dlg_field_float2() was added. add_dlg_field_do() was cleaned up
	(and indentation was fixed as well).  

Tue Nov 30 06:30:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	menu_search_handler: Rather than setting |menu->selected| directly, 
	use scroll_menu, which properly updates |menu->first|.  Now the menu
	is scrolled and redrawn properly to show the matched item.  

Tue Nov 30 06:15:23 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	menu_search_handler: Begin searching with the selected item, unless 
	the user pressed previous-item or next-item. Now, as long as the
	pattern matches the selected item, it will not jump between items as
	the user enters the pattern.  

Mon Nov 29 17:31:06 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/inpfield.c:

	Typo fix in comment.  

Sat Nov 27 17:53:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/protocol/Makefile.am,
	src/protocol/auth/Makefile.am, src/protocol/auth/digest.c,
	src/protocol/http/http.c, src/util/Makefile.am, src/util/md5.c,
	src/util/md5.h:

	Add built-in MD5 support. Can be tested with --enable-own-libc or
	when OpenSSL or GNUTLS support is disabled.  

Sat Nov 27 16:03:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	exit_prog(): Minor cleanup of the logics which means that you should
	never use exit_prog() when really quiting however Ctrl-C correctly
	uses really_quit_prog(). Use list_is_singleton(terminals) when
	checking whether to force a quit-dialog when downloads are still in
	progress.  

Sat Nov 27 01:27:19 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Nov 27 01:12:18 2004  Laurent Monin <zas@norz.org>:

	* src/config/conf.c:

	Slightly improve config file look when rewritten.  

Fri Nov 26 17:27:00 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/html/parser/forms.c:

	Back to previous version. Links numbering should be correct now.  

Fri Nov 26 17:23:45 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/renderer.c:

	Partial revert hidden links change.  

Fri Nov 26 17:16:20 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Fri Nov 26 10:28:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/lists.h:

	Oops. Fix the assert message from last patch. A little reformatting
	on the side.  

Fri Nov 26 10:26:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, util/lists.h:

	Introduce list_is_singleton() macro with Miciah as the inspirational
	source.  

Thu Nov 25 23:53:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/options.inc, dialogs/menu.c:

	Use add_shell_quoted_to_string instead of add_shell_safe_to_string 
	in format_command so that URIs passed to external commands will be 
	escaped against shell misinterpretation rather than correct browser 
	interpretation. Add a warning to document.uri_passing._template_ not
	to escape the URI there.  

Thu Nov 25 23:50:15 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: osdep/osdep.c, util/conv.c, util/conv.h:

	Add |len| parameter to add_shell_quoted_to_string.  

Thu Nov 25 23:24:09 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: osdep/osdep.c, util/conv.c, util/conv.h:

	Factor add_shell_quoted_to_string out from the code for GNU Screen's 
	clipboard in the generic set_clipboard_text.
	add_shell_quoted_to_string adds ', the given source string with all
	occurrences of ' changed to '\'', and another ' to the given
	destination string.  

Thu Nov 25 22:19:18 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/action.c:

	In the switch in do_action, put back the default: label removed in
	1.126.  Even tho there are cases for all values of enum main_action, 
	its callers might get -1 from kbd_action and pass that value, which
	is not enumerated by enum main_action, to do_action.  This fixes the
	bug that prevented alt-[fvltsh] from opening the menus.  

Thu Nov 25 18:01:39 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/spidermonkey.c:

	Fixed segfault on bugzilla site.  

Wed Nov 24 22:47:23 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Nov 24 22:16:54 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/group.c:

	Fix a segfault triggered by resize terminal dialog: let accept NULL
	widget text.  

Wed Nov 24 18:21:39 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/: ecmascript.c, spidermonkey.c:

	An option called ecmascript.max_exec_time was added to control the
	maximum time a script may be run (5 seconds by default). Ecmascript
	options stuff was simplified.  

Wed Nov 24 17:42:01 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Fix compilation issues: JSVAL_TO_VALUE_START should follow variable
	declaration block.  

Wed Nov 24 17:10:33 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/spidermonkey.c:

	Now should be compilable.  

Wed Nov 24 09:03:58 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Disable parts recently added by witekfl, they break compilation. #if
	1 -> #ifdef WITEKFL. Please witekfl, fix these asap ;).  

Tue Nov 23 17:12:56 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: document/html/parser/forms.c, document/renderer.c,
	document/html/renderer.c, document/html/renderer.h,
	ecmascript/spidermonkey.c, viewer/text/form.c, viewer/text/form.h:

	Don't beat me. Links navigation is broken because of hidden links, 
	which are internally "visible" now. They should be skiped somehow in
	navigation (not done yet). Hidden form is used by eg.
	https://www.mbank.com.pl/. My long term goal is make this site work
	with ELinks.  

Tue Nov 23 13:08:29 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/listbox.c, bfu/listbox.h,
	bfu/widget.h, bookmarks/dialogs.c:

	box -> listbox.  

Mon Nov 22 17:07:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	Introduce md5_bin_digest buffer typedef.  

Mon Nov 22 17:04:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	Fix descriptions from last patch. Rename convert_hex() ->
	convert_to_md5_hex_digest(). I like upcased hex numbers.  

Mon Nov 22 16:52:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	init_random_cnonce() -> init_cnonce_digest(), digest_calc_response()
	-> init_response_digest() and add function descriptions + lots of
	FIXMEs.  

Mon Nov 22 13:27:41 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/inphist.c, bfu/listmenu.c, bfu/listmenu.h, bfu/menu.h,
	dialogs/info.c, dialogs/info.h, dialogs/menu.c, dialogs/menu.h,
	dialogs/options.c, dialogs/options.h, document/html/parser.c,
	mime/dialogs.c, sched/task.c, sched/task.h, viewer/text/form.c,
	viewer/text/form.h, viewer/text/link.c, viewer/text/link.h,
	viewer/text/textarea.c, viewer/text/textarea.h:

	Drop type casting to menu_func, use correct prototype for functions
	which are called by menus (menu_func).  

Mon Nov 22 11:31:09 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: dialog.c, hierbox.c, inpfield.c, widget.h:

	Trim trailing whitespaces.  

Mon Nov 22 11:29:09 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Drop inline keyword since performance is not an issue here.  

Mon Nov 22 07:28:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/dialog.c, bfu/dialog.h,
	bfu/hierbox.c, bfu/inpfield.c, bfu/listbox.c, bfu/widget.c,
	bfu/widget.h, bookmarks/dialogs.c:

	Now longer use the |dlg_data->focus_selected_widget| flag to
	indicate to the widget-specific drawing code whether the widget is
	focused. Instead, check within the individual drawing routines 
	whether the widget being drawn is focused.  
	
	struct dialog_data: Drop the boolean focus_selected_widget.  
	
	display_widget_focused, display_widget_unfocused: Drop.  
	
	display_widget: Expose.  
	
	select_widget, cycle_widget_focus: Set
	|dlg_data->selected_widget_id| _before_ calling display_widget on
	the previously selected widget.  
	
	display_button, display_checkbox, display_field_do: Use
	|is_selected_widget(dlg_data, widget_data)| instead of checking
	|dlg_data->focus_selected_widget|.  
	
	Everywhere: Use display_widget instead of display_widget_focused and
	display_widget_unfocused.  

Mon Nov 22 06:28:50 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Fix some compilation errors that came with the change from void * to
	t_widget_handler * for the callback provided to add_dlg_button_do.  

Sun Nov 21 17:15:50 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, dialog.c, inpfield.c, listbox.c,
	text.c, widget.h:

	Add a clear handler for widgets and make clear_dialog() more
	generic.  

Sun Nov 21 16:54:30 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/dialog.c, bfu/inpfield.c,
	bfu/widget.h, viewer/text/search.c:

	Struct widget @data and @udata fields were merged. @datalen usage
	was clarified a bit.  

Sun Nov 21 14:53:30 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/button.h, bfu/hierbox.c, bfu/inpfield.c,
	bfu/msgbox.c, config/dialogs.c, cookies/dialogs.c,
	dialogs/download.c, dialogs/edit.c, dialogs/options.c,
	mime/dialogs.c, protocol/auth/dialogs.c, scripting/lua/core.c,
	viewer/text/search.c:

	Reorder parameters of add_dlg*button*() to match syntax of other
	kind of widgets.  

Sun Nov 21 14:17:14 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Use correct type for @done.  

Sun Nov 21 14:14:27 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, button.h:

	Use t_widget_handler * instead of void * for @handler.  

Sun Nov 21 14:07:00 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, button.h:

	@key -> @flags.  

Sun Nov 21 14:03:25 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/button.h, bfu/msgbox.c,
	bookmarks/dialogs.c, dialogs/edit.c, dialogs/edit.h,
	dialogs/options.c, globhist/dialogs.c, mime/dialogs.c,
	protocol/auth/dialogs.c:

	BUTTON_DONE_FUNC() macro was dropped in favor of t_done_handler
	typdef. Functions declarations were fixed to match correct
	prototype.  

Sun Nov 21 13:35:44 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/msgbox.c:

	@fn -> @done.  

Sun Nov 21 13:33:17 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/dialog.c, bfu/inpfield.c, bfu/widget.h,
	dialogs/options.c:

	Field @fn of struct widget was renamed @handler.  

Sun Nov 21 13:23:58 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: common.h, hierbox.h, inpfield.c, inpfield.h, widget.h:

	t_widget_handler -> t_widget_handler *. Suggested by Miciah.  

Sun Nov 21 05:20:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/session.c:

	Avoid an infinite loop when a page redirects to itself, as the
	search form on www.bestbuy.com will.  

Sat Nov 20 11:32:57 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: common.h, hierbox.h, inpfield.c, inpfield.h, widget.h:

	Drop WIDGET_HANDLER_FUNC() macro, and introduce new type
	t_widget_handler.  

Sat Nov 20 04:29:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/: auth.c, auth.h:

	Make find_auth_entry() once again static.  

Sat Nov 20 03:52:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	I never did quite understand why find_auth() was not good enough for
	FTP authentication. It checks for blocked entries and the user/pass
	checking is only to validate that they were not updated through the
	goto dialog. So use find_auth() for FTP.  

Sat Nov 20 02:50:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Wrap digest code in CONFIG_SSL_DIGEST #ifdef.  

Sat Nov 20 02:08:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Move WWW-Authenticate HTTP header field checking to
	check_http_authentication().  

Sat Nov 20 01:32:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	Introduce init_uri_method_digest() for calculating that H(A2).  

Sat Nov 20 01:27:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	digest_calc_ha1() -> init_credential_digest().  

Sat Nov 20 00:46:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	random_cnonce() -> init_random_cnonce().  

Sat Nov 20 00:44:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	Use stack allocated buffers through typedef'ed md5_hex_digest.  

Sat Nov 20 00:33:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	Make all the hex'ed digest lengths explicit.  

Sat Nov 20 00:26:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	Only make digest_calc_response() worry about ha1 calculation.  

Sat Nov 20 00:09:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	digest_calc_ha1(): Drop unused cnonce arg.  

Fri Nov 19 23:46:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/: digest.c, digest.h:

	Make auth digest helpers static.  

Fri Nov 19 23:45:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: auth/digest.c, auth/digest.h, http/http.c:

	Oops misread the RFC
	s/get_http_auth_digest_challenge/get_http_auth_digest_response/.  

Fri Nov 19 23:40:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: auth/digest.c, auth/digest.h, http/http.c:

	Move HTTP auth digest challenge computation and string construction
	to new get_http_auth_digest_challenge().  

Fri Nov 19 19:05:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/checkbox.h:

	Fix cut and paste error introduced in (1.34 -> 1.35) 'Move specific
	info to widgets headers, ...' 

Fri Nov 19 18:59:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/widget.h:

	Fix potentially confusing comment.  

Fri Nov 19 17:46:04 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/button.h, bfu/checkbox.c, bfu/checkbox.h,
	bfu/common.h, bfu/group.c, bfu/hierbox.h, bfu/inpfield.c,
	bfu/inpfield.h, bfu/leds.c, bfu/listbox.c, bfu/listbox.h,
	bfu/menu.c, bfu/msgbox.c, bfu/msgbox.h, bfu/style.h, bfu/text.c,
	bfu/text.h, bfu/widget.h, document/css/apply.c,
	document/css/property.h, document/html/parser.h, util/Makefile.am,
	util/align.h:

	Move enum format_align to new util/align.h since it is not bfu
	specific. Drop most bfu/style.h inclusions.  

Fri Nov 19 17:19:05 2004  Laurent Monin <zas@norz.org>:

	* src/: main.c, bfu/inphist.c, bfu/inphist.h, bfu/widget.c,
	bfu/widget.h:

	Move dlg_set_history() to inphist.{c,h}.  

Fri Nov 19 17:14:56 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: checkbox.h, dialog.h, inpfield.h, text.h, widget.h:

	Move macros from widget.h to related header files.  

Fri Nov 19 17:08:47 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/http/http.c:

	Off course Proxy-Authenticate. Spotted by Jonas.  

Fri Nov 19 17:07:18 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.h, checkbox.h, inpfield.h, listbox.h, text.h,
	widget.h:

	Move specific info to widgets headers, and simplify widget.h.  

Fri Nov 19 16:54:21 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/widget.h, dialogs/status.c, modules/module.c,
	sched/session.c, sched/session.h:

	Reduce number of inclusions, just include bfu/dialog.h.  

Fri Nov 19 16:42:35 2004  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/bookmarks.c, bookmarks/backend/common.c,
	bookmarks/backend/default.c, bookmarks/backend/xbel.c,
	cache/cache.c, config/kbdbind.c, config/options.c,
	config/opttypes.c, config/urlhist.c, cookies/cookies.c,
	dialogs/status.c, globhist/globhist.c, protocol/nntp/codes.c:

	Reduce number of inclusions, just include bfu/dialog.h.  

Fri Nov 19 16:33:01 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/widget.h, dialogs/exmode.c:

	Reduce number of inclusions, just include bfu/dialog.h.  

Fri Nov 19 16:29:23 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Reduce number of inclusions, just include bfu/dialog.h.  

Fri Nov 19 16:27:52 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/widget.h:

	Do not include twice the same header.  

Fri Nov 19 16:26:11 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/widget.h, dialogs/edit.c, dialogs/options.c,
	formhist/dialogs.c, globhist/dialogs.c, mime/dialogs.c,
	protocol/auth/dialogs.c, scripting/lua/core.c:

	Reduce number of inclusions, just include bfu/dialog.h.  

Fri Nov 19 16:22:19 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/widget.h, bookmarks/dialogs.c, cache/dialogs.c,
	config/dialogs.c, cookies/dialogs.c, dialogs/download.c:

	Reduce number of inclusions, just include bfu/dialog.h.  

Fri Nov 19 16:16:26 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/widget.h, dialogs/document.c, dialogs/info.c,
	dialogs/menu.c, ecmascript/spidermonkey.c, formhist/formhist.c,
	protocol/protocol.c, protocol/user.c, sched/download.c,
	sched/session.c, sched/task.c, terminal/tab.c, viewer/text/draw.c,
	viewer/text/form.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c:

	Fix header files inclusions.  

Fri Nov 19 16:08:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/formhist/formhist.c:

	#include missing headers revealed by widget cleanup.  

Fri Nov 19 16:08:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: msgbox.h, widget.h:

	Create dynamic widget #include area. The message box interface rely
	on the button flags (B_*) so #include the widget header.  

Fri Nov 19 15:53:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/: cookies.c, dialogs.c, dialogs.h:

	Move accept_cookie_dialog() and cookie_queries list_head to dialogs
	file.  

Fri Nov 19 15:45:46 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: listbox.c, listbox.h:

	Fix get_listbox_widget_data() compilation issue.  

Fri Nov 19 15:40:20 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: common.h, hierbox.h, inpfield.h, listbox.h, msgbox.h,
	widget.h:

	Drop more #include.  

Fri Nov 19 15:39:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	These dialog/widget #includes looks like relics from the
	pre-input_line implementation.  

Fri Nov 19 15:33:07 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: Makefile.am, button.h, checkbox.h, common.h, hierbox.h,
	inpfield.h, listbox.h, text.h, widget.h:

	Create new header common.h and drop some #include <bfu/widget.h>
	from header files.  

Fri Nov 19 12:17:10 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: main.c, protocol/http/http.c, protocol/http/http.h:

	Experimental proxy digest authorization. Not tested at all. Note
	that wrong credentials leads to infinite loop.  

Fri Nov 19 11:12:53 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: text.c, text.h:

	Make add_dlg_text() a function.  

Fri Nov 19 11:07:53 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/listbox.c:

	Drop now useless ().  

Fri Nov 19 11:06:40 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: listbox.c, listbox.h:

	Make add_dlg_listbox() a function.  

Fri Nov 19 11:01:54 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: inpfield.c, inpfield.h, widget.h:

	Make add_dlg_field_do() a function with the help of
	WIDGET_HANDLER_FUNC() new macro.  

Fri Nov 19 10:48:04 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: checkbox.c, checkbox.h:

	Move code from macro add_dlg_radio() to new function
	add_dlg_radio_do().  

Fri Nov 19 10:30:50 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, button.h:

	Make add_dlg_button_do() a function.  

Fri Nov 19 10:04:45 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.h, bfu/checkbox.h, bfu/dialog.c, bfu/dialog.h,
	bfu/inpfield.h, bfu/listbox.h, bfu/msgbox.c, bfu/text.h,
	bfu/widget.h, config/dialogs.c, cookies/dialogs.c, dialogs/edit.c,
	protocol/auth/dialogs.c, scripting/lua/core.c:

	Rename |widgets_size| of struct dialog to |number_of_widgets|. Make
	it appear only in bfu/ with the help of some new macros.  

Fri Nov 19 09:39:25 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/checkbox.c, bfu/dialog.c, bfu/dialog.h, bfu/group.c,
	dialogs/download.c:

	Rename |n| field of struct dialog_data to explicit
	|number_of_widgets|. More foreach_widget() usage.  

Fri Nov 19 09:28:40 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: dialog.c, dialog.h:

	Introduce foreach_widget() and few helpers macros. Use them for
	widget_data iterations.  

Fri Nov 19 05:07:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/connection.c:

	Update a TODO comment to reflect the renaming of uncompress_shutdown 
	to decompress_shutdown.  

Thu Nov 18 23:52:20 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/checkbox.c:

	Let display_checkbox() return EVENT_PROCESSED on allocation error.
	Spotted by Miciah.  

Thu Nov 18 22:25:48 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/util/snprintf.c:

	Our official native English speaker forgot to use the subjunctive
	mood.  Any intelligent native English speakers care to check this? 

Thu Nov 18 21:39:33 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/dialog.c, bfu/dialog.h,
	bfu/inpfield.c, bfu/widget.h, protocol/auth/dialogs.c:

	Struct dialog_data "selected" field was renamed
	"selected_widget_id".  Code related to it was moved to dialog.{c,h]
	only with the help of new select_widget(), select_widget_by_id(),
	update_all_widgets().  Code redundancy was reduced.  

Thu Nov 18 17:59:32 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/osdep/stub.h:

	Included ctype.h in stub.h.  

Thu Nov 18 17:58:26 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Thu Nov 18 17:30:49 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/auth/auth.c:

	Use mem_free_set() for leak fix.  

Thu Nov 18 17:23:09 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/auth/auth.c:

	Possible(?) memleak avoided.  

Thu Nov 18 09:06:41 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Nov 18 08:15:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/button.c, config/options.inc:

	Make it possible to also underline button shortcuts. Along with zas'
	button shortcut coloring this should pretty much fix bug 329.  

Thu Nov 18 00:52:42 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: dialog.c, dialog.h, hierbox.c, inpfield.c, listbox.c,
	text.c, widget.h:

	Use new term_event of struct dlg_data, and drop last parameter of
	widget kbd() functions.  

Thu Nov 18 00:31:42 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, dialog.c, inpfield.c, listbox.c,
	text.c, widget.h:

	Use new term_event of struct dlg_data, and drop last parameter of
	widget mouse() functions.  

Thu Nov 18 00:23:48 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: checkbox.c, dialog.c, dialog.h, inpfield.c, listbox.c,
	widget.h:

	Make struct term_event * a new field of struct dlg_data, and do not
	pass it anymore to all widget init() functions.  

Thu Nov 18 00:11:41 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/dialog.c, bfu/dialog.h,
	bfu/hierbox.c, bfu/inpfield.c, bfu/listbox.c, bfu/text.c,
	bfu/widget.c, bfu/widget.h, bookmarks/dialogs.c:

	Explode display_dlg_item() to new display_widget_focused() and
	display_widget_unfocused(), dropping last parameter in favor of a
	new struct dlg_data field named focus_selected_widget.  

Wed Nov 17 23:05:18 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/inpfield.c:

	Revert chunk of last patch that was wrongly committed. Sorry.  

Wed Nov 17 23:02:07 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/inpfield.c, config/options.inc:

	Show button shortcut (first letter of label) using specific colors
	configurable through dialog.button-shortcut-selected,
	dialog.button-shortcut color options.  

Wed Nov 17 22:16:56 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/inpfield.c:

	display_field_do() now return t_handler_event_status.  

Wed Nov 17 22:13:43 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, inpfield.c, listbox.c, text.c,
	widget.c, widget.h:

	struct widget_ops display: struct widget_data *, struct dialog_data
	* -> struct dialog_data *, struct widget_data *.  

Wed Nov 17 22:07:16 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: checkbox.c, dialog.c, inpfield.c, listbox.c, widget.h:

	struct widget_ops init: struct widget_data *, struct dialog_data *
	-> struct dialog_data *, struct widget_data *.  

Wed Nov 17 22:03:48 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, dialog.c, inpfield.c, listbox.c,
	text.c, widget.h:

	struct widget_ops mouse: struct widget_data *, struct dialog_data *
	-> struct dialog_data *, struct widget_data *.  

Wed Nov 17 21:59:46 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: dialog.c, hierbox.c, inpfield.c, listbox.c, text.c,
	widget.h:

	struct widget_ops kbd: struct widget_data *, struct dialog_data * ->
	struct dialog_data *, struct widget_data *.  

Wed Nov 17 21:53:52 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, dialog.c, widget.h:

	Invert parameters position for select in struct widget_ops, goal is
	to uniformize order of params in most functions ->
	dlg_data,widget_data instead of widget_data,dlg_data.  

Wed Nov 17 21:09:04 2004  Laurent Monin <zas@norz.org>:

	* src/: protocol/auth/dialogs.c, protocol/auth/digest.c,
	sched/session.c, viewer/text/search.c:

	Trim trailing whitespaces.  

Wed Nov 17 21:04:55 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Revert witekfl patch: string.h must be included before elinks.h
	(isdigit issue), it breaks linking.  

Wed Nov 17 19:12:02 2004  Laurent Monin <zas@norz.org>:

	* src/: cookies/dialogs.c, dialogs/download.c, dialogs/edit.c,
	dialogs/options.c, formhist/dialogs.c, globhist/dialogs.c,
	viewer/text/search.c:

	Use t_handler_event_status.  

Wed Nov 17 19:09:36 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/http/http.c:

	Attempt to handle multiple WWW-Authenticate header field. For
	example Outlook Web interface use it.  

Wed Nov 17 19:08:55 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/dialog.c, bfu/hierbox.c,
	bfu/hierbox.h, bfu/inpfield.c, bfu/inpfield.h, bfu/listbox.c,
	bfu/text.c, bookmarks/dialogs.c, config/dialogs.c:

	Use t_handler_event_status.  

Wed Nov 17 19:07:28 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: dialog.h, widget.h:

	Introduce t_handler_event_status type and change handlers to return
	it (EVENT_PROCESSED/EVENT_NOT_PROCESSED.  

Wed Nov 17 19:05:28 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/viewer/text/view.c:

	string.h must be included before elinks.h (isdigit issue).  

Wed Nov 17 19:04:01 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/osdep/stub.c:

	Missing includes.  

Wed Nov 17 01:24:55 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	dialog_ev_kbd(): call kbd_action() after ops->kbd test.  

Wed Nov 17 01:23:01 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Optimize select_button_by_key() loop by calling
	toupper(get_kbd_key(ev)) once outside the loop.  

Wed Nov 17 01:20:39 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Use temporary variables to shorten lines.  

Wed Nov 17 01:17:25 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Convert action related code from dialog_ev_kbd() to switch().  

Wed Nov 17 01:12:04 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Move code from dialog_ev_kbd() to new select_button_by_key().  

Wed Nov 17 01:07:17 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Reduce code redundancy by introducing select_button_by_flag().  

Wed Nov 17 01:04:04 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Use temporary variable to shorten lines.  

Wed Nov 17 01:01:59 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Split code per action.  

Wed Nov 17 00:58:00 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Check for first letter in button text after checking for action.  

Wed Nov 17 00:54:12 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Check for first letter in button text after checking for action.  

Tue Nov 16 10:32:25 2004  Laurent Monin <zas@norz.org>:

	* src/globhist/globhist.c:

	Drop useless tests in search loop (search_title, search_url are
	non-NULL at this point), add some comments.  

Mon Nov 15 15:08:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/dialogs.c:

	It's always good to leave a little scenting comment close to strange
	looking hacks.  

Mon Nov 15 03:36:04 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/util/snprintf.c:

	Answer zas' question why we cannot use mem_alloc in
	elinks_vasprintf.  The answer: elinks_vasprintf is an alternative to
	vasprintf, which will use malloc. If we changed elinks_vasprintf to
	use mem_alloc, all calls to vasprintf would need to take into
	account whether the ELinks vasprintf was used, in which case we
	would need to mem_free the allocated memory, or whether the system
	vasprintf was used, in which case we would need to use free.  

Mon Nov 15 02:20:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/: auth.c, dialogs.c:

	Readd auth entries if the user/password in the URI changes. That is
	punching a URI into the goto dialog with different user/password the
	auth entry will be updated. This also means that auth_ok() needs to
	fakely redirect to a URI with no user/password in order to avoid the
	auth dialog to keep popping up if the user/password is wrong.  

Mon Nov 15 00:58:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/dialogs.c:

	When the auth entry is derived from URIs user/password there may not
	be any realm. Make the auth dialog check that before accessing the
	realm.  

Mon Nov 15 00:57:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Don't compare user and password from URIs when finding auth entries.
	It makes HTTP Basic auth work with user/password specified in the
	URI.  

Mon Nov 15 00:54:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Fix comma spacing.  

Sun Nov 14 22:54:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	sched/session.c (1.579 -> 1.580) broke reloading completely, so
	revert it.  

Sun Nov 14 22:54:41 2004  Laurent Monin <zas@norz.org>:

	* src/util/conv.h:

	hx() now returns lowercased letters, Hx() was added, and unhx() now
	first test for lowercased letters. It fixes issue with
	convert_hex(), and should not break anything else.  

Sun Nov 14 22:39:49 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/auth/digest.c:

	Optimize convert_hex() and use hx() from conv.h. Please check that
	digest upper/lower case change has no impact.  

Sun Nov 14 22:19:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	digest_calc_response(): Use uri->datalen instead of
	strlen(uri->data) which is wrong when posting.  

Sun Nov 14 22:17:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	random_cnonce(): Don't care about MD5()'s return value.  

Sun Nov 14 21:53:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, config/m4/features.m4:

	Log CONFDIR, LOCALEDIR, CFLAGS and LIBS to features.log 

Sun Nov 14 21:32:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/protocol/Makefile.am,
	src/protocol/auth/Makefile.am, src/protocol/http/http.c:

	Check that the GNU TLS OpenSSL compatibility library is available
	before engaging in adding HTTP Digest support. There is no
	libgnutls-openssl configuration helper. Also define
	CONFIG_SSL_DIGEST variable that will be useful when we add our own
	(optional) MD5 implementation.  

Sun Nov 14 21:26:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Make EL_CHECK_OPTIONAL_LIBRARY() macro more generally useful by
	moving command line argument declaration to new wrapper
	EL_CONFIG_OPTIONAL_LIBRARY().  

Sun Nov 14 19:57:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	Define MD5_DIGEST_LENGTH if it is not. GNU TLS doesn't.  

Sun Nov 14 19:46:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Revert part of a logic change involving the checking of HTTP Digest.  

Sun Nov 14 19:42:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/auth.h:

	Describe the boolean members of struct auth_entry.  

Sun Nov 14 19:16:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	convert_hex(): Take a unsigned char buffer with length
	MD5_DIGEST_LENGTH + 1.  

Sun Nov 14 18:57:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/auth.h:

	Only the user, password and host part is supposed to be used in this
	URI. It is mainly a convenient way to store host info so later when
	finding auth entries it can be compared as a reference against the
	current URI that needs to send authorization.  

Sun Nov 14 18:51:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: auth/digest.c, auth/digest.h, http/http.c:

	digest_calc_response(): Take the response URI as an argument. Now
	redirecting and navigation works.  

Sun Nov 14 18:48:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	random_cnonce(): Make it use MD5() so convert_hex() only works on
	buffers with length MD5_DIGEST_LENGTH.  

Sun Nov 14 18:46:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/auth.c:

	Reformat comment.  

Sun Nov 14 18:46:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Avoid URI mismatching in digest requests although redirects are not
	supported.  

Sun Nov 14 18:00:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	When reloading use loading_callback and set up a session task so
	that the reloading will work even when the reloaded document
	contains redirects. This is needed atleast when reloading HTTP auth
	document after the user has entered credentials.  
	
	Is there any issues with this? Maybe ses_goto() could be used.  

Sun Nov 14 16:52:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Fix HTTP auth digest compilation when CONFIG_SSL is disabled.  

Sun Nov 14 15:59:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/digest.c:

	s/17/MD5_DIGEST_LENGTH + 1/.  

Sun Nov 14 15:49:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: auth/auth.c, auth/auth.h, auth/dialogs.c,
	auth/digest.c, auth/digest.h, ftp/ftp.c, http/http.c:

	s/http_auth_basic/auth_entry/ now that HTTP digest and FTP uses it
	too.  

Sun Nov 14 15:43:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/: auth.h, digest.c:

	Standardize auth/digest.c header. Only .c files is supposed to
	include elinks.h and if they do it before elinks .h files no .h file
	needs to include elinks.h 

Sun Nov 14 15:39:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: auth/auth.c, http/http.c:

	Add closure to the move of the HTTP basic auth string to the HTTP
	protocol. This was what I meant. It fixes also an uncheck return
	value.  

Sun Nov 14 15:37:22 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/auth/auth.h:

	Fixed includes.  

Sun Nov 14 15:27:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: Makefile.am, auth/Makefile.am, auth/digest.c:

	Only compile and add auth/digest.o when CONFIG_SSL is enabled.  

Sun Nov 14 15:20:28 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/Makefile.am:

	Link with digest.o only when SSL is enabled. Not tested.  

Sun Nov 14 15:18:30 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/auth/digest.c:

	Ansi C fixes.  

Sun Nov 14 15:16:19 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/http/http.c:

	- Include digest.h only with SSL enabled 

Sun Nov 14 14:28:20 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/auth/: auth.c, auth.h:

	Sorry, forgot about those.  

Sun Nov 14 14:21:58 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/http/http.c:

	Digest auth works for first time for my public_html, but the rest
	needs more work.  

Sun Nov 14 14:17:18 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/: Makefile.am, auth/Makefile.am, auth/digest.c,
	auth/digest.h:

	Digest auth part IV.  

Sun Nov 14 13:43:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Reduce indentation of the digest extraction code.  

Sun Nov 14 11:40:34 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Unify kbdprefix.repeat_count stuff and loops, later it will help.
	Take in account the return value of move_(up|down)() in the loop.  

Sun Nov 14 11:25:22 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	move_(up|down)() now return enum frame_event_status.  

Sun Nov 14 11:21:48 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/http/http.c:

	Digest part III.  

Sun Nov 14 11:10:51 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Use a decimal-compatible prefix count limit: 99999.  

Sun Nov 14 11:02:16 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/: auth/auth.c, auth/auth.h, ftp/ftp.c, http/http.c:

	More preparation for digest auth.  

Sun Nov 14 10:32:55 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/auth/: auth.c, auth.h:

	Preparation for digest authentication.  

Sun Nov 14 10:24:00 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Nov 14 09:11:44 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Sun Nov 14 03:23:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/info.c, document/document.c:

	Report number of refreshing documents by using
	formatted_info(INFO_TIMERS).  

Sun Nov 14 03:14:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	Resource dialog: 'Document cache: %d formatted, %d locked' is
	shorter and hopefully more precise.  

Sun Nov 14 03:10:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	Climb mount bloat and plant a oneliner in the resource dialog
	informing about terminal status, interlinked terminals and number of
	sessions.  

Sun Nov 14 02:53:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	Resource info dialog: Make the allocated memory info a one liner and
	show the truly allocated values as 'overhead' in bytes and
	percentage.  

Sun Nov 14 02:43:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	s/get_ressource_info/get_resource_info/.  

Sun Nov 14 02:42:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	get_ressource_info(): Tidy up.  

Sun Nov 14 02:41:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	Resource info dialog: The 'Cache size' can be derived from the
	'Memory cache' lines first entry so ditch it.  

Sun Nov 14 01:14:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/: info.c, menu.c:

	Merge the Resource and Memory info dialogs. Makes it easier to check
	what happends when testing on mangle.cgi. Plus I never really saw
	the point of having those two separated.  

Sun Nov 14 01:02:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	get_ressource_info(): Use string utils instead of msg_text().  

Sun Nov 14 00:15:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	do_action(): Update comments.  

Sun Nov 14 00:11:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	do_action(): Alphabetize action handling in the switch. Quit the
	default label.  

Sat Nov 13 21:51:35 2004  Laurent Monin <zas@norz.org>:

	* src/sched/action.c:

	When CONFIG_MARKS is undefined, do not set status to
	FRAME_EVENT_REFRESH, just use the default which is FRAME_EVENT_OK.  

Sat Nov 13 20:27:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	do_action(): Don't touch the @ses variable if the status is
	FRAME_EVENT_SESSION_DESTROYED. Maybe it was causing bug 563.  

Sat Nov 13 20:10:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/README:

	Try to rewrite and complement a few sections.  

Sat Nov 13 13:33:50 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* configure.in:

	Check for isdigit.  

Sat Nov 13 13:31:54 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/osdep/: stub.c, stub.h:

	Own definition of isdigit.  

Sat Nov 13 13:09:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Safety boots required when entering do_action().  

Sat Nov 13 02:22:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	Fix missing linebreak when ending a list efter an empty list item.  

Fri Nov 12 22:54:45 2004  Laurent Monin <zas@norz.org>:

	* src/sched/action.c:

	FRAME_EVENT_OK is the default, so drop useless assignment.  

Fri Nov 12 22:49:26 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	move_document_(start|end)() now return enum frame_event_status.  

Fri Nov 12 22:20:01 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	move_link() and move_link_(next|prev)() now return enum
	frame_event_status.  

Fri Nov 12 22:10:24 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	move_link_(dir|up|down|left|right) now return enum
	frame_event_status.  

Fri Nov 12 22:01:08 2004  Laurent Monin <zas@norz.org>:

	* src/sched/action.c:

	Reduce indentation level.  

Fri Nov 12 21:52:48 2004  Laurent Monin <zas@norz.org>:

	* src/sched/action.c:

	Simplify things a bit using variables @anonymous and @has_vs.  

Fri Nov 12 21:32:20 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Fix (horizontal|vertical)_scroll(), they must return
	FRAME_EVENT_REFRESH when doc_view->vs->(x|y) were modified. Spotted
	by Miciah.  

Fri Nov 12 17:33:19 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	move_page_(up|down)() now return enum frame_event_status.  

Fri Nov 12 17:28:39 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: view.c, view.h:

	move_(up|down)() were made static.  

Fri Nov 12 17:24:44 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	move_cursor(): reflect changes related to
	(horizontal|vertical)_scroll(). Please check carefully.  

Fri Nov 12 17:19:10 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Propagate (horizontal|vertical)_scroll_() changes.  

Fri Nov 12 17:15:29 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	(horizontal|vertical)_scroll_() now return enum frame_event_status.  

Fri Nov 12 17:11:36 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	scroll_*() now return enum frame_event_status. Related changes to
	do_action() were made.  

Fri Nov 12 17:03:51 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	scroll_mouse_*() now return an enum frame_event_status.
	frame_ev_mouse() was modified to reflect that.  

Fri Nov 12 16:48:30 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	frame_ev_mouse(): clear things a bit, behavior unchanged.  

Fri Nov 12 16:24:52 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	frame_ev_kbd(): just return FRAME_EVENT_IGNORED at the end.  

Fri Nov 12 16:16:22 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	frame_ev_kbd(): cache value of document.browse.accesskey.priority
	option.  

Fri Nov 12 16:10:23 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	move_link(): do not test twice for current_link == wraparound_bound.  

Fri Nov 12 16:07:35 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	move_link(): Get document.browse.links.wraparound option value only
	once and only if needed.  

Fri Nov 12 13:45:59 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	Prevent an assertion failure in ecmascript_eval() (bug 558), may be
	incorrect. Pasky please check.  

Fri Nov 12 11:20:02 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	send_kbd_event(): attempt to make code clearer. @doc_view == NULL
	case looks like to not be handled in last part.  

Fri Nov 12 11:06:28 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	send_kbd_event(): let code breath a bit, @m -> @win.  

Fri Nov 12 10:52:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/file.c:

	stat_size(): Fix typo and improve the comment.  

Fri Nov 12 10:06:15 2004  Laurent Monin <zas@norz.org>:

	* src/globhist/globhist.c:

	Increase the size of input buffer to a more reasonable value.  

Fri Nov 12 09:49:04 2004  Laurent Monin <zas@norz.org>:

	* src/: cookies/cookies.c, globhist/globhist.c, util/time.h,
	util/ttime.h:

	Introduce str_to_ttime() wrapper instead of using atol() directly,
	since this one is surely non portable as Miciah told.  

Fri Nov 12 09:42:22 2004  Laurent Monin <zas@norz.org>:

	* src/globhist/globhist.c:

	read_global_history(): cleanup and code simplification.  

Fri Nov 12 09:38:43 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Move @cookies_nosave setting outside the while() loop.  

Fri Nov 12 02:39:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/file.c:

	stat_size(): Tidyup the unsigned long cast. Try to explain the two
	ulongcat() calls that Miciah was pondering about.  

Fri Nov 12 02:26:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/file.c:

	stat_size(): Fix bad logic involving checking unsigned long
	overflow.  

Thu Nov 11 20:31:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/text.c:

	#undef is_unsplitable after it has fulfilled its purpose.  

Thu Nov 11 20:29:40 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	In draw_menu_left_text_hk, transform |x < w + !!hk_state| to |x -
	!!hk_state < w| to better represent the abstract condition: the
	co-ordinate of the character to be printed must be less than the
	width of the available space, and if there was a hotkey marker, do
	not count it towards that co-ordinate.  

Thu Nov 11 20:20:39 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	In draw_menu_left_text_hk, rename the local variable hk to hk_state 
	to better indicate its usage.  

Thu Nov 11 19:50:38 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Nov 11 19:40:08 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/inpfield.c:

	In kbd_field, after handling the copy-clipboard action, return
	EVENT_PROCESSED rather than EVENT_NOT_PROCESSED.  

Thu Nov 11 19:31:09 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Thu Nov 11 19:05:30 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cookies/cookies.c:

	In del_from_cookie_list, drop the local variable tmp and instead
	operate directly on the passed pointer.  

Thu Nov 11 19:04:39 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cookies/cookies.c:

	Halve the indirection to the cookie passed to del_from_cookie_list.  

Thu Nov 11 19:02:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cookies/cookies.c:

	Substitute foreachsafe for foreach where the loop calls
	del_from_cookie_list.  

Thu Nov 11 18:59:00 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Drop an extra newline at the end of the same option description.  

Thu Nov 11 18:58:02 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Change the description of terminal._template_.colors not to
	erroneously indicate that the environment variable TERM must have a
	certain value for 256 color support and instead just to say that
	ELinks will use XTerm RGB codes.  

Thu Nov 11 00:07:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	How embarressing that these ancient encoding macros are still in
	use. Vive la CONFIG_*.  

Wed Nov 10 23:49:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Add some probation code for detecting infinite loops in URI
	translation. Idea by lindi-, which apparently doesn't trust the
	current code much. ;) 

Wed Nov 10 23:16:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Rearrange the code where the strange bug 559 fails.  

Wed Nov 10 22:41:39 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Introduce del_from_cookie_list() and reduce code redundancy.  

Wed Nov 10 22:19:42 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	accept_cookie(): @d -> @c, @e -> @tmp and make them more local.  

Wed Nov 10 22:17:36 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	accept_cookie(): @c -> @cookie.  

Wed Nov 10 22:10:04 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	send_cookies(): minor cleanup.  

Wed Nov 10 22:09:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Pop up 'Bad URL' error dialog if get_hooked_uri() returns NULL for
	non-remote sessions instead of bailing out. It was reproducable when
	passing URIs like http://?.  

Wed Nov 10 21:53:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Bail out if host is missing and slash after host is missing. Should
	fix bug 561 about infinite loop in translate_url().  

Wed Nov 10 21:31:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Decode the URI string used for titles.  

Wed Nov 10 21:30:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Decoded any document title derived from an URI string. Add check for
	allocation failure.  

Wed Nov 10 21:22:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, document/renderer.c, protocol/data.c,
	protocol/uri.c, protocol/uri.h, protocol/file/cgi.c,
	protocol/file/file.c, protocol/gopher/gopher.c, sched/download.c,
	viewer/text/link.c:

	Make decode_uri_string() take {struct string *} arg and introduce
	decode_uri() which just takes char pointer. Should make it a little
	easier to figure out.  

Wed Nov 10 21:20:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Fix typo in comment.  

Wed Nov 10 21:08:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: gopher/gopher.c, nntp/connection.c,
	nntp/response.c:

	Remove unneded system #includes.  

Wed Nov 10 20:06:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Improve handling of URI_ERRNO_NO_SLASHES to check how many slashes
	is missing.  

Wed Nov 10 20:00:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix off by one error in the URI sanitizers.  

Wed Nov 10 19:57:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Trim trailing '.'s in the host component of URIs.  

Wed Nov 10 19:24:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	is_domain_security_ok(): Test if @domain is a 'complete' substring
	of @server by comparing the lengths of the two strings. Eliminates
	one strncasecmp().  

Wed Nov 10 19:15:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	is_domain_security_ok(): Simplify the test of @domain being a
	substring of @server.  

Wed Nov 10 18:39:44 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/http/http.c:

	s/uncompress/decompress/ Even smaller first read in decompress_data.
	If this doesn't help code will need rewrite.  

Wed Nov 10 17:43:01 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Clarify is_in_domain().  

Wed Nov 10 17:26:27 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Rename check_domain_security() to is_domain_security_ok(). Idea by
	Lindi.  

Wed Nov 10 17:21:52 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Fix wrong returned value in check_domain_security().  

Wed Nov 10 17:20:01 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Fix wrong format string in cookies debugging code.  

Wed Nov 10 16:47:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/win32/win32.c:

	Minor space tidyup.  

Wed Nov 10 16:46:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/dialogs/menu.c, src/sched/download.c:

	URL decode filenames when saving. Patch by Omar Khayam
	<omark@cyentec.com>.  

Wed Nov 10 15:58:01 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Simplify cookie loading code, and fix debugging cookie code (causing
	segfault).  

Wed Nov 10 15:47:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/ftp/ftp.c, sched/download.c:

	Remove silly |return;| statements at end of functions.  

Wed Nov 10 15:44:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/conv.c:

	Let arithmic operators breathe.  

Wed Nov 10 12:25:18 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Use intermediate variable @path to shorten lines.  

Wed Nov 10 12:16:41 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	cookie->secure is 0 by default so no need to set again.  

Wed Nov 10 12:11:40 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Code related to cookie expiration was rewritten and simplified,
	preventing useless allocation when max_age is 0.  

Wed Nov 10 11:39:21 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Minor tidy up.  

Wed Nov 10 11:06:35 2004  Laurent Monin <zas@norz.org>:

	* src/: config/options.inc, cookies/cookies.c, dialogs/options.c,
	protocol/data.c, protocol/http/http.c, protocol/http/http.h,
	protocol/smb/smb.c, sched/connection.c, util/conv.c:

	Whitespaces fixes.  

Tue Nov  9 14:42:42 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Reduce code redundancy by introducing move_cursor_rel().  

Tue Nov  9 13:59:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/nntp/response.c:

	Markup the shown NNTP headers with <b> instead of <i>.  

Tue Nov  9 13:56:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Align the search input-field with the rest of the gopher menu text.
	Shorten the searchable gopher index page.  

Tue Nov  9 12:21:38 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/header.c:

	Rewrite parse_header() to be more tolerant about header syntax,
	especially tab chars and separators. It should partially fix bug
	439. Please test heavily.  

Tue Nov  9 05:47:19 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Translation update.  

Tue Nov  9 01:39:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Only encode slashes if there are two successive ones. It gets too
	ugly with %2F's in globhist.  

Tue Nov  9 01:02:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Add support for gopher index searching by introducing a little
	(HTTP) GET method extension. Now a text-input form-field is shown
	for gopher index menu entries and index pages.  

Tue Nov  9 00:33:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Fix off by one error in the query string calculation.  

Mon Nov  8 23:51:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Fix issue with handling links like
	gopher://gopher.floodgap.com/hURL:http://www.floodgap.com/ where the
	slashes in the selector apparently has to be encoded as well.  

Mon Nov  8 22:15:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man1/elinks.1.in:

	Update elinks(1) manpage with new names of options. Head-shakingly
	ignoring that alot of new options are not listed. ;) 

Mon Nov  8 22:11:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Don't declare hidden options as unknown. All of them are handled by
	the redir_cmd(). Fixes problem with -stdin mentioned in bug 557 so
	it now warns about it being deprecated.  

Mon Nov  8 21:55:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/draw.c:

	Restart the document refreshing when rerendering.  

Mon Nov  8 20:16:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	I think this is a fix for incorrect generating of title. It does not
	cause crash, but excessive memory allocation. Part of mikulas batch
	of fixes in links-1.0pre12 for bugs discovered with mangleme
	<http://lcamtuf.coredump.cx/mangleme/mangle2.cgi>.  

Mon Nov  8 19:41:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/signals.c:

	Use pid_t for storing return value of getpid().  

Mon Nov  8 19:37:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/signals.c:

	Fixed bad error codes because of errno modified by signal handler.
	Patch by user in links-1.0pre9.  

Mon Nov  8 19:27:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/listmenu.c, bfu/menu.c, bfu/style.c,
	document/html/renderer.c, document/sgml/scanner.c,
	mime/backend/common.c, mime/backend/mimetypes.c, modules/module.c,
	modules/module.h, osdep/newwin.c, protocol/uri.c:

	19:38 < Miciah> We have several foreach macros that follow a pattern
			of |for (...) if (...)| or |foreach (...) if (...)|.  
			That will not work so well when somebody does: 
			if (frink) foreach_foo (x, y) frob(x); else wooble; 
	
	... so I made this patch that puts {} to reduce ambiguity.  

Mon Nov  8 19:15:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Reset the ses->redirect_cnt in ses_goto() rather than in do_move() 
	and make it depend on the @redir variable. It apparently fixes a bug 
	triggered when clicking on broken links that after five times would 
	display the redirect itself.  
	
	Patch by user in links-1.0pre5.  

Mon Nov  8 17:04:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: encoding/encoding.c, util/file.c:

	Fix overflow when accessing local files >= 2G. Patch by user in
	links-1.0pre9.  

Mon Nov  8 16:47:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Allow '@' in the password URI-component. Patch by user in
	links-1.0pre5.  

Mon Nov  8 16:15:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/osdep/stub.c, src/osdep/stub.h:

	Add stub function for raise(). Inspired by Wojciech Puchar
	<wojtek@tensor.3miasto.net>'s 'Portability fixes for SunOS' in
	1.0pre11.  

Mon Nov  8 15:52:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	Make sure the user is notified if initialization of the first
	session fails.  

Mon Nov  8 15:42:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/osdep.c, osdep/beos/beos.c, osdep/win32/win32.c,
	protocol/file/cgi.c, protocol/smb/smb.c:

	Use pid_t for storing return value of fork(). Inspired by Mikulas in
	1.0pre9.  

Mon Nov  8 15:36:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Introduce check_cwd() that will chdir(getenv("HOME")) if CWD cannot
	be stat()'ed. Inspired by Mikulas in 1.0pre9.  

Mon Nov  8 14:57:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Remove code for reporting 'URL expected after -{dump,source}' errors
	that was not working correctly after the introduction of URL list
	support. It was duplicated in src/main.c (1.223 -> 1.224).  

Mon Nov  8 14:24:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/encoding.c:

	It looks like the workaround for reading zero bytes to invalid
	address on Linux by adding one byte is not needed anymore. Inspired
	by Mikulas in the links-1.0pre9.  

Mon Nov  8 03:36:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	decode_color(): Another small sanity check for strtoul() return
	value. Inspired by Mikulas in the links-1.0 prereleases.  

Mon Nov  8 02:57:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	get_width(): Add sanity check for strtoul() return value. Inspired
	by Mikulas in the links-1.0 prereleases.  

Mon Nov  8 02:43:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/unix/unix.c:

	Add sanity check for GPM coordinate calculation. Inspired by Mikulas
	in the links-1.0 prereleases.  

Mon Nov  8 02:12:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Make it hopefully a little easier to see what is going one with the
	CR-LF concatenation.  

Mon Nov  8 01:57:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Report 'URL expected after -{dump,source}' error. Inspired by
	Mikulas in the links-1.0 prereleases.  

Mon Nov  8 01:38:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Fix wrong HTTP error code reporting when server returns 204. Patch
	by Mikulas; backported from links-1.0 prereleases.  

Mon Nov  8 01:28:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/charsets.c:

	Tidyup from links-1.0 prereleases.  

Mon Nov  8 00:31:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/forms.c:

	html_select(): Fix leak when two <select multiple=elements> appears
	successively. (bug 552) 

Sun Nov  7 17:39:45 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/http/http.c:

	Smaller first read. If you still get garbage make it smaller.  

Sun Nov  7 13:27:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Guard do_frame_action() calls with checks for doc_view->vs as it is
	asserted to be non-NULL.  

Sun Nov  7 09:25:50 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Minor code simplification.  

Sun Nov  7 00:23:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* contrib/Makefile.am:

	Add the spidermonkey patch to EXTRA_DIST.  

Sat Nov  6 13:48:13 2004  Laurent Monin <zas@norz.org>:

	* doc/small.txt:

	Small/static ELinks compilation guide was updated a bit.  

Sat Nov  6 13:40:01 2004  Laurent Monin <zas@norz.org>:

	* src/osdep/unix/unix.c:

	Do not try to include gmp.h header file when --without-gpm is used.  

Fri Nov  5 23:02:28 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	Minor code cleanup.  

Fri Nov  5 15:35:50 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	fastfind_new_cnode() was renamed compress_node(),
	fastfind_node_compress() was renamed compress_tree().  

Fri Nov  5 15:31:08 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Move code from fastfind_node_compress() to new fastfind_new_cnode(),
	and add number of compressed nodes to debug output.  

Fri Nov  5 06:00:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Factor common code in is_in_range_regex and get_searched_regex out
	to the new get_search_region_from_search_nodes, which copies the
	characters from a range of search nodes, adds new-line characters, 
	and returns the new string.  

Fri Nov  5 03:50:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Remove an obsolete TODO for reporting regex compilation errors.  

Fri Nov  5 03:32:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, protocol/protocol.c,
	protocol/smb/smb.c, protocol/smb/smb.h:

	Add SMB protocol module.  

Thu Nov  4 21:10:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/file/cgi.c, protocol/finger/finger.c,
	protocol/gopher/gopher.c, protocol/http/http.c,
	protocol/nntp/connection.c, ssl/connect.c:

	Try to document read_buffer->close by introducing read_buffer_close
	enum.  

Thu Nov  4 17:17:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/navigator.h:

	Bump DOM_NAVIGATOR_MAX_DEPTH to 4096 making it highlight
	http://www.usdoj.gov/atr/cases/f1900/1914.htm more correctly.  

Thu Nov  4 17:14:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/navigator.c:

	push_dom_node(): Don't call done_dom_node(@node) when navigator
	depth is bigger than DOM_NAVIGATOR_MAX_DEPTH. It is the
	responsibility of the caller. Fixes crash on
	http://www.usdoj.gov/atr/cases/f1900/1914.htm caused by the current
	SGML parser naively expects closing tags.  

Thu Nov  4 14:22:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/navigator.c:

	Fix callback extractions and add assertion about the DOM node type.  
	
	It looks like http://www.usdoj.gov/atr/cases/f1900/1914.htm is
	creating corruption in the navigator.  

Thu Nov  4 13:44:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10pre3.CVS 

Thu Nov  4 13:17:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10pre3 

Thu Nov  4 13:15:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	Sync .po files.  

Thu Nov  4 13:10:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Fix version.  

Thu Nov  4 13:07:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/tools/help2doc:

	Fix elinks version extraction.  

Thu Nov  4 13:02:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Thu Nov  4 12:50:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Alphabetize Makefile creation.  

Thu Nov  4 09:59:55 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/header.c:

	Add comments and documentation related to bug 549.  

Wed Nov  3 18:03:57 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Clarify things related to LF+NUL termination chars, and prevent a
	potential bug.  

Wed Nov  3 17:48:25 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Properly close sockets in case of init_string() failure, may be
	useless in that case but cleaner.  

Wed Nov  3 17:40:35 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Move code from end_smb_connection() to new parse_smbclient_output().  

Wed Nov  3 17:20:36 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Use intermediate variable of type struct uri * to shorten lines.  

Wed Nov  3 17:19:21 2004  Laurent Monin <zas@norz.org>:

	* src/util/string.c:

	Reduce indentation level, tidy up.  

Wed Nov  3 11:16:05 2004  Laurent Monin <zas@norz.org>:

	* src/util/string.c:

	straconcat(): do not call memcpy() if there is nothing to copy.  

Wed Nov  3 11:12:02 2004  Laurent Monin <zas@norz.org>:

	* src/util/string.c:

	Optimize straconcat() a bit using memcpy() instead of strcat().  

Tue Nov  2 09:34:09 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/msgbox.c:

	Minor tidyup, reduce indentation level.  

Mon Nov  1 22:22:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: options.h, options.inc:

	A few gcc-4 compatibility fixes from Kalle Olavi Niemitalo
	<kon@iki.fi>.  

Sat Oct 30 02:21:43 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	When performing a type-ahead search on document text, do not rewind
	just because the search wrapped.  

Fri Oct 29 23:07:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Fix leak when ecmascript is disabled.  

Fri Oct 29 20:07:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Fix insert mode resetting when submitting text-input form-field.
	Introduced in 1.244 and spotted by Mr. Timo Lindfors.  

Thu Oct 28 16:20:27 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Simplify code by using new struct ff_data.  

Wed Oct 27 22:35:05 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/parser/parse.c, intl/charsets.c,
	util/color.c, util/fastfind.c, util/fastfind.h:

	Make FastFind more data-driven. Patch by Jonas and me.  

Wed Oct 27 20:18:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: parser.c, parser/link.c:

	Remove unneeded #includes.  

Wed Oct 27 17:21:14 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Modify example to reflect recent changes in fastfind API.  

Wed Oct 27 17:17:45 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/parser/parse.c, intl/charsets.c,
	util/color.c, util/fastfind.c, util/fastfind.h:

	Use a flags parameter of new type enum fastfind_flags instead of two
	parameters of type integer for fastfind_index().  

Wed Oct 27 16:57:01 2004  Laurent Monin <zas@norz.org>:

	* src/util/: fastfind.c, fastfind.h:

	Drop fastfind_index_compress(), and make fastfind_index() call
	fastfind_node_compress() directly.  

Wed Oct 27 16:52:51 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/parser/parse.c, intl/charsets.c,
	util/color.c, util/fastfind.c, util/fastfind.h:

	Add a @compress parameter to fastfind_index() and let it call
	fastfind_index_compress() before returning.  

Wed Oct 27 16:45:28 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Make fastfind_node_compress() static.  

Wed Oct 27 16:38:10 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Rename label |alloc_error| to |return_error| since we may go to it
	on errors which are not allocation errors.  

Wed Oct 27 15:11:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Add data the conventional way if rb->close == 2, so the HTML
	document ending is added but ensure that the connection is shutdown
	afterwards.  

Wed Oct 27 15:04:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Fix assertion failure when get_gopher_entity_description() returns
	NULL. Fix error response message hyperlinking.  

Tue Oct 26 21:36:38 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Fix comment.  

Tue Oct 26 21:32:35 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Optimize pointers/keylen_list allocation: alloc_pointers() does it
	in one step using info->count obtained by precedent loop, simplify
	add_to_pointers().  

Tue Oct 26 21:04:49 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Group debugging code.  

Tue Oct 26 20:52:26 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Move debug code from fastfind_search() to new FF_DBG_search_stats().  

Tue Oct 26 17:03:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	Revert 1.77 and 1.78. It is reversing tab placement.  

Mon Oct 25 20:31:16 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Trivial cleanup: tab/space fixes, move iterator initialization to
	for(), move debug code from fastfind_done() to new
	FF_DBG_dump_stats().  

Mon Oct 25 20:08:45 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	fastfind_index(): minor cleanup, drop useless @j, move comment near
	ifcase().  

Mon Oct 25 19:41:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/terminal/tab.c:

	How does it behave now? 

Mon Oct 25 19:14:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/terminal/tab.c:

	Keep tabs together in term->windows. Fixes problems with stuck
	dialogs when new tab was opened over them. Hoefpully.  

Mon Oct 25 19:10:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/terminal/: event.c, window.c:

	Reverted my tab/window ordering hacks resulting in sometimes bad
	behaviour, as suggested by Jonas. I figured a wrong solution to my
	problem.  

Mon Oct 25 16:00:55 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Improve fastfind debug output a bit.  

Mon Oct 25 15:52:32 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Use memchr() in char2idx() and reduce code redundancy a bit.  

Mon Oct 25 12:56:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: ecmascript/spidermonkey.c, terminal/terminal.h:

	Define ENV_ANY value.  

Mon Oct 25 12:41:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/spidermonkey.c:

	window_open(): Simplify URI unreferencing and fix a bug.  

Mon Oct 25 10:29:55 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/table.c:

	Minor optimization: move @size test before the loop.  

Mon Oct 25 10:20:35 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/table.c:

	Drop useless parenthesis.  

Mon Oct 25 10:16:43 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/table.c:

	Move code from new_cell() to new copy_table().  

Mon Oct 25 09:59:09 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/table.c:

	Optimize copy of cells to new table in new_cell(): copy rows by rows
	instead of cells by cells, it speedups things a lot.  

Mon Oct 25 09:06:01 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Oct 23 12:49:18 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Sat Oct 23 11:40:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/terminal/window.c:

	Add windows to the top of the stack, not at the near-bottom.  

Sat Oct 23 11:06:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/terminal/: event.c, window.c:

	Properly handle having windows open inside of inactive tabs (that's
	the case for window.open() in conjuction with window.alert() or
	javascript errors).  

Sat Oct 23 10:04:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Whatever that JS_ClearPendingException() is good for... Moz has it.  

Sat Oct 23 09:53:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	FIXME about the real need to keep adjectent links as separate links
	now since we got event handlers.  

Sat Oct 23 09:53:02 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/forms.c:

	html_focusable() only the new element created for the form control;
	this makes the event handlers to work.  

Sat Oct 23 09:48:10 2004  Petr Baudis <pasky@ucw.cz>:

	* test/ecmascript/ontest.html:

	Some simple event hooks test.  

Sat Oct 23 08:04:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/renderer.c, document/css/css.c, sched/session.c:

	Try to break ELinks completely again by also checking for redirected
	scripts/CSSes properly.  

Sat Oct 23 07:54:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cookies/cookies.h:

	Fix misleading send_cookies() description.  

Sat Oct 23 00:01:34 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Slightly reduce code redundancy, introducing free_cookies_list().  

Fri Oct 22 23:55:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/: string.c, string.h:

	Register the caller of init_string() when memory leak debugging is
	enabled. Makes it much easier to locate leaks.  

Fri Oct 22 23:53:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/spidermonkey.c:

	The cookie string is allocated so use JSPT_ASTRING as the property
	type.  

Fri Oct 22 20:15:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/html/renderer.c, document/html/parser/forms.c,
	viewer/text/form.c, viewer/text/form.h:

	Button (known as FC_BUTTON) is now a good member of the form
	controls community! We want it to live as a regular button now
	because there may be event hooks on it. (And I never really liked
	magic executed on it.) 

Fri Oct 22 18:49:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	s/exception/<appropriate_desc>/ for linebufless js errors too.  

Fri Oct 22 18:47:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	JS_ClearPendingException() at the tail of error reported. This
	might've helped with carrying over those exceptions, but it doesn't
	quite work yet, seemingly.  

Fri Oct 22 10:39:19 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/table.c:

	Move code from parse_table_attributes() to new set_table_rules(),
	reducing indentation and clarifying code.  

Fri Oct 22 10:36:18 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/table.c:

	Move code from parse_table_attributes() to new set_table_frame(),
	reducing indentation and clarifying code.  

Fri Oct 22 10:16:41 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/table.c:

	Reduce indentation level.  

Fri Oct 22 09:56:41 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c, src/ecmascript/spidermonkey.c,
	src/protocol/http/README.timegm, NEWS:

	Remove trailing spaces.  

Fri Oct 22 07:59:43 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/stack.c:

	Introduce kill_element() and drop two gotos.  

Fri Oct 22 07:36:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Enhance error reporting to report what kind of thing it actually is,
	and SetOptions VAROBJFIX and COMPILE_N_GO, which should improve
	things and fix language-wise buggy behaviour. Sorry for combining
	those two trivial patches, I'm in hurry.  

Thu Oct 21 23:22:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/ecmascript.c:

	If allocating vs->ecmascript doesn't work out, set
	vs->ecmascript_fragile so that we try again the next time.  

Thu Oct 21 23:18:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/ecmascript.c:

	doc_view->vs->ecmascript is on-demand.  

Thu Oct 21 23:11:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	In delayed_goto(), deg->vs->doc_view might get NULL.  

Thu Oct 21 23:11:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Some semi-dirty document.cookie support.  

Thu Oct 21 21:18:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/main.c:

	Prevent ECMAScript code execution when using -dump or -source.
	Magically fixes bug 538.  

Thu Oct 21 21:01:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	TODO: Provide info about script event hooks too.  

Thu Oct 21 20:54:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/document.c, document/document.h,
	document/html/parser.c, document/html/parser.h,
	document/html/renderer.c, document/html/parser/stack.c,
	viewer/text/link.c:

	Theoretical (not much tested and not always working) support for
	onClick, onDblClick, onMouseOver, onHover, onFocus, onMouseOut and
	onBlur ECMAScript events on focusable elements.  

Thu Oct 21 20:52:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Fix a virtually possible crash if a sub-frame referenced a top frame
	while the top frame had no ecmascript handle, since the ecmascript
	handles are now created on-demand.  

Thu Oct 21 20:50:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	window.<blahblah> now tries to resolve blahblah as frame id and
	returns the appropriate one's reference if found. Finally fixes
	http://www.cinema-ostertor.de/.  

Thu Oct 21 17:36:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	s/port_end == host_end/uri->portlen == 0/ is more clear.  

Thu Oct 21 17:03:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Remove ':' from URIs when no port number follows using
	URI_ERRNO_NO_PORT_COLON error value. Hmm maye we should consider
	loosing up the URI comparison on the other hand it is nice to have
	these trivial error show up.  

Wed Oct 20 17:55:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/: gettext.m4, iconv.m4:

	Append LIBICONV to LIBS instead of INTLLIBS. It was causing
	dependency problems when linking. Brougt up by Nelson H. F. Beebe
	<beebe@math.utah.edu>.  

Wed Oct 20 16:19:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* config.guess, config.sub, config/config.guess, config/config.sub:

	Update with versions from cvs HEAD. Fixes configuration on even more
	platforms. Mentioned by Nelson H. F. Beebe <beebe@math.utah.edu>.  

Wed Oct 20 11:09:34 2004  Laurent Monin <zas@norz.org>:

	* src/: setup.h, document/html/parser/table.c:

	Limit max. memory used for table cells, and abort table parsing on
	cell allocation failure. It prevents eating of all memory in case
	where number of columns and/or rows is very high.
	HTML_MAX_CELLS_MEMORY is set to 32Mb by default.  

Wed Oct 20 08:16:35 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	Replace nul char if any by a space in html_option(), it prevents bad
	things. Revealed by remangle.cgi?0x14aa2da9.  

Wed Oct 20 01:27:02 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/action.c:

	In do_action, return FRAME_EVENT_REFRESH when handling 
	ACT_MAIN_MARK_GOTO or ACT_MAIN_MARK_SET so that the user will get
	those nice 'Enter a mark to set' and 'Enter a mark to which to jump"
	messages (see src/dialogs/status.c revision 1.80). Prior to revision 
	src/viewer/text/view.c revision 1.612, this refresh was handled by 
	send_to_frame, which calls frame_ev, which calls frame_kbd_ev, which
	had handled the aforementioned key actions.  

Tue Oct 19 23:38:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	In tp_show_header, drop the code to open a new connection and just
	use |type_query->cached|.  

Tue Oct 19 19:23:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/protocol.c:

	Fix the typo fix.  

Tue Oct 19 19:19:39 2004  Petr Baudis <pasky@ucw.cz>:

	* features.conf:

	Trim a ridiciously huge FTP description.  

Tue Oct 19 18:29:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memory.h:

	Undefine CRASH_IF_ALLOC_MAXTRIES by default (then we might give up
	on all our error handling whatsoever) and lower ALLOC_MAXTRIES to 3
	(makes no sense to try more times).  

Tue Oct 19 17:21:03 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Tue Oct 19 14:38:00 2004  Laurent Monin <zas@norz.org>:

	* src/util/: memdebug.c, memory.c, memory.h:

	Define CRASH_IF_ALLOC_MAXTRIES by default, ALLOC_MAXTRIES was
	increased from 3 to 5, ALLOC_DELAY from 1 to 3 seconds. Minor
	tidyup.  

Tue Oct 19 12:46:37 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/table.c:

	Check if @span_cell is NULL before using it.  

Tue Oct 19 10:24:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/table.c:

	Also put an upper limit on <col span=value> and <colgroup
	span=value>. Fixes mozilla_die3.html in the browser test suite of
	horror.  

Tue Oct 19 09:35:30 2004  Laurent Monin <zas@norz.org>:

	* src/mime/backend/mimetypes.c:

	Prevent assertion failure in get_hash_item(), do not call it when
	extensionlen==0.  

Tue Oct 19 09:23:50 2004  Laurent Monin <zas@norz.org>:

	* src/: setup.h, document/html/parser/table.c:

	Limit rowspan/colspan values to HTML_MAX_(ROWSPAN|COLSPAN) set to
	32768 by default. It prevents crash reported at
	
	http://www.securityfocus.com/archive/1/378632/2004-10-16/2004-10-22/0, using links_die1.html.

Tue Oct 19 08:40:21 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	An assertion was disabled, it is triggered when checkboxes are
	pressed in bugzilla. Please recheck this one.  

Tue Oct 19 08:32:54 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/dump/dump.c:

	When saving formatted documents skip trailing spaces, fix bug 544.  

Tue Oct 19 08:09:17 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Oct 19 06:02:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	In cached_header_dialog, introduce the local variable |title| to fit
	the call to msg_box at the end of the routine within the confines of
	an eighty-column terminal without violating the unspoken rule that
	calls to msg_box must put the title and its alignment flag on the
	same line.  

Tue Oct 19 05:54:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	Give some comments that native-English-speaker touch.  

Tue Oct 19 05:50:53 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	Remove an extra space.  

Tue Oct 19 05:48:32 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	If there is nothing left after removing all CRs and trailing
	newlines, display the 'No header info' box instead of an empty
	'Header info' box.  

Tue Oct 19 05:46:04 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	Rework some gotos to save some indentation and simplify the code.  

Tue Oct 19 05:40:43 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	Delete an extra space.  

Tue Oct 19 05:40:04 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	Move the allocation of |headers| to slightly simplify memory
	management and to allow it to be localised.  

Tue Oct 19 05:34:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	Reduce intentation in cached_header_dialog by swapping an if block 
	and its implicit else block and adding a little goto magic.  

Tue Oct 19 05:28:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Fix missing '#ifndef BUG_517' -> '#ifdef BUG_517' in 1.344 as was
	pointed out by Miciah.  

Tue Oct 19 05:26:22 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	In cached_header_dialog, mem_alloc the needed memory rather than
	using stracpy as cached_header_dialog goes on to perform the copying
	itself.  

Tue Oct 19 05:23:59 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	In cached_header_dialog, use |cached->head| instead of |header|, the
	latter of which is a copy of the former, to check whether the header
	is empty and whether it begins with '\r'.  

Tue Oct 19 05:08:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/document.c, dialogs/document.h, sched/download.c:

	Export cached_header_dialog.  
	
	Introduce tp_show_header, which backs a new button in type-query
	boxes, 'Show header', and uses the new
	download_show_header_callback, which uses cached_header_dialog.  

Tue Oct 19 05:01:43 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	Factor most of protocol_header_dialog out into the new
	cached_header_dialog. protocol_header_dialog now only calls either
	nowhere_box, if the session has no location, or
	cached_header_dialog, with the return of find_in_cache.  

Tue Oct 19 04:54:22 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/document.c:

	Delete an extra blank line at the end of protocol_header_dialog.  

Mon Oct 18 05:08:40 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Use match_link_text instead of search_link_text when handling a
	redraw event in link_typeahead_handler to check whether we need to
	call draw_typeahead_match.  

Mon Oct 18 04:18:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Return TYPEAHEAD_ERROR_NO_FURTHER from do_typeahead when 
	search_link_text returns the current link as a match and the user
	has told ELinks to go to the next or previous match.  
	
	Now ELinks will tell the user that there are no further matches when
	there are no further matches, even when it loops around from the
	current match back to the current match.  

Mon Oct 18 04:12:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Return TYPEAHEAD_ERROR_NO_FURTHER instead of TYPEAHEAD_ERROR from
	do_typeahead when document.browse.search.wraparound is disabled, the
	current link matches the search pattern, and the user tells ELinks 
	to go to the next or previous match.  
	
	This avoids the repeated "Could not find a link with the text '...'" 
	messages, fixing bug 513 a little more (the previous fix only
	improved the situation when wraparound was enabled).  

Mon Oct 18 03:14:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Swap an if block and its implicit else block.  

Mon Oct 18 03:12:23 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Factor the code to match a string against a link out from
	search_link_text to the new match_link_text.  

Mon Oct 18 03:06:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Eliminate the match_link_text macro, and expand its one call, in
	search_link_text; 

Sun Oct 17 23:15:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Hmm, further improve on the checks introduced in sched/action.c
	(1.108 -> 1.109) fixing problems with moving viewer event handling
	to do_action().  

Sun Oct 17 21:36:25 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Fold a nested if statement with its container.  

Sun Oct 17 21:34:56 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Fold two redundant return statements.  

Sun Oct 17 21:33:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In try_form_action, reverse the outer if block and its implied else
	block.  

Sun Oct 17 21:31:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Revert; I wanted to go in a different direction...  

Sun Oct 17 21:29:06 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In try_form_action, initialise status to FRAME_EVENT_IGNORED and
	return status at the end of the routine instead of returning
	FRAME_EVENT_IGNORED.  

Sun Oct 17 21:25:56 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Factor the form-action code out from frame_ev to the new
	try_form_action.  

Sun Oct 17 21:05:34 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	In field_op, leave insert mode when submitting a form field.  This
	eliminates an assertion failure and, more importantly, behaves as I
	think that it should.  

Sun Oct 17 20:45:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Rename frame_ev_kbd_number to try_prefix_key.  

Sun Oct 17 20:44:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Move the check whether the key is a digit from the caller of
	frame_ev_kbd_number to frame_ev_kbd_number.  

Sun Oct 17 20:40:34 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Remove a superfluous assertion and fold two checks whether
	|ses->kbdprefix.mark| in try_mark_key.  

Sun Oct 17 20:38:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Swap an if block and its implicit else block to reduce indentation.  

Sun Oct 17 20:34:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Remove a useless comment.  

Sun Oct 17 20:33:17 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Move the #ifdef CONFIG_MARKS within try_mark_key to enclose the
	routine, and enclose the call from frame_ev_kbd to try_mark_key
	similarly.  

Sun Oct 17 20:31:29 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Factor the mark code in frame_ev_kbd out to the new try_mark_key.  

Sun Oct 17 20:21:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Unwrap a line.  

Sun Oct 17 20:20:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: link.c, link.h, view.c:

	Change the return type of try_document_key from int to enum
	frame_event_status for uniformity.  

Sun Oct 17 20:03:02 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: link.c, view.c:

	Reset |ses->kbdprefix.repeat_count| in try_document_key rather than
	in its callers.  

Sun Oct 17 17:17:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, uri.c:

	Set the free_syntax flag for unknown protocols and ditch the @known
	variable in parse_uri(). It is a relic from back when we had
	PROTOCOL_INVALID and the procotol backend accessors didn't work for
	them.  

Sun Oct 17 16:41:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix the 'too many slashed after protocol' trimming. For hostless
	URIs like file:// URIs normalize_uri() should do the trimming so
	only trim if the protocol needs a slash after the host.  

Sun Oct 17 16:21:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Fix false assertion failures introduced in
	src/viewer/text/view.c:1.618. Triggered when pasting stuff into
	textareas so now only assert if the event was handled by field_op()
	in frame_ev().  

Sun Oct 17 15:38:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Add support for trimming off too many slashed after the protocol
	name. Spotted at dictionary.com where the 'Thesaurus' and 'Web'
	links at the top redirects to 'http:///...' leading to a 'Bad URL
	syntax' error.  

Sun Oct 17 15:32:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup and remove unnecessary goto usage.  

Sun Oct 17 00:41:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Oops fix compile error.  

Sat Oct 16 23:12:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Add bug 533 near the comment added in last patch.  

Sat Oct 16 23:09:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Disable the error message about 'script ... lost in too full cache.'
	and leave a big comment.  

Sat Oct 16 20:20:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	move_current_tab(): Honour ses->kbdprefix.repeat_count so you can
	move the current tab a variable number of steps. However it doesn't
	work well for wrap around.  

Sat Oct 16 20:15:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/draw.c:

	Check the link under the cursor using new check_link_under_cursor()
	when drawing a document with cursor routing navigation enabled. This
	fixes links not being highlighted correctly when moving back and
	forth in history. It is kind of a parallel to check_vs() for
	link-wise navigation.  

Sat Oct 16 19:59:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	switch_current_tab(): Honour ses->kbdprefix.repeat_count so you can
	jump variable number of tabs. However it doesn't work well for wrap
	around due to switch_to_tab() usage.  

Sat Oct 16 19:57:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: viewer/text/view.c, sched/action.c, terminal/tab.c,
	terminal/tab.h:

	Merge switch_to_(next|prev)_tab() into switch_current_tab()
	controlled by a direction arg.  

Fri Oct 15 02:39:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Always separate the ETA part using ', ' to make it stand out.  

Fri Oct 15 01:34:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Fix the '#if 0' -> '#ifndef BUG_517' change in 1.343 to be '#ifdef
	BUG_517' since BUG_517 is undefined.  

Fri Oct 15 00:59:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Crudely add guarding checks around code updating local state
	variables. This is sledgehammer-hacks of the highest quality that
	will make your mama cry. ELinks should now not crash when rendering
	2.avi from bug 515. A lot of assertions was also added.  

Thu Oct 14 23:16:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/navigator.c:

	Assert navigator->depth >= 0.  

Thu Oct 14 20:28:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/: cache.c, cache.h:

	Merge defrag_entry() into get_cache_fragment(). It involved some
	best-effort logics for handling allocation failure; is that
	good/bad? 

Thu Oct 14 20:23:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	defrag_entry(): Add comments and prepare for next patch.  

Thu Oct 14 20:13:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Use get_cache_fragment() for document image mapping. Same goes as
	for preformatting if the document is already rendered it should also
	make sense to get the cache fragment using get_cache_fragment().  

Thu Oct 14 20:10:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Use get_cache_fragment() when preformatting. This restrict what
	fragments preformatting will attempt to work on but I hope it will
	not matter much since it is more in sync with the document rendering
	so we only preformat if we are also going to render. (I pray that
	this compiles else pasky will madly ask me to consider configuring
	--with-lua ;-) 

Thu Oct 14 20:02:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Use get_cache_fragment() for document rendering. Fixes dangerous
	dereference of the first fragment before the
	list_empty(cached->frag) check.  

Thu Oct 14 20:00:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, document/css/css.c:

	Introduce get_cache_fragment() that defragments the cache entry and
	does the sanity checks to determine whether to return the first
	fragment or NULL.  
	
	Use is for CSS import handling.  

Thu Oct 14 19:00:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/: cache.c, cache.h:

	Describe add_fragment().  

Thu Oct 14 18:50:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.h, mime/mime.c:

	Convert remaining uses of get_cache_uri() to just access
	cached->uri. I think the same applies as the previous patch namely
	that validity of the cache entry is irrelevant because we already
	access stuff like the cached header so why not also use any
	extensions from the cache entry's URI.  

Thu Oct 14 18:38:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/download.c, sched/task.c, viewer/dump/dump.c:

	Fix confusing uses of get_cache_uri() to just use cached->uri as we
	shouldn't care whether the cache entry is valid or not when using
	the URI as referrer in redirects.  

Thu Oct 14 18:32:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.h:

	Remove confusing comment pointed out by zas (I think). Move
	cache_info() to be ast and describe it and also move get_cache_uri()
	below {struct fragment} so the struct declarations are grouped.  

Thu Oct 14 18:13:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Make send_to_frame() take doc_view as an arg so its current_frame()
	call can be removed and the guarding assertion moved to frame_ev().  

Thu Oct 14 18:05:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Convert the original insert mode resetting to an assertion so future
	regressions will be caught.  

Thu Oct 14 18:04:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: action.c, session.c:

	Do the insert mode resetting in do_action() (is this the right place
	Miciah\?) and revert my previous attempt at fixing it in
	sched/session.c 1.574.  

Thu Oct 14 14:21:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	process_snippets(): Since the external reference snippet handling is
	the larger shortcut the shorter <script>code</script> snippet
	handling.  

Thu Oct 14 14:05:07 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/parser/parse.c, protocol/finger/finger.c,
	viewer/text/textarea.c:

	Use add_crlf_to_string() where applicable.  

Thu Oct 14 13:51:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	process_snippets(): No need to allocate the imported source uri
	string. onload_snippets strings are NUL terminated.  

Thu Oct 14 13:23:05 2004  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	Revert DACT(N_()) -> D_() patch, it was breaking i18n. Spotted by
	Jonas.  

Thu Oct 14 12:49:51 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/select.c:

	Reduce code redundancy by introducing can_read_or_write(), called by
	can_read() and can_write().  

Thu Oct 14 12:48:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	process_snippets(): Free the URI right after the cache lookup. Use
	{string->source + 1} instead in the error message.  

Thu Oct 14 12:41:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	process_snippets(): More usage of the local {struct string}
	variable.  

Thu Oct 14 12:35:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	process_snippets(): Lessen the operator overload by using a local
	{struct string} variable. Also short cut the snippet loop for empty
	strings.  

Thu Oct 14 12:34:37 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	Cleanup and fix debugging code, log_data() was renamed
	debug_transfer_log().  

Thu Oct 14 12:28:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Reset the session insert mode to off when changing document in
	doc_loading_callback(). Reproducable when changing document by
	posting from 'an entered' text-input form-field (that is with insert
	mode being on) all future pages would have insert mode on. Forensic
	speculation: before it was handled magically at the end of
	frame_ev() but 1.605 reindenting changes in 1.477 fixing text-input
	field handling and redrawing caused the magic code never to be
	reached. Anyway I think it makes good sense to handle it at the new
	place.  

Wed Oct 13 21:57:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.c:

	Try to call load_ecmascript_imports() foreach frame in
	load_frames(), let's see what happens. Suggested by Jonas.  

Wed Oct 13 21:50:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Silence Jonas - small reworking of external snippets references
	handling and taking care of memory allocaiton failures.  

Wed Oct 13 16:26:11 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/intl/charsets.c:

	Resolve a discrepancy in convert_string when checking whether the
	character terminating an entity is alphanumeric by using 
	isasciialpha and isdigit in place of isdigit.  

Wed Oct 13 16:12:10 2004  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	Drop DACT(N_(...)) and use shorter D_(...), defined as (N_(x)).  

Wed Oct 13 15:52:31 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Change #if 0 added to disable bzip2 code related to bug 517 to more
	explicit #ifndef BUG_517.  

Wed Oct 13 15:34:46 2004  Laurent Monin <zas@norz.org>:

	* src/: elinks.h, main.c, cookies/cookies.c, dialogs/info.c,
	dialogs/menu.c, document/css/README, document/css/apply.c,
	document/css/parser.c, document/css/stylesheet.c,
	document/css/stylesheet.h, document/dom/navigator.c,
	document/dom/node.c, osdep/os2/os2.c, terminal/hardio.c,
	util/fastfind.c, util/memdebug.c, util/memdebug.h, util/memory.c,
	util/memory.h, util/scanner.c, util/scanner.h, util/string.c,
	util/string.h:

	Uniformize debugging macros names: LEAK_DEBUG -> DEBUG_MEMLEAK,
	COOKIES_DEBUG -> DEBUG_COOKIES, CSS_DEBUG -> DEBUG_CSS, OS2_DEBUG ->
	DEBUG_OS2, HW_DEBUG -> DEBUG_HARDIO, FASTFIND_DEBUG ->
	DEBUG_FASTFIND, SCANNER_DEBUG -> DEBUG_SCANNER.  

Wed Oct 13 15:18:25 2004  Laurent Monin <zas@norz.org>:

	* src/: encoding/bzip2.c, encoding/gzip.c, util/color.inc,
	util/color_s.inc:

	Drop remaining ELINKS_SMALL, this one was replaced by CONFIG_SMALL.  

Wed Oct 13 10:00:57 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/protocol.c:

	Minor typo fix and reindentation.  

Wed Oct 13 08:28:20 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Fix buggy #ifdef IPV6 in ftp options.  

Wed Oct 13 08:17:00 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Assertion was added to catch bug 538.  

Wed Oct 13 00:30:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Some non-javascript scripts use the language attribute. I found a
	language='vbscript' at
	http://www.geocities.com/cliktoprogram/vbscript/introduction.html so
	waste time checking that the language attribute is 'javascript' with
	optional version digits postfixed (like: 'javascript1.1') 

Wed Oct 13 00:12:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/Makefile.am:

	Stack SUBDIR listing.  

Wed Oct 13 00:09:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, protocol/ftp/ftp.c:

	Move FTP options.  

Tue Oct 12 23:37:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/intl/gettext/plural.y:

	Fix parser generation from plural.y to expect 7 instead of 10
	shift/reduce conflicts. Patch by Alexey Tourbin <at@altlinux.org>.
	(bug 537) 

Tue Oct 12 23:32:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS:

	Alphabetize entries.  

Tue Oct 12 15:28:12 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/finger/: Makefile.am, finger.c, finger.h:

	Finger-related files added.  

Tue Oct 12 15:25:21 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/finger/: .cvsignore, .vimrc:

	Add .vimrc .cvsignore to finger/.  

Tue Oct 12 15:23:26 2004  Laurent Monin <zas@norz.org>:

	* configure.in, src/protocol/Makefile.am, src/protocol/finger.c,
	src/protocol/finger.h, src/protocol/protocol.c:

	Use a separate directory for finger protocol, more coherent with
	other protocols.  

Tue Oct 12 14:36:36 2004  Laurent Monin <zas@norz.org>:

	* features.conf:

	Definition of FTP protocol was added, borrowed from wikipedia.  

Tue Oct 12 14:26:47 2004  Laurent Monin <zas@norz.org>:

	* configure.in, features.conf, src/config/options.inc,
	src/protocol/Makefile.am, src/protocol/protocol.c,
	src/protocol/ftp/ftp.c, src/protocol/ftp/ftp.h, src/sched/error.c:

	Make ftp protocol a module, introducing --disable-ftp configure
	option.  

Tue Oct 12 07:52:51 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Fix memleak (@src was not always freed) introduced by bug 532 fix.  

Mon Oct 11 18:14:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Fix the fix :).  

Mon Oct 11 18:13:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Fix bug 532, crash on <script src> with NULL part->document,
	reported by zas.  

Mon Oct 11 10:25:00 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Oct 10 23:09:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/document.c, document/document.h,
	document/renderer.c, document/html/parser.c,
	document/html/parser.h, document/html/renderer.c, sched/session.c:

	<script src> support.  

Sun Oct 10 20:39:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/exmode.c:

	Gee, can't you guys grep? 

Sun Oct 10 20:36:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/vs.c:

	To avoid stability (and relieve the memory and CPU a little), in
	init_vs() just set ecmascript_fragile and let vs->ecmascript be
	created magically on demand.  

Sun Oct 10 20:33:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	assert(vs->ecmascript) only unless vs->ecmascript_fragile - in that
	case vs->ecmascript might not be created yet, we do it on-demand for
	copy_vs()'d vses.  

Sun Oct 10 20:17:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/ecmascript.c:

	assert() that at the time of ecmascript_protocol_handler(), the
	associated vs will always have its ecmascript interpreter.  

Sun Oct 10 20:17:15 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/action.c:

	In do_action, do not call the routines corresponding to the movement
	and scrolling actions when |doc_view| is NULL.  
	
	This prevents crashes when using those actions before loading any
	documents.  

Sun Oct 10 20:12:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Resurrect the assert()ion commented out as a temporary bug 521
	measure. I'm gonna trace it and find it out and nothing will stay in
	my way to justice! 

Sun Oct 10 20:08:22 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	try_jump_to_link_number: Return 0 if there is a prefix and
	|doc_view| is NULL.  

Sun Oct 10 19:31:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/inpfield.c, bfu/menu.c, viewer/text/search.c:

	input_line_event_handler: 
	
	 - Give the input line's handler a shot at EVENT_RESIZE events,
	   passing them ACT_EDIT_REDRAW, as we do for EVENT_REDRAW events.  
	
	 - Return EVENT_NOT_PROCESSED just the same, because we want 
	   input_line_event_handler's caller to perform its redraw as well.  
	
	menu_search_handler: Return immediately on ACT_EDIT_REDRAW.  
	
	exmode_input_handler: No change necessary.  
	
	text_typeahead_handler: Return immediately on ACT_EDIT_REDRAW.  
	
	link_typeahead_handler: Handle ACT_EDIT_REDRAW by redrawing the
	highlighting for search matches.  
	
	This fixes bug 530, 'Terminal resizing and Ctrl-L removes typeahead
	search highlighting'.  

Sun Oct 10 18:04:03 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/inpfield.c:

	In input_line_event_handler, when handling a redraw event, set
	|action| to |ACT_EDIT_REDRAW| instead of to |ACT_EDIT_NONE| so as to
	give the input-line handler a more semantically correct action
	value.  

Sun Oct 10 17:23:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Drop the inline keyword from draw_typeahead_match, which is big and
	has only one caller.  

Sun Oct 10 15:31:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/status.c:

	Introduce get_current_link_info_and_title and use it in
	print_screen_status to display the title of the selected link, if it
	has one, in the status bar.  
	
	This fixes bug 127.  

Sun Oct 10 08:53:35 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Sun Oct 10 04:40:58 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/options.inc, viewer/text/view.c:

	Add an option document.browse.search.typeahead that allows one to
	configure typeahead searching to start automatically whenever one
	presses an unbound key with no modifier. The option can be set to
	disabled, search link text, or search document text.  

Sun Oct 10 04:02:44 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In frame_ev_kbd, initialise |status| to |FRAME_EVENT_IGNORED| as it
	was eventually assigned that value anyway at the end of the routine,
	which assignment is now removed.  

Sun Oct 10 03:56:21 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Delete the |if (status != FRAME_EVENT_IGNORED)
	ses->kbdprefix.repeat_count| at the end of frame_ev_kbd and reset
	|ses->kbdprefix.repeat_count| at the one point from which execution
	could have flow to that if statement without |status| being
	|FRAME_EVENT_IGNORED|.  

Sun Oct 10 03:51:04 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In frame_ev_kbd, now that it has only one case remaining, remove the
	switch statement from around its single case.  

Sun Oct 10 03:47:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Reset |ses->kbdprefix.repeat_count| to zero after handling a
	document accesskey when document.browse.accesskey.priority = 2.  

Sun Oct 10 03:12:21 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/action.c:

	Change do_frame_action to take a doc_view instead of calling 
	current_frame itelf. Change do_action, the only caller of
	do_frame_action, to pass do_frame_action doc_view.  

Sun Oct 10 02:56:34 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: sched/action.c, viewer/text/view.c:

	Handle ACT_MAIN_JUMP_TO_LINK, ACT_MAIN_MARK_SET, and
	ACT_MAIN_MARK_SET in do_action instead of in frame_ev_kbd.  

Sun Oct 10 02:51:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: sched/action.c, viewer/text/view.c:

	Handle prefixes for ACT_MAIN_OPEN_LINK_IN_NEW_TAB_IN_BACKGROUND, 
	ACT_MAIN_OPEN_LINK_IN_NEW_TAB, ACT_MAIN_OPEN_LINK_IN_NEW_WINDOW, and 
	ACT_MAIN_LINK_MENU in do_action instead of in frame_ev_kbd.  

Sun Oct 10 02:42:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/action.c:

	Change do_frame_action to return enum frame_event_status and to
	return FRAME_EVENT_OK on error or else pass on the return of the
	frame_action passed to it.  Further, remove the refresh code from
	do_frame_action and let do_action handle it.  

Sun Oct 10 02:27:18 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/action.c:

	Clean up the refresh code in do_action and, as a side effect, change
	it to return FRAME_EVENT_REFRESH when a refresh is needed (even tho
	none of do_action's callers will do anything about it, not that they
	need to as do_action performs any necessary refresh).  

Sun Oct 10 02:23:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	move_link and move_link_dir, too.  

Sun Oct 10 01:58:58 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Zero |ses->kbdprefix.repeat_count| after using it in move_page_down, 
	move_page_up, scroll_up, scroll_down, scroll_left, scroll_right, 
	move_cursor_left, move_cursor_right, move_cursor_up, and
	move_cursor_down.  
	
	This fixes refreshing when using a prefix with one of the actions 
	that correspond to these routines. The repeat count was already 
	being reset, but only after the status line was being updated.  

Sun Oct 10 01:53:43 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Eliminate the kbdprefix_repeat_count_or_one macro.  

Sun Oct 10 01:46:57 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: view.c, view.h:

	Convert move_cursor_left, move_cursor_right, move_cursor_up, and
	move_cursor_down from macros to C routines.  

Sun Oct 10 00:43:33 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/exmode.c, sched/action.c, sched/action.h,
	viewer/text/view.c, viewer/text/view.h:

	Add FRAME_EVENT_SESSION_DESTROYED to enum frame_event_status.  
	
	Change do_action to return enum frame_event_status instead of enum
	main_action, to use FRAME_EVENT_SESSION_DESTROYED as appropriate, 
	and to use FRAME_EVENT_IGNORED instead of ACT_MAIN_NONE to indicate
	that the action was not handled.  
	
	Change exmode_action_handler to cope.  
	
	Remove the hack in send_kbd_event that checks whether the action is
	one that might close the tab and instead check whether do_action 
	returns FRAME_EVENT_SESSION_DESTROYED.  

Sat Oct  9 23:57:01 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Oops, I misindented some code in June (revision 1.477). Fix.  

Sat Oct  9 23:36:33 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Nope, that wa'n't right. Revert.  

Sat Oct  9 23:31:48 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In honour of Jonas' sledgehammer, crudely fix refreshing after
	actions that are given numeric prefixes.  

Sat Oct  9 23:00:33 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	In do_action, call copy_current_link_to_clipboard via
	do_frame_action and drop the try_jump_to_link_number call from 
	copy_current_link_to_clipboard as do_frame_action will do it.  

Sat Oct  9 22:51:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	Handle ACT_MAIN_COPY_CLIPBOARD in do_action instead of in
	frame_kbd_ev.  This requires that copy_current_link_to_clipboard be
	exported.  

Sat Oct  9 22:43:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Factor out the code in frame_ev_kbd to handle
	ACT_MAIN_COPY_CLIPBOARD into a new procedure,
	copy_current_link_to_clipboard.  

Sat Oct  9 22:32:54 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.h:

	Introduce the macro kbdprefix_repeat_count_or_one and use it in the
	macros move_cursor_left, move_cursor_right, move_cursor_up, and
	move_cursor_down to support prefixes for the corresponding actions.  

Sat Oct  9 22:19:40 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	Handle the following in do_action instead of in frame_ev_kbd: 
	
	ACT_MAIN_MOVE_CURSOR_UP ACT_MAIN_MOVE_CURSOR_DOWN 
	ACT_MAIN_MOVE_CURSOR_LEFT ACT_MAIN_MOVE_CURSOR_RIGHT 
	
	This required that move_cursor be exposed as well as the macros 
	move_cursor_left, move_cursor_right, move_cursor_up, and
	move_cursor_down.  

Sat Oct  9 22:06:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	Handle the following in do_action instead of in frame_ev_kbd: 
	
	ACT_MAIN_MOVE_PAGE_DOWN ACT_MAIN_MOVE_PAGE_UP 
	ACT_MAIN_MOVE_LINK_NEXT ACT_MAIN_MOVE_LINK_PREV 
	ACT_MAIN_MOVE_LINK_UP ACT_MAIN_MOVE_LINK_DOWN 
	ACT_MAIN_MOVE_LINK_LEFT ACT_MAIN_MOVE_LINK_RIGHT 
	ACT_MAIN_MOVE_DOCUMENT_START ACT_MAIN_MOVE_DOCUMENT_END 
	ACT_MAIN_SCROLL_DOWN ACT_MAIN_SCROLL_UP ACT_MAIN_SCROLL_LEFT 
	ACT_MAIN_SCROLL_RIGHT 
	
	This required the exposure of several routines: 
	
	move_down move_page_down move_up move_page_up move_link 
	move_link_dir scroll_up scroll_down scroll_left scroll_right 
	move_document_start move_document_end 
	
	...and several macros: 
	
	move_link_up move_link_down move_link_left move_link_right 
	move_link_next move_link_prev 

Sat Oct  9 21:13:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	Export try_jump_to_link_number.  
	
	Add a parameter jump_to_link_number to do_frame_action to indicate 
	whether to call try_jump_to_link_number, in which case
	do_frame_action will only proceed if try_jump_to_link_number
	succeeds.  
	
	Change calls from do_action to do_frame_action to use the new flag.  
	
	Drop six actions from frame_ev_kbd which are already handled by
	do_action: now that do_action handles prefixes, there is no need for
	the duplicate code.  

Sat Oct  9 21:08:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In frame_ev_kbd, do not reset |ses->kbdprefix.repeat_count = 0| if
	we are returning |FRAME_EVENT_IGNORE|.  

Sat Oct  9 12:28:53 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/http/http.c:

	Minor optimization.  

Fri Oct  8 21:54:45 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/plain/renderer.c:

	Probably fix bug 515.  

Fri Oct  8 17:19:25 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/: finger.c, finger.h, protocol.c, gopher/gopher.c,
	gopher/gopher.h:

	Dummy modules entries were added for finger and gopher protocols, so
	they appear in Info box.  

Fri Oct  8 16:57:52 2004  Laurent Monin <zas@norz.org>:

	* src/sched/: connection.c, connection.h:

	|remaining_info| -> |progress|.  

Fri Oct  8 16:54:57 2004  Laurent Monin <zas@norz.org>:

	* src/: dialogs/download.c, dialogs/status.c, dialogs/status.h,
	protocol/ftp/ftp.c, protocol/http/http.c, sched/connection.c,
	sched/connection.h, sched/download.c:

	|prg| -> |progress|.  

Fri Oct  8 16:47:23 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Fri Oct  8 16:44:09 2004  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	|stat| -> |download_p|.  

Fri Oct  8 16:41:07 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	|stat| -> |download|.  

Fri Oct  8 16:36:56 2004  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	|stat| -> |download|.  

Fri Oct  8 16:32:51 2004  Laurent Monin <zas@norz.org>:

	* src/sched/: session.c, connection.c:

	|stat| -> |download|.  

Fri Oct  8 16:25:13 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.h:

	|down| -> |download|.  

Fri Oct  8 16:21:41 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.h:

	@stat -> @download.  

Fri Oct  8 16:20:52 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/: download.c, status.c, status.h:

	Use @download for struct download * instead of @stat, and rename
	get_stat_msg() to get_download_msg().  

Fri Oct  8 16:12:17 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/http/http.c:

	Set *new_len to zero to prevent segfault.  

Fri Oct  8 16:04:12 2004  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/connect.c, protocol/ftp/ftp.c, sched/connection.c,
	sched/connection.h:

	Rename @pf to @protocol_family, and make it a bitfield (using 0 for
	IPv4 and 1 for IPv6, instead 1 and 2).  

Fri Oct  8 15:33:59 2004  Laurent Monin <zas@norz.org>:

	* src/sched/: download.c, download.h:

	Rename @prog,@prog_flags to @external_handler,
	@external_handler_flags.  

Fri Oct  8 13:11:07 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Oct  8 13:06:13 2004  Laurent Monin <zas@norz.org>:

	* src/: cache/cache.c, document/html/parser.c,
	document/sgml/scanner.c, protocol/smb/smb.c, viewer/text/view.c:

	Drop trailing spaces.  

Fri Oct  8 13:01:41 2004  Laurent Monin <zas@norz.org>:

	* test/target_blank.html:

	A test file named target_blank.html was added to test/. (i forgot to
	cvs add !).  

Fri Oct  8 13:00:07 2004  Laurent Monin <zas@norz.org>:

	* src/: config/options.inc, sched/task.c:

	Option document.browse.links.target_blank which let user choose to
	open links with target=_blank in a new tab in foreground or
	background. See bug 468. A test file named target_blank.html was
	added to test/.  

Thu Oct  7 16:44:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	add_document_line(): Never let @expanded underflow when
	approximating the line length. Should fix bug 515 for the
	http://starosek.com/elinks/1.avi test case.  

Thu Oct  7 10:08:33 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Oct  7 10:01:30 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Little italian update.  

Thu Oct  7 03:15:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/dns.h:

	Other places #includes <sys/types.h> first required by OS/2.  

Thu Oct  7 02:54:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, lowlevel/connect.c, lowlevel/connect.h,
	lowlevel/dns.c, lowlevel/dns.h, lowlevel/interlink.c,
	osdep/osdep.c, protocol/uri.c, protocol/ftp/ftp.c:

	Add guards around 'exotic' #includes.  

Thu Oct  7 02:54:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/conf.c, lowlevel/home.c:

	Add missing #includes.  

Wed Oct  6 19:59:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Assign CONFIG_UNIX=no if some other OS was detected.  

Wed Oct  6 13:48:31 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/leds.c, dialogs/status.c, terminal/terminal.h:

	Fix progress bar/leds/clock/timer display issues (bug 518).  

Wed Oct  6 12:10:04 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Just return if doc_view->vs is NULL, should fix bug 525.  

Tue Oct  5 20:19:18 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Hungarian translation updates/fixes.  

Tue Oct  5 16:40:01 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation fixes. Certyfikaty --\> Dane uwierzytelniaj±ce.  

Tue Oct  5 09:14:01 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c:

	Assertion related to bug 521 was disabled.  

Tue Oct  5 01:23:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/memory.c:

	Check for MAP_FAILED return value when calling mmap() and mremap()
	so it won't be treated as a valid address. Never munmap() the old
	pointer if reallocation fails -- remember it should behave like
	realloc()! 

Mon Oct  4 16:48:25 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Mon Oct  4 14:08:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	When tabbing to some next match while doing a link typeahead with
	wraparound disabled and only the current link is matching pop up a
	"No further matches for '%s'." dialog so a ton of 'normal' typeahead
	dialogs is not displayed. Idea by Miciah in comment to bug 513 which
	should hopefully be fixed now.  

Mon Oct  4 13:26:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, protocol/http/http.c:

	Move the usage of the protocol.http.bugs.broken_302_redirect option
	to the HTTP code and limit the lookup to only happen when there is a
	302. Should hopefully make this thing a bit more clear.  

Sun Oct  3 18:01:54 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/http/http.c:

	Commented out code related to bzip2 encoding. This code didn't work
	as it should.  

Fri Oct  1 16:03:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/menu.c, protocol/proxy.c, util/memory.c,
	viewer/text/form.c, viewer/text/textarea.c:

	#define _GNU_SOURCE only if it's not defined yet - necessary for
	those a little wilder systems.  

Fri Oct  1 16:02:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Load imported CSS documents as additional files. It should fix CSS
	in frames issue reported by pasky and me. I have a bloated patch
	(that I will stash for now) which tries to add CSS magic numbers for
	child frames to the parents but it doesn.t look like it is needed.
	Could be that the get_cached_document() will do it implicit when a
	CSS document imported from a frame is loaded and the whole frame set
	is forced to be rerendered.  

Fri Oct  1 14:38:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/Makefile.am:

	Dammit broke make dist when I attempted to add doc/ files.  

Fri Oct  1 10:52:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	If there are no non-element nodes after the last element node make 
	sure that we flush to the end of the cache entry source including 
	the '>' of the last element tag if it has one. (bug 519) 

Fri Oct  1 07:15:46 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Attempt to fix bug 517, which leads to an infinite loop. Just break
	if read_encoded returns an error.  

Fri Oct  1 01:14:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	Drop some 'support' words. If there was no support for the feature
	it wouldn't be mentioned in this file.  

Fri Oct  1 01:12:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/config/options.inc, src/protocol/smb/smb.c:

	Add option protocol.smb.credentials specifying a credential file
	passed using -A flag to smbclient. Fixes bug 514. Patch by Sergey
	Starosek <star@sunbay.com>.  

Fri Oct  1 00:42:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	search_link_text(): Always check the wraparound condition even if no
	matching is performed. Fixes bug 513.  

Fri Oct  1 00:40:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	search_link_text(): Simplify the checking of wrapping around only
	once.  

Thu Sep 30 21:18:36 2004  Laurent Monin <zas@norz.org>:

	* po/pl.po:

	Polish translation was updated. Patch by Adam Golebiowski.  

Thu Sep 30 21:11:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/renderer.c, sched/session.c, sched/session.h,
	viewer/text/draw.c:

	Fix for bug 516 - in draw_formatted() pass gradual_rerendering to
	render_document_frames() if session_is_loading(), instead of doing
	it in doc_loading_callback(), since we may call draw_formatted()
	from multiple places during loading (anything, i.e. ^L,
	tabswitching, ...).  

Thu Sep 30 21:09:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	ecmascript_reset_state() only if we are going to add new snippets
	there and so. Otherwise we might end up with an empty context during
	rerendering.  

Thu Sep 30 21:08:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Add some more commented-out debugging messages.  

Thu Sep 30 19:52:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.c:

	Make sure (thru new session_is_loading()) that draw_formatted() is
	always called with 3 when still rerendering (i.e. when we just
	finished loading of some aux file or there's still some aux file to
	get which will cause another rerender).  

Thu Sep 30 18:46:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix typo in command line info. Patch by Adam Golebiowski.  

Thu Sep 30 18:27:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	add_document_line(): Fix out of bound array access in the plain
	renderer. We need to review this code.  

Thu Sep 30 10:51:50 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/: uri.c, uri.h:

	Use macro POST_CHAR_S instead of hardcoded \001 in strings.  

Wed Sep 29 23:27:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	document.(location|url) now behaves same as location.url when
	setting it. Necessary to support some broken sites.  

Wed Sep 29 23:25:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	document.location is alias to document.url 

Wed Sep 29 23:18:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/Makefile.am:

	A few files missing from the doc/ dir. Now how am I supposed to
	guide new users of ecmascript in the 0.10pre2 announcement.  

Wed Sep 29 22:51:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/Makefile.am:

	There's no such thing as ecmascript/*.js yet 

Wed Sep 29 22:45:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cookies/cookies.c:

	Do not weed out duplicate cookies when loading them, which is
	horribly ineffective and doesn't scale. Ad maintainer position, qui
	tacet, consentire videtur ;p.  

Wed Sep 29 22:38:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: dom/Makefile.am, sgml/Makefile.am:

	Doh. Add README in sgml dir and remove it from dom dir.  

Wed Sep 29 22:12:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/frames.c:

	When calling format_frames() recursively on a frameset newly
	gathered by format_frame(), lock the document during its execution
	because we could lose the underlying frames otherwise due to some
	other bugs described in the comment. Fixes the last crash on
	http://www.cinema-ostertor.de/ (but it still behaves very weird).  

Wed Sep 29 22:04:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10pre2.CVS 

Wed Sep 29 21:56:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10pre2 

Wed Sep 29 21:54:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	Update .po files.  

Wed Sep 29 21:52:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Wed Sep 29 20:03:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/frames.c:

	If CONFIG_DEBUG, make it possible to debug format_frames() without
	removing -O2.  

Wed Sep 29 20:01:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Pah, it seems we use some stupid weak CONFIG_DEBUG instead of good
	ol' DEBUG, whose idea was that? :) Bring the assertion failures
	back! 

Wed Sep 29 17:02:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, ecmascript/spidermonkey.c:

	Never open new windows if -no-home or -no-connect or -anonymous is
	enabled.  

Wed Sep 29 16:42:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/spidermonkey.c:

	window_open(): Fix URI leaking.  

Wed Sep 29 15:49:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	display_title_bar(): Fix crash when dereferencing NULL doc_view->vs
	triggerable at http://p2p.ingce.unibo.it/ 

Wed Sep 29 15:05:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	do_html_script(): Fix off by one error in the HTML comment end
	skipping. Fixes the example in bug 512.  

Wed Sep 29 14:47:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/scanner.c:

	scan_sgml_element_token(): Simplify the '<!' notation token scanning
	and fix the comment node text to start after '<!--'.  

Wed Sep 29 14:38:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	@include "../garbage.html"; 

Wed Sep 29 12:10:54 2004  Laurent Monin <zas@norz.org>:

	* src/encoding/gzip.c:

	Prevent gzip.c:155: warning: 'error' might be used uninitialized in
	this function.  

Wed Sep 29 11:49:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	get_content_type(): Fix memleaking of empty strings.  

Tue Sep 28 23:57:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/draw.c:

	check_document_fragment(): Check also that the cache entry id and
	document id are in sync. Fixes displaying of wrong 'missing
	fragment' dialogs when opening tab between the cache entry has been
	marked complete but the document still hasn't been rerendered.  

Tue Sep 28 23:50:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/status.c:

	Do it my way instead, if you will. Do not attempt to show the link
	info altogether unless doc_view->vs, it looks too dangerous. Also
	explain why can actually doc_view->vs be NULL there.  

Tue Sep 28 23:45:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	display_status_bar(): Fix crash when doc_view->vs is NULL. pasky is
	this ok? 

Tue Sep 28 23:28:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	location_goto()'s goto_uri_frame() now happens in a bottom half
	handler to prevent nasty surprises inside of complex frame
	configurations.  

Tue Sep 28 23:14:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Disable the killer assert(!vs->doc_view) with a thorough explanation
	- it should be re-enabled when we get frame name conflicts right.
	Instead do some wild recovery now.  

Tue Sep 28 22:41:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Moved the DBG message around.  

Tue Sep 28 22:40:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Some so frequently useful debug message... (commented out, of
	course).  

Tue Sep 28 22:35:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	add_new_win_to_menu(): Fix the action ID.  

Tue Sep 28 20:08:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/frames.h:

	Disclaimer near frameset_desc.box.  

Tue Sep 28 19:22:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/marks.c:

	Preserve vs->doc_view over goto_mark().  

Tue Sep 28 19:20:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/vs.c:

	Disconnect doc_view in destroy_vs().  

Tue Sep 28 17:56:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/task.c:

	When walking inside of a frame, break the bind between vs and
	vs->doc_view when replacing vs->uri. This should fix the assertion
	failures connected with frames.  

Tue Sep 28 17:53:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.c:

	Fixed broken usage of formatted cache by passing no_cache to
	draw_formatted(), spotted by Jonas.  

Tue Sep 28 16:55:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/task.c:

	ses_forward()'s @loaded_in_frame description attempt.  

Tue Sep 28 16:46:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/task.c:

	Try to slightly simplify ses_forward(). Dancing in the minefield...  

Tue Sep 28 16:34:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/task.c:

	Fixed two errrorneous end_load() -> doc_loading_callback().  

Tue Sep 28 16:33:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.h:

	doc_end_load()-> doc_loading_callback() 

Tue Sep 28 16:28:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/connection.h:

	Fixed download.callback description, I got it wrong.  

Tue Sep 28 16:25:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/connection.c:

	sched_connection_info() -> notify_connection_callbacks() 

Tue Sep 28 16:21:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: sched/connection.c, sched/connection.h, sched/download.c,
	sched/session.c, sched/task.c, viewer/dump/dump.c:

	download.end -> download.callback 

Tue Sep 28 16:13:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/dump/dump.c:

	dump_end() -> dump_loading_callback() 

Tue Sep 28 16:12:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/: download.c, session.c, task.c, task.h:

	*end_load() -> *loading_callback(), removing one of the
	HYPER-misleading function names. It is called basically each time
	something interesting happens on @stat.  

Tue Sep 28 14:13:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Moved the commented out part of add_fragments() to a debug check in
	the case of list_empty(*queued_snippets) which we now handle - it
	can happen when we already visited that view_state and processed the
	fragments.  

Tue Sep 28 14:02:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	@doc_current now gets initialized to the first @doc_snippets item
	like a nice good iterator. We could survive a page load without a
	crash right away now again, maybe? 

Tue Sep 28 14:00:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.c:

	Oh. So pretend it's gradual rerendering only when you are gradual
	rerendering (that's in display_timer()).  

Tue Sep 28 13:56:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Simplification: peek to document_options at gradual_rerendering
	directly thru the @options pointer.  

Tue Sep 28 13:55:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: options.h, renderer.c:

	Process onload snippets only when NOT just gradually rerendering the
	document - thus only on final loads. This was probably inevitable
	and I knew it subconciously anyway, but now I have few real reasons
	why I must do this - they're described in an added comment. There
	are still some historical relicts around but I'm not gonna break it
	all up even more now. This should cure all the non-frames-related
	assertion failures.  

Tue Sep 28 13:30:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Swap two assert()ions in add_snippets().  

Tue Sep 28 12:49:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Fix an assertion failure triggered when adding first a single
	snippet and then some more later - it was a kinda off-by-one error,
	skipping the last entry in the queued_snippets before adding new
	stuff.  

Tue Sep 28 12:18:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_send_header(): Use @talking_to_proxy to better fit into the
	other code.  

Tue Sep 28 12:17:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	URI_PROXY should no longer add post data. Should (finally) bring IDN
	support to connections through proxies.  

Tue Sep 28 11:57:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: proxy.c, http/http.c:

	Make IDN work for through proxies by moving the IDN string munging
	from the time the proxy URI is generated to when it is added to the
	HTTP request send to the proxy. Now all IDN is only done at the
	lowest levels keeping state data free from IDN strings. The old
	behaviour actually caused assertion failures because URIs in the
	cache could be either IDN encoded or not. (bug 495) 

Tue Sep 28 10:27:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/features.m4:

	Fix the feature listing to handle () when appending dots.  

Tue Sep 28 08:04:59 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Sep 28 07:35:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Don't add snippets and fail the strlcmp() assertion when ecmascript
	is enabled.  

Tue Sep 28 07:16:11 2004  Laurent Monin <zas@norz.org>:

	* src/document/css/parser.c:

	get_next_scanner_token() can return NULL, so just break the loop in
	that case. It prevents a segfault when accessing clamav.net. Patch
	by Jonas and me.  

Mon Sep 27 18:15:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: setup.h, dialogs/menu.c:

	Add LXR URI shortcut to Help menu. Move menu separator so non-debug
	builds has it after the bugzilla entry.  

Mon Sep 27 12:28:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	add_dom_link(): Use init_template() which also initializes the
	template chars data and attribute members. Fixes problem with
	obfuscated link text on dpreview.com in the highlighted source.  

Mon Sep 27 12:24:34 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* contrib/elinks.spec.in:

	Updated spec for ELinks-now.  

Mon Sep 27 11:40:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Fix bug 507 (reloading disables HTML highlighting) problem which
	apparently only affected reloading of local files. It was introduced
	in version 1.177 that caused the cache entries content type to
	always be updated (I didn't mention a reason in the log) and for
	files that would remove the content type assigned by ses_chktype().
	So the check in render_encoded_document() for whether to highlight
	would fail because the content type was NULL.  

Mon Sep 27 11:30:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	Check for non-empty content type like we already do for cache header
	checking.  

Mon Sep 27 09:37:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Compilation fix.  

Mon Sep 27 09:37:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Compilation fixes.  

Mon Sep 27 09:36:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	add_snippets() doesn't need @current.  

Mon Sep 27 09:36:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	process_snippets() now also handles NULL *current.  

Mon Sep 27 09:35:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	ecmascript_eval() now moved to new process_snippets() which just
	goes from *current to the end of queue and evals the snippets.  

Mon Sep 27 09:32:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	process_snippets() -> add_snippets().  

Mon Sep 27 09:31:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Changed process_snippets() to ignore *current for now.  

Mon Sep 27 07:42:31 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Sep 27 07:33:09 2004  Laurent Monin <zas@norz.org>:

	* src/ecmascript/spidermonkey.c:

	Fix compilation without CONFIG_LEDS.  

Mon Sep 27 02:29:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cache/cache.c:

	Ufff. Finally fixed the bug I was hunting for about 1.5 days with
	every weapon I had available. When reloading document, don't assume
	it is the same if the already loaded data is same and just truncate
	it anyway, because that wasn't healthy for the snippets at all. I'm
	so tired that I can't even celebrate much.  

Mon Sep 27 02:27:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Two more assertions discovering real and difficult bugs.  

Mon Sep 27 01:10:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/ftp/ftp.c:

	Oops, prompt for credentials if username was invalid too.  

Mon Sep 27 01:03:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: document.c, document.h, html/renderer.c:

	link.event_hooks is now pointer to list, giving it more flexibility
	and fixing one nice infinite loop when freeing up the document.  

Mon Sep 27 00:57:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/ftp/ftp.c:

	Compilation fix. Didn't I say it? 

Mon Sep 27 00:56:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/document.c:

	Compilation fix.  

Mon Sep 27 00:55:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: document.c, document.h, html/renderer.c:

	Introduced yet-unused link.event_hooks list.  

Mon Sep 27 00:43:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.h:

	+its in a comment, spotted by biesi.  

Mon Sep 27 00:38:08 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS, src/protocol/auth/auth.c, src/protocol/auth/auth.h,
	src/protocol/ftp/ftp.c:

	Support for FTP authentication over user interface, fixing bug 194.
	Patch by Christian Biesinger <cbiesinger@gmx.at>, tuned by me based
	on further IRC discussion. So if it breaks, it's probably my fault
	;-).  

Mon Sep 27 00:10:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.h:

	Simplify have_location(). Patch by Christian Biesinger.  

Sun Sep 26 20:57:26 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	In features.log and so, add (JavaScript) to ECMAScript.
	Experimentally confirmed that people don't know what ECMAScript is.  

Sun Sep 26 20:31:21 2004  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	Once upon a time, there was a .po resync, and then translators
	stopped by, and happily updated their translations.  

Sun Sep 26 20:24:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Oops, revert my debugging squad.  

Sun Sep 26 20:23:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/renderer.c, ecmascript/spidermonkey.c:

	Return undef from window.open() if failed. Otherwise it should
	return the new window's pointer but we can't handle that now so
	still return true on success.  

Sun Sep 26 20:13:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	window.alert() now returns undef instead of true. Dunno about
	window.open() (returning true/false now) and document.true (always
	gives false back).  

Sun Sep 26 18:21:58 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Forgotten ~ 

Sun Sep 26 17:45:07 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Sun Sep 26 17:21:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	Add TODO about checking for URI strings in certain DOM nodes.  

Sun Sep 26 17:15:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	Highlight links using information about whether they are visited or
	bookmarked.  

Sun Sep 26 16:43:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: dom/renderer.c, sgml/scanner.c:

	Fix double rendering of ';' in entity references the right way by
	ommiting ';' before continuing the text node scanning.  

Sun Sep 26 16:09:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/util/types.h:

	Check for uint16_t type and merge fallback macros from the
	ECMACSRIPT branch.  

Sun Sep 26 15:10:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Set S_TRANS state only after we actually received anything. See? It
	crashes a little later now.  

Sun Sep 26 15:03:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.c:

	Call display_timer() only after we already get to receive something.
	Should help to fix the reload-on-javascript-page crash.  

Sun Sep 26 14:47:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/marks.c:

	Another ECMAScript-less compilation fixes spotted by zas.  

Sun Sep 26 14:34:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/vs.c:

	ECMAScriptless compilation fix, spotted by zas.  

Sun Sep 26 14:02:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	'T' now by default opens the link in new tab in background instead
	of in foreground. It's so *MUCH* more practical, everyone else is
	doing it that way and so and so and so. Who'll kill me this time? ;) 

Sun Sep 26 13:28:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/connection.c:

	Something about download->end() calling from load_url().  

Sun Sep 26 12:55:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	document.write() *PLACEHOLDER* just to silence those annoying
	warnings.  

Sun Sep 26 12:23:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/vs.c:

	In copy_vs(), reset destination doc_view to NULL too. Another
	hopefully crash-fixing measurement. Damn, are there really no better
	test cases for these ECMAScript dances that those stupid porn sites? 

Sun Sep 26 12:17:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/vs.c:

	Reset destination ecmascript and ecmascript_fragile. This could cure
	few crashes.  

Sun Sep 26 12:13:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: sched/location.c, sched/task.c, viewer/dump/dump.c,
	viewer/text/marks.c, viewer/text/vs.c, viewer/text/vs.h:

	destroy_vs() now takes an additional parameter telling it whether to
	put the associated ecmascript interpreter. Useful for marks.  

Sun Sep 26 11:18:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	Only implicit render DOM text nodes via the flush calls. Fixes
	double rendering of ';' in entity references.  

Sun Sep 26 11:00:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/README:

	Mostly some TODO items for the SGML parser.  

Sun Sep 26 10:40:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/parser.c:

	More tagsoup navigation enhancements. Add attributes even if the
	value is missing (example: "attrname=").  

Sun Sep 26 10:15:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/vs.h:

	Throw unsigned in. Spotted by Jonas.  

Sun Sep 26 10:05:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	Fix linkifying of DOM attribute values. Damn quoted strings. ;) 

Sun Sep 26 10:03:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/renderer.c, ecmascript/ecmascript.c,
	ecmascript/ecmascript.h, viewer/text/vs.c, viewer/text/vs.h:

	onload_snippets are now stored inside of struct
	ecmascript_interpreter instead of struct view_state.  

Sun Sep 26 09:56:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/renderer.c, document/view.h,
	document/html/frames.c, ecmascript/ecmascript.c,
	ecmascript/ecmascript.h, ecmascript/spidermonkey.c,
	sched/session.c, sched/task.c, viewer/text/view.c,
	viewer/text/vs.c, viewer/text/vs.h:

	struct ecmascript_interpreter is now associated with struct
	view_state rather than struct document_view. This simplifies things
	a lot, making the interpreter really reliably persistent over
	rerenderings (to indicate real document replaces in the scope of a
	single view_state, view_state.ecmascript_fragile is used).
	view_state now holds pointer to the current document_view
	associated. ecmascript_cleanup_state() -> ecmascript_reset_state().
	This also fixes location ECMAScript object to contain the self
	location instead of top location as another side-effect.  

Sun Sep 26 09:50:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	When rendering "attr1='val1'attr2='val2'" the DOM node string can be
	located at the renderers current position.  

Sun Sep 26 01:53:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/parser.c:

	Shoot, @valtoken can be NULL in add_sgml_attribute(). Fixes quoted
	attribute value highlighting patch.  

Sun Sep 26 01:46:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	Also highlight the entity reference delimiters ('&' and ';').
	Requested by pasky.  

Sun Sep 26 01:41:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: dom/node.h, dom/renderer.c, sgml/parser.c:

	Also highlight the string delimiters of attribute values. Requested
	by pasky.  

Sun Sep 26 01:24:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/scanner.c:

	Simplify comment skipping and move to separate function. The
	changing of '<' and '>' precedence could have caused more problems.
	Fix also scanning of '<a' that would cause lookup of '--a' instead
	of '--'. Now it is specialized and will not cause any table lookup.  

Sun Sep 26 00:30:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	window.open() support. Opens to a new window if possible, to a new
	tab (on foreground) otherwise.  

Sun Sep 26 00:28:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bookmarks/bookmarks.c, sched/action.c, sched/session.c,
	terminal/tab.c, terminal/tab.h, bfu/hierbox.c:

	open_uri_in_new_tab() now takes additional @based option telling it
	whether to preload the current location in the new tab or not.  

Sat Sep 25 23:57:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Comment out attr="value""continuinghere" handling since this is
	extremely rare and you rather meet broken code where this hurts
	(i.e. some idos.cz page pointed out by Miernik). And we were already
	doing this when scanning for the tag end anyway.  

Sat Sep 25 23:51:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/: scanner.c, scanner.h:

	Improve handling of '</a<b>' tagsoup by treating it as '</a><b>'.  

Sat Sep 25 23:38:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/scanner.c:

	Improve handling of '<a<b>' tagsoup by treating it as '<a><b>' and
	remove guarding assertion. The scanner now handles both yahoo (bug
	510) and test/garbage.html .. more tagsoup handling comming up.  

Sat Sep 25 23:10:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/scanner.c:

	Optimize the main SGML scanner loop. Allow NUL chars in elements.  

Sat Sep 25 22:39:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/newwin.c:

	When looking for a suitable command, stop at the first match.  

Sat Sep 25 22:19:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/navigator.h:

	Fix off by one error in the foreachback_dom_state iterator causing
	search_dom_navigator() to never search in the DOM state at the
	bottom. (bug 505) 

Sat Sep 25 22:06:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	A little hack that lowers html_context.line_breax so newlines in
	<pre> tags are added even after </end-element-tags>. (bug 504) 

Sat Sep 25 20:37:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/util/memory.c:

	Check for existence of the _SC_PAGE_SIZE value passed to sysconf().
	It is not defined on Mac OS X. Reported by Eugenia Loli-Queru.  

Sat Sep 25 20:32:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	document.referrer support.  

Sat Sep 25 20:23:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Add support for window.parent. It's aliased to window.top for now,
	with some non-working commented out code and a thorough description.
	It will take a big rewrite of the frames support to have
	window.parent available without some totally insane magic.  

Sat Sep 25 20:02:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Don't set the LED value for -dump rendering.  

Sat Sep 25 19:56:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/frames.c:

	Compilation fixes. The whole frames thing is a huge mess.  

Sat Sep 25 19:51:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: document.h, html/frames.c:

	If a {struct document} has a frame associated somewhere, record it
	in a @frame field. I need that for ECMAScript window.parent.  

Sat Sep 25 19:25:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/frames.c:

	Compilation fix.  

Sat Sep 25 19:24:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/frames.c:

	Pass frame pointer directly to format_frame().  

Sat Sep 25 19:07:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/memory.c:

	Include <sys/types.h> before <sys/mman.h>. Reported by Eugenia
	Loli-Queru and verified it fixes compile errors on Mac OS X.  

Sat Sep 25 18:07:23 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	When assigning to window.location, return JS_FALSE to prevent losing
	that property object to some stupid string. That was the root of the
	problem all the time, probably.  

Sat Sep 25 17:52:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	location_goto() now abstracts up the location change hook and is
	called directly from window_set_property(), instead of passing this
	to location_set_property().  

Sat Sep 25 17:40:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Drop window properties which are filled by JS_InitClass() later
	anyway.  

Sat Sep 25 17:38:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Identify window.location by string instead of id.  

Sat Sep 25 15:40:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/: ecmascript.c, spidermonkey.c:

	Check *_abs_url before using it, spotted by Jonas.  

Sat Sep 25 15:30:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/: ecmascript.c, spidermonkey.c:

	When going anywhere, use join_urls() instead of get_hooked_uri().  

Sat Sep 25 14:18:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.c:

	Don't fricking touch free_syntax URIs, saving me an hour of
	debugging! 

Sat Sep 25 14:10:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: setup.h, dialogs/menu.c:

	Show the 'Bug information' entry in the 'Help' menu even for non
	debug builds. Add cvs history url shortcut.  

Sat Sep 25 12:46:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Support for working directly with the location object, proxying
	location.href. Man, this was one nightmare to get going.  

Sat Sep 25 04:26:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	Fix serious access of free()d memory causing the table width parsing
	in get_width() to fail when memory leak detection is disbled. The
	bug was introduced in (1.41 -> 1.42) when merging parse_width() and
	get_width().  Filed as bug 483.  

Sat Sep 25 01:31:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/ecmascript.c:

	About disallowing ECMAScript scripts to trash your disk and so.  

Sat Sep 25 01:04:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/leds.c, document/renderer.c, ecmascript/spidermonkey.c,
	sched/session.c, sched/session.h:

	Add ecmascript error led using 'J' when on.  

Sat Sep 25 00:59:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/ecmascript.c:

	Compilation fix.  

Sat Sep 25 00:59:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/renderer.c, ecmascript/ecmascript.c,
	ecmascript/ecmascript.h:

	Moved ECMAScript state cleanup bit from render_document_frames() to
	ecmascript_cleanup_state().  

Sat Sep 25 00:50:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: dialogs/status.c, ecmascript/spidermonkey.c,
	sched/session.c, sched/session.h:

	Support for ECMAScript's window.(status|menu)bar.visible. Try
	javascript:statusbar.visible=0. This is getting scary... ;-) 

Sat Sep 25 00:19:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/: ecmascript.c, spidermonkey.c:

	Add boolean option named ecmascript.error_reporting will stop all
	script error reporting.  

Sat Sep 25 00:03:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	VALUE_TO_JSVAL_END() now takes a @vp argument.  

Sat Sep 25 00:02:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	window.alert() implemented.  

Fri Sep 24 23:46:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Ok, evade the crash by constructing @window_obj as a nice global
	object again, gradually instead of a direct sledgehammer hit by
	JS_InitClass().  

Fri Sep 24 23:40:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Carry JSPT_BOOLEAN in int instead of string.  

Fri Sep 24 23:38:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Do the similar thing with VALUE_TO_JSVAL* - group all the local
	variables into the (enum prop_enum) union.  

Fri Sep 24 23:33:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Convert the JSVAL_TO_VALUE* macros to use {union jsval_union}
	instead of a bunch of variables.  

Fri Sep 24 23:24:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Get actual support for JSPT_BOOLEAN and JSPT_OBJECT so that we
	compile again :).  

Fri Sep 24 23:19:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Give the window object few properties - closed, document, location,
	self, top and window.  

Fri Sep 24 22:53:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	@global_class -> @window_class and the literal name renamed to
	"window" too. @global_obj -> @window_obj.  

Fri Sep 24 22:43:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	And process_snippets() even when retrieving the document from cache.
	This should fix the rest of problems with undefined values (the link
	in the inlinescript.html test).  

Fri Sep 24 22:35:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Preserve interpreter over rerenderings. Works most times, but not
	always.  

Fri Sep 24 22:23:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Untested support for prettyprinting the errors (if enough info is
	available).  

Fri Sep 24 22:12:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Move the static safeguard functions to the rest of static symbol
	definitions and drop the spidermonkey_ prefix there.  

Fri Sep 24 22:11:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Introduced error_reporter(), which is, well, an error reporter ;-).  

Fri Sep 24 21:45:45 2004  Petr Baudis <pasky@ucw.cz>:

	* test/ecmascript/inlinescript.html:

	nice_href() needs to be called as nice_href(0). I'd love to know
	why.  

Fri Sep 24 21:29:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	The private interpreter->doc_view is now property of global_obj
	instead of document_obj and location_obj (which look it up in their
	parent). The Blue Ones can already smell some window object traces.  

Fri Sep 24 21:23:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Return NULL in eval_stringback() if JSVAL_IS_VOID(). Fixes
	javascript:void(0); 

Fri Sep 24 21:21:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/vs.c:

	Fixed EcmaScriptless compilation as reported by zas.  

Fri Sep 24 20:47:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/ecmascript.h, src/ecmascript/spidermonkey.c,
	test/ecmascript/infinite.html:

	A safeguard function introduced, which kills the script after 5
	seconds of running. That has to be enough for anything.  

Fri Sep 24 20:34:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/: time.h, ttime.h:

	Simplify the #ifdef maze.  

Fri Sep 24 20:24:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	...for the interpreter structure itself.  

Fri Sep 24 20:23:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	interpreter->doc_view was also made private of the both objects
	(document, location), and it's fetched from there now. We will need
	the context private...  

Fri Sep 24 20:18:23 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	FIXME about timer safeguards against CPU eaters. Pointer out by
	witekfl.  

Fri Sep 24 20:05:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Ok, now for the first process_snippets() call @doc_current was one
	entry ahead ;-). Hopefully calibrated well now.  

Fri Sep 24 19:54:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	process_snippets() @doc_view was two entries behind @*current when
	merging new snippets, taking ELinks down in flames at
	http://www.dr.dk/.  

Fri Sep 24 19:14:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Fixed totally broken --> scanning in do_html_script().  

Fri Sep 24 19:01:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: parser.c, parser/stack.c:

	It's ok when part->document is NULL - that means we are just
	'pre-rendering' stuff at a dry run (i.e. in the tables code to
	compute tables width), therefore we ignore onload_snippets gained in
	that way. Could fix few more crashes.  

Fri Sep 24 18:59:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/: navigator.c, node.c:

	Fix compile error when LEAK_DEBUG is disabled. Reported by witekfl.  

Fri Sep 24 18:50:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Enhanced scanning for </script> - don't at least get fooled by
	<script><\!--document.write('</script>');--></script>.  

Fri Sep 24 18:42:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Mention that rxvt supports 256 colors.  

Fri Sep 24 18:38:31 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Fri Sep 24 18:10:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Oops, forgot to :w before committing.  

Fri Sep 24 18:01:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS, configure.in, features.conf:

	Make HTML highlighting support official.  

Fri Sep 24 13:48:19 2004  Petr Baudis <pasky@ucw.cz>:

	* test/ecmascript/inlinescript.html:

	Some nice_href() fixes.  

Fri Sep 24 13:45:19 2004  Petr Baudis <pasky@ucw.cz>:

	* test/ecmascript/inlinescript.html:

	Oops, fix syntax errors in the code snippets ;-). So that's why the
	testcases didn't work! 

Fri Sep 24 13:07:23 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: parser.c, parser/parse.c:

	Call do_html_script() only after we have an entry in the HTML stack.
	Otherwise it would be difficult to skip the contents if we weren't
	processing the element (and if we were processing it, it was broken
	until now because we were calling html_skip() on its parent).  

Fri Sep 24 12:58:40 2004  Petr Baudis <pasky@ucw.cz>:

	* test/ecmascript/inlinescript.html:

	Testcase for the inline <script> element.  

Fri Sep 24 12:54:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	In do_html_script(), skip all leading blanks, not just newlines.  

Fri Sep 24 12:43:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: parser.c, parser.h, parser/parse.c:

	Support for inline <script> elements containing Javascript code.  

Fri Sep 24 12:28:03 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Sep 24 10:57:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Fix crash on tabloid pages with onLoad on body - when retreating
	from parse_html() reset html_context.part in case it was destroyed
	in the last iteration by a recursive parse_html() call.  

Fri Sep 24 10:54:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, document.h, renderer.c,
	html/renderer.c:

	Don't add css_magic and css_imports member to {struct document} and
	related code when CONFIG_CSS=no.  

Fri Sep 24 10:47:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Fix crash for multiple process_snippets() calls - initialize
	@doc_current correctly if *current.  

Fri Sep 24 10:27:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	OnLoad games only if CONFIG_ECMASCRIPT.  

Fri Sep 24 02:53:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	Out define DOM tree rendering code.  

Fri Sep 24 02:51:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Insert magic check that workaround a bug in the <html> CSS handling.
	Suggested by pasky.  

Fri Sep 24 02:34:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/dom/renderer.c:

	The actual source highlighting without some arcane default
	stylesheet tinkering. Jonas is lazy so it's up to me, therefore
	being impossibly dirty. But at least I get to choose the colors,
	which are vim-like now. Quotes and &; of entities should be
	highlighted too, though.  

Fri Sep 24 02:11:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/parser.h:

	Nitpicking variable renaming.  

Fri Sep 24 02:08:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: renderer.c, dom/renderer.c, dom/renderer.h,
	sgml/parser.c, sgml/parser.h:

	Pass the buffer so DOM rendering supports compressed documents.
	Pointed out by pasky.  

Fri Sep 24 01:52:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Fix those damn onLoad memleaks Jonas is bothering me with.  

Fri Sep 24 01:47:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Mention our onLoad-on-any-element extension.  

Fri Sep 24 01:46:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	kill_html_stack_item(): @onLoad -> @onload as req by Jonas.  

Fri Sep 24 01:45:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Fixed initial adding to the snippets queue in process_snippets().
	onLoad should work fine now.  

Fri Sep 24 01:44:32 2004  Petr Baudis <pasky@ucw.cz>:

	* test/ecmascript/onload.html:

	onLoad testcase.  

Fri Sep 24 01:43:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Oops.  

Fri Sep 24 01:41:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/document.c:

	@css_magic now takes the stylesheets' current length into account
	too, so that if the document is rendered and loading of stylesheets
	is yet in progress, the document will be still rerendered after the
	stylesheets make it. Reported by me, idea by Jonas.  

Fri Sep 24 01:37:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: parser.c, parser/parse.c:

	<html> element now has its corresponding structure in the HTML stack
	since CSS can apply styles to it.  

Fri Sep 24 01:16:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	Use the URI string as title for highlighted HTML source. Idea by
	pasky. ;) 

Fri Sep 24 00:59:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/scanner.c:

	Don't check quoting when skipping potential garbage inside of tags.  

Fri Sep 24 00:59:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cookies/dialogs.c:

	Fixed bogus check in push_add_button() causing crash when there are
	no cookies. Reported by uroboros.  

Fri Sep 24 00:44:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf, src/document/Makefile.am,
	src/document/renderer.c, src/document/dom/.cvsignore,
	src/document/dom/.vimrc, src/document/dom/Makefile.am,
	src/document/dom/navigator.c, src/document/dom/navigator.h,
	src/document/dom/node.c, src/document/dom/node.h,
	src/document/dom/renderer.c, src/document/dom/renderer.h,
	src/document/sgml/.cvsignore, src/document/sgml/.vimrc,
	src/document/sgml/Makefile.am, src/document/sgml/parser.c,
	src/document/sgml/parser.h, src/document/sgml/scanner.c,
	src/document/sgml/scanner.h, src/document/sgml/sgml.c,
	src/document/sgml/sgml.h, src/document/sgml/html/.cvsignore,
	src/document/sgml/html/.vimrc, src/document/sgml/html/Makefile.am,
	src/document/sgml/html/attribute.inc,
	src/document/sgml/html/element.inc, src/document/sgml/html/html.c,
	src/document/sgml/html/html.h, src/intl/charsets.c,
	src/intl/charsets.h:

	Import the DOM and SGML parser code from the ECMASCRIPT and use it
	for HTML source highlighting.  

Fri Sep 24 00:07:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/renderer.c:

	Set doc_view->document as soon as we get it in render_document(), so
	that it's immediatelly available for ECMAScript chewing.  

Fri Sep 24 00:03:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/document.c, document/document.h,
	document/renderer.c, document/html/parser/stack.c, sched/session.c,
	viewer/text/vs.c, viewer/text/vs.h:

	A little wild support for the onLoad element hooks.  

Thu Sep 23 23:34:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/file.c:

	stat_size(): Increase the @size buffer, but only use it if the
	number is bigger than 8 chars.  

Thu Sep 23 23:17:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/draw.c:

	If draw_formatted()'s @rerender > 2, let render_document_frames()
	know.  

Thu Sep 23 22:18:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Remove unused local list head.  

Thu Sep 23 22:15:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.c:

	FTP URIs are now auto-encoded again. There is hopefully no harm to
	be done there, so why not...? Right? 

Thu Sep 23 22:14:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.c:

	Oops, fixed prepending of schemes to URIs. Hopefully.  

Thu Sep 23 22:08:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.c:

	Bug 358 revisited another time, now really encode the URI string
	only if we are prepending the file:// scheme to it, as described
	everywhere. This fixes non-working entering of URIs with query parts
	to the Goto URI box and supposedly on the commandline too. I don't
	want to know about the possible problems still associated with local
	CGIs. (Those people ought to use full URIs.) 

Thu Sep 23 19:36:51 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/selectors.html:

	'div,' selector looks like a good crash testcase. Borrowed from
	irc.mozilla.org/#developers ;). (Haha, it crashes for them...) 

Thu Sep 23 19:34:41 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	/usr/include/smjs as $spidermonkeydir makes no sense, try to check
	it as $spidermonkeyinclude instead and see who gets enraged.  

Thu Sep 23 19:31:31 2004  Petr Baudis <pasky@ucw.cz>:

	* test/ecmascript/protocol.html:

	Elaborate on the tests.  

Thu Sep 23 19:23:21 2004  Petr Baudis <pasky@ucw.cz>:

	* test/ecmascript/protocol.html:

	Each link in a single paragraph.  

Thu Sep 23 19:15:15 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* configure.in:

	PLD location for SpiderMonkey.  

Thu Sep 23 18:10:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Remove junk -I includes flags in SPIDERMONKEY_CFLAGS.  

Thu Sep 23 16:25:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/ecmascript.c:

	Do not eval() anything unless get_ecmascript_enable().  

Thu Sep 23 16:23:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/: ecmascript.c, ecmascript.h, spidermonkey.c,
	spidermonkey.h:

	ecmascript_eval() is like ..._eval_stringback() but gives back no
	string ;-).  

Thu Sep 23 16:14:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	Looks like freshmeat and slashdot redirects away from www host. Hit
	them directly instead.  

Thu Sep 23 15:43:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/ecmascript/protocol.html:

	Grow with separate tests for javascrip: URIs.  

Thu Sep 23 15:40:33 2004  Laurent Monin <zas@norz.org>:

	* src/: config/options.inc, viewer/text/form.c, viewer/text/link.c:

	A boolean option named document.browse.accesskey.display was added
	to enable display of access key in link info.  

Thu Sep 23 15:26:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/ecmascript.c:

	ecmascript_protocol_handler(): Tidy up.  

Thu Sep 23 15:25:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/: ecmascript.c, spidermonkey.c:

	Space fixes.  

Thu Sep 23 15:21:47 2004  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	Advertise ECMAScript.  

Thu Sep 23 15:04:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Use free_syntax strategy for javascript: URIs.  

Thu Sep 23 15:04:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ecmascript/ecmascript.c:

	Fix compilation.  

Thu Sep 23 14:55:47 2004  Petr Baudis <pasky@ucw.cz>:

	* test/: Makefile.am, ecmascript/protocol.html:

	Add a simple testcase for the javascript: protocol, document.title
	and document.url.  

Thu Sep 23 14:12:17 2004  Laurent Monin <zas@norz.org>:

	* doc/ecmascript.txt:

	Spidermonker compilation/installation documentation was improved.  

Thu Sep 23 14:05:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Basic support for the location object - just the 'href' property for
	now.  

Thu Sep 23 14:03:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/ecmascript.c:

	Use get_hooked_uri() instead of get_uri() in
	ecmascript_protocol_handler(), which munches it however weird could
	it be before.  

Thu Sep 23 13:56:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: ecmascript/ecmascript.c, ecmascript/ecmascript.h,
	protocol/protocol.c:

	Move code for the javascript: protocol handling to
	ecmascrip_protocol_handler().  

Thu Sep 23 13:51:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/ecmascript.txt:

	Sorry the rewrapping went a little crazy. Make it more clear what SM
	means ;) and try to rearrange section about compiling SM so it is
	clearer that it belong together.  

Thu Sep 23 13:39:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/ecmascript.txt:

	Insert section for people living on easy street with nice package
	systems that will do all the dirty work.  

Thu Sep 23 13:16:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Add support for detecting existence of spidermonkey on debian
	systems.  

Thu Sep 23 13:12:04 2004  Laurent Monin <zas@norz.org>:

	* src/util/memory.c:

	Even more fix mmap() usage: some systems (HP/UX it seems) may not
	have MAP_ANON but MAP_ANONYMOUS, and no alias, so just handle that
	case.  

Thu Sep 23 12:42:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Guarding #includes should not be necessary ever unless it is system
	headers.  

Thu Sep 23 12:42:16 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	Evangelize doc/small.txt in --enable-small description.  

Thu Sep 23 12:40:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/dialogs.c:

	Fix immediate crash when compiled with CONFIG_SMALL, reported by
	uroboros. act->desc was NULL and the dialogs code didn't cope well
	with that.  

Thu Sep 23 11:57:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/protocol.c:

	Just get_uri(, 0) instead of get_uri(, URI_ORIGINAL) in the
	javascript protocol handler. The get_uri() function could use some
	real documentation :).  

Thu Sep 23 10:28:47 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/renderer.c, document/plain/renderer.c,
	protocol/gopher/gopher.c, protocol/nntp/nntp.c:

	Drop trailing spaces.  

Thu Sep 23 08:40:59 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/lua/core.c:

	When lua_dofile() fails, sleep 3 seconds to let see Lua error
	message. Patch by Alexey Tourbin.  

Thu Sep 23 00:07:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: renderer.c, view.h, html/frames.c:

	(struct document_view) now references (struct session *) as the
	.session field. This will be enormously useful in the ECMAScript
	code, but should create space for more simplifications all over the
	map.  

Wed Sep 22 23:59:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/protocol.c:

	Oops, fixed invalid usage of @uri instead of @redirect_uri. It of
	course took me a deep and dreadful into the ucs16-based SpiderMonkey
	parser to discover that. :/ 

Wed Sep 22 23:30:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	SpiderMonkey doesn't like uppercase property names - document.URL ->
	document.url.  

Wed Sep 22 23:21:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Oops, use JS_GetStringBytes() instead of JS_GetStringChars().  

Wed Sep 22 23:21:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Do not free() strings acquired by JS_GetStringChars(). Should fix
	those random crashes ;-).  

Wed Sep 22 23:14:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Pass "" filename instead of NULL to JS_EvaluateScript(). Who knows
	where it would crash again otherwise...  

Wed Sep 22 23:13:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Now the whole context has doc_view private data, instead of
	individual objects having various stuff (which might be empty at the
	time of get_interpreter() anyway, leading to fast and painful
	crash). This means entering 'javascript:document.title=1+1' to the
	Goto URL window (with some document loaded, of course) already works
	now! 

Wed Sep 22 22:32:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Capitalization fixes.  

Wed Sep 22 22:31:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Betrayal! NULL cannot be passed as the class hooks, stub hooks need
	to be used instead.  

Wed Sep 22 22:14:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Handle JS_NewObject() failures.  

Wed Sep 22 22:06:23 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/view.c:

	ecmascript_put_interpreter() in detach_formatted() only if we have
	any.  

Wed Sep 22 21:59:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/modules/module.c:

	Oops, added @ecmascript_module to the list of builtin modules.  

Wed Sep 22 21:57:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: ecmascript/ecmascript.c, ecmascript/ecmascript.h,
	ecmascript/spidermonkey.c, ecmascript/spidermonkey.h,
	protocol/protocol.c:

	Introduced ecmascript_eval_stringback() and used it in the
	javascript: protocol handling - so that's the first point where we
	support real ECMAScript.  

Wed Sep 22 21:36:29 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/ecmascript.txt:

	Disclaimer ad other programs working with such an SpiderMonkey
	installation (we need to set the XP_ #define manually and other
	software probably won't bother).  

Wed Sep 22 21:21:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/spidermonkey.c:

	Some preliminary implementation of the document class, with the
	'title' and 'URL' properties. This also introduces the relevant
	infrastructure of macros and other code obfuscators.  

Wed Sep 22 19:11:51 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/ftp/ftp.c:

	Trying to fix displaying after resuming status.  

Wed Sep 22 17:01:41 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	get_http_code(): reduce code redundancy a bit.  

Wed Sep 22 16:17:23 2004  Petr Baudis <pasky@ucw.cz>:

	* INSTALL, contrib/js-1.5-rc6a+elinks.patch, doc/ecmascript.txt:

	Added doc/ecmascript.txt and corresponding
	contrib/js-1.5-rc6a+elinks.patch, which should guide users through
	SpiderMonkey installation.  

Wed Sep 22 15:46:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Only check HTTP Status header field when handling CGI requests. It
	is not a standard field and breaks redirects when downloading from
	www.php.net reported by saviles. The check was introduced in 1.214
	one december night.  

Wed Sep 22 15:25:41 2004  Petr Baudis <pasky@ucw.cz>:

	* INSTALL:

	~/.links -> ~/.elinks. Man, that file is dusty.  

Wed Sep 22 15:22:34 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in, src/ecmascript/Makefile.am,
	src/ecmascript/ecmascript.c, src/ecmascript/njs.c,
	src/ecmascript/njs.h, src/ecmascript/spidermonkey.c,
	src/ecmascript/spidermonkey.h:

	Replaced njs ECMAScript backend by Mozilla SpiderMonkey backend. njs
	is much smaller but just sucks when you want to do anything with it,
	and isn't under active development. SpiderMonkey OTOH is not so easy
	to install.  

Wed Sep 22 12:28:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Location header is valid for status 201 too.  

Wed Sep 22 10:42:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/: ecmascript.c, njs.c:

	Oops, #include elinks.h. I *knew* I forgot something.  

Wed Sep 22 10:33:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/njs.c:

	Somehow implemented decodeURI, decodeURIComponent, encodeURI and
	encodeURIComponent global methods.  

Wed Sep 22 07:49:38 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Sep 21 22:37:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/Makefile.am, src/document/renderer.c,
	src/document/view.h, src/document/html/frames.c,
	src/viewer/text/view.c:

	Cleanup the ecmascript build-system integration. Now a
	CONFIG_ECMASCRIPT is defined that can be used outside of the
	ecmascript directory.  

Tue Sep 21 22:11:39 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in, src/Makefile.am, src/document/renderer.c,
	src/document/view.h, src/document/html/frames.c,
	src/ecmascript/Makefile.am, src/ecmascript/ecmascript.c,
	src/ecmascript/ecmascript.h, src/ecmascript/njs.c,
	src/ecmascript/njs.h, src/viewer/text/view.c:

	Some basic stubby ECMAScript support, consisting of
	get_interpreter/put_interpreter and a njs backend of the similar
	scope; the interpreter is bound to {struct doc_view}. So it does
	nothing but taking up your memory so far, and surely breaking
	compilation on all systems but mine.  

Tue Sep 21 21:26:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/: .cvsignore, .vimrc:

	Fairies.  

Tue Sep 21 21:24:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10pre1.CVS 

Tue Sep 21 21:18:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10pre1 

Tue Sep 21 21:15:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	Update .po files.  

Tue Sep 21 21:13:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Tue Sep 21 20:54:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	And '*' is IDENT_START too.  

Tue Sep 21 20:52:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/selectors.html:

	Add test for selector containing *.  

Tue Sep 21 20:49:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	Moved '*' from CSS_CHAR_TOKEN to CSS_CHAR_IDENT... because it may be
	an ident ;).  

Tue Sep 21 20:34:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/README:

	Hint regarding Grasping the selector tree - what the one dumped by
	CSS_DEBUG.  

Tue Sep 21 20:16:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Reorder the selector type checking so that it's now in the
	specificity order: '*', element name, pseudo-class, class, id.  

Tue Sep 21 20:15:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Try to support the '*' selector. Yes, I think it *could* be that
	simple.  

Tue Sep 21 20:10:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c:

	Make sure really all the root selectors have CSR_ROOT relation, and
	replace with that the 'relative relation' fix by Jonas. Jonas,
	please verify whether this fixes stuff.  

Tue Sep 21 20:09:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Change even the last WDBG() to DBG().  

Tue Sep 21 19:38:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	In find_css_selector() first compare integers, then strings.  

Tue Sep 21 19:15:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	A little unsure about this one. Don't use free syntax URI parsing
	for user protocols. It breaks mailto command invocation because both
	uri->userlen and uri->hostlen is zero. It might break some more
	exotic URIs defined by the user. Maybe free syntax should mean
	'increase error tolerance' when parsing.  

Tue Sep 21 18:23:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/stylesheet.c:

	Pasky is afk so lets take out the sledgehammer and bump an itchy
	corner.  It was introduced in '(find|get)_css_*selector() now takes
	an {enum css_selector_relation} argument ...' and caused .classes
	not to be matched. These CSS enhancements quickly get very
	addictive.  Now the relation is good if the value is <= than the
	selector->relation.  I have no clue if it is correct from a design
	point of view.  

Tue Sep 21 17:34:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/css.c, css/parser.c, css/parser.h,
	css/stylesheet.h, html/internal.h, html/parser.c,
	html/parser/link.c, html/parser/parse.c:

	Pass a base uri all they way down the CSS @import callchain. Fixes
	relative imports from imported stylesheets (example: redhat.com).  

Tue Sep 21 17:22:02 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Tue Sep 21 17:07:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/link.c:

	html_link(): Don't bail out when document.html.link_display is 0. We
	are still interested in checking if it is a CSS link. Reported by
	Witold.  

Tue Sep 21 16:49:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: css/apply.c, html/parser.h, html/parser/link.c:

	Support for link and visited CSS pseudo-classes. Don't expect more
	from me ;).  

Tue Sep 21 16:15:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Specificity matches are more specific than ancestor matches, so do
	them later.  

Tue Sep 21 16:15:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Apply CSS_PARENT after CSR_ANCESTOR, thus overriding it.  

Tue Sep 21 16:09:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, stylesheet.c, stylesheet.h:

	(find|get)_css_*selector() now takes an {enum css_selector_relation}
	argument (and honors it). This almost fixes the '>' combinator
	support.  

Tue Sep 21 16:03:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	'>' is now CHAR_TOKEN.  

Tue Sep 21 15:12:31 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/selectors.html:

	Use <span> instead of <i> to test ancestors. Also added 'div .foo'
	test and '>' combinator test (it doesn't work now ;).  

Tue Sep 21 15:03:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: css/apply.c, css/apply.h, html/parser.c,
	html/parser/parse.c:

	Support for HTML stack lookups (ancestor and parent combinators). It
	doesn't work 100% yet, it already has some visible effects
	nevertheless.  

Tue Sep 21 14:14:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix off by one errors in the <!-- and --> CSS scanning. Patch by
	pasky and me.  

Tue Sep 21 13:52:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	document.browse.forms.insert_mode is turned on by default now. It's
	a Good Thing (tm), raises usability, reduces complaints, makes
	people happy, and helps keep the world peace.  

Tue Sep 21 13:00:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed reparent_selector() blasting off selector pointed at by
	pkg->selector. (It still blasts it but corrects the pointer.) Fixes
	fm crash reported by zas.  

Tue Sep 21 12:43:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Applying to... WDBG() -> DBG().  

Tue Sep 21 12:42:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Recursive iterations of examine_element() keep all the same original
	@base now, avoiding corrupting the whole stylesheet when merging
	stuff together - now it all merges only to our temporary selector.
	This fixes i.e. http://cia.navi.cx/.  

Tue Sep 21 12:26:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Blast a forgotten argument.  

Tue Sep 21 12:26:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Dump at least list of property types along with the selector.  

Tue Sep 21 12:10:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed hopefully one of the last bugs - multiple selectors of the
	same name and type could appear in the stylesheet because of the
	@prev_element_selector reparenting-if-specificitier-but-last hack.
	Instead of simple add_to_list() introduced reparent_selector() which
	checks for twins in the list and if it finds one it instead
	ultra-merges the @prev_element_selector to it.  

Tue Sep 21 11:43:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Fixed fatal error in dump_css_selector_tree_iter() call ;-).  

Tue Sep 21 11:33:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Prettyprinting fixes.  

Tue Sep 21 11:02:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Compilation fixes.  

Tue Sep 21 11:00:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Introduced dump_css_selector_tree() which does precisely that, but
	it's around only #ifdef CSS_DEBUG.  

Tue Sep 21 10:00:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Fixed dbginfo().  

Tue Sep 21 09:58:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c:

	Commented out #define CSS_DEBUG added.  

Tue Sep 21 09:57:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Oops, forgot to add another message triggered in
	process_found_selector().  

Tue Sep 21 09:45:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c:

	Some debugging messages #ifdef CSS_DEBUG.  

Tue Sep 21 09:44:32 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Sep 21 09:41:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Of course I got it slightly wrong. In css_parse_selector() try to
	make the description of 'selector stack' variables less ambiguous
	and more confusing.  

Tue Sep 21 09:32:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Try to describe the most interesting variables in
	css_parse_selector() so it's all a little more confusing.  

Tue Sep 21 09:24:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	merge_css_selectors() in process_found_selector() before recursively
	calling examine_element() so that the more specific matches aren't
	overriden by the less specific ones later. But it's not like any
	improvement would be visible now over the current bugs ;-).  

Tue Sep 21 09:20:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Rant about how many memory can the format cache take in
	document.cache.format.size description.  

Tue Sep 21 08:34:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	If CST_SPECIFITY is marked as last_fragment, it means the last base
	fragment wasn't and we need to add it to the stylesheet now.  

Tue Sep 21 08:26:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	set_mem_comment(selector, name) in init_css_selector().  

Tue Sep 21 00:34:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed setting of @last_chained_selector.  

Tue Sep 21 00:30:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed another few memory leaks.  

Tue Sep 21 00:30:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed the condition for determining @selector_start.  

Tue Sep 21 00:21:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed completely nonsensical condition when repkg->selectoring.  

Tue Sep 21 00:12:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Oops - now pkg->selector (where the properties are bound) is the
	_most_ specific selector in the chain, not the about least one. So
	that's why some things had very strange styles applied.  

Tue Sep 21 00:08:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Some preliminary quick hack in the applier to handle applying of
	structured selectors (i.e. 'div.foo' or 'p#bar' or 'i#baz.quux').
	Note that HTML stack lookups ('i b' selectors) are still not
	supported.  

Tue Sep 21 00:03:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Now we finally correctly determine whether we are looking at 'p #x'
	or 'p#x' (through @selector_start) and therefore correctly set
	relations for potential specificitiers.  

Mon Sep 20 23:33:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Unify the @last_fragment cleanup code.  

Mon Sep 20 23:32:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Hopefully the last combined selectors fix: for 'div p#x', make sure
	the hierarchy becomes 'p -> #x -> div', not 'p -> (#x, div)'.  

Mon Sep 20 23:26:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Compilation fix.  

Mon Sep 20 23:23:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	In css_parse_selector() do not rely on pkg->selector anymore when
	referring to the previous selector but save it in @prev_*_selector
	variables persistent over the loop iterations. This enabled us to
	differentiate between @prev_specific_selector and
	@prev_element_selector and makes sure that when we combine i.e. 'p#x
	i', 'p' will be bound to 'i', not '#x'.  

Mon Sep 20 23:11:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fix the massive leaks for broken stylesheets breaking up in the
	middle of selectors.  

Mon Sep 20 23:01:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	assert() that we never slip to the next in-@pkg iteration when
	@last_fragment is set.  

Mon Sep 20 22:58:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed destroying of perfectly good selectors by brute-force
	reparenting fragments of combined ones (for 'p {x:y}' and 'p i
	{z:a}', first and second 'p' shared a single selector but then we
	reparented the selector behind 'i' and things broke).  

Mon Sep 20 22:56:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Reverted invalid 1.111.  

Mon Sep 20 22:56:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed css_parse_selector()'s wrong token memcpy() size.  

Mon Sep 20 22:54:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	Fix get_css_base_selector() to grok complex expressions as
	@stylesheet.  

Mon Sep 20 22:48:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fix get_css_base_selector() to grok complex expressions as
	@stylesheet.  

Mon Sep 20 22:41:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Ok, we will need the late @element again, so it's reintroduced now,
	but under a different name @last_token.  

Mon Sep 20 22:31:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	get_css_base_selector() now handles NULL passed as @stylesheet.  

Mon Sep 20 22:28:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Eliminated @element in css_parse_selector(), which is now useless.
	Instead, we just move to the next token a little later now.  

Mon Sep 20 22:24:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Apply the style attribute content last, therefore overriding the
	stylesheet once again. Fixes test/css/cascading.html.  

Mon Sep 20 22:18:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed parsing of ID selectors, we now accept the fact that they
	contain the id string in the token itself, not as a successive
	TOKEN_IDENT token.  

Mon Sep 20 22:11:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	Fix bad behaviour when we weren't sure whether a #string is a
	TOKEN_HEX_COLOR or TOKEN_HASH. Patch by Jonas (the idea and missing
	scan_css() fix) and me (the leading hex digits bugfix).  

Mon Sep 20 16:41:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Removed forgotten check for end of selector which prevented us from
	registering complex selectors.  

Mon Sep 20 16:22:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	In merge_css_selectors(), the new selector's properties now win over
	the original ones in case of a conflict.  

Mon Sep 20 15:59:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Mon Sep 20 15:49:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	examine_element(): @altsel -> @selector 

Mon Sep 20 15:49:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	examine_element(): @selector -> @base 

Mon Sep 20 15:27:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/link.c:

	Spell fix.  

Mon Sep 20 12:41:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/hierbox.c:

	Also redraw the hierbox browser window when refreshing it. Bad
	behaviour intoduced in my fix for hierbox browser burying other
	dialog window below itself in bfu/hierbox.c v1.188. Spotted by
	Miciah.  

Mon Sep 20 10:02:06 2004  Laurent Monin <zas@norz.org>:

	* src/document/css/apply.c:

	Compilation fix. Pasky, please check it.  

Mon Sep 20 08:39:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Abstract an examine_element() code bit to a process_found_selector()
	macro.  

Mon Sep 20 08:37:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Hm, compilation fix.  

Mon Sep 20 08:36:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	examine_element() now takes the list of selectors where it should
	search.  

Mon Sep 20 08:29:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Separate stylesheet lookup from css_apply() to examine_element().  

Sun Sep 19 23:00:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	One of the really puzzling Jonas TODOs...  

Sun Sep 19 22:59:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Support for parsing and storing multi-fragment selectors - that
	means 'td.foo p#x>a:hover' should be supported now. Note the absence
	of 'support for applying'. It should be grasped ok but you won't see
	it in practice because the elements matching code is not there yet.  

Sun Sep 19 22:35:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Trivial reorganization in css_parse_selector().  

Sun Sep 19 22:33:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Tidyup the switch of css_parse_selector(). That hex color thing is
	annoying.  

Sun Sep 19 22:32:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Blast off a confusing comment in css_parse_selector().  

Sun Sep 19 22:32:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Try to get css_parse_selector() slightly more organized.  

Sun Sep 19 22:30:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Eliminate the monstrous switch (token->type) in
	css_parse_selector().  

Sun Sep 19 22:25:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Whew, blasted another stale TODO.  

Sun Sep 19 22:25:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	English fix.  

Sun Sep 19 22:11:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, stylesheet.h:

	Support for non-element selectors - ids, classes and pseudo-classes.
	Note that mixing them together (i.e. element and class or id and
	pseudo-class) is not supported yet. Anyway, this means perl sources
	on scripts.irssi.org are highlighted now and news.google.com is full
	of bright green dashes :^).  

Sun Sep 19 21:46:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	TODO about hash^Wbinary trees.  

Sun Sep 19 21:38:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, stylesheet.h:

	*_css_base_selector() now takes @type argument too.  

Sun Sep 19 21:33:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, stylesheet.c, stylesheet.h:

	Added @type argument to the basic *_css_selector() suite, defaulting
	to CSS_ELEMENT for *_base_css_selector().  

Sun Sep 19 21:28:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, stylesheet.c, stylesheet.h:

	Reverted back @element* -> @name*, find_css_selector_by_element() ->
	find_css_selector().  

Sun Sep 19 21:24:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, stylesheet.c, stylesheet.h:

	Convert find_css_selector_by_element(), get_css_selector() and
	init_css_selector() to just work on a list of selectors instead of
	{struct css_stylesheet}, making them more generic.  

Sun Sep 19 20:45:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	Unify declaration style.  

Sun Sep 19 20:44:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	Minor stylistical nitpicking.  

Sun Sep 19 20:38:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	Adjust things to my 80 columns.  

Sun Sep 19 20:34:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: stylesheet.c, stylesheet.h:

	Blasted css_selector.(element,id,class,pseudo) and introduced
	css_selector.name, now equivalent to .element. Things may look a
	little weird now but it will settle down as fast as the C2H5OH in my
	head.  

Sun Sep 19 19:28:20 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Hungarian translation update.  

Sun Sep 19 18:29:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/README:

	How I foresee implementing the selectors tree. Let's drink some wine
	now so mail me if you think it's a total bullshit.  

Sun Sep 19 17:38:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/README:

	Add Id tag.  

Sun Sep 19 17:35:23 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS:

	Miciah is too humble.  

Sun Sep 19 17:30:19 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS:

	Typo fixes.  

Sun Sep 19 17:24:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	The selector grammar description was rewritten, simplified, and made
	more flexible.  

Sun Sep 19 17:21:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Reduced another TODO.  

Sun Sep 19 11:40:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/memory.c:

	Fix mmap() usage on FreeBSD filed as bug 501. Patch by Lewis
	Collard.  

Sun Sep 19 11:40:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS:

	Fix mmap() usage on FreeBSD. Patch by Lewis Collard.  

Sun Sep 19 09:56:02 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS:

	Boost my entry with various stuff so that I don't look as such a
	loser near zas and Jonas. ;-) 

Fri Sep 17 23:17:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Blasted two obsolete FIXMEs. Feels good.  

Fri Sep 17 23:03:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: stylesheet.c, stylesheet.h:

	s/name/element/ in argument list of all CSS selector functions.  

Fri Sep 17 23:01:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Tidyup. Living with 80 columns :-).  

Fri Sep 17 22:58:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, stylesheet.c, stylesheet.h:

	find_css_selector() -> find_css_selector_by_element(), arguments
	renamed appropriately.  

Fri Sep 17 17:21:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	Mention support for specifying IP family as protocol postfix.  

Fri Sep 17 17:14:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Fix typo and reference the generated features.log.  

Fri Sep 17 13:08:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Only send the "ProxyAuthorization" HTTP header if really talking to
	a proxy.  Before it was sent always if protocol.http.proxy.user was
	defined.  
	
	Patch by Timo Lindfors. Updated by me.  

Fri Sep 17 12:23:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/pl.po:

	Fix bad reformatting introduced in fixing of untested translation
	update. Please test changes after updating translations by running
	make in po/.  

Fri Sep 17 12:14:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf:

	Disable finger support by default.  

Thu Sep 16 21:03:48 2004  Laurent Monin <zas@norz.org>:

	* po/pl.po:

	Fix typo in pl.po, preventing compilation.  

Thu Sep 16 19:52:33 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Thu Sep 16 00:32:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/charsets.c:

	Fix probable off-by-one overflow in convert_string() non-callback
	usage. No clue how old it is nor whether it can be ever dangerous
	nor why didn't our debugger detect it.  

Wed Sep 15 23:45:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/charsets.c:

	Call convert_string() @callback only if the buffer would be of
	non-zero length.  

Wed Sep 15 23:42:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/charsets.h:

	Document convert_string().  

Wed Sep 15 23:37:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: cache/cache.c, document/html/parser.c,
	document/html/renderer.c, document/html/parser/forms.c,
	document/html/parser/parse.c, document/plain/renderer.c,
	intl/charsets.c, intl/charsets.h, viewer/text/form.c:

	Potentially fix the convert_string() call from HTML renderer
	duplicating the whole rendered document in memory (which can be
	_SLOW_ for big documents due to low granularity used in
	convert_string(), which is right for most of the other uses). Now it
	takes a @callback argument which is called instead of reallocations
	if non-NULL, convert_string() then always returning NULL.  

Wed Sep 15 14:55:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	set_vars(): Rewrap referrer code.  

Wed Sep 15 14:53:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	set_vars(): Switch in.  

Wed Sep 15 14:51:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	set_vars(): Make same referrer setting saner.  

Wed Sep 15 14:50:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	set_vars(): Rename optstr -> str and rewrap.  

Wed Sep 15 14:40:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Use add_long_to_string() when adding the IP family to the URI
	string.  

Wed Sep 15 10:13:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	add_document_line(): Move assertion of pos[-1].data which can
	potentially access out of bound. Most likely the cause is the plain
	text mark-up. Closes bug 498.  

Wed Sep 15 09:12:44 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/file/cgi.c:

	Sent referrer only when there is one.  

Wed Sep 15 08:27:05 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Sep 14 23:28:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/info.c:

	Display Cache size in get_memory_info() if HAVE_MMAP as it isn't
	counted in the Allocated field.  

Tue Sep 14 23:09:28 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in, src/cache/cache.c, src/cache/cache.h,
	src/util/memory.c, src/util/memory.h:

	Introduced mem_mmap_(alloc|free|realloc)() which covers mmap(),
	munmap() and potentially mremap() (and just reverts to the normal
	heap if the system doesn't provide mmap()). And we use this new
	allocator right away in the cache code for the cache fragments,
	which amounts some small overhead per cache entry but should prevent
	the infamous pathological cases where the ELinks gets fat to 50M and
	doesn't shrink even after a cache flush. Full rationale in a comment
	inside. It crashes surprisingly seldom so there must be some
	kickback. ;-) 

Tue Sep 14 22:31:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cache/cache.c:

	Abstracted out memory manipulation on fragments to
	frag_(alloc|realloc|free)().  

Tue Sep 14 20:58:51 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/file/cgi.c:

	Scripts with .cgi extension are not secure in multiuser environment.  

Tue Sep 14 20:56:36 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/file/cgi.c:

	Fix for bug 373. PATH_TRANSLATED does the trick.  

Tue Sep 14 20:24:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/task.c:

	Handle URI parsing failures properly even with scripting support.  

Tue Sep 14 20:23:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/: uri.c, uri.h:

	Fixed [ipv6addyURInotation] parsing.  

Tue Sep 14 20:05:07 2004  Petr Baudis <pasky@ucw.cz>:

	* features.conf:

	Slightly elaborated on CONFIG_IPV6.  

Tue Sep 14 19:48:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/options.inc, lowlevel/connect.c, protocol/uri.c,
	protocol/uri.h:

	Added support for a 4/6 postfix to the protocol scheme (i.e.
	http4://, http6://).  

Tue Sep 14 17:14:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/options.inc, lowlevel/connect.c:

	Introduced connection.try_ipv[46], which controls whether to use
	IPv4/IPv6 at runtime on a global basis.  

Tue Sep 14 17:10:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/connect.c:

	Move the (sin6|sin)_family logic from socket() call to setting a
	separate @family variable. Purpose will be clear soon.  

Tue Sep 14 07:23:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/gzip.c:

	Remove all the alternative versions of gzip_decode_buffer().  

Tue Sep 14 07:21:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/gzip.c:

	Implement gzip header skipping and switch to do all decoding in
	memory.  
	
	Thanks goes out to lindi- for digging into the problem where I gave
	up and for sstar for enlightening us both.  

Tue Sep 14 06:47:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/gzip.c:

	gzip_decode_buffer(): Like the bzip2 backend check stream.avail_in
	in the decoding loop condition.  

Tue Sep 14 06:46:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/gzip.c:

	gzip_decode_buffer(): Use Z_NO_FLUSH when calling inflate().  

Mon Sep 13 20:04:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/bzip2.c:

	bzip2_decode_buffer(): Check stream.avail_in > 0 in the loop
	condition. lindi- reported that it could cause an infinite loop.  

Mon Sep 13 15:27:18 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/data.c:

	Grammar and spelling fixes in the comment that Jonas just added.  

Mon Sep 13 14:16:57 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Sep 13 11:35:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listbox.c:

	Introduce VERTICAL_LISTBOX_MARGIN macro to make the height
	calculation less cryptic.  

Mon Sep 13 11:17:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/data.c:

	Add FIXME about redirecting.  

Mon Sep 13 01:11:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Fix chopping of junk after port string. Spotted by Miciah.  

Mon Sep 13 00:18:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/gopher/gopher.c:

	Revise the comment describing the gopher_entity_info table.  

Sun Sep 12 23:34:20 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/gopher/gopher.c:

	Indentation fixes.  

Sun Sep 12 22:03:21 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/gopher/gopher.c:

	Comment grammar fix.  

Sun Sep 12 21:12:53 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/gopher/gopher.c:

	Comment typo-fix: s/Otheriwse/Otherwise/ 

Sun Sep 12 20:59:59 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/gopher/gopher.c:

	Comment typo-fix: s/buf/but/ 

Sun Sep 12 20:24:29 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Fix a problem in the last patch whereby freed memory was used.  
	
	Thanks to Jonas for spotting the problem.  

Sun Sep 12 18:14:50 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	Move a semi-colon before a comment on the same line.  

Sun Sep 12 18:10:17 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/session.c:

	Reformat a prototype.  

Sun Sep 12 18:09:25 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Close the clicked tab when one middle-clicks on the tab bar.  

Sun Sep 12 18:08:35 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/tab.c:

	In really_close_tab, delete the tab for the given session without
	assuming that it is the current tab for the terminal.  

Sun Sep 12 18:03:35 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	De-localise local variable |tab|.  

Sun Sep 12 18:01:00 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Introduce local variable |term| to eliminate half a dozen
	occurrences of |ses->tab->term|.  

Sun Sep 12 17:55:33 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In send_mouse_event, rename local integer variable |tab| to
	|tab_num|.  

Sun Sep 12 12:12:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Out comment unportable check for numbers of characters in the
	English alphabet added in 1.422. Fixes bug 475 about breakage on
	OpenBSD and adamg also reported problems on pdksh.  

Sun Sep 12 11:12:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/bookmarks.c:

	open_bookmark_folder(): Open bookmark tabs in the order they have in
	the folder so it doesn't open in the reverse order half of the time.
	It matches 1.110 -> 1.111 that fixed session saving to bookmark tabs
	from left to right.  

Sun Sep 12 11:05:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Fix session auto restoring broken by my reorderings in
	init_session().  

Sun Sep 12 06:03:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Localise p.  

Sun Sep 12 06:02:18 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	In mainmenu_mouse_handler, use the constant L_MAINMENU_SPACE instead
	of the local variable p, which is initialised to the same, when
	checking whether the user clicked on the left scroll spot.  

Sun Sep 12 04:14:53 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	In menu_mouse_handler, eliminate some code duplication with the aid
	of a fall-thru.  

Sun Sep 12 04:09:28 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Delete a comment rendered inaccurate by revision 1.162, where
	menu_mouse_handler was split from menu_handler.  

Sun Sep 12 04:02:22 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Re-indent, with the aid of continue.  

Sun Sep 12 03:56:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Rename nbox to box.  

Sun Sep 12 03:54:09 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Eliminate box.  

Sun Sep 12 03:52:15 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Introduce the local variable menu_height, assign it the value of
	nbox.height before assigning nbox.height = 1, and use menu_height 
	instead of box.height.  

Sun Sep 12 03:49:02 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Copy box to nbox sooner and pass nbox instead of box to draw_box and
	draw_border.  

Sun Sep 12 03:43:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Use .x and .width of nbox rather than those of box as those members 
	are the same.  

Sun Sep 12 03:34:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Move the assignment |nbox.height = 1| outside of the loop.  

Sun Sep 12 03:31:36 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	In display_menu, delete the local variable y; instead, use nbox.y, 
	which we were already keeping in sync with y.  

Sun Sep 12 02:56:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/inpfield.c:

	In input_line_event_handler, when the input line's handler returns
	INPUT_LINE_REWIND, after rewinding, call the handler again.  
	
	Now, when one starts type-ahead searching, enters a matching
	pattern, and then enters a character that yields a non-matching
	pattern causing type-ahead searching to rewind, the highlighting for
	matched text is restored, and the tab key will cycle thru matches
	instead of trying to search for the non-matching pattern again.  

Sun Sep 12 02:34:52 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/listbox.c:

	Add a blank line before a return statement.  

Sun Sep 12 02:34:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/listbox.c:

	Unwrap a line.  

Sun Sep 12 02:33:50 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/listbox.c:

	Use the ternary operater instead of an if-else statement in
	mouse_listbox.  

Sun Sep 12 02:30:12 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/listbox.c:

	In mouse_listbox, remove a check whether the event is button-up or
	button-down: it is always either one or the other.  
	
	Patch by Jonas.  

Sun Sep 12 02:27:29 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Missing part from last patch: 
	
	In frame_ev_mouse, call do_not_ignore_next_mouse_event for left- or
	middle-button down, and call link_menu for both right-button up and
	right-button down.  

Sun Sep 12 00:38:28 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/menu.c, terminal/event.c,
	terminal/terminal.h:

	Introduce new member to struct terminal, struct term_event_mouse
	prev_mouse_event.  
	
	Introduce new macro do_not_ignore_next_mouse_event, which clears it.  
	
	Introduce new routine ignore_mouse_event, used by
	handle_interlink_event to ignore mouse-button up following
	mouse-button down when the button and y co-ordinate are the same
	between both events.  
	
	In mouse_checkbox and mouse_button, call
	do_not_ignore_next_mouse_event, so that after a mouse-button down
	(to select the item), mouse-button up (to activate it) will not be
	ignored.  
	
	Idea and code by Jonas and me.  

Sat Sep 11 22:52:25 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Mention ui.colors.color.tabs.unvisited, added in 0.9.1.  

Sat Sep 11 22:41:57 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	ELinks-now: Plain-text mark-up support. Noted by Jonas.  

Sat Sep 11 22:39:57 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Mention add-bookmark-tabs (bookmark all tabs) option and menu item,
	added in 0.9.1.  

Sat Sep 11 22:34:00 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Mention folding of multiple successive blank lines, added in
	ELinks-0.9.1.  

Sat Sep 11 22:30:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Move automatic session-saving/restoring from ELinks-now to
	ELinks-0.9.1.  

Sat Sep 11 22:22:00 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Mention beginning-of-buffer and end-of-buffer actions under
	ELinks-0.9.1.  

Sat Sep 11 22:07:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Add a section for ELinks-0.9.1, and add thereunder an entry for
	<object> support.  

Sat Sep 11 22:01:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Add an entry for the 'unset' configuration directive, added in
	0.9.2.  

Sat Sep 11 21:56:30 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Move 'directional links navigation' entry from ELinks-now to a new
	section, ELinks-0.9.2. Altho the features was developed on HEAD, it
	has been backported, and the first stable release with it is 0.9.2.  

Sat Sep 11 21:54:17 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* NEWS:

	Tweak and clarify some entries for ELinks-now.  

Sat Sep 11 20:39:23 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Translation update.  

Sat Sep 11 18:02:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10pre0.CVS 

Sat Sep 11 17:30:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	0.10pre0 

Sat Sep 11 17:19:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	The big po sync.  

Sat Sep 11 17:10:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree. Heh now the default System codepage
	values is visible.  

Sat Sep 11 17:09:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/backend/default.c:

	Make the mime.handlers description less passive and format it so
	that it does not break elinks.conf.5 updating.  

Sat Sep 11 16:50:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/hierbox.c:

	update_hierbox_browser() Fix refreshing of hierbox browsers buried
	under other dialogs by using redraw_from_window() instead of only
	display_dlg_item().  
	
	To trigger: open one elinks, open bookmark manager, open a bookmark
	edit dialog, start second elinks, quit second elinks, first elinks
	has bookmark manager refresh on top of edit dialog.  

Sat Sep 11 16:37:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/href_tests.html:

	Gopher links.  

Sat Sep 11 16:31:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	One could get the impression we actually did implement that RFC.  

Sat Sep 11 13:55:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	A highly questionable patch to align the table caption correctly. It
	was triggered by <http://freshmeat.net/articles/view/1279/> table
	caption nested in a table that would cause the caption to be
	positioned according to the nesting table cell. Or so it seems.  

Sat Sep 11 05:36:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/inpfield.c:

	Give field_ops an explicit NULL |select| callback.  

Sat Sep 11 04:42:25 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/intl/charsets.c:

	Fix a copy-and-paste error.  
	
	CCMAIL:witekfl@poczta.gazeta.pl 

Sat Sep 11 04:39:29 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/intl/charsets.c:

	Take off the flag in cp2utf_8 as well, per Jonas' suggestion.  
	
	_Really_ do it in u2cp_ (I had deleted that line for testing in the
	middle of committing the patch -- oops).  
	
	CCMAIL:witekfl@poczta.gazeta.pl 

Sat Sep 11 04:32:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/intl/charsets.c:

	In u2cp_, strip SYSTEM_CHARSET_FLAG from |to|, which is used to
	index the codepages array.  
	
	This fixes a bug that caused ELinks to crash on any page containing
	HTML entities that are represented by characters that are beyond
	lower ASCII.  The bug was introduced in revision 1.96, 'Fix for bug
	494 - System charsets.' 
	
	CCMAIL:witekfl@poczta.gazeta.pl 

Fri Sep 10 16:13:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Back out 1.580 -> 1.581. It is only part of the intended change.
	FIXME added to lure possible developers to do the remaining work.
	This should make it up for Sergeys patch posted today
	<Pine.LNX.4.61.0409101611300.1601@tigris.sai.msu.ru> and fix bug
	493. Plus it should bring us one step closer to release usable
	1.0pre0.  

Thu Sep  9 10:13:13 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/intl/charsets.c:

	Fix for bug 494 - System charsets.  

Thu Sep  9 10:05:55 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Translation update.  

Tue Sep  7 10:47:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Fix bug 496 involving memory leaks when handling HTTPS proxy
	connections.  

Tue Sep  7 10:41:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	The reordering of session status updating _also_ has benefits when
	dealing with big documents. Important clarity by Miciah.  

Sat Sep  4 12:34:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	Add smart prefix 'fsd' for searching the Free Software Directory.  

Sat Sep  4 11:31:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Fix potentially dangerous printf(gettext()) usage to printf(%s,
	gettext()). They caused the gettextized string to be marked with
	c-format.  

Sat Sep  4 11:19:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, bookmarks/backend/xbel.c, config/cmdline.c,
	intl/gettext/libintl.h, lowlevel/home.c, lowlevel/interlink.c,
	lowlevel/select.c, mime/backend/mailcap.c, terminal/kbd.c,
	viewer/dump/dump.c:

	Revert G_() abbreviation introduction and always use gettext().
	Apparently xgettext cannot recognize them. Hopefully some of the
	translated messages has not been lost.  

Sat Sep  4 11:08:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/pl.po:

	Temporary fix for pl.po update. Either something got lost or it
	should be ok to remove ending \n reported by msgfmt.  

Sat Sep  4 10:53:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/pl.po:

	Update of polish translations. Patch by Adam Golebiowski
	<adamg@pld-linux.org>.  

Fri Sep  3 19:45:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	Revert the down prioritizing of the content type info from the
	protocol header. It looks like the decoding buffer support will
	magically be handled by the rendering if it is needed. Reported by
	Felix on elinks-dev.  

Fri Sep  3 16:09:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	The error handling in the IDN support is not particularly good so
	fall back to just add the host unprepared.  

Fri Sep  3 15:35:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	Mention usage of automake conditionals and -verbose option.  

Fri Sep  3 11:20:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/link.c:

	Improve handling of <object> element.  

Fri Sep  3 11:19:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	get_extension_content_type(): Assert that the extension is useful.  

Fri Sep  3 11:17:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/link.c:

	Fix crash when the <embed> src attribute is empty and a content type
	lookup is performed. Reported by pasky.  

Fri Sep  3 02:31:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS:

	Update polish translator authors adding adamg and mikmach.  

Fri Sep  3 02:14:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/dialogs/info.c:

	Change maintainer. Climb mount Ego and plant my flag in the copying
	dialog.  

Fri Sep  3 02:10:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	check_uri_file(): Fix restoring of NUL'ed out char. Introduced in my
	fix for always checking the 3 URI component delimiter chars.  

Thu Sep  2 15:50:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Print that the feature summary is available in the features.log
	file.  

Thu Sep  2 15:34:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	Elaborate and add modal text-input form-field editing and goper and
	NNTP protocol support.  

Thu Sep  2 14:42:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	s/feature.conf/features.conf/ 

Mon Aug 30 03:08:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Oops, missing part of previous patch.  

Mon Aug 30 03:08:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/screen.c:

	Space.  

Mon Aug 30 03:06:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Don't just check special chars in the URI file name the first time
	and fix signed -> unsigned int triggered bug in file URI parsing.  

Sat Aug 28 16:23:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Related to bug 297: Big memory leak, ELinks doesn't free memory on
	cache flush atleast this was discovered while debugging that bug.  
	
	When initializing a session in init_session() update the session
	status info _before_ opening the requested URI. Reduces the memory
	usage quite a bit from looking at top.  

Sat Aug 28 14:58:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/document.c:

	Remove global @format_cache_entries and the hazzle with keeping it
	in sync. It is not even used when returning document cache info and
	we are iterating all entries in shrink_format_cache() (only real
	user) anyway so count it there.  

Sat Aug 28 14:23:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Make {struct uri} length members unsigned int.  

Sat Aug 28 02:52:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/formhist/formhist.h:

	Boolean members should always have unsigned int type.  

Mon Aug 23 17:22:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.h:

	Renumerate.  

Mon Aug 23 17:15:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, protocol/http/http.c,
	sched/connection.h, sched/error.c:

	Try to simplify connection states by making S_SSL_ERROR be
	equivalent to S_NO_SSL when CONFIG_SSL is not defined.  

Mon Aug 23 17:04:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.h:

	Remove obsolete S_NO_FINGER and S_NO_SMB states.  

Mon Aug 23 17:03:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, sched/error.c:

	generic_external_protocol_handler(): Handle 'This version of ELinks
	does not contain X protocol support' in the default case. Also
	genericly handle no-SSL reporting. Should fix missing error messages
	for optional data, gopher and nntp protocols.  

Mon Aug 23 02:52:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/data.c:

	Make that atleast 3 chars in the data protocol mediatype.  

Mon Aug 23 02:50:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/data.c:

	Improve data protocol mediatype and base64 attribute checking.  

Mon Aug 23 02:37:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/data.c:

	Rename parse_data_uri_type() to parse_data_protocol_header().  

Mon Aug 23 00:29:35 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/protocol.c:

	Delete a comment that refers to protocol external-handlers, which
	were removed in revision 1.47.  

Mon Aug 23 00:20:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/connection.c:

	Fix a typo in a comment: s/managment/management/ 

Sun Aug 22 15:17:56 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Aug 22 15:14:33 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	Typo fix: reguler -> regular.  

Sun Aug 22 14:31:06 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/data.c:

	Fix compilation issue, @type needs to be initialized.  

Sun Aug 22 00:54:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Fix (1.65->1.66) by using integer type for @start and @end since 0
	<= -1 for enum values.  

Sat Aug 21 21:51:28 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/renderer.c:

	In process_link, use a switch instead of an if-else and assertion.  

Sat Aug 21 21:47:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/renderer.c:

	In process_link, should link_state be neither LINK_STATE_NEW nor
	LINK_STATE_SAME, thereby triggering an assertion, provide a recovery
	path by returning if_assert_fails.  

Sat Aug 21 21:38:13 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/renderer.c:

	Wrap a line.  

Sat Aug 21 21:11:33 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/uri.c:

	Rewrap two lines.  

Sat Aug 21 16:55:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	get_protocol(): Use almost binary searching. Checking HTTP entry
	first.  

Sat Aug 21 15:59:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h:

	Alphabetize protocol backends.  

Sat Aug 21 15:16:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/generic.h:

	Wrap <stddef.h> #include in HAVE_STDDEF_H.  

Sat Aug 21 14:57:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Remove unused #include.  

Fri Aug 20 23:46:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser/parse.c, formhist/formhist.c,
	sched/connection.c:

	Clean up block trailing semicolons.  

Fri Aug 20 21:41:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/refresh.c:

	Fix starting of multiple document refresh timers. Reported by pasky
	when he was throwing hand signs at transport tycoon forum (the URI
	is in the comment).  

Fri Aug 20 21:28:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/refresh.c:

	Remove trailing semicolons.  

Fri Aug 20 21:28:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/document.c:

	Use foreachsafe().  

Fri Aug 20 15:51:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Attempt to fix bug 479 by never updating @last_link_to_move and
	@last_tag_to_move beyond the current line. For some scenarios it
	might be a bad assumption but at least all it does is decrease the
	gain that this position updating optimization provides.  

Fri Aug 20 15:19:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	move_links(): Use while (list_has_next(tags, tag)) looping.  

Fri Aug 20 14:22:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	move_links(): Tidyup.  

Fri Aug 20 04:05:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Parse user and custom protocols using free_syntax. I think Miciah
	mentioned it a few months ago. Fixes an assertion error in
	check_uri_sanity() with 'entering' mailto links in binary files.  

Fri Aug 20 04:02:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	check_uri_sanity(): Print the URI in the error message.  

Fri Aug 20 03:43:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Fix email address checking so there is stuff on both sides of the
	'@'-sign.  

Thu Aug 19 20:57:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/vs.h:

	Boolean members should always have unsigned int type.  

Thu Aug 19 14:11:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf, src/protocol/gopher/gopher.c,
	src/sched/connection.h, src/sched/error.c:

	Make it more clear that the CSO phone-book protocol is non-existent
	both at compile- and runtime.  

Thu Aug 19 10:32:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	Partially revert revision 1.315 and abort the download in
	download_data_store if |term| is NULL (before 1.315, it was checking
	whether |ses| was NULL).  

Thu Aug 19 10:24:01 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	Add an #include for util/lists.h 

Thu Aug 19 10:23:19 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	Use foreachsafe in destroy_downloads.  

Thu Aug 19 10:04:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	In destroy_downloads, when we find a session with the same terminal
	as that of the passed session, assign the found session to the |ses|
	member of the file downloads of passed session to avoid dangling
	pointers.  

Thu Aug 19 10:02:35 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	In destroy_downloads, in the loop that searches for a session with
	the same terminal as that of the one for which we are deleting file
	downloads, replace the if-continue with if-continue-else-return with
	an inverted condition.  

Thu Aug 19 09:58:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	In destroy_downloads, which deletes a session's file downloads, when
	we skip deletion of file download because it has a NULL |prog|, 
	assign its |ses| member NULL to avoid a dangling pointer.  

Thu Aug 19 09:44:43 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	In download_data_store, assert |term| and |ses| instead of silently
	aborting when |ses| is NULL.  

Thu Aug 19 09:41:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	Use |file_download->term| instead of |ses->tab->term| with |ses|
	obtained from |file_download->ses|.  

Thu Aug 19 09:35:58 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	Delete get_download_ses() and instead use |file_download->ses|.  

Thu Aug 19 09:30:44 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/download.c:

	In download_data_store, pass |ses| to |msg_box| instead of passing 
	|get_download_ses(file_download)|, which is already assigned to
	|ses|.  

Thu Aug 19 08:58:44 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In add_document_line, delete the local variable |last_link_end|, 
	which has been unused since revision 1.128.  

Thu Aug 19 08:52:00 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Fix an overflow in the back-space code: If one has seventeen spaces 
	(number chosen to avoid memory-alignment from obscuring the problem) 
	followed by a back-space, we print seventeen characters to the
	screen before we back-space the last one. The solution is to include 
	the deleted characters in counting how much memory to allocate for
	the line.  
	
	The overflow was found by Jonas Fonseca in a test-case provided by
	AprilDL when reporting another problem.  

Thu Aug 19 08:12:52 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Delete a blank line.  

Thu Aug 19 08:12:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Rewrap.  

Thu Aug 19 08:08:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/: renderer.c, renderer.c:

	If-splice.  

Thu Aug 19 08:01:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Similar change to the code that counts how much memory to allocate
	for the line.  

Thu Aug 19 07:53:57 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Do not expand tabs that precede back-space characters.  Now, the
	back-space code will back-space the proper amount: one space, just
	as for any other character.  

Thu Aug 19 07:43:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Use |next_char| in the linkifying code.  

Thu Aug 19 07:41:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Move |next_char| and |prev_char| out of the back-space code to the
	containing loop.  

Thu Aug 19 07:30:34 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	s/ $// 

Thu Aug 19 07:29:02 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Eliminate |saved_char| as |prev_char| supersedes it.  

Thu Aug 19 07:27:09 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Assign |next_char| '\0' if |line[line_pos + 1]| is out of bounds.  

Thu Aug 19 07:24:13 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In the code in add_document_line to handle backspace characters, 
	introduce the local variables |next_char| and |prev_char| and use
	them instead of subscripting |line|.  

Thu Aug 19 07:16:03 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Delete a blank line that should have disappeared along with some
	other code in revision 1.132.  

Thu Aug 19 07:12:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In add_document_line, check whether |expanded + line_pos| is
	non-zero rather than maintaining a count of backspaces and checking 
	whether it doubled is less than |line_pos|.  
	
	This will affect the current quirky behaviour on tabs followed by
	backspaces: Now, we will avoid backspacing beyond the start of the
	expanded line rather than beyond the start of the line as counted in
	characters.  I intend eventually to improve backspace handling so
	that a backspace that immediately follows a tab will backspace the
	whole tab in the first place.  

Thu Aug 19 06:58:56 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In add_document_link, substitute a conditional decrement and an
	unconditional decrement for a conditional decrement-by-two or
	decrement.  

Thu Aug 19 05:26:33 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	At Jonas' behest, revert revision 1.124 by re-introducing in
	print_document_link the local variable |x|, but change the name to
	|screen_column| to better explain the significance of its value.  

Wed Aug 18 21:19:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	get_content_type(): Lowercase the extension always so .JPG gets
	treated as .jpg .. it is stupid to have to add two entries for this
	thing. Mostly old files use uppercase anyway (gopher triggered the
	issue for me).  

Wed Aug 18 20:40:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	add_gopher_menu_line(): Try to eliminate unneeded default gopher
	port number from links.  

Wed Aug 18 20:02:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: encoding/encoding.c, protocol/file/file.c,
	sched/connection.h, sched/error.c:

	When loading encoded files that are corrupt read_file() would end up 
	retuning -errno == 0 (which is used for S_WAIT). This patch
	introduces S_ENCODE_ERROR with the purpose of propagating an error
	message to the user. I hope this qualifies as a fix for the FIXME.  

Wed Aug 18 19:49:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	Fix CONFIG_BZIP2 check.  

Wed Aug 18 19:24:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/gzip.c:

	gzip_decode_buffer(): Fix encoding stream leak.  

Wed Aug 18 18:27:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	read_gopher_response_data(): if rb->close == 2 add any additional
	data to the cache entry before shutting down the connection.  

Wed Aug 18 18:11:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Alphabetize gopher_entity_info[] entries.  

Wed Aug 18 18:09:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Now all cso stubs uses S_UNKNOWN_PROTOCOL.  

Wed Aug 18 18:07:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	gopher_protocol_handler(): Out comment the finger redirect detection
	code.  

Wed Aug 18 17:43:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Remove dummy cso_protocol_handler().  

Wed Aug 18 17:42:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	add_gopher_menu_line(): If no selector is defined just diplay the
	name text.  

Wed Aug 18 17:37:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Fix init_gopher_index_cache_entry() and free(NULL).  

Wed Aug 18 17:30:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/gopher.c:

	Clarify why @port is checked.  

Wed Aug 18 17:24:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf, src/config/options.inc,
	src/protocol/Makefile.am, src/protocol/protocol.c,
	src/protocol/protocol.h, src/protocol/gopher/Makefile.am,
	src/protocol/gopher/gopher.c, src/protocol/gopher/gopher.h:

	Experimental gopher support ported from Lynx. No CSO for now.  

Wed Aug 18 17:20:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/gopher/: .cvsignore, .vimrc:

	m77p.  

Wed Aug 18 14:12:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Fix building with marks disabled. This and previous error was
	reported by lindi- 

Wed Aug 18 14:11:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/data.h:

	Conditionally declare the data_protocol_handler.  

Tue Aug 17 13:39:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/nntp/connection.h:

	Cleanup #include and protocol handler declaring.  

Tue Aug 17 13:38:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/Makefile.am:

	Alphabetize. Why should intl get special treatment.  

Tue Aug 17 08:05:15 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/menu.c, document/html/parser.c:

	Put spaces after type casts.  

Tue Aug 17 08:03:17 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/button.c, ssl/ssl.c, cookies/cookies.c,
	modules/module.h, document/plain/renderer.c:

	Move end-of-line comments after the semicolons of the statements
	that they follow.  

Tue Aug 17 07:54:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Rather than checking whether the current and the previous characters 
	are alphabetic and backing up if so when linkifying, check whether 
	the curent and the next character are alphabetic. This localises the
	optimisation and makes it trivial to change the code to check for, 
	say, three or four alphabetic characters in a row.  

Tue Aug 17 07:47:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Initialise |was_alpha_char| outside of the loop in add_document_line 
	to fix the optimisation that I broke in 1.114.  

Tue Aug 17 07:40:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Spiff up the comment describing when we check for a URI.  

Tue Aug 17 07:19:11 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Color links.  

Tue Aug 17 07:16:22 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Put the characters to the screen from within print_document_link 
	rather than from within add_document_link.  

Tue Aug 17 07:09:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Pass print_document_link the renderer instead of the document, which
	it now obtains from the renderer.  

Tue Aug 17 06:59:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In print_document_link, inverse the if condition and swap its return
	statement with the following one.  

Tue Aug 17 06:57:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In print_document_link, introduce the local variable |link_end|.  

Tue Aug 17 06:55:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In print_document_link, drop the local variable |x| and substitute 
	the expression previously assigned to it in the one place we used
	it.  

Tue Aug 17 06:52:11 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	We only check for a link when the current character is alphabetic 
	and the last character was alphabetic or we are at the beginning of
	the line; if we are not at the beginning of the line, we must back
	up and linkify the character before the current.  
	
	Back up in add_document_link instead of in print_document_link.  

Tue Aug 17 06:44:29 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Unwrap lines in print_document_link.  

Tue Aug 17 06:43:39 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Move linkifying code from add_document_line to new
	print_document_link.  

Tue Aug 17 04:54:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Add some missing #include directives: termina/color.h, for enum
	color_flags, enum color_mode, and set_term_color; 
	document/options.h, for struct document_options and global_doc_opts;
	and util/color.h, for color_t, struct color_pair, and
	INIT_COLOR_PAIR().  

Tue Aug 17 04:45:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In add_document_line, save the whole |renderer->template| rather
	than merely its |attr| member.  

Mon Aug 16 18:04:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/nntp/: .cvsignore, .vimrc:

	m33p 

Mon Aug 16 17:03:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/window.c:

	delete_window_ev(): Fix triggering of the assertion in tabwin_func
	that it is only called for current tab and the event is from
	keyboard or mouse.  
	
	Reproducable when openning two tabs, switching back to the first
	one, opening the tab menu and then clicking on the tab area with the
	mouse.  

Mon Aug 16 13:49:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	check_link_word(): Ensure there is <user> before @ in mailto checks.  

Mon Aug 16 12:26:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Splice two if-blocks together.  

Mon Aug 16 12:20:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	No need to set @was_alpha_char if is already set.  

Mon Aug 16 11:05:09 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Rewrap some lines.  

Mon Aug 16 11:03:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In add_document_line, linkify in the second loop, when we're drawing 
	the text to the screen, rather than in the first loop, when we're 
	determining the line's width. This change requires the elimination 
	of that great chunk of code duplication, '[a] little code redundancy 
	to improve performance' from zas. Will he complain? 

Mon Aug 16 10:27:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In add_document_line, always set |was_alpha_char = 0| for the
	backspace character.  

Mon Aug 16 10:14:23 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Revert an unrelated change that snuck in with the last patch.  

Mon Aug 16 10:11:40 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Allow ASCII mark-up: x^Hx for a bold 'x' and _^Hx or x^H_ for an
	underlined 'x'; combinations are supported.  

Mon Aug 16 10:09:43 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Properly handle backspaces.  

Mon Aug 16 01:05:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	get_content_type(): Try to more correct get the content type by not
	always trusting the cache header content type when the resource has
	signs of being encoded. This might break things a bit but now
	.html.gz should work from any webserver --dump'ing or not. Atleast
	now gzipped patches can be viewed without scripting.  

Mon Aug 16 01:02:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: renderer.c, html/renderer.c, html/renderer.h,
	plain/renderer.c, plain/renderer.h:

	Add support for rendering encoded documents (from cache).  

Mon Aug 16 00:59:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/: bzip2.c, encoding.c, encoding.h, gzip.c:

	Upgrade the encoding module with a decoding buffer routine. That
	gzip thing went out of proportions since I had to probe three times
	to find a working solution (and what an ugly one it is). The
	discarded probes (in order of 'cleanest design') has been out
	commented. Please somebody check if I made some mistake there.  

Mon Aug 16 00:34:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	get_cache_header_content_type(): Reformat.  

Mon Aug 16 00:33:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	get_content_type(): Split out cache header checking to
	get_cache_header_content_type().  

Sun Aug 15 16:35:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/de.po:

	German translation update by Thomas Fuchs <antispam17@gmx.de>.  

Sun Aug 15 15:44:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	init_remote_session(): When SES_REMOTE_CURRENT_TAB is masked out and
	no other flags are defined OR in the SES_REMOTE_NEW_TAB flag. The
	alternative fix is to always mask in this flag when ORing
	SES_REMOTE_CURRENT_TAB (don't know which one is cleaner).
	Reproducable when passing '-remote openURL(...)'. Reported by Thomas
	Fuchs <tfox@gmx.de>.  

Sun Aug 15 11:56:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/hierbox.c:

	In do_delete_item, drop the |delete| parameter and related bad
	logic, which were introduced (replacing logic that was merely
	twisted) in revision 1.114 to force recursive deletion of all
	children The one call to do_delete_item with a non-zero argument for
	the |delete| parameter was deleted in revision 1.180, which moved
	responsibility for child-deletion to the listbox delete operator.  

Sun Aug 15 11:52:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/action.c,
	viewer/text/form.c, viewer/text/form.h, viewer/text/search.c,
	viewer/text/search.h, viewer/text/view.c, viewer/text/view.h:

	Make frame_action handlers return {enum frame_event_status}.  

Sun Aug 15 10:06:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	In menu_mouse_handler, when handling a right-click event outside the
	menu, forward the event. Now, when one left-clicks the main menu-bar
	or right-clicks the document canvas or a link, the new menu opens on
	mouse-down.  

Sun Aug 15 09:54:25 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/listbox.c:

	When clicking a listbox item, select it on mouse-button down as well
	as up.  

Sun Aug 15 09:53:22 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	When right-clicking a link, open the link menu on mouse-button down 
	as well as on mouse-button up.  

Sun Aug 15 08:28:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/status.c:

	In display_status_bar, move the local variable last_current_link to
	the block in which it is used.  

Sun Aug 15 08:23:09 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/status.c, viewer/text/view.c:

	display_status_bar: Print a relevant message if the user has pressed 
	mark-goto, mark-set, or a numeric prefix.  
	
	send_to_frame: Call print_screen_status if we aren't calling
	refresh_view.  

Sun Aug 15 07:54:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	try_jump_to_link_number: Swap the return values so that now it
	returns 0 if an invalid number was given, 1 otherwise.  

Sun Aug 15 07:38:23 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	In text_typeahead_handler, do not report failure to compile a
	regular expression and do not rewind on such an error.  
	
	This allows one to enter regular expressions without the handler 
	deleting characters when it tries and fails to compile the partial 
	regular-expression in the middle of the user typing it.  

Sun Aug 15 07:32:50 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Don't report an error when the user presses search-toggle-regex and
	we can't find the pattern under the new mode. It isn't too nifty, 
	and the change eases my next patch.  

Sun Aug 15 07:15:33 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	enum find_error: Add FIND_ERROR_MEMORY and FIND_ERROR_REGEX.  
	
	print_find_error: Print an appropriate message for FIND_ERROR_REGEX, 
	indicating a compilation failure for the regular expression.  Do not
	print anything for FIND_ERROR_MEMORY as a message box will take
	memory.  
	
	find_next_do: Return FIND_ERROR_MEMORY or FIND_ERROR_REGEX when 
	is_in_range returns -1 or -2, respectively.  
	
	find_next_do will now return FIND_ERROR_MEMORY when the assertion in
	is_in_range fails. This design may be semantically conspicuous, but
	it should not cause any problems as print_find_error will not
	display a message for FIND_ERROR_MEMORY. I assume that the message
	printed by assert() obviates any need for a message box.  

Sun Aug 15 06:55:20 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	is_in_range_regex: Return -2 for regular-expression compilation
	failure and -1 for memory allocation failure.  
	
	is_in_range_plain: Return -1 for memory allocation failure.  
	
	is_in_range (which will return the return value of one of the
	preceding two routines): Return -1 for assertion failure.  
	
	find_next_do: Interpret only values from is_in_range that are
	greater than 0 as success values.  

Sun Aug 15 06:49:08 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	get_range: Return -1 for assertion failure to distinguish it from no
	match, in which case we return 1.  

Sun Aug 15 05:51:12 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* Unicode/Makefile.am, contrib/Makefile.am, doc/book/Makefile.am,
	test/Makefile.am:

	Use explicit file lists or more specific globs than just '*' when
	setting EXTRA_DIST. This should eliminate the erroneous distribution
	of CVS and possibly other files.  

Sun Aug 15 05:48:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/osdep/: unix/Makefile.am, win32/Makefile.am:

	Use one-space indenting.  

Sun Aug 15 05:46:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/Makefile.am:

	Whitespace clean-up.  

Sun Aug 15 00:43:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_CHECK_COMPILER_MACRO upgraded to EL_CHECK_COMPILER_MACROS .. so
	that we can also check __WIN32__ macro like the gettext code does.  

Sun Aug 15 00:27:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/osdep.c, osdep/osdep.h, osdep/os2/os2.c,
	osdep/win32/win32.c, terminal/terminal.c:

	Introduce get_shell() which checks GETSHELL env. variable or falls
	back to DEFAULT_SHELL. Replaces three implementations.  

Sat Aug 14 23:53:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: beos/sysinfo.h, os2/sysinfo.h, unix/sysinfo.h:

	Remove unused ASSOC_BLOCK and ASSOC_CONS_XWIN. From looking at
	links2 code it looks like remaining parts of the dialog code for
	handling associations between content types and external programs.  

Sat Aug 14 23:48:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: beos/sysinfo.h, os2/sysinfo.h, riscos/sysinfo.h,
	unix/sysinfo.h, win32/sysinfo.h:

	Tidyup sysinfo.h files.  

Sat Aug 14 23:36:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/os2/sysinfo.h:

	CONFIG_OS2 is defined by configure on basis of __EMX__ compiler flag
	and the beos sysinfo.h file is already guarded by #ifdef CONFIG_OS2
	so no need for this extra #ifdef __EMX__.  

Sat Aug 14 23:34:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: system.h, beos/sysinfo.h, os2/sysinfo.h,
	riscos/sysinfo.h, unix/sysinfo.h, win32/sysinfo.h:

	Remove unused system identifiers.  

Sat Aug 14 23:29:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: newwin.c, osdep.c, system.h, win32/sysinfo.h,
	win32/win32.c, win32/win32.h:

	Obsolete usage of WIN32 #define in favor of CONFIG_WIN32.  

Sat Aug 14 23:23:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: osdep.c, system.h, unix/sysinfo.h, unix/unix.c,
	unix/unix.h:

	Obsolete usage of UNIX #define in favor of CONFIG_UNIX.  

Sat Aug 14 23:18:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/newwin.c, osdep/osdep.c, osdep/system.h,
	osdep/os2/os2.c, osdep/os2/os2.h, osdep/os2/sysinfo.h,
	util/secsave.c:

	Obsolete usage of OS2 #define in favor of CONFIG_OS2.  

Sat Aug 14 23:13:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/system.h:

	Reintroduce CONFIG_<OS> #define sanity checking. This will make sure
	that config.h is always included before elinks.h 

Sat Aug 14 23:08:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/newwin.c, osdep/osdep.c, osdep/system.h,
	osdep/beos/beos.c, osdep/beos/beos.h, osdep/beos/overrides.c,
	osdep/beos/overrides.h, osdep/beos/sysinfo.h, terminal/terminal.c:

	Obsolete usage of BEOS #define in favor of CONFIG_BEOS.  

Sat Aug 14 23:00:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: osdep.c, system.h, riscos/riscos.c, riscos/riscos.h,
	riscos/sysinfo.h:

	Obsolete usage of RISCOS #define in favor of CONFIG_RISCOS.  

Sat Aug 14 21:42:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/util/: color.inc, color_s.inc:

	Clarify that color_s.inc is always included and that color.inc is
	only included if CONFIG_SMALL is undefined.  

Sat Aug 14 21:30:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/util/Makefile.am:

	Sort libutil_a_SOURCES.  

Sat Aug 14 21:28:53 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/ssl/Makefile.am:

	Add TODO to EXTRA_DIST.  

Sat Aug 14 21:15:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/osdep/Makefile.am, src/osdep/system.h:

	Move OS compiler macro checks to configure and conditionalize
	src/osdep/ building.  

Sat Aug 14 21:13:17 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/osdep/unix/Makefile.am:

	Fix some indenting.  

Sat Aug 14 21:12:36 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bookmarks/backend/Makefile.am, document/css/Makefile.am,
	document/html/Makefile.am, document/html/parser/Makefile.am,
	mime/backend/Makefile.am, osdep/beos/Makefile.am,
	osdep/os2/Makefile.am, osdep/riscos/Makefile.am,
	osdep/unix/Makefile.am, osdep/win32/Makefile.am:

	s/convience/convince/ 

Sat Aug 14 15:59:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Always update cache_entry->content_type and try to handle allocation
	failure when the local @type variable is non-NULL.  

Sat Aug 14 15:57:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/Makefile.am:

	The data.[ch] should always be in EXTRA_..._SOURCES. Tak Miciah.  

Sat Aug 14 15:26:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	In text_typeahead_handler, return INPUT_LINE_REWIND when
	search_for_do indicates an error and there is something in the
	buffer.  

Sat Aug 14 15:22:39 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	search_for_do: return the result of find_next_do.  

Sat Aug 14 15:21:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	In search_for_do, to report errors, call print_find_error directly 
	with the return value of find_next_do, rather than calling find_next 
	in place of find_next_do.  

Sat Aug 14 15:16:48 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/inpfield.c:

	In input_line_event_handler, after back-spacing when the input-line
	handler returns INPUT_LINE_REWIND, call update_dialog_data to update 
	|input_line->buffer| (which is the same as |widget_data->data|).  

Sat Aug 14 13:29:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/kbdbind.c:

	Expand the descriptions of the save-as and save-formatted actions.  

Sat Aug 14 13:13:56 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/mime/backend/default.c:

	Clarify the description of mime.handler to explain that its
	sub-options do not refer to MIME types, but rather that one must
	create options under mime.type that refer to the handlers under
	mime.handler.  

Sat Aug 14 07:53:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf, src/setup.h, src/config/options.inc,
	src/protocol/Makefile.am, src/protocol/protocol.c,
	src/protocol/protocol.h, src/protocol/nntp/Makefile.am,
	src/protocol/nntp/codes.c, src/protocol/nntp/codes.h,
	src/protocol/nntp/connection.c, src/protocol/nntp/connection.h,
	src/protocol/nntp/nntp.c, src/protocol/nntp/nntp.h,
	src/protocol/nntp/response.c, src/protocol/nntp/response.h,
	src/sched/connection.h, src/sched/error.c, test/href_tests.html:

	Add (experimental) NNTP support. Disabled by default.  

Sat Aug 14 06:57:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.c, sched/connection.h, protocol/ftp/ftp.c,
	protocol/http/http.c, main.c:

	Add keep-alive connection time-out callback support.  

Sat Aug 14 06:19:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_got_header(): Add FIXME about obsolete fake header usage. Fix
	leak.  

Sat Aug 14 05:59:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: about.c, file/file.c, ftp/ftp.c, http/codes.c,
	smb/smb.c:

	Prefer using cache_entry->content_type instead of setting up a fake
	protocol header.  

Sat Aug 14 05:56:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c, mime/mime.c,
	sched/download.c:

	Add content_type string member to struct cache_entry.
	get_content_type() 'caches' the type in this member.  

Sat Aug 14 03:49:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	s/Data/data/ .. hmm 

Sat Aug 14 03:32:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS, configure.in, features.conf, src/protocol/Makefile.am,
	src/protocol/data.c, src/protocol/data.h, src/protocol/protocol.c,
	src/protocol/protocol.h, test/href_tests.html:

	Experimental support for data URI protocols. Base64 handling not
	widely tested (the href test isn't working for some reason).  

Fri Aug 13 21:28:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, viewer/text/search.c:

	Introduce INPUT_LINE_REWIND which removes last entered char. Use it
	for typeahead error handling. Text typeahead could use it too but it
	looks a little harder.  

Fri Aug 13 21:02:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	do_frame_action(..., set_frame, ...): Fix frame maximizing when
	maximizing a recursive frameset where current_frame() will return
	NULL (already in bugzilla). Reported by kahmalo and me.  

Fri Aug 13 20:54:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hotkey.c, bfu/widget.c, document/renderer.c,
	protocol/proxy.c, protocol/smb/smb.c, viewer/text/marks.c:

	Include own header.  

Fri Aug 13 20:32:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/about.c:

	Include about.h header.  

Thu Aug 12 20:54:13 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* Unicode/gen-ent, src/intl/entity.inc:

	Give |struct entity| its name, which is used by the previous patch.  

Thu Aug 12 11:28:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: protocol/http/codes.c, intl/charsets.c:

	Use bsearch(3) in http_code_to_string and get_entity_string.  This
	required the introductions of compare_http_codes and
	compare_entities, respectively, the latter of which required changes
	to xxstrcmp so that the second string, rather than the first, is
	expected to be NULL-terminated.  

Thu Aug 12 08:44:04 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/util/file.c:

	Add a space after the return-type declaration of a function
	type-cast.  

Thu Aug 12 08:40:28 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/listmenu.c, ssl/connect.c, intl/charsets.c,
	util/error.h, util/hash.c, util/snprintf.c, cookies/cookies.c,
	dialogs/info.c, dialogs/options.c, osdep/os2/os2.c, osdep/osdep.c,
	osdep/stub.c, sched/task.c, terminal/terminal.c,
	scripting/lua/core.c, document/html/parser.c,
	document/html/frames.c, util/file.c:

	Add spaces after type casts.  

Thu Aug 12 08:21:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/backend/xbel.c:

	In print_xml_entities, do not recur on an empty string when
	u2cp_no_nbsp returns NULL as this will do approximately nothing.
	This curious recursion was introduced in revision 1.36, when the
	NULL-check was introduced.  

Thu Aug 12 07:33:23 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/action.c:

	In do_action, in the ACT_MAIN_TAB_MENU case, factor in whether the
	status bar is enabled in the arithmetic to place the tab menu on the
	tab bar.  

Thu Aug 12 05:13:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	In find_next, eliminate the local |flags| variable, which is
	essentially unused after the last patch.  

Thu Aug 12 05:05:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Introduce print_find_error_not_found, and use it in print_find_error 
	and typeahead_error.  

Thu Aug 12 05:04:30 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Move typeahead_error above print_find_error to decrease the diffage 
	for the next patch.  

Thu Aug 12 04:41:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Introduce print_find_error, which is essentially the same as
	find_next, except that print_find_error takes an enum find_error
	instead of calling find_next_do. find_next is now a wrapper that
	calls find_next_do and passes the result to print_find_error.  

Thu Aug 12 04:35:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	In find_text, replace the local flag |unsigned int free_text| with
	|enum msgbox_flags flags|.  

Thu Aug 12 04:31:30 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Replace the second space in |N_("Search string '%s' not found"),|, 
	which I accidently removed in the last revision.  

Thu Aug 12 01:17:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	do_mainmenu(): Use select_menu() instead of sending an Enter
	keyboard event.  

Mon Aug  9 09:16:02 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Wrap some lines.  

Mon Aug  9 08:47:34 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/kbdbind.c, config/kbdbind.h, viewer/text/search.c:

	Add search-toggle-regex in the edit map to toggle
	document.browse.search.regex in the type-ahead input field. Bind to
	alt-r by default, like in EMACS.  

Mon Aug  9 08:38:07 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	In text_typeahead_handler, introduce the local variable
	|report_errors|.  Initialise it to and use it instead of |action ==
	-1|.  

Mon Aug  9 07:00:35 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	In search_for_do, add a parameter |report_errors| to search_for_do,
	and use find_next_do instead of find_next when that parameter is
	given a zero argument.  
	
	In search_for_back and search_for, pass search_for_do |1| for its
	new |report_errors| parameter, preserving the behaviour from before
	this change.  
	
	In text_typeahead_handler, pass search_for_do |1| only when the user
	presses a key that is not bound, and pass |0| otherwise. This avoids
	repeated errors when the user enters a string that is not found and
	presses further keys that do not change the buffer to contain a
	string that matches something.  

Mon Aug  9 06:19:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	In find_next, introduce local variables |message| and |free_text| 
	and use them to eliminate all calls to msg_box but one.  

Mon Aug  9 05:58:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Divide find_next into two routines, find_next and find_next_do, with
	the former handling error reporting and using the latter as a
	back-end.  

Mon Aug  9 05:18:09 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/inpfield.c, bfu/menu.c, viewer/text/search.c:

	input_line_event_handler: Allow ACT_EDIT_ENTER to fall thru to the
	handler given to input_field_line even if the input buffer is empty.  
	
	text_typeahead_handler: Unhighlight any matches from the previous
	search on ACT_EDIT_ENTER with an empty buffer.  
	
	menu_search_handler: Cope with the above change and return
	INPUT_LINE_CANCEL for ACT_EDIT_ENTER even if the buffer is empty.  
	
	exmode_input_handler needed no changes.  

Sun Aug  8 06:33:21 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	In handle_ret_goto_url, use goto_url_with_hook instead of goto_url 
	to avoid a segfault when Lua code tells the browser to load a new
	URL but provides a string that is not a full, parsable URI -- e.g., 
	a simple path-name. The code was fine until src/sched/task.c 1.111 
	on 2004-06-09, which changed goto_url to require a full URI.  
	
	An added bonus to this change is that goto-url hooks are called when
	Lua sends the browser to a new URI.  

Sat Aug  7 22:03:53 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Delete a superfluous NULL check in do_hooks_file.  

Fri Aug  6 18:26:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	Fix bug 491 - 'Link navigation looks weird after disabling title or
	status bar.' by setting the screen dirty when drawing and clearing a
	link.  

Fri Aug  6 17:03:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	draw_current_link(): Minor optimization.  

Fri Aug  6 09:11:01 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Little hack to preserve rendering of [   ], in directories listing,
	we only clear spaces if length of alt or title attributes is > 5.
	Issue reported by Jonas.  

Fri Aug  6 09:02:29 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/: draw.c, draw.h:

	Move get_char() at top of draw.c, make it inline, and rename
	xpos,ypos to x,y in header file.  

Fri Aug  6 08:43:38 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_border_char(): @sc -> @screen_char.  

Fri Aug  6 08:41:58 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_text(): use get_char() and simplify code.  

Fri Aug  6 08:40:19 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_box(): use get_char() and simplify code.  

Fri Aug  6 08:38:10 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_char(): use get_char() and simplify code.  

Fri Aug  6 08:36:36 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_line(): use get_char() and simplify code.  

Fri Aug  6 08:35:22 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_char_data(): use get_char() and simplify code.  

Fri Aug  6 08:34:19 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_char_color(): use get_char() and simplify code.  

Fri Aug  6 08:32:35 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_border_cross(): use get_char() and simplify code.  

Fri Aug  6 08:31:40 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_border_char(): use get_char() and simplify code.  

Fri Aug  6 08:30:27 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	get_char(): return NULL on assertion failure.  

Wed Aug  4 22:32:01 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Translation updated.  

Wed Aug  4 19:16:41 2004  Laurent Monin <zas@norz.org>:

	* src/sched/connection.c:

	Indentation fix.  

Wed Aug  4 05:16:57 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/ssl/connect.c:

	What the heck, try to get it to work with OpenSSL as well.  

Wed Aug  4 05:07:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/ssl/connect.c:

	Fix a compilation error with GNUTLS by reverting the removal of the
	ssl_error label in revision 1.82.  

Tue Aug  3 22:54:44 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hotkey.c:

	Drop inline attribute from is_hotkey() and is_not_so_hotkey(), it
	doesnt make sense now that we call them from check_hotkeys_common().  

Tue Aug  3 22:24:17 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Move @os2xtd declaration where it is used, making it anonymous
	struct with @x -> @key and @y -> @modifier as fields.  

Tue Aug  3 21:53:14 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hotkey.c:

	Reduce code redundancy by introducing check_hotkeys_common(), now
	used by check_hotkeys() and check_not_so_hot_keys(). Cleanup and
	code simplification.  

Tue Aug  3 21:25:00 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: hotkey.c, hotkey.h, menu.c:

	Only pass struct menu * to clear_hotkeys() and init_hotkeys().  

Tue Aug  3 21:02:03 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: hotkey.c, hotkey.h, menu.c:

	Drop @ni parameter from init_hotkeys() and clear_hotkeys_cache().  

Tue Aug  3 20:57:39 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hotkey.c:

	init_hotkeys(): use foreach_menu_item().  

Tue Aug  3 17:08:09 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/hotkey.c, bfu/menu.c, bfu/menu.h,
	document/html/parser.c:

	Use struct menu_item * in mi_is_*() macros, and simplify code. This
	will help to expand usage of foreach_menu_item() macro.  

Tue Aug  3 16:19:27 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_char16(): minor simplification, @code[x] already contains 0.  

Tue Aug  3 16:13:26 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_char16(): drop static attribute for @code, there is no reason to
	use it.  

Tue Aug  3 10:41:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, protocol/http/http.c,
	sched/connection.c, ssl/connect.c:

	Do the init_ssl_connection() call in ssl_connect(). It simplifies a
	lot of things. Now all the SSL handle setup and teardown is done
	within ssl/.  

Tue Aug  3 10:31:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, sched/connection.c,
	ssl/connect.c:

	Continue the rampage. Introduce done_connection_info().  

Tue Aug  3 10:04:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/http/http.c:

	Introduce init_connection_info().  

Tue Aug  3 09:43:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	make_connection(): Why yes Mam but de gospel do say that man was
	born of woman's womb.  

Tue Aug  3 09:39:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, protocol/finger.c,
	protocol/ftp/ftp.c, protocol/http/http.c:

	make_connection(): Drop @port arg. It is needless code dublication.
	The return value check in http_protocol_handler() should not be
	needed anymore. T'is legacy.  

Tue Aug  3 09:37:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, uri.c, uri.h:

	Introduce uri_port_is_valid() macro. Check the port numbers for the
	protocol backend in get_protocol_port().  

Tue Aug  3 09:23:02 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	truncate_entry(): add a comment about doubt of zero length fragment
	legality.  

Tue Aug  3 09:19:40 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cache/cache.c:

	Tweak the assertion added in 1.167, 'truncate_entry(): reduce code
	redundancy by reordering tests.' The assertion was triggered by a
	Lua preformatting hook.  Zas doesn't know why, but suggested this
	change, which asserts that cache-entry fragments have a length >= 0
	rather than > 0.  

Tue Aug  3 09:18:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/http/http.c, ssl/connect.c:

	Rename struct conn_info's @func callback to @done. D-scribe
	make_connection().  

Tue Aug  3 09:11:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	connected(): No need to test for conn_info or conn_info->func.  

Tue Aug  3 09:08:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c:

	Rename all conn_info struct variables to conn_info.  

Tue Aug  3 08:43:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listbox.c:

	init_listbox(): Reduce indentation by doing check on the listbox
	browser's box_data->items.  

Tue Aug  3 08:24:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.h, ssl/connect.c:

	struct connection: Rename @no_tsl to @no_tls.  

Tue Aug  3 08:14:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	ssl_set_no_tls(): It is only called after checking |if
	(conn->no_tsl)| which means there is no need to test it in the
	function. Cleaned up to use table stack initialization. Reduce size
	of @cipher_priority[], it was too big.  

Tue Aug  3 00:50:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/http/http.c, sched/connection.c, ssl/ssl.c,
	ssl/ssl.h:

	init_ssl_connection(): Take connection_socket struct as arg.  

Tue Aug  3 00:44:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	ssl_read(), ssl_do_read(): Use passed connection_socket struct.  

Tue Aug  3 00:39:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	ssl_write(), ssl_do_write(): Use passed connection_socket struct.  

Tue Aug  3 00:37:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	ssl_want_read(): Use local connection_socket pointer.  

Tue Aug  3 00:35:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	ssl_do_connect(): Take connection_socket struct as arg.  

Tue Aug  3 00:33:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	ssl_set_no_tls(): Take connection_socket struct as arg.  

Tue Aug  3 00:10:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	ssl_connect(): Use the passed connection_socket for retrieving the
	SSL handle.  

Tue Aug  3 00:04:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Introduce connection_is_https_proxy() macro.  

Mon Aug  2 23:58:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	HTTP is allowed to assume SSL handle is in conn->socket. Add TODO
	about moving cache->ssl_info initialization.  

Mon Aug  2 23:37:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/: connect.c, ssl.c, ssl.h:

	done_ssl_connection(): Take only the connection_socket struct.
	Rename? 

Mon Aug  2 23:22:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c, ssl/connect.h:

	Use the read_buffer socket for testing SSL and pass the socket to
	ssl_read().  

Mon Aug  2 23:20:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c, ssl/connect.h:

	Use the write_buffer socket for testing SSL and pass the socket to
	ssl_write().  

Mon Aug  2 23:15:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	connected(): Check for SSL in the connection info struct's socket.  

Mon Aug  2 23:10:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	dns_found(): Check for SSL in the connection info struct's socket.  

Mon Aug  2 22:59:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	interrupt_connection(): Since close_socket() calls ssl_close() which
	then calls done_ssl_connection() there is no need to do it here.
	Further this also allows GNUTLS backend to close down the SSL
	connection properly via ssl_do_close() macroed to gnutls_bye().  

Mon Aug  2 22:50:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	Oops, fix last patch. ;-) 

Mon Aug  2 22:45:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	ssl_do_close(): Use the passed socket.  

Mon Aug  2 22:43:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c, ssl/connect.h:

	close_socket(): Pass the mic to ssl_connect().  

Mon Aug  2 22:13:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, protocol/http/http.c,
	sched/connection.c, sched/connection.h, ssl/connect.c, ssl/ssl.c:

	Move the connection struct's ssl handle to struct connection_socket.
	All users still assume that there can be only one ssl handle and it
	is conn->socket.ssl. Ugly tag appended for each substitution so they
	are easy to locate.  

Mon Aug  2 21:38:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Mon Aug  2 16:26:13 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.c:

	update_status(): test only once for @dirty.  

Mon Aug  2 16:17:43 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.c:

	update_status(): force rerendering when title/status/tabs/leds
	display is toggled. Until now, only tabs toggling was forcing
	document rerendering.  

Mon Aug  2 14:57:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	We should call the change hooks when toggling document options.  

Sun Aug  1 20:54:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.h, file/cgi.c, http/http.c:

	Introduce URI_HTTP_REFERRER flag. Now URI_PUBLIC is only used for
	dialogs and coument titles and never for URI strings sent over the
	net.  

Sun Aug  1 20:51:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.c:

	Add leading slash always when we want URI_PATH. This fixes
	determining default value of the action attribute of <form>.  

Sun Aug  1 20:46:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.h:

	Helper URI_SERVER bitmask enum.  

Sun Aug  1 20:43:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.h:

	We do not use URI_POST_INFO now, it must not be sent over the net.  

Sun Aug  1 20:40:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.h:

	Separate the parts of enum uri_component.  

Sun Aug  1 20:33:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.h:

	Prevent the horrible URI_POST_INFO sneaking all around into various
	URIs like <form> action URI, URI coming over clipboard,
	in-Lua-processing URIs and so on, by sticking it to URI_RARE. Let's
	see what did I break.  

Sun Aug  1 20:12:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	Hrmpf. Indeed use the conn->data_socket.fd for passing
	conn->cgi_pipes[1].  

Sun Aug  1 20:08:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/file/cgi.c:

	Compilation fix (call me dirty...), and Jonas should better do test
	compilations on full-featured ELinks configurations or I'll give him
	hard time.  

Sun Aug  1 10:00:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, protocol/http/http.c, ssl/connect.c,
	ssl/connect.h:

	ssl_connect(): Take connection_socket struct.  

Sun Aug  1 09:51:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, protocol/finger.c,
	protocol/ftp/ftp.c, protocol/http/http.c, ssl/connect.c:

	read_from_socket(): Take struct connection_socket instead of socket
	fd. Describe it and rename @read_func to @done to reflect the
	change. Well actually also @buf is renamed to @buffer. To further
	overload the patch also struct read_buffer now holds the
	connection_socket struct.  

Sun Aug  1 09:18:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	struct write_buffer: Replace |int sock| member with |struct
	connection_socket *socket| member.  

Sun Aug  1 09:14:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, protocol/finger.c,
	protocol/ftp/ftp.c, protocol/http/http.c:

	write_to_socket(): Take struct connection_socket instead of socket
	fd. Describe it and rename write_func to done to reflect the change.  

Sun Aug  1 09:08:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.h:

	struct connection: Update @data_socket comment. SMB is also using
	it.  

Sun Aug  1 09:07:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, protocol/ftp/ftp.c,
	protocol/smb/smb.c, sched/connection.c, ssl/connect.c:

	close_socket(): Take struct connection_socket instead of socket
	descriptor pointer.  

Sun Aug  1 09:01:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h,
	protocol/http/http.c, ssl/connect.c:

	struct conn_info: Replace |int *sock| member with |struct
	connection_socket *socket| member.  

Sun Aug  1 08:55:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, lowlevel/connect.h, protocol/finger.c,
	protocol/ftp/ftp.c, protocol/http/http.c:

	make_connection(): Take struct connection_socket pointer.  

Sun Aug  1 08:45:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/finger.c, protocol/ftp/ftp.c,
	protocol/http/http.c, protocol/smb/smb.c, sched/connection.c,
	sched/connection.h:

	Introduce struct connection_socket. For now only holding the socket
	descriptor.  

Sat Jul 31 18:29:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	transform_file_url(): Bug 358 revisited. Encode the CWD before
	inserting it. Fixes test case added by lindi- in comment #14 on
	2004-07-31 20:05.  

Sat Jul 31 11:23:44 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/dialog.c, bfu/menu.c, sched/session.c,
	terminal/event.c, terminal/window.c, terminal/window.h,
	viewer/text/view.c:

	Eliminate the |int fwd| parameter from window event handlers.  
	
	|fwd| is a boolean indicating whether or not the event came from
	delete_window or delete_window_ev. It is apparently named for its
	usage by its one user, mainmenu_kbd_handler, which uses it to
	determine whether the delete event was forwarded from a sub-menu. It
	is used when one presses left or right with a menu open:
	menu_kbd_handler deletes the menu and passes (via delete_window_ev) 
	the ACT_MENU_LEFT or ACT_MENU_RIGHT event on to mainmenu_kbd_handler
	which then knows from the |fwd| flag to open the newly selected
	menu. This way, left and right open the newly selected menu only
	when a menu was already open.  
	
	Now, menu_kbd_handler deletes the old menu and passes the
	ACT_MENU_LEFT or ACT_MENU_RIGHT event on to mainmenu_kbd_handler as
	before, but now menu_kbd_handler opens the newly selected menu
	itself.  

Sat Jul 31 11:05:54 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/kbd.c:

	Tidy up a comment in decode_terminal_mouse_escape_sequence: 
	s/Prospone/Postpone/ and remove a bogus 'errors has'.  

Sat Jul 31 11:01:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: bfu/hotkey.c, terminal/kbd.c, util/conv.c, util/hash.c,
	util/snprintf.c, viewer/text/form.c, viewer/text/textarea.c:

	Put spaces after some type casts.  

Sat Jul 31 10:50:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: terminal/kbd.c, viewer/text/view.c:

	In send_mouse_event and decode_terminal_mouse_escape_sequence, 
	substitute two remaining uses of |ev->info.mouse| with the local
	|mouse| variables in the respective routines.  

Sat Jul 31 09:59:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	decode_terminal_escape_sequence(): Fix bug where the mark for
	invalid KBD event would be removed. Initialize local variable to -1
	and only update the event if it has been changed.  

Sat Jul 31 09:53:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	process_queue(): Fix the check for event queuing to not access the
	wrong union struct. Restore the old behaviour of only changing the
	event type when all mouse sanity checks has been done.  

Sat Jul 31 07:33:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/osdep/os2/os2.c:

	Remove an extra space.  

Sat Jul 31 06:32:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/text.c:

	Update a comment in mouse_text to reflect 1.103 which changed the
	region over which one can click the mouse or roll its wheel to
	scroll a text widget.  

Sat Jul 31 05:30:07 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/kbd.c:

	In decode_terminal_mouse_escape_sequence, remove an extra space.  

Sat Jul 31 04:06:01 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/mime/backend/default.c:

	In get_content_type_default, remove some extra parentheses.  

Fri Jul 30 22:22:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/osdep.c, osdep/osdep.h, osdep/os2/os2.c,
	osdep/win32/win32.c, terminal/kbd.c:

	get_terminal_size(): Drop bogus error return value. The @x and @y
	variables are always non-NULL.  

Fri Jul 30 16:39:44 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	handle_trm(): use memset() + affectations to initialize @info, and
	simplify code, dropping useless intermediate variables like @width,
	@height.  

Fri Jul 30 16:16:57 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jul 30 16:11:37 2004  Laurent Monin <zas@norz.org>:

	* src/config/dialogs.c:

	Drop trailing spaces.  

Fri Jul 30 16:04:19 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	html_img(): trim whitespaces around alt or title attribute value.  

Fri Jul 30 14:52:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/osdep.c:

	Fixed smelly mouse-related #if condition.  

Fri Jul 30 14:31:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	check_keepalive_connections(): Use foreachsafe().  

Fri Jul 30 10:41:11 2004  Laurent Monin <zas@norz.org>:

	* src/: config/cmdline.c, viewer/dump/dump.c:

	Add -no-references command line option that prevents dump of any
	link reference when dumping a document to stdout.  

Fri Jul 30 10:38:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Make send_mouse_event() return session for controlling event
	cleanup. Remove goto stuff in send_event().  

Fri Jul 30 10:36:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_kbd_event(): Reformat 

Fri Jul 30 10:34:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_event(): Split out keyboard event handling to send_kbd_event().  

Fri Jul 30 10:27:26 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/dump/dump.c:

	dump_to_file(): always dump links even with -no-numbering, do not
	print any number in this case. It fixes bug 485.  

Fri Jul 30 10:26:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Hmm .. fix brain deadness in last patch.  

Fri Jul 30 10:26:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_event(): Split out mouse event handling to send_mouse_event().  

Fri Jul 30 10:17:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Use event union struct to shorten lines.  

Fri Jul 30 10:09:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Use event union struct to shorten lines.  

Fri Jul 30 10:01:59 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	set_cursor(): only call check_range() if needed.  

Fri Jul 30 09:55:32 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_text(): drop useless memset() call.  

Fri Jul 30 09:49:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Remove the assertion that causes bug 477. Introduce
	html_has_non_space_chars() to properly check if the line has real
	content in which case the last tag will be updated. All this was
	initiated by the fix for bug 324 '<pre> tags with an ID don't behave
	correctly'.  

Fri Jul 30 09:46:25 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	try_document_key(): space fix.  

Fri Jul 30 09:43:57 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	try_document_key(): fix bug introduced in rev 1.284 -> 1.285.  

Thu Jul 29 15:58:41 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_border_char(): minor code optimization.  

Thu Jul 29 15:56:28 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_box(): minor code optimization.  

Thu Jul 29 15:47:45 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_char(): code simplification and optimization, assert
	term->screen->image.  

Thu Jul 29 10:21:04 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Jul 29 10:02:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/encoding.c:

	guess_encoding(): Fix comparison. Now that the extension contains
	the '.' the filename isn't necessarily longer than the extension.  

Thu Jul 29 09:45:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Another fix for the assertion that causes bug 477. Only check
	@charslen chars.  

Thu Jul 29 09:43:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/: bindtextdom.c, dcigettext.c:

	Use offsetof() definition in osdep/generic.h 

Thu Jul 29 09:43:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/generic.h:

	Include <stddef.h> - it may contain offsetof() definition.  

Wed Jul 28 23:43:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/README:

	Something about selectors.  

Wed Jul 28 16:25:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* SITES:

	Add link to DEBs of CVS at http://www.miernik.ctnet.pl/debian/ 

Wed Jul 28 16:03:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/dialog.c, bfu/menu.c, sched/session.c, terminal/tab.c,
	terminal/tab.h, terminal/window.c, terminal/window.h:

	Introduce window_handler typedef.  

Wed Jul 28 15:43:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/listbox.c, bfu/menu.c, bfu/text.c,
	lowlevel/timer.c, osdep/os2/os2.c, osdep/unix/unix.c,
	terminal/event.c, terminal/event.h, terminal/kbd.c,
	terminal/mouse.h, viewer/text/view.c:

	struct term_event: Move remaining variables to union.  

Wed Jul 28 15:30:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Check for NULL doc_view in do_mouse_event() and cleanup.  

Wed Jul 28 15:26:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	decode_terminal_escape_sequence(): Make it more clear that the event
	type is changed.  

Wed Jul 28 15:20:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_mouse_handler(): Cleanup handling of clicks outside the
	mainmenu bar.  

Wed Jul 28 15:15:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	frame_ev_mouse(): Use local @x and @y variables.  

Wed Jul 28 14:58:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/unix/unix.c:

	For helvede. Thanks to miernik for patiently telling me how broken
	my patches are.  

Wed Jul 28 14:50:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	decode_terminal_escape_sequence(): Use local @key and @modifier
	variables.  

Wed Jul 28 14:39:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	process_queue(): Remove need for l1 label.  

Wed Jul 28 14:37:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	set_kbd_event(): Cleanup.  

Wed Jul 28 14:35:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	process_queue(): Move l2 label code to separate function badly named
	set_kbd_event().  

Wed Jul 28 14:21:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	process_queue(): Minor simplification.  

Wed Jul 28 13:56:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: os2/os2.c, unix/unix.c:

	Oops some missing users of ev->b was converted 

Wed Jul 28 13:53:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Introduce decode_mouse_position().  

Wed Jul 28 13:37:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	decode_terminal_escape_sequence(): Split out mouse escape decoding.  

Wed Jul 28 13:29:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	decode_terminal_escape_sequence(): Move the get_esc_code() call
	after special case.  

Wed Jul 28 13:27:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	get_esc_code(): Return the length of the escape code.  

Wed Jul 28 13:21:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	decode_terminal_escape_sequence(): Normalize indentation.  

Wed Jul 28 13:19:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	decode_terminal_escape_sequence(): cleanup special case. The switch
	stretches all the way to the end of the function.  

Wed Jul 28 13:17:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	decode_terminal_escape_sequence(): Write out fake goto label users
	now return -1. Comment the function.  

Wed Jul 28 13:12:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	process_queue(): Split out decode_terminal_escape_sequence().  

Wed Jul 28 12:25:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/dialog.c, bfu/inpfield.c, bfu/menu.c, config/kbdbind.c,
	viewer/text/form.c, viewer/text/link.c, viewer/text/view.c:

	Use get_kbd_key() int the rest of the EVENT_KBD handlers.  

Wed Jul 28 12:24:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	Use get_kbd_key() at the lower levels.  

Wed Jul 28 12:17:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.h:

	A little clean up and preparation for next patch.  

Wed Jul 28 11:42:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/text.c:

	mouse_text(): Store scroller modifier area in a box and use
	check_mouse_position(). Note this also means it is only possible to
	modify the scoller in the right side of the dialog box around the
	scroller.  

Wed Jul 28 11:22:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	do_mouse_event(): Use check_mouse_position() and elliminate
	is_in_box() FIXME. When rendering documents we copy the
	document->option box (and thus x and y members) to the doc_view box
	so it should be ok but I've added assertions anyway.  

Wed Jul 28 11:02:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Tidy up.  

Wed Jul 28 10:50:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, viewer/text/view.c:

	Use {get,check}_kbd_modifier() for all modifier access.  

Wed Jul 28 10:43:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/dialog.c, bfu/menu.c, terminal/event.c,
	terminal/event.h, viewer/text/link.c, viewer/text/view.c:

	Introduce {get,check}_kbd_modifier() for EVENT_KBD events.  

Wed Jul 28 10:31:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Update comment about mouse button mask.  

Wed Jul 28 10:19:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.h, kbd.c, mouse.h:

	Move the term_event->b member to struct in union. It is now
	accessible at ev->info.mouse.button 

Wed Jul 28 09:41:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/screen.c:

	Remove misinforming comments. Questioned by Miciah.  

Wed Jul 28 04:09:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/blacklist.c:

	Now that strlcasecmp() is being used in get_blacklist_entry() NUL
	terminate the entry->host so -1 usage for automatic length
	calculation is ok.  

Wed Jul 28 03:36:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	read_select(): Fix buffer overflow by substracting the length of the
	buffer that has already been read. Reported by Jan Braun
	<janbraun@gmx.de> on elinks-user Wed, Jul 28, 2004 in
	<20040728022541.GA25879@fera.kawo2.rwth-aachen.de>.  

Wed Jul 28 02:20:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/info.h, dialogs/menu.h, osdep/newwin.h,
	util/secsave.h:

	Fix guard names. Declare terminal and session structs to avoid
	#includes.  

Tue Jul 27 22:53:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	add_uri_command_to_menu(): Make the labels different for each type.  

Tue Jul 27 22:45:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	I recall pasky talking about View being a stripped down version of
	the tab menu so remove the pass frame URI to external command menu
	item so that no one will ever notice this feature unless they know
	the tab menu ;) 

Tue Jul 27 22:41:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	dialogs/menu.h, sched/action.c, viewer/text/link.c:

	Make the external command URI passing use also tab (toplevel) URI.  

Tue Jul 27 22:05:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	dialogs/menu.h, sched/action.c, viewer/text/link.c:

	Add possibility to pass URI of the current frame to external
	command. Idea by miernik.  

Tue Jul 27 22:01:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	Sort frame-* actions.  

Tue Jul 27 21:32:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.c, event.h, kbd.c:

	Make the terminal_info->data member have size of one for
	portability. Define TERMINAL_INFO_SIZE macro using offsetof() to
	ignore the extra byte and padding.  

Tue Jul 27 21:28:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/options.c, osdep/generic.h:

	Move offsetof() macro.  

Tue Jul 27 17:54:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	For crying out load we always use unsigned char _not_ char,
	especially when using <ctype.h>'s is<chargroup>() functions.  

Tue Jul 27 17:48:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	init_connection(): Improve referrer setup comment. Revisited.  

Tue Jul 27 17:45:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Always set the referrer when loading file: URIs, so that CGI scripts
	can use it.  

Tue Jul 27 17:34:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/dialog.c, bfu/menu.c, terminal/event.h:

	Introduce check_kbd_label_key() macro. Fix off by two error in
	terminal/event.h (1.12 -> 1.13) 

Tue Jul 27 17:30:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	init_connection(): Improve referrer setup comment.  

Tue Jul 27 16:36:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	kbd_field(): Rewrite char inserting in the default label.  

Tue Jul 27 16:26:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, terminal/event.h, viewer/text/form.c:

	Introduce check_kbd_textinput_key() macro.  

Tue Jul 27 16:11:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/inpfield.c,
	bfu/listbox.c, bfu/menu.c, terminal/mouse.h, viewer/text/link.c:

	Introduce check_mouse_position() macro.  

Tue Jul 27 03:10:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	load_file_from_doc_view() -> load_additional_file() .. more in the
	spirit of request_additional_file().  

Tue Jul 27 03:07:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.c, session.c, session.h:

	Move the referrer weeding to init_connection(). It means that CGI
	can now have referrer if it is desirable.  

Tue Jul 27 02:44:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	Make ssl_want_read() static.  

Mon Jul 26 23:01:04 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	load_file_from_doc_view(): we dont want to set referrer for file
	protocol.  

Mon Jul 26 22:53:12 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	Revert last patch for now, it breaks the patch Miciah submitted on
	ml. So just let him do the thing.  

Mon Jul 26 22:40:58 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	tabwin_func(): unused @fw -> @xxx.  

Mon Jul 26 22:38:20 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	reload(): @l ->@loc.  

Mon Jul 26 22:34:33 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	load_file_from_doc_view(): referer -> referrer.  

Mon Jul 26 22:31:52 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	abort_loading(): @l -> @loc.  

Mon Jul 26 22:25:55 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	get_current_url(), get_current_title(), get_current_link_url(),
	get_current_link_name(): assert(str && str_size > 0), not strictly
	needed but may prevent bad things in future.  

Mon Jul 26 22:15:55 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	abort_files_load(): @q -> @more.  

Mon Jul 26 22:09:43 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	get_session_info(): reduce indentation level.  

Mon Jul 26 22:07:15 2004  Laurent Monin <zas@norz.org>:

	* src/sched/: session.c, session.h:

	process_file_requests(): try to mmake it somehow reentrant by using
	a session status flag. Cleaner, imho.  

Mon Jul 26 22:02:01 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	process_file_requests(): minor code simplification.  

Mon Jul 26 17:40:42 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	Reduce code redundancy by introducing (perhaps badly named)
	load_file_from_doc_view(), now used by process_file_requests() and
	reload().  

Mon Jul 26 17:24:22 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	encode_session_info(): reduce indentation level.  

Mon Jul 26 17:17:31 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	request_frame(): drop goto/label |found|.  

Mon Jul 26 17:15:10 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	request_frame(): drop commented out old code.  

Mon Jul 26 17:13:35 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	request_frameset(), request_frame(): pass @depth and drop static
	declaration of @depth.  

Mon Jul 26 17:10:15 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	request_frameset(): reduce indentation level.  

Mon Jul 26 07:43:49 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jul 26 05:42:52 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cache/cache.c:

	Revert revision 1.168, 'remove_overlaps(): @nf declaration was moved
	near where it is really used.' We cannot safely pass |f->next| to
	mem_free after we have passed it to del_from_list, as the latter
	modifies |x->prev->next|, where |x| is |f->next|, meaning we modify
	|f->next->prev->next|, which is the same as |f->next|.  

Sun Jul 25 19:46:49 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/document.c:

	Fix stupid error i made, reported by Stephan Roh.  

Sun Jul 25 11:57:01 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	free_entry_to(): @off -> @offset.  

Sun Jul 25 11:51:37 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	add_fragment(): use @end_offset value instead of @offset + @length.  

Sun Jul 25 11:48:51 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	add_fragment(): remove now useless affectation.  

Sun Jul 25 11:45:31 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	add_fragment(): @f_end_offset is only used in loop, so declare it
	where appropriate.  

Sun Jul 25 11:44:23 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	add_fragment(): move @ret in loop.  

Sun Jul 25 10:21:06 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/: ftp/ftp.c, smb/smb.c:

	Handle/ignore possible allocation failure when adding header to
	@conn->cached->head.  

Sun Jul 25 10:11:49 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/codes.c:

	Content-type -> Content-Type in header.  

Sun Jul 25 10:09:29 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/about.c:

	about_protocol_handler(): reintroduce \r\n in header string, i
	overlooked the fact that is a marker for artificial header.  

Sun Jul 25 10:08:07 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/document.c:

	protocol_header_dialog(): show artificial header info in debug mode.  

Sun Jul 25 05:03:20 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/about.c:

	Remove a pointless #include "util/memory.h" and add #include
	"util/string.h" for stracpy.  

Sat Jul 24 18:52:45 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	find_in_cache(): clarify code.  

Sat Jul 24 18:42:02 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	remove_overlaps(): goto/label vs indentation level, last one wins.  

Sat Jul 24 18:39:25 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	remove_overlaps(): @nf declaration was moved near where it is really
	used.  

Sat Jul 24 18:32:08 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	truncate_entry(): reduce code redundancy by reordering tests.  

Sat Jul 24 18:07:17 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	truncate_entry(): @off -> @offset.  

Sat Jul 24 18:06:03 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	truncate_entry(): drop gotos/label |del| while introducing
	delete_fragment().  

Sat Jul 24 17:46:03 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	add_fragment(): return 1 directly.  

Sat Jul 24 17:34:49 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	add_fragment(): drop goto/label |remove_overlaps|.  

Sat Jul 24 14:23:00 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	Move code from add_fragment() to new remove_overlaps().  

Sat Jul 24 13:58:30 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	history_menu_common(): goto/label vs indentation level. Indentation
	level increased.  

Sat Jul 24 13:47:06 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	Drop history_menu_model() macro and introduce history_menu_common()
	function instead. It reduces code redundancy while performance
	impact is very low, and is not an issue here.  

Sat Jul 24 07:05:00 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/screen.c:

	Fix alignment in comments after the last patch (forgot to :w before
	committing).  

Sat Jul 24 07:03:19 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/screen.c:

	Rename to .transparent the .trans member of struct screen_driver.  

Sat Jul 24 06:48:52 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/file/cgi.c:

	In execute_cgi, decode the path name after extracting it from the
	URI.  This is necessary because that path name is used to chdir and
	execute the script and because SCRIPT_NAME is supposed to have the
	decoded path name (see
	http://cgi-spec.golux.com/draft-coar-cgi-v11-03-clean.html#8.1).  

Sat Jul 24 06:18:44 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/forms.c:

	In get_html_form, tighten the assertion that the URI to which a form
	get request is to be posted has no query part when that URI is based
	on the current URI: Now that file: URIs are properly encoded, remove
	the exception for them.  

Sat Jul 24 05:12:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	In field_op, simplify the boolean logic involving
	document.browse.forms.auto_submit.  

Sat Jul 24 02:08:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	Fixed document.browse.forms.auto_submit to behave right - if it is
	turned off, the form is submitted by enter only if the form has no
	submit button (as in original Links) or when
	document.browse.forms.auto_submit is turned on. Looks like it
	actually never worked right when auto_submit was off (that's way
	back to 2002), but noone noticed ;-). But it has at least one user
	now - reported by Dave Belfer-Shevett.  

Fri Jul 23 20:09:22 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	ftp_data_accept(): reduce indentation level.  

Fri Jul 23 20:07:26 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	got_something_from_data_connection(), ftp_data_accept(): fix last
	patch, return on error.  

Fri Jul 23 20:02:52 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Move code from got_something_from_data_connection() to new
	ftp_data_accept().  

Fri Jul 23 19:57:30 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	got_something_from_data_connection(): drop goto/label |conn_error|.  

Fri Jul 23 16:47:26 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/auth/dialogs.c:

	get_http_auth_basic_info(): limit displayed realm to a reasonable
	length (512 chars).  

Fri Jul 23 16:04:45 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/auth/auth.c:

	Transform set_auth_user() and set_auth_password() macros to
	functions. There is no reason to use macros here.  

Fri Jul 23 15:52:37 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/about.c:

	about_protocol_handler(): simplify code.  

Fri Jul 23 15:49:25 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/about.c:

	about_protocol_handler(): drop extra \r\n which was preventing
	effective setting of content type.  

Fri Jul 23 15:42:41 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Invert return codes 0 and 1 in read_*http_data(), 0 was already used
	by get_header() to indicate more to read, so it looks more logical
	now.  

Fri Jul 23 15:30:52 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	read_http_data(): use a switch() for return value test.  

Fri Jul 23 15:25:21 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Move code from read_http_data() to new read_normal_http_data(), and
	use returned value, like for read_chunked_http_data().  

Fri Jul 23 15:18:17 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	read_chunked_http_data(): make it return a value, used in
	read_http_data(), it helps to simplify code.  

Fri Jul 23 15:09:08 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Move code from read_http_data() to new read_chunked_http_data().  

Fri Jul 23 14:57:41 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	subst_user_agent(): reduce indentation level.  

Fri Jul 23 14:52:36 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	read_http_data(): drop two labels and associated gotos by moving
	code to new functions named read_more_http_data() and
	read_http_data_done().  

Fri Jul 23 06:09:39 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/uri.h:

	Forgotten piece of the last patch.  

Fri Jul 23 05:21:11 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: protocol/uri.c, protocol/file/file.c,
	protocol/rewrite/rewrite.c, viewer/text/form.c:

	Add a new parameter |convert_slashes| to encode_uri_string to
	indicate whether slashes should be converted along with other unsafe
	characters to hexadecimal notation.  
	
	When prepending "file://" to the string to convert a path name to a
	URI in encode_uri_string, also encode the path name.  
	
	Now, when a user provides on the command line or in the Go to URL
	box a path with question marks, octothorpes, or other characters
	considered unsafe, they will be encoded so that later on we do not
	misinterpret part of the file name as a fragment identifier, query
	part, or whatever.  
	
	This fixes bug 358: browsing local files fails if path contains
	"%7E".  

Fri Jul 23 03:48:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/renderer.c:

	When setting a title for a document that doesn't specify one 
	(e.g., HTML files without <title> and plain-text files), use the
	file's path instead of the URI if it is a file: URI.  

Fri Jul 23 02:57:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Fix a memory leak that came with my last patch.  

Fri Jul 23 02:36:23 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Use get_current_link, get_link_uri, and get_uri_string instead of
	using get_current_link_info, which drops any password in the URI,
	adds a suffix if there is form post data, adds prefix if the link is 
	an image or usemap, and decodes the string. Now copy-clipboard 
	copies the real URI.  
	
	Remove Jonas' TODO comment.  

Fri Jul 23 02:27:01 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In the ACT_MAIN_COPY_CLIPBOARD case for the switch in frame_ev_kbd, 
	rename |current_link| to |uristring| and change its type from |char
	*| to |unsigned char *|.  

Fri Jul 23 02:24:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Add a missing #include "document/view.h".  

Fri Jul 23 01:56:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/listmenu.c, bfu/listmenu.h,
	document/html/parser/forms.c:

	Post <select>ed values in correct charset (by Mikulas; from
	1.00pre8).  

Fri Jul 23 00:57:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/signals.c:

	AIX compilation fix (by Mikulas; from 1.00pre6).  

Fri Jul 23 00:51:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/smb/smb.c:

	Fix incorrect error handling in smb_read_data() (by Mikulas; from
	1.00pre6).  

Thu Jul 22 22:23:19 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	get_temp_name(): fix an error, @nm should be freed by free() not
	mem_free().  

Thu Jul 22 22:20:30 2004  Laurent Monin <zas@norz.org>:

	* src/sched/error.c:

	Stick a comment about get_err_msg() return value.  

Thu Jul 22 22:14:15 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	print_error_dialog(): get_err_msg() can not return NULL, drop
	intermediate @t, and simplify code.  

Thu Jul 22 22:07:14 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	write_cache_entry_to_file(): drop gotos/label |write_error|.  

Thu Jul 22 22:04:16 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	get_download_ses(): test for list_empty(sessions) before any
	foreach().  

Thu Jul 22 22:02:05 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	write_cache_entry_to_file(): drop list_empty(sessions) test,
	get_download_ses(() will do it and it is called by
	download_error_dialog().  

Thu Jul 22 21:56:04 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	download_data_store(): drop last goto and label |abort|.  

Thu Jul 22 21:54:35 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	download_data_store(): assuming get_err_msg() can not return NULL,
	simplify code and drop some gotos.  

Thu Jul 22 21:50:47 2004  Laurent Monin <zas@norz.org>:

	* src/sched/error.c:

	get_err_msg(): drop goto/label.  

Thu Jul 22 21:39:56 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	download_data_store(): move some code to new
	abort_download_and_beep() and drop spome gotos.  

Thu Jul 22 21:28:38 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	download_data(): drop gotos and label |store|.  

Thu Jul 22 17:25:23 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/connect.c:

	Fix large files uploads timing out (by Mikulas; from 1.00pre2).  

Thu Jul 22 17:15:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/: connect.c, connect.h:

	Describe {read,write}_buffer.done.  

Thu Jul 22 17:04:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/task.c:

	Fix entities sometimes wrongly decoded in imgmaps (by Mikulas; from
	1.00pre1). @global_doc_opts looks like a gross mess, it should be
	put into @html_context and usage out of the HTML engine eradicated.  

Thu Jul 22 15:50:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	When uploading files in anonymous mode, fix wrong error code (by
	Mikulas; from 1.00pre1).  

Thu Jul 22 15:49:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	When uploading files, fix fd leak on read() error (by Mikulas; from
	1.00pre1).  

Thu Jul 22 08:07:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/proxy.c:

	Clarify the comment with further help from Timo Lindfors: The
	communication between ELinks and the proxy is never encrypted, altho
	the proxy may be used to transfer encrypted data between ELinks and
	the Web server.  

Thu Jul 22 07:51:25 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Jul 22 07:45:32 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/proxy.c:

	Revert a change that snuck in with revision 1.40: Don't check
	whether the URI for the proxy to be used for https:// URIs begins
	with "https://", but rather check for "http://". This is because
	ELinks uses HTTP to communicate with the proxy, even if the proxy
	opens a TLS connection on the client's behalf.  
	
	Thanks to Timo Lindfors for explaining to me the situation, which I
	attempt to explain in a new comment.  

Thu Jul 22 06:09:35 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/proxy.c:

	Eliminate a useless assignment and if-statement in get_proxy_worker.  

Thu Jul 22 02:26:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/conv.c:

	Describe #include "intl/charsets.h" 

Thu Jul 22 02:25:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/secsave.c:

	Jonas noticed get_opt() usage in util/. :( 

Thu Jul 22 02:19:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/inpfield.c:

	kbd_field(): Does not seem as a goto cleanup candidate anymore.  

Thu Jul 22 02:16:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/inphist.c:

	Sanitize comment.  

Thu Jul 22 02:06:02 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/hierbox.c, bookmarks/dialogs.c, cache/dialogs.c,
	config/dialogs.c, formhist/dialogs.c, globhist/dialogs.c,
	protocol/auth/dialogs.c:

	The default hierbox info button handler now gives a chance to the
	get_info() listbox op even if a folder is concerned and prints the
	'use space to expand the folder' only if that op returns NULL. This
	fixes options folders not showing up.  

Thu Jul 22 02:02:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/secsave.c:

	secure_file_saving -> infofiles.secure_save 

Thu Jul 22 01:59:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/rewrite/rewrite.c:

	Reply to Miciah.  

Thu Jul 22 01:58:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/rewrite/rewrite.c:

	The gr smart prefix now searches the Google Groups.  

Thu Jul 22 01:56:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/rewrite/rewrite.c:

	Improve dumb/smart prefixes options descriptions.  

Thu Jul 22 01:49:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	secure_file_saving -> infofiles.secure_save 

Thu Jul 22 01:47:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Blank lines.  

Thu Jul 22 01:18:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/globhist/globhist.c:

	Noted when was document.history.global.write_interval aliased.  

Thu Jul 22 00:17:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/proxy.c:

	get_protocol_proxy(): @protocol_proxy -> @proxy. I'll probably leave
	the rest to our cleanup and URI team ;-).  

Thu Jul 22 00:15:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/proxy.c:

	get_proxy_worker(): split and unify the redundant code to
	get_protocol_proxy(), with extremely crude calling notation etc.  

Thu Jul 22 00:05:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/proxy.c:

	get_proxy_worker(): Whoops, fix b0rked getenv()s.  

Thu Jul 22 00:00:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/proxy.c:

	get_proxy_worker(): if chain -> switch 

Wed Jul 21 23:48:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/proxy.c:

	get_proxy_worker(): use @protocol_proxy everywhere instead of
	<protocol>_proxy.  

Wed Jul 21 23:27:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bookmarks/dialogs.c:

	add_bookmark_after_selected() -> move_bookmark_after_selected() 

Wed Jul 21 23:25:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/link.c:

	When highlighting a link, globhist should have more priority than
	bookmarks, being more tentative and likely also more relevant at the
	time.  

Wed Jul 21 23:15:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: internal.h, parser.c, parser.h,
	parser/forms.c, parser/link.c, parser/stack.c:

	html_format.{href_base,target_base} are not per-element properties,
	therefore let's move them to html_context. This fixes a bug of <base
	target> broken by the last <title> fix of mine, generously tracked
	down by zas.  

Wed Jul 21 19:39:25 2004  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	ses_forward(): assert(loc) and provide a recovery path.  

Wed Jul 21 19:35:54 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Set url to about:blank if no src attribute is set in frame tag. It
	prevents segfault reported by Miciah triggered by
	thinkofthechildren.co.uk.  

Wed Jul 21 12:53:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/proxy.c:

	Rewrap comment and remove blank line.  

Tue Jul 20 22:46:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: kbdbind.c, kbdbind.h:

	...and fix @edit_action_table sort order, pointed out by Miciah.  

Tue Jul 20 22:31:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Bla.  

Tue Jul 20 22:26:01 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In send_event, we |ev->y &= ~KBD_ALT| before calling the menu code 
	and |ev->y |= ~KBD_ALT| after. I don't understand why we do the
	bitwise-or or where |ev| will be used after that, but the
	bitwise-not looks wrong, and disappeared silently in Links 1.00pre5,
	so drop it in ELinks.  

Tue Jul 20 22:25:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/kbdbind.c, viewer/text/form.c, viewer/text/link.c,
	config/kbdbind.h:

	ACT_EDIT_EDIT -> ACT_EDIT_OPEN_EXTERNAL 

Tue Jul 20 22:14:25 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/uri.c:

	check_uri_file(): use static const attributes for @chars.  

Tue Jul 20 22:07:47 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	get_proxy_worker(): space fix.  

Tue Jul 20 22:05:58 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	get_proxy_worker(): use else if for protocol tests.  

Tue Jul 20 22:04:27 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	get_proxy_worker(): extract no_proxy stuff only if needed.  

Tue Jul 20 22:02:37 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	get_proxy_worker(): test for ftp protocol in uri before extracting
	environment variables related to ftp proxy.  

Tue Jul 20 22:01:01 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	get_proxy_worker(): test for https protocol in uri before extracting
	environment variables related to https proxy.  

Tue Jul 20 21:59:41 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	get_proxy_worker(): test for http protocol in uri before extracting
	environment variables related to http proxy.  

Tue Jul 20 21:56:39 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	get_proxy_worker(): drop useless else, and invert a test.  

Tue Jul 20 21:55:58 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Move the quit: label after the check |ev->x == KBD_CTRL_C|, which is
	already done before the only goto for that label.  

Tue Jul 20 21:54:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Rewrap and add a blank line.  

Tue Jul 20 21:54:17 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	get_proxy_worker(): reindent code.  

Tue Jul 20 21:52:40 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Re-indent part of send_event.  

Tue Jul 20 21:52:20 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	get_proxy_worker(): prepare for reindentation, slightly increase
	code redundancy.  

Tue Jul 20 21:46:01 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	Move code from get_proxy_worker() to new proxy_uri().  

Tue Jul 20 21:39:18 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/proxy.c:

	get_proxy_worker(): move (http|https|ftp|no)_proxy to inner branch,
	where they are used.  

Tue Jul 20 19:01:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/dialogs.c:

	Introduce add_bookmark_after_selected() and use it after calls to
	add_bookmark() to insert it more logically.  

Tue Jul 20 09:18:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/osdep.c:

	Simplify the #if jungle.  

Tue Jul 20 09:18:00 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Jul 20 09:01:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/generic.h:

	Describe.  

Tue Jul 20 07:58:44 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/dialogs.c:

	In the option manager, when the user selects 'Add', add the new
	option to the selected item's parent if the selected item is a
	collapsed folder.  

Tue Jul 20 07:39:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/mime/mime.c:

	In check_extension_type, do not free handler->program, which is
	allocated along with handler since 2003-12-31 08:50:39, 'Introduce
	mime handler initializer and allocate the program with the struct so
	freeing is easier.' 
	
	This change fixes a segfault when one creates an option
	mime.type.image.x-foo with a valid handler and tries to load a file
	with the extension foo for which no content type is supplied by the
	server or by a mime.extension.foo option.  

Tue Jul 20 07:26:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: mime/backend/mimetypes.c, protocol/uri.c, sched/download.c:

	get_extension_from_uri: Include the leading '.' in the returned
	extension.  
	
	get_temp_name: Now that get_extension_from_uri includes the '.', do
	not add another here.  
	
	get_content_type_mimetypes: Increment |extension| before the first
	iteration to skip the leading '.'. The loop iteratively truncates
	the beginning of the string up to and including the first '.' and
	looks up the result, and so the routine would still work without
	this change, but it looks better with the increment and avoid a
	first interation in which we would look up the content type for an
	empty extension.  
	
	The impetus for this change was to fix the code in http_got_header
	that detects whether the content encoding matches the extension of
	the file, which is the heuristic used to determine whether to
	decompress the data.  http_got_header passes the result of
	|get_extension_from_uri(uri)| to guess_encoding, which expects the
	leading '.'. Thus, we were always decoding the data, and now we
	again decode only when the extension does not match the content
	encoding 
	(e.g., 'Content-Encoding: gzip' and file name 'foo.tar.gz').  

Tue Jul 20 01:36:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.h:

	Describe the rest of the menu_item_flags.  

Tue Jul 20 01:11:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, mime/dialogs.c:

	Move NO_INTL flag to new_menu() call for File :: History menus. Use
	NO_INTL for URI passing to command menu and mime extension menu.  

Tue Jul 20 00:35:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Fix double free error in external URI passing. I guess it is not
	that well tested ;) 

Tue Jul 20 00:14:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c,
	viewer/text/link.c:

	Remove ACT_MAIN_EDIT 'fake' action. Improve caption for
	ACT_EDIT_EDIT. Workaround rtext only working for main mappings by
	initializing it the cruel way. Pointed out by miernik.  

Mon Jul 19 23:19:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/color.html:

	The color test now uses table and contains all colors in
	util/color.inc 

Mon Jul 19 23:09:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Heh fix isscreensafe() bugfix.  

Mon Jul 19 22:52:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/plain/renderer.c, terminal/screen.c,
	util/string.h, viewer/dump/dump.c:

	Introduce isscreensafe() for testing if char is usable for screen
	writing. Fixes bug in plain renderer.  

Mon Jul 19 22:09:49 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/text.c:

	Let text scroller work when mouse is outside dialog borders, so it
	is easier to use.  

Mon Jul 19 21:16:39 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	menu_mouse_handler(): drop redundant test and reindent code.  

Mon Jul 19 21:01:26 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: menu.c, menu.h:

	Drop mi_is_unselectable() macro, just use !mi_is_selectable()
	instead.  

Mon Jul 19 16:43:00 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Optimize selectable items search by introducing search_selectable()
	function.  

Mon Jul 19 16:25:04 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	scroll_menu(): @w -> @height, drop useless int_lower_bound() calls.  

Mon Jul 19 16:14:53 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	scroll_menu(): move @w, @scr_i calculations where they are needed.  

Mon Jul 19 16:11:01 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	scroll_menu(): almost complete rewrite to fix issues revealed by
	file completion menu. Home/end were not working when unselectable
	menu items where at start or end of menu, page up/down were working
	with some glitches. All issues should now be fixed, code was
	commented.  

Mon Jul 19 13:33:35 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	scroll_menu(): add a @wrap parameter, not yet used.  

Mon Jul 19 13:29:29 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	scroll_menu(): @d -> @steps.  

Mon Jul 19 12:57:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	decode_color(): Stick a comment near the broken hexadecimal rgb
	color workaround.  

Mon Jul 19 12:45:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	decode_color(): Looks like somebody b0rked up the color values in
	the slashcode so treat hex digit string with length 3 or 6 as hex
	colors if the color lookup didn't find a match.  

Mon Jul 19 08:05:10 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	scroll_menu(): fix scroll up in menu, when first item is not
	selectable, issue revealed by file completion menu.  

Mon Jul 19 00:56:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	complete_file_menu(): Don't expand the form state value for
	directories when there is only one entry. Open 'Empty directory'
	menu for ... Use do_menu() since it does the same as the
	do_menu_selected() call.  

Sun Jul 18 18:29:54 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	Compilation fix: |quoted_value| is no more used due to change in
	parse.c (1.81 -> 1.82).  

Sun Jul 18 16:34:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Disable handling of <foo id='a''b'> (well, it is handled as <foo
	id='a'> now) in favour of handling <foo id='a''>. Motivated by lindi
	and the Astalavista's Babelfish.  

Sun Jul 18 16:00:33 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Jul 18 15:53:58 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): no need to set @s_info_connect.fd to -1, since
	on error @s_info_connect.addr is set to NULL.  

Sun Jul 18 15:52:01 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): drop |free_and_return| label.  

Sun Jul 18 15:50:28 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): break loop instead of gotos.  

Sun Jul 18 15:48:56 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): move @saved_errno declaration in while() loop.  

Sun Jul 18 15:47:46 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): drop |again| label and use a while() loop
	instead.  

Sun Jul 18 15:46:08 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): add a goto free_and_error.  

Sun Jul 18 15:43:29 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): reindent code.  

Sun Jul 18 15:42:16 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): introduce @saved_errno, and close file
	descriptor immediatly after connect() error.  

Sun Jul 18 15:38:48 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): drop one goto free_and_error.  

Sun Jul 18 14:06:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/hooks.c:

	EHS_NEXT -> EVENT_HOOK_STATUS_NEXT for now.  

Sun Jul 18 13:57:49 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation updated.  

Sun Jul 18 13:33:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bookmarks/dialogs.c, cookies/dialogs.c:

	Annihilate  expressions from listbox messages.  

Sun Jul 18 12:40:23 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/interlink.c:

	Dropped unreviewable 1.79 (and depending 1.80) - please don't mix
	reindenting code with anything else. You're my cosmo-girl, you're in
	my mind...  

Sun Jul 18 12:36:04 2004  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	.po files were resynced. You're my hearth, you're my soul...  

Sun Jul 18 11:00:34 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Jul 18 10:51:19 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	complete_file_menu(): optimize entries loop. Drop @i for @entry,
	drop useless initialization of @entries to NULL, free @entry->attrib
	as soon as possible, and reorder tests.  

Sun Jul 18 04:44:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Add a few comments.  

Sun Jul 18 04:38:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	form_file_menu(): Disable the no elevator hack for now.  

Sun Jul 18 04:33:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/optgroup.html:

	Add file completion test.  

Sun Jul 18 04:28:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Update comments a bit.  

Sun Jul 18 04:01:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, viewer/text/form.c:

	Add menu style file completion to upload file form fields (Bug 294).
	It's quite cool but there is still room for improvements. It should
	be easily extended for usage by other filename inputs widgets.  

Sun Jul 18 02:21:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/file.c, util/file.c:

	Looks like these #includes might belong to the dir entry stat()ing.  

Sun Jul 18 02:20:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/file.c, util/file.c, util/file.h:

	Use file_is_dir() in file_protocol_handler() and move the opendir()
	call to get_directory_entries().  

Sun Jul 18 01:50:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/file.c, util/file.c, util/file.h:

	Move the directory entry table factory to util/file.* so it can be
	used for file text-input form-field completion and maybe file input
	widgets. I don't particularly like the system headers exposed in
	util/file.h the alternative is to move the opendir() call to it and
	just do an fstat() in file_protocol_handler().  

Sun Jul 18 01:32:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/uri.c:

	Use assertm and if_assert_failed instead of INTERNAL in join_urls.  

Sun Jul 18 00:58:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Fix a typo in the caption for ui.success_msgbox: s/sucess/success/.  

Sat Jul 17 22:57:36 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): drop another goto/label.  

Sat Jul 17 22:53:39 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): drop goto/label and simplify code.  

Sat Jul 17 22:28:43 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): drop commented out code.  

Sat Jul 17 22:27:10 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	connect_to_af_unix(): use mem_free_set().  

Sat Jul 17 22:21:42 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	Introduce safe_close() and slightly reduce code redundancy.  

Sat Jul 17 20:22:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/inpfield.h, config/conf.c, dialogs/status.c:

	Partially reverted brainless s/80/DEFAULT_TERMINAL_WIDTH/, updated
	the value of 80 to some more sensible value in each case while at
	it.  

Sat Jul 17 20:14:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.c:

	Our whitespace police detected a tragic incident in the
	add_char_to_string() avenue.  

Sat Jul 17 20:13:10 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/group.c:

	dlg_format_group(): assert @n > 0.  

Sat Jul 17 20:10:42 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/button.c:

	buttons_width(): assert @n > 0 and simplify loop test.  

Sat Jul 17 20:08:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/Makefile.am:

	Removed codepage.h reference. Look kids, here you see Jonas, who
	unknowingly broke make dist and nightly builds by forgetting to
	update this. Take example. Now let's go on in the excursion, here
	you see the image of our magnificient project leader...  

Sat Jul 17 20:03:28 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Mark unused parameters using @xxx name.  

Sat Jul 17 19:51:58 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	select_dlg_item(): use struct widget_data *widget_data.  

Sat Jul 17 19:47:42 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	dialog_ev_mouse(): shorten lines by using struct widget_data *.  

Sat Jul 17 19:36:31 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/button.c:

	buttons_width(): simplify loop by using @n only.  

Sat Jul 17 16:28:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Include sched/event.h now that it defines an event hook.  

Fri Jul 16 18:55:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/urlhist.c:

	Compile fix.  

Fri Jul 16 18:53:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/urlhist.c, dialogs/menu.c:

	done_url_history(): Free goto url history.  

Fri Jul 16 18:50:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Periodically save searchhist to disk.  

Fri Jul 16 18:46:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/urlhist.c, config/urlhist.h:

	Periodically save gotohist to disk. Fixes bug 229.  

Fri Jul 16 18:33:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/events.txt:

	Add periodic-saving event description.  

Fri Jul 16 18:30:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, globhist/globhist.c, lowlevel/timer.c:

	Use global history code to make infrastructure for periodically
	saving ~/.elinks info files to disk. It introduces 'infofiles'
	option tree where the 'save_interval' is placed. Idea is to also
	move secure saving there. Maybe they can all go under 'config' tree.
	Anyway the naming of things is not so good so please search and
	replace any oddities.  

Fri Jul 16 15:32:49 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Minor optimization: test @file_encoding before any string
	comparaison.  

Fri Jul 16 12:27:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	draw_typeahead_match(): Use get_current_link().  

Fri Jul 16 12:20:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	draw_link_text() -> draw_typeahead_match() 

Fri Jul 16 12:13:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/blacklist.c:

	get_blacklist_entry(): Use strlcasecmp() to make sure the whole
	string is matched. Tak Miciah.  

Fri Jul 16 07:00:07 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/link.c:

	Fix a logic inversion introduced in revision 1.277 that prevented 
	the display of information on the selected form field in the status
	bar.  

Fri Jul 16 06:55:19 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/document.c:

	In done_link_members, drop the |name| local variable and pass the
	return value of get_link_name directly to mem_free_if.  

Fri Jul 16 06:13:18 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/http/blacklist.c:

	In get_blacklist_entry, return NULL rather than 0 when the assertion
	fails.  

Thu Jul 15 17:51:32 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/html/renderer.c:

	- Compilation fix.  

Thu Jul 15 16:20:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/blacklist.c:

	add_blacklist_entry(): Use get_blacklist_entry().  

Thu Jul 15 16:19:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/blacklist.c:

	add_blacklist_entry(): @b -> @entry 

Thu Jul 15 16:18:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/blacklist.c:

	del_blacklist_entry(): Use get_blacklist_entry() and cleanup.  

Thu Jul 15 16:13:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: blacklist.c, blacklist.h:

	Introduce SERVER_BLACKLIST_NONE for the code bloat.  

Thu Jul 15 16:12:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: blacklist.c, blacklist.h:

	get_blacklist_flags(): Return enum blacklist_flags.  

Thu Jul 15 16:11:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/blacklist.c:

	get_blacklist_flags(): Move assertions and blacklist lookup to
	get_blacklist_entry().  

Thu Jul 15 16:03:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/blacklist.c:

	Make @blacklist static.  

Thu Jul 15 16:01:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: blacklist.c, blacklist.h, http.c:

	Server blacklist functions now take URI struct.  

Thu Jul 15 15:54:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/inpfield.c, bfu/listbox.c,
	bfu/menu.c, bfu/text.c, config/dialogs.c, config/kbdbind.c,
	config/kbdbind.h, dialogs/exmode.c, dialogs/info.c,
	lowlevel/timer.c, sched/action.c, viewer/text/form.c,
	viewer/text/view.c:

	enum keymap: KM -> KEYMAP 

Thu Jul 15 15:52:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: blacklist.h, http.c:

	enum blacklist_flags: BL -> SERVER_BLACKLIST 

Thu Jul 15 15:44:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/rewrite/rewrite.c, sched/event.c, sched/event.h,
	scripting/guile/hooks.c, scripting/lua/core.c,
	scripting/lua/hooks.c, scripting/perl/hooks.c:

	enum evhook_status: s/EHS_/EVENT_HOOK_STATUS_/ 

Thu Jul 15 15:38:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.c, tab.c, tab.h, window.c, window.h:

	enum window_type: s/WT_/WINDOW_/ 

Thu Jul 15 15:35:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/inpfield.c, bfu/listbox.c,
	bfu/menu.c, config/kbdbind.c, lowlevel/timer.c, osdep/os2/os2.c,
	osdep/unix/unix.c, sched/session.c, terminal/event.c,
	terminal/event.h, terminal/kbd.c, terminal/terminal.h,
	terminal/window.c, viewer/text/form.c, viewer/text/view.c:

	enum term_event_type: s/EV_/EVENT_/ 

Thu Jul 15 15:24:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser/forms.c, viewer/text/form.c,
	viewer/text/form.h, viewer/text/link.c:

	enum form_method: s/FM/FORM_METHOD/ ... and remove double ;; from
	last patch.  

Thu Jul 15 15:20:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.c, document/document.h,
	document/html/renderer.c, sched/session.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/search.c, viewer/text/textarea.c:

	Move link->name and link->form_control members into a union.  
	Introduce get_link_name() and get_link_form_control() macros to wrap
	access.  It saves ~20kB when having fm an /. opened in two tabs.  
	The link->form_control using code is now even uglier.  

Thu Jul 15 14:03:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/hierbox.c:

	done_listbox_item(): Assert listbox_item->child is empty.  

Thu Jul 15 12:55:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/opttypes.c:

	tree_dup(): Initialize option->root.  

Thu Jul 15 12:50:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	Revert last patch. It triggers 'Orphaned unregistered option ...'
	errors.  

Thu Jul 15 10:54:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	delete_option(): Double funny looking del_from_list() to make things
	clearer.  

Thu Jul 15 10:42:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/action.c,
	viewer/text/view.c:

	tab_menu(): Drop @term arg.  

Thu Jul 15 08:42:16 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/group.c, document/html/tables.c,
	document/html/parser/table.h, sched/connection.c,
	viewer/text/form.c, viewer/text/link.c, viewer/text/search.c,
	viewer/text/textarea.c, viewer/text/view.c:

	Drop bunch of useless/obsolete comments.  

Thu Jul 15 08:29:08 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/link.c:

	Remove a stale comment listing the callers of goto_current_link: 
	submit_form_do has been renamed and there are now many other
	callers.  

Thu Jul 15 08:13:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/action.c,
	viewer/text/view.c:

	Add a |place_above_cursor| parameter to tab_menu to indicate whether
	to draw the menu with the top at |y| or the bottom.  This allows us
	to position the menu appropriately when one right-clicks the tab bar
	and when one right-clicks the document canvas.  

Thu Jul 15 08:03:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/action.c,
	viewer/text/view.c:

	Add |x| and |y| parameters to tab_menu instead of relying on callers 
	to call set_window_ptr.  

Thu Jul 15 07:38:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/action.c,
	viewer/text/view.c:

	Drop the |tab| parameter from tab_menu as the tab can be obtained
	from |ses|.  Remember to update the prototype this time.  

Thu Jul 15 07:30:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/menu.c:

	In tab_menu, take |struct window *tab| directly instead of taking a
	void pointer.  

Thu Jul 15 07:13:04 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/dialogs.c:

	Give a NULL value for the |messages| field of the
	options_listbox_ops and keybinding_listbox_ops structures.  

Thu Jul 15 07:03:52 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/options.c:

	In charset_list, do not initialise |i| twice. The extra
	initialisation was introduced in src/dialogs/options.c 1.150.  

Thu Jul 15 06:53:56 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	In get_image_text, fix the loop that truncates everything before and
	including the last slash to delete the slash even if it is at the
	start of the string.  

Thu Jul 15 06:22:30 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/link.c:

	In get_image_text, adjust |len| by the difference between |start|
	and |src| instead of calling strcspn a second time.  

Thu Jul 15 00:49:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/parsetst.c:

	Drop unneeded guards.  

Thu Jul 15 00:45:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/: bookmarks.h, dialogs.h, backend/common.c,
	backend/default.c, backend/xbel.c:

	Remove unneeded guards and move decls after #includes.  

Thu Jul 15 00:45:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/globhist/: dialogs.h, globhist.h:

	Remove unneded #include. Move decls after #includes which seems to
	be the norm.  

Thu Jul 15 00:43:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/backend/: mailcap.h, mimetypes.h:

	Remove unneeded guards.  

Thu Jul 15 00:36:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/: bookmarks.c, bookmarks.h:

	Drop return value from delete_bookmark().  

Thu Jul 15 00:17:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/.cvsignore:

	Ignore .html (test) and .patch (probe) files often found in (my)
	src/ dir.  

Wed Jul 14 22:16:14 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/: menu.c, menu.h:

	pass_uri_to_command(): @a -> @xxx, since it is not used.  

Wed Jul 14 22:14:43 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	Minor indentation and comment fixes.  

Wed Jul 14 22:13:07 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/: menu.c, menu.h:

	dialog_goto_url(): char *url -> unsigned char *url.  

Wed Jul 14 22:11:04 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/: menu.c, menu.h:

	tab_menu(): @d -> @tab_.  

Wed Jul 14 22:08:30 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	menu_url_shortcut(): @d -> @url.  

Wed Jul 14 22:00:03 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	open_in_new_window(): @xxx -> @func.  

Wed Jul 14 21:54:13 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/options.c:

	charset_list(): cleanup, do not call get_cp_name() twice.  

Wed Jul 14 21:37:11 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/hardio.c:

	Assert p && l >= 0 for safety.  

Wed Jul 14 21:32:08 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/hardio.c:

	Reduce number of tests in hard_read()/hard_write(), declare @r,@w in
	loops.  

Wed Jul 14 21:27:16 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/hardio.c:

	Code simplification in hard_write() and hard_read().  

Wed Jul 14 20:04:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cookies/dialogs.c:

	In delete_cookie, rename foreachsafe's temporary variable from
	|from| to |next|.  

Wed Jul 14 19:28:15 2004  Laurent Monin <zas@norz.org>:

	* src/config/conf.c:

	Move code to write_config() and drop write_config_to().  

Wed Jul 14 19:15:29 2004  Laurent Monin <zas@norz.org>:

	* src/globhist/globhist.c:

	Only mark globhist as clean if secure_close() succeeds.  

Wed Jul 14 18:21:17 2004  Laurent Monin <zas@norz.org>:

	* src/globhist/globhist.c:

	Move anonymous test to write_global_history(), and timers funcs,
	drop elinks_home test from callers.  

Wed Jul 14 18:13:49 2004  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Handle add_bookmark() possible failure in bookmarks/dialogs.c.  

Wed Jul 14 18:08:48 2004  Laurent Monin <zas@norz.org>:

	* src/bookmarks/: bookmarks.c, backend/default.c:

	Fix add_bookmark() stupid bug introduced in bookmarks.c (1.133 ->
	1.134), and handle add_bookmark() failure in
	read_bookmarks_default().  

Wed Jul 14 17:44:40 2004  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/bookmarks.c, globhist/globhist.c, util/conv.c,
	util/conv.h:

	Move sanitize_(title|url)() to conv.{c,h} and use them for globhist
	too. Sanitization now occurs in add_(bookmark|globhist_item)() on
	title and url copies, cleaner.  

Wed Jul 14 17:21:23 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/text.c:

	Drop redundant @term test, get_bfu_color() does the job.  

Wed Jul 14 15:14:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hierbox.c, hierbox.h, listbox.h:

	Remove listbox_item->root.  

Wed Jul 14 15:12:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	push_kbdbind_add_button(): Cleanup usage of listbox_item->root.  

Wed Jul 14 15:02:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	Hack up a way to resolve keymap box items from action strtonum by
	checking that the pointer is within a table range range.  

Wed Jul 14 14:52:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	get_keybinding_root(): Now only action boxes uses item->root.  

Wed Jul 14 14:33:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: dialogs.c, dialogs.h, kbdbind.c:

	Move keybinding listbox init/done functionality to dialog code. Had
	to move init/free keymap functions.  

Wed Jul 14 14:20:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: dialogs.c, dialogs.h, kbdbind.c, kbdbind.h:

	Cleanup keybinding text toggling. Only the dialog code needs to know
	about it.  

Wed Jul 14 14:17:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	{init,free}_action_listboxes() -> {init,done}_keybinding_listboxes() 

Wed Jul 14 14:13:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Introduce get_keybinding_action_box_item().  

Wed Jul 14 14:02:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Oops this little change slipped into the get_root() introducing
	patch. Harmless 

Wed Jul 14 14:00:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: dialogs.c, options.c, options.h, opttypes.c:

	Add root member to struct option. Use it for implementing correct
	listbox get_root() op. Sanitize change_hook crawling by using
	option->root instead of option->root->udata. More (autocreate)
	option code can probably also be cleaned up to use option->root.  

Wed Jul 14 13:51:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/listbox.c, bfu/listbox.h,
	bookmarks/bookmarks.c, bookmarks/dialogs.c, cache/dialogs.c,
	config/dialogs.c, config/kbdbind.c, cookies/dialogs.c,
	dialogs/download.c, formhist/dialogs.c, globhist/dialogs.c,
	protocol/auth/dialogs.c:

	Introduce listbox_ops->get_root(). The listbox_item->root member is
	still there and some implementations simply return item->root for
	now. Non hierarchic listbox browser just return NULL.  

Wed Jul 14 12:02:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/listbox.h, cookies/dialogs.c:

	Make listbox_ops->delete() also delete nested listboxes. Bookmarks
	and option deletion alreay does it so just make cookie ops do it.
	Fixes access to free()d memory because do_delete_item() deleted
	childs before the parent and the cookie code would automagically
	remove the cookie_server.  

Wed Jul 14 09:44:07 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Jul 14 02:28:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/link.c:

	html_img(): Split out image from src='<text>' setup.  

Wed Jul 14 02:06:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/link.c:

	html_applet(): Cleanup.  

Wed Jul 14 01:22:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Drop the type casting now that zas has made the part known to HTML
	parser.  

Wed Jul 14 00:58:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Update description of ui.sessions.auto_save_foldername to mention
	uniqueness.  

Wed Jul 14 00:45:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/bookmarks.c:

	Doh them last minute changes. Fix last patch to currently detect
	bookmark folders.  

Wed Jul 14 00:44:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/bookmarks.c:

	Only delete matching bookmark folders when saving the auto session
	but then delete _all_ matches.  

Wed Jul 14 00:31:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, bookmarks/bookmarks.h,
	terminal/terminal.c:

	Introduce bookmark_auto_save_tabs() that wraps
	bookmark_terminal_tabs().  

Wed Jul 14 00:24:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	send_connection_info(): Use foreachsafe().  

Wed Jul 14 00:24:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/lists.h:

	Introduce foreachsafe() list iterator and use it for free_list().  

Wed Jul 14 00:03:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/lists.h:

	Introduce list_typeof() macro to wrap typeof(). With a little extra
	type casting code dublication was decreased.  

Tue Jul 13 22:11:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/bookmarks.c:

	delete_bookmark(): Cleanup the infanticide.  

Tue Jul 13 21:22:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/dialogs.c:

	Simplify code for bookmark root checking by not going through the
	listbox_items.  

Tue Jul 13 19:53:45 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	Move continue_download_do() before continue_download() and drop its
	prototype.  

Tue Jul 13 19:51:41 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	Move common_download_do() before common_download() and drop its
	prototype.  

Tue Jul 13 19:50:14 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	Move create_download_file_do() before create_download_file() and
	drop its prototype.  

Tue Jul 13 19:49:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	Make delete_option_do() static.  

Tue Jul 13 19:44:57 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	Make write_cache_entry_to_file() static.  

Tue Jul 13 16:54:37 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser.h, renderer.c,
	tables.c, tables.h, parser/forms.c, parser/forms.h, parser/parse.c,
	parser/parse.h:

	Use struct part *part instead of void *f.  

Tue Jul 13 16:28:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/lua/core.c:

	It should be ok to just use cached documents.  

Tue Jul 13 16:24:02 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/lua/core.c:

	Compilation fix. Jonas, please verify if 1 is ok or wrong.  

Tue Jul 13 15:09:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/status.c, document/renderer.c, document/renderer.h,
	sched/action.c, viewer/text/draw.c, viewer/text/draw.h:

	Make draw_formatted() and no caching support introduced in 'Make
	render_document_frames() always rerender ...' less aggressive and by
	tristating @rerender arg to draw_formatted(). 2 now means no caching
	and is only used for ACT_MAIN_RERENDER action.  

Tue Jul 13 14:48:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: draw.c, draw.h:

	Make draw_doc() static.  

Tue Jul 13 10:31:31 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	render_html_document(): tidy up and more comments.  

Tue Jul 13 10:12:31 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Jul 13 08:42:10 2004  Laurent Monin <zas@norz.org>:

	* src/: protocol/http/http.c, viewer/text/form.c:

	Comments about special handling of LF char by http_send_header()
	were added. Thanks to Jonas.  

Mon Jul 12 20:55:27 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Revert changes to line terminators, it breaks post on fm, need to be
	rechecked.  

Mon Jul 12 20:48:49 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	encode_multipart(): use add_crlf_to_string(), add_char_to_string()
	were applicable, and cleanup.  

Mon Jul 12 20:40:14 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Use \r\n instead of \n as line terminators. It seems to be more
	conform to RFCs and to behavior of other web browsers. Please test
	heavily.  

Mon Jul 12 18:32:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, options.h, renderer.c:

	Make render_document_frames() always rerender the document by
	disabling the formatted cache using new document_options->no_cache
	boolean member. Idea by Miciah. It should fix amongst other things
	the View :: Rerender menu action and also rerendering document when
	draw_formatted(..., @rerender) is called with non-zero @rerender.
	This will make followed links from a document appear visited when
	going back (hmm should this only be done when CONFIG_GLOBHIST is
	defined?). Bad thing is a lot of rerendering can be result and it
	may have to be fine-tuned a bit or even reverted if it is too
	annoying.  

Mon Jul 12 18:25:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, options.h, renderer.c, html/parser.c:

	Revert last patch. My tree was poisoned.  

Mon Jul 12 18:23:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, options.h, renderer.c, html/parser.c,
	html/parser.c:

	html_hr(): Use get_html_max_width() if get_width() fails. This fixes
	an off by something error in the width calculation that was spotted
	by zas. Note usage of get_html_max_width() don't add extra margin
	width which the old code did (by looking at links2) but using the
	max width is more in the spirit of what mozilla and opera does. The
	bad width calculation was introduced in (1.145 -> 1.146) 'Bunch of
	miscelleanous cleanup, optimizations, assert(), ....' over a year
	ago.  

Mon Jul 12 18:16:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: internal.h, parser/parse.c, parser/table.c:

	Introduce get_html_max_width() macro.  

Mon Jul 12 15:07:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	enter(): For text-input form-field when insert mode is off simply
	submit form.  

Mon Jul 12 14:31:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, link.h, view.c:

	next_link_in_dir(): Use get_current_link() so somthing bad dosn't
	happen if current link is -1.  

Mon Jul 12 14:03:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	get_protocol(): Try to make code simpler.  

Mon Jul 12 13:52:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h:

	Replaced unused PROTOCOL_INVALID with PROTOCOL_BACKENDS for proocol
	backend index checking.  

Mon Jul 12 13:43:44 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	@s -> @socket.  

Mon Jul 12 13:39:44 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	log_data(): make it static and reduce indentation level.  

Mon Jul 12 12:07:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	link_typeahead_handler(): 'I shall proceed and continue to rock the
	mic' when an error occurs so you don't have to start all over.
	Requested by calmar.  

Mon Jul 12 12:00:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	do_typeahead(): Use separate arg (@match) for the returned link
	number.  

Mon Jul 12 11:58:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	do_typeahead(): Oops fix wrong renaming in (1.242 -> 1.243) -
	'Rename enum typeahead_code values to better match what they are
	mapped to.' 

Mon Jul 12 11:31:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/Makefile.am, protocol/protocol.c,
	protocol/protocol.h, protocol/http/Makefile.am,
	protocol/http/http.h, protocol/http/https.c, protocol/http/https.h,
	sched/connection.c:

	Introduce need_ssl boolean member to protocol_backend. It will make
	it easier to add nntps:// support. SSL initialization now happens in
	run_connection() and nicely pair up with the SSL teardown in
	interrupt_connection().  

Mon Jul 12 11:16:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h, uri.c:

	Reintroduce free_syntax boolean member in protocol backends. For now
	about: uses it.  

Mon Jul 12 10:59:23 2004  Laurent Monin <zas@norz.org>:

	* configure.in, src/config/cmdline.c, src/lowlevel/connect.c,
	src/lowlevel/dns.c, src/lowlevel/interlink.c,
	src/osdep/getifaddrs.c, src/osdep/osdep.c, src/osdep/osdep.h,
	src/protocol/ftp/ftp.c:

	set_ip_tos_throughput() was introduced in osdep.c, and a test for
	sys/socket.h was added to configure.in, headers inclusion was
	modified/improved according to these changes. It simplifies things a
	bit.  

Sat Jul 10 18:57:23 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	Attempt to fix a potential bug in connected(): @func may be NULL and
	still used, as func(conn). This case should not occur since with
	assertions enabled, but it may when these are disabled. Please
	verify, this patch is may be wrong if i missed something.  

Sat Jul 10 18:40:43 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/file/cgi.c:

	Drop redundant call to abort_conn_with_state(), alloc_read_buffer()
	takes care of that.  

Sat Jul 10 14:30:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Minor cleanup.  

Sat Jul 10 13:31:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	mark_option_as_deleted(): For OPT_TREE also mark children as
	deleted.  

Sat Jul 10 13:02:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: options.c, options.inc:

	Make user protocol option initialization table driven.  

Fri Jul  9 18:01:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Add more to FIXME about protocol detection.  

Fri Jul  9 17:55:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_url(): In the handling for unknown protocols in the the
	parse_uri goto loop's URI_ERRN_OK switch label.  
	
	- Improve <IP-address>:<port> check by ``resetting'' the infinite
	  loop prevention.  
	
	- Use check_uri_file() to detect local files with ':'s in the name.  
	
	- Add FIXME about code duplication.  

Thu Jul  8 21:06:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Hmm .. fix the strange bug on newsforge.com (added in tablebg.html)
	but always expanding width - 1 chars even for the right table edge
	expanding. This removes the hack I added in (1.358 -> 1.359). Stuff
	like /. looks more 'tight' but let's see if it is not for the
	better. :) 

Thu Jul  8 20:33:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/table.c:

	parse_table_attributes(): Minor cleanup.  

Thu Jul  8 17:17:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Convert to FIXME.  

Thu Jul  8 17:03:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/tablebg.html:

	Test for the problem with center alignment at newsforge.com 

Thu Jul  8 16:31:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cells(): Remove last suspicious expand_lines() call. Now
	we expand before and after drawing table cells and for each cell and
	that should be enough.  

Thu Jul  8 16:25:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cell(): It seems that the special line expansion for
	table border case is not needed after we align the edge of the whole
	table.  

Thu Jul  8 16:22:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cell(): Oops. Fix off by @y error in last patch.  

Thu Jul  8 16:14:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cell(): Remove internal block.  

Thu Jul  8 15:39:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	expand_lines(): Don't do anything if not rendering background
	colors.  

Thu Jul  8 15:29:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: renderer.c, renderer.h, tables.c:

	expand_lines(): Take the bgcolor as arg.  

Thu Jul  8 14:05:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cells(): Fix the easy fix for off by one error in right
	table edge alignment when there are borders involved.  

Thu Jul  8 13:53:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cells(): Hmm .. the easy way to fix off by one error in
	right table edge alignment. The deeper issue is that we align always
	to the right. It is very obvious when looking at sf with 255 colors.
	The separators in the top menu '|' is drawn with it's darker
	background color as '| '. This is a problem that is hard to fix and
	not a very serious one but it leads the last column to be sometimes
	drawn too wide.  

Thu Jul  8 13:32:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cells(): My assertion about removing the the
	expand_table_.. option was wrong. But I won't introduce the use of
	it again instead we should maybe ignore it if no background color
	usage is set. Anyway expand lines before and after drawing all
	cells. Now the left edge of the body table on /. is nice. Off by one
	errors on the right edge is very obvious now.  

Thu Jul  8 12:44:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.c, parser/table.h:

	struct table_cell: Rename @group -> @is_group, and make it a boolean
	member.  

Thu Jul  8 11:30:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, document/options.c, document/options.h,
	document/html/tables.c:

	Obsolete document.html.expand_table_columns since always expanding
	table columns slipped in the backdoor. The only thing (protected
	and) affected by the option seems to be tha drawing of background
	color for borders so simply check if table->border instead. Lightly
	tested on various sites, so please report any issues.  

Thu Jul  8 11:12:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_cell(): Take @cell as arg and ditch @col and @row args.  

Thu Jul  8 11:09:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cell(): Initialize the HTML state alignment to that of
	the cell. If not for anything else it makes the code cleaner.  

Thu Jul  8 11:00:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cell(): Use the calculated width that accounts for stuff
	like column spanning. Fixes amongst other things background coloring
	in sf's left menu.  

Wed Jul  7 05:45:36 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/draw.c:

	Move assignment to |vs->y| and call to set_link from
	check_document_fragment to draw_doc.  

Wed Jul  7 05:36:08 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/draw.c:

	Whoops, don't set did_fragment if the page isn't done loading.  

Wed Jul  7 04:26:01 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/draw.c:

	Assign |vs->did_fragment = 1;| in |draw_doc| rather than in
	|check_document_fragment|. Now, all references to |did_fragment| are
	in the same routine.  

Wed Jul  7 04:22:40 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/draw.c:

	Negatory, revert. Prepare for a different approach, with help from
	Jonas.  

Wed Jul  7 04:12:19 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/draw.c:

	check_document_fragment's return value is never used, so change the
	return type to void.  

Wed Jul  7 03:04:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/hierbox.c:

	In search_hierbox_browser, pass init_listbox_context |NULL| for its
	|item| argument, which it assigns to |context->item|, instead of
	passing it |box->sel| and then assigning NULL to |context->item|.  

Wed Jul  7 02:59:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/hierbox.c:

	Delete an extra semicolon introduced in revision 1.95.  

Wed Jul  7 02:44:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	smart_config_string(): Fix bad attempt at matching _template_
	options. I think. I mean it is smart code. Too smart for me. Anyways
	the comment suggests that the purpose is to match _template_ options
	so I take it's word for it. It's bad because with searching
	invisible items might not be saved and with _template_ options
	visible they could be saved. Ok there is a check for _template_
	later in the function but hope the point is clear.  

Wed Jul  7 02:24:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/hierbox.h, bfu/listbox.h,
	bookmarks/dialogs.c, cache/dialogs.c, config/dialogs.c,
	cookies/dialogs.c, dialogs/download.c, formhist/dialogs.c,
	globhist/dialogs.c, protocol/auth/dialogs.c:

	Attempt to provide generic hierbox browser searching. It sucks I
	know and that is why _you_ need to help and improve it. ;) 

Wed Jul  7 02:02:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, dialogs/download.c:

	Fix misplaced box->ops->get_info(), it should be get_text(). Add
	NULL returning get_file_download_info() to fix crash when pressing
	the 'Abort' button in the download manager.  

Wed Jul  7 01:37:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	Ditch listbox_info enum and add get_text() op. Idea by Miciah.  

Tue Jul  6 11:05:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/listbox.c, bfu/listbox.h,
	bookmarks/dialogs.c, cache/dialogs.c, cookies/dialogs.c,
	dialogs/download.c, formhist/dialogs.c, globhist/dialogs.c,
	protocol/auth/dialogs.c:

	Ditch listbox_info enum and add get_text() op. Idea by Miciah.  

Tue Jul  6 10:25:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/: cookies.c, cookies.h, dialogs.c:

	s/c_server/cookie_server/.  

Mon Jul  5 11:56:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/util/string.h:

	Remove the isalnum() check. If it's missing that it's probably
	missing the rest of the <ctype.h> ones.  

Mon Jul  5 11:46:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/string.h:

	Fix last patch + minor cleanup.  

Mon Jul  5 11:38:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/: conv.c, string.h:

	If no isalnum() define it to (isalpha || isdigit).  

Mon Jul  5 11:19:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/inpfield.c:

	Reverted my the->a English fix.  

Mon Jul  5 10:41:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/osdep.c:

	set_window_title(): Outcomment GNU screen window name setting.
	Miciah is da screen man, and I was just looking for a random patch.  

Mon Jul  5 05:51:59 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/osdep/osdep.c:

	Fix the default set_clipboard_text routine to correctly set GNU
	Screen's clipboard (or, rather, its '.' register) when running under
	GNU Screen.  This was broken with revision 1.130, 'Drop most
	register variable attribute.' 

Mon Jul  5 04:45:25 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/ftp/ftp.c:

	Re-align the comments describing the members of |struct
	ftp_connection_info|.  

Mon Jul  5 02:54:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Decrease indentation.  

Sun Jul  4 18:17:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	move_link(): Work around the link wrap around by restoring the value
	of doc_view->vs->current_link so it doesn't matter if
	next_link_in_view() 'resets' it.  

Sun Jul  4 17:33:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	move_link(): Add FIXME about the buggy link wrap around.  

Sun Jul  4 16:45:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/string.h:

	Tidyup.  

Sun Jul  4 16:43:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/backend/xbel.c, config/conf.c,
	document/html/parser/parse.c, terminal/event.c, terminal/kbd.c,
	util/string.h:

	isA() -> isident() + minor tidyup.  

Sun Jul  4 16:31:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	try_document_key(): Cleanup. Use isasciialpha().  

Sun Jul  4 16:29:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: viewer/text/marks.c, intl/charsets.c,
	intl/gettext/dcigettext.c, protocol/uri.c, util/conv.h,
	util/string.h:

	Introduce isasciialpha(), isasciialnum() and isident().  

Sun Jul  4 14:56:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inphist.c:

	Fix serious bug where loading non existing history files would leave
	the input_history->nosave flag set to 1.  

Sun Jul  4 14:03:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/exmode.c, dialogs/exmode.h, dialogs/menu.c,
	modules/module.c:

	Modularize exmode and load/save exmode history.  

Sun Jul  4 13:32:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/opttypes.c, util/conv.c:

	Allow '\'' for string delimiters in config set commands.  

Sun Jul  4 13:23:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	More isquote() usage.  

Sun Jul  4 13:06:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, document/css/scanner.c,
	document/html/parser/parse.c, protocol/header.c, util/string.h:

	IS_QUOTE() -> isquote(), and use it for option and CSS parsing.  

Sun Jul  4 12:15:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	get_esc_code(): Drop unchecked return value.  

Sun Jul  4 12:13:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: intl/charsets.c, intl/gettext/loadmsgcat.c,
	protocol/date.c, protocol/uri.c, protocol/ftp/ftp.c,
	protocol/ftp/ftpparse.c, protocol/http/http.c, protocol/smb/smb.c,
	terminal/kbd.c, util/conv.h, viewer/text/view.c:

	s/c < '0' || c > '9'/!isdigit(c)/ and s/c >= '0 && c <=
	'9'/isdigit(c)/.  

Sun Jul  4 11:29:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/backend/mimetypes.c, util/string.h:

	Oops. Wake up and fix last patch.  

Sun Jul  4 11:26:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/exmode.c, document/html/parser/parse.c,
	intl/gettext/loadmsgcat.c, intl/gettext/localealias.c,
	mime/backend/mimetypes.c, protocol/header.c, util/string.h:

	Introduce skip_nonspace() + more skip_space() usage.  

Sun Jul  4 11:04:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, cookies/parser.c, document/html/frames.c,
	intl/gettext/localealias.c, mime/backend/mailcap.c,
	mime/backend/mimetypes.c, protocol/header.c, protocol/proxy.c,
	util/string.h:

	skip_whitespace() -> skip_space(), remove remains of local defines.  

Sun Jul  4 10:54:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/frames.c, intl/gettext/localealias.c,
	protocol/header.c:

	More uses of skip_whitespace().  

Sun Jul  4 10:54:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/draw.c:

	draw_view_status(): Only draw search word if @active. Bug introduced
	when making the draw_current_link() -> draw_view_status() switch.  

Sun Jul  4 10:49:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.c:

	parse_day(): Use isdigit().  

Sun Jul  4 01:10:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/date.c, protocol/ftp/ftpparse.c, util/conv.c:

	Do the string lowering in month2num(). Make parse_month() check that
	there are 3 chars so month2num() won't access beyond the string.
	Looks like most of date parsing does little checking.  

Sun Jul  4 00:01:28 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Pass struct string * to send_cmd() and simplify code.  

Sat Jul  3 23:58:21 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Split ftp_send_retr_req() -> end_it_line_by_line().  

Sat Jul  3 23:37:20 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftpparse.h:

	Improve and reorder comments.  

Sat Jul  3 23:29:49 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/: ftp.c, ftpparse.c, ftpparse.h:

	Warn about FTPPARSE_(SIZE|MTIME|ID)_UNKNOWN zero value, and let
	memset() do the job, simplifying code even more.  

Sat Jul  3 23:20:43 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/: ftp.c, ftpparse.c:

	Use memset() to nullify struct ftpparse fields.  

Sat Jul  3 16:28:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: setup.h, bfu/inpfield.h, config/conf.c, config/options.inc,
	dialogs/status.c, osdep/osdep.c, osdep/os2/os2.c,
	osdep/win32/win32.c, viewer/dump/dump.c:

	Introduce DEFAULT_TERMINAL_{WIDTH,HEIGHT} macros with values 80 /
	25. I hope it is ok to make the default height 25 rather than 24
	since that is what -dump likes.  

Sat Jul  3 16:25:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	handle_trm(): Fix bug setting width and height to non-zero before
	calling get_terminal_size(). If the ioctl() would fail COLUMNS and
	LINES environment variables would not be checked. Introduced in
	(1.58 -> 1.59) 'Introduce struct terminal_info that holds all the
	stuff sent over the interlink'. Motivation was that the terminal
	event was initialized with these values and would later be updated
	but all should be handled by get_terminal_size() now.  

Sat Jul  3 16:03:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/osdep.c, terminal/kbd.c:

	get_terminal_size() [default one]: If ioctl() fails set @x and @y to
	zero so resize_terminal() don't have to.  

Sat Jul  3 15:56:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/osdep.c:

	set_window_title(): Set the GNU screen window name. Idea snatched
	from w3m.  

Sat Jul  3 14:13:45 2004  Laurent Monin <zas@norz.org>:

	* src/util/string.c:

	add_char_to_string(): minor simplification.  

Sat Jul  3 11:31:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Fix bug in (1.295 -> 1.296). Add crlf to accept charset string and
	not header string.  

Sat Jul  3 11:01:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Move isatty() checks to check_stdio() and call it after both
	parse_options() so any commandl line options are correctly
	overridden.  

Sat Jul  3 10:27:55 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/: http/http.c, ftp/ftp.c:

	Use add_crlf_to_string().  

Sat Jul  3 10:26:45 2004  Laurent Monin <zas@norz.org>:

	* src/util/: string.c, string.h:

	Introduce add_crlf_to_string().  

Sat Jul  3 09:58:40 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Use ASCII_LF/ASCII_CR.  

Sat Jul  3 09:44:40 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	get_ftp_response(): reduce indentation level.  

Sat Jul  3 01:34:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	parse_element(): Improve tag soup handling and allow stuff like
	<font=pn-normal>.  

Sat Jul  3 01:21:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/osdep.c:

	Insert Adam Borowski's words from debian bug 228977 regarding xterm
	detection.  

Sat Jul  3 00:04:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/encoding/encoding.c:

	Revert protocol/file/file.c:1.159 changing core part of
	read_encoded_file() from if() chain to a switch() - I think it's
	more clear as it was.  

Sat Jul  3 00:02:30 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Fix last patch, handle errors if any. Spotted by pasky ;).  

Fri Jul  2 23:51:41 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Introduce ftp_data_connect() and reduce code redundancy in
	ftp_retr_file().  

Fri Jul  2 23:39:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	Compilation fix of our put_chars() spaces assertion.  

Fri Jul  2 23:38:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	put_chars(): update last_tag_for_newline also if
	html_is_preformatted() because in that case the existing test is
	unreliable (and often wrong). Could fix Debian bug 219331 (<pre
	id=foo> positioned foo wrongly) reported by Francesco Potorti
	<Potorti@isti.cnr.it>. Insights and help all along the way by Jonas.
	Hope this does not break anything :-).  

Fri Jul  2 23:34:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	Introduce a test in put_chars() to make sure our thoughts about the
	eerie last_tag_for_newline test are right - if we didn't pass the
	test assert that there are no non-whites in the string. Please
	report any failures.  

Fri Jul  2 23:30:41 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	ftp_got_final_response(): trivial clean up.  

Fri Jul  2 23:29:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	Document renderer_context.last_tag_for_newline.  

Fri Jul  2 23:17:38 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/header.c:

	parse_header(): parameters tidy up.  

Fri Jul  2 23:14:22 2004  Laurent Monin <zas@norz.org>:

	* src/: cookies/cookies.c, dialogs/document.c, document/renderer.c,
	document/html/parser.c, mime/mime.c, protocol/header.c,
	protocol/header.h, protocol/http/http.c:

	s/_http_header/_header/ 

Fri Jul  2 23:07:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Simplify parse_html()'s element processing plant by eliminating the
	dark goto put_sp, which seems to be rather pointless. This is quite
	adventurous so it's worth it to stop by this revision when looking
	for any HTML screwups.  

Fri Jul  2 23:04:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/internal.h:

	Try to describe html_context.putsp.  

Fri Jul  2 23:03:50 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/header.c:

	get_http_header_param(): minor tidyup.  

Fri Jul  2 23:01:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Make the impact of the put_chrs()'s -1 branch a little more clear.  

Fri Jul  2 22:43:55 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftpparse.c:

	Reformat comments to be in ELinks style and fix a minor typo (bellow
	-> below).  

Fri Jul  2 22:42:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	put_chrs(): Move the len == 0 check near the place where len is
	decremented. Removes one putsp asignment.  

Fri Jul  2 22:34:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	put_chrs(): Use oneline logics.  

Fri Jul  2 22:31:32 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/ftp/ftp.c:

	Use bitfields for boolean fields in struct ftp_connection_info.  

Fri Jul  2 22:17:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Fixed subconcious errorneous swap of two if()s in put_chrs() by me
	in the tidyup, spotted by Jonas.  

Fri Jul  2 22:14:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	put_chrs(): simplify trivially.  

Fri Jul  2 22:12:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	put_chrs() tidyup.  

Fri Jul  2 22:09:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	Trivial put_chars() tidyup.  

Fri Jul  2 18:07:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/proxy.c:

	proxy_probe_no_proxy(): Be more tolerant and skip leading whitespace
	so '<host1>, <host2>, ...' will also work. Use strcasestr() to
	compare. Fixes debian bug 218451: 'does probably not correctly grok
	no_proxy'.  

Fri Jul  2 17:09:35 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Fix french translation.  

Fri Jul  2 17:05:45 2004  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Fix delete bookmarks' folder text.  

Fri Jul  2 17:03:33 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/dialogs.c:

	Fix delete cookies folder text.  

Fri Jul  2 16:55:27 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jul  2 16:50:38 2004  Laurent Monin <zas@norz.org>:

	* src/globhist/dialogs.c:

	Fix cut'n'paste error.  

Fri Jul  2 16:17:42 2004  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/dialogs.c, cache/dialogs.c, cookies/dialogs.c,
	dialogs/download.c, formhist/dialogs.c, globhist/dialogs.c,
	protocol/auth/dialogs.c:

	English fixes.  

Fri Jul  2 16:00:46 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.h, checkbox.h, inpfield.h, listbox.h, text.h:

	Cleanup, shorter lines in macros.  

Fri Jul  2 15:51:38 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/text.h:

	add_dlg_text(): use struct widget *.  

Fri Jul  2 15:48:32 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/checkbox.h:

	add_dlg_radio(): cleanup.  

Fri Jul  2 15:46:24 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/listbox.h:

	add_dlg_listbox(): use struct widget *.  

Fri Jul  2 15:43:30 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/button.h:

	add_dlg_button_do(): use struct widget *.  

Fri Jul  2 15:37:31 2004  Laurent Monin <zas@norz.org>:

	* src/bookmarks/dialogs.c:

	Add [ Clear ] button to bookmarks manager.  

Fri Jul  2 15:09:31 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/hierbox.c, bfu/listbox.h, bookmarks/dialogs.c,
	cache/dialogs.c, cookies/dialogs.c, dialogs/download.c,
	formhist/dialogs.c, globhist/dialogs.c, protocol/auth/dialogs.c:

	Set per-hierbox messages for all managers. Please check english and
	improve.  

Fri Jul  2 13:05:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/inpfield.c:

	English fix.  

Fri Jul  2 12:23:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/file.c:

	Removed IMHO non-needed description from file_is_dir().  

Fri Jul  2 12:22:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/file.c:

	Removed non-needed !! from file_is_dir().  

Fri Jul  2 11:36:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/tables.html:

	Add test of table tagsoup and troubleling rowspan attribute.  

Fri Jul  2 11:22:06 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/hierbox.c, bfu/listbox.h, bookmarks/dialogs.c:

	Introduce struct listbox_ops_messages, it permits to use per-hierbox
	messages, as an example it was done for bookmarks deletion. More
	work needed.  

Fri Jul  2 10:34:11 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	Drop now useless bookmarks.h inclusion.  

Fri Jul  2 09:51:20 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/hierbox.c, bfu/hierbox.h, bookmarks/bookmarks.c,
	bookmarks/bookmarks.h, bookmarks/dialogs.c,
	bookmarks/backend/common.c:

	Manipulate bookmarks_dirty though bookmarks_(set|unset|are)_dirty()
	functions, and keep it static. Add a callback function
	expansion_callback() to struct hierbox and cleanup bfu/hierbox.c
	from bookmarks_dirty stuff.  

Fri Jul  2 07:36:40 2004  Laurent Monin <zas@norz.org>:

	* src/util/file.c:

	file_is_dir(): use stat(), compilation fix.  

Fri Jul  2 04:16:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/file.c:

	file_is_dir(): Use state() instead of fstat() and don't leak file
	descriptors (?).  

Fri Jul  2 03:28:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/file.c:

	expand_tilde(): Decrease indentation.  

Fri Jul  2 03:24:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/util/file.c:

	expand_tilde(): Use getpwnam() to add support for '~<user>'
	expanding.  

Fri Jul  2 02:14:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Remove old expand_line() call.  

Fri Jul  2 02:11:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Add newline.  

Fri Jul  2 00:26:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/exmode.c:

	Disallow using configuration file commands in exmode in anonymous
	mode.  

Fri Jul  2 00:24:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/exmode.c:

	Revert r1.41 (not allowing exmode in the anonymous mode).  

Fri Jul  2 00:24:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/action.c:

	ACT_MAIN_(KEYBINDING|OPTIONS)_MANAGER is now not accessible in
	anonymous mode.  

Thu Jul  1 23:45:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tr33.  

Thu Jul  1 23:26:33 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Revert idiotic cookies_context patch. Time to sleep...  

Thu Jul  1 22:54:31 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/cookies.c:

	Group cookies global variables in struct cookies_context and use
	only one global for all.  

Thu Jul  1 22:29:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	Hopefully fix <Esc> not triggering menu when inside of an input item
	(and not in the insert mode).  

Thu Jul  1 22:26:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/user.c:

	Cleanup a rather silly-looking get_user_program() assert().  

Thu Jul  1 21:28:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/forms.c:

	Check if <textarea> has nowrap attribute if no wrap attribute is
	found.  

Thu Jul  1 21:05:30 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Jul  1 20:51:47 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update. Greeks are still tough, prolonged and
	still 0:0. They are pretty dangerous now but we'll kick their ass.  

Thu Jul  1 20:48:49 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Updated hungarian translation (go go go Czech edition) 

Thu Jul  1 20:40:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Reindent document.browse.forms.insert_mode. Big chance for Czech in
	GR:CZ right now, but unsuccessful :-(.  

Thu Jul  1 20:31:12 2004  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	.po files were resynced. Greek:Czech still 0:0, but we are playing
	better than those losers now.  

Thu Jul  1 20:19:56 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Updated hungarian translation. (tribute to 0:0) 

Thu Jul  1 19:54:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/table.c:

	Don't rely on add_table_bad_html_end() to do the job in </caption>.
	Greek vs Czech in the second half-life, still 0:0.  

Thu Jul  1 19:47:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/table.c:

	Drop evil inlines from add_table_bad_html_*().  

Thu Jul  1 19:32:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/terminal/event.c:

	Fixed terminal_interlink.utf_8 description. Half-time, still 0:0.  

Thu Jul  1 19:27:02 2004  Petr Baudis <pasky@ucw.cz>:

	* src/terminal/event.c:

	Zero-width arrays aren't well portable -
	terminal_interlink.input_queue [0] -> [1]. Pavel Nedved out of the
	playground.  

Thu Jul  1 19:23:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Reverted part of 1.335, returning the goto to the game. Czech:Greek
	still 0:0, Pavel Nedved injured.  

Thu Jul  1 19:21:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Convert INTERNAL() after apply_stretch_method() call in
	distribute_widths() to an assertm().  

Thu Jul  1 18:39:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/renderer.c:

	FIXME about {struct tag} and find_tag() being in a too specific
	place.  

Thu Jul  1 18:33:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Remove superfluous FIXME.  

Thu Jul  1 18:18:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Fix comment.  

Thu Jul  1 18:12:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Cleanup variables passed to table border drawing functions.  

Thu Jul  1 17:59:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Misc cleanups.  

Thu Jul  1 17:48:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_frames(): Move table rule information gathering to
	init_table_rules().  

Thu Jul  1 17:22:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	handle_interlink_event(): Oops only destroy the current terminal. ;) 

Thu Jul  1 16:29:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	realloc_line(): @x -> @length.  

Thu Jul  1 15:20:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	handle_interlink_event(): Don't send event to any tabs (and trigger
	assertion failures). Instead set @terminate to non-zero and let the
	select loop handle the rest.  

Thu Jul  1 15:07:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Add note about why tag soup handling is after
	done_html_parser_state().  

Thu Jul  1 14:46:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Ditch unused @indent arg to draw_table_bad_html(). Make
	format_table() draw the bad HTML drawing after the created HTML
	state has been removed. This makes the tag soup handling more like
	before the 1.288 -> 1.289 change and fixes the link ordering for bad
	HTML.  

Thu Jul  1 14:42:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_html() -> draw_table_caption(). Add FIXME about bug 432.  

Thu Jul  1 14:38:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_bad_html(): Revert the change to draw bad table HTML
	using draw_table_html(). Change (1.288 -> 1.289) 'Improve handling
	of <caption> (bug 432) ...'. Fixes weird rendering of tag soup on
	http://www.dr.dk/nyheder/penge/article.jhtml?articleID=181763 but
	not completely, the link navigation is still b0rked in the right
	menu.  

Thu Jul  1 14:26:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.c, parser/table.h:

	Add {struct html_start_end} @caption member to {struct table} and
	output that first while saving the table->bad_html stuff to later.  

Thu Jul  1 13:34:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/table.h:

	Move up {struct html_start_end} so it is declared before {struct
	table}.  

Thu Jul  1 13:33:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_bad_html(): Fix bug where entries would be drawn on top
	of each other.  

Thu Jul  1 13:30:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_bad_html(): Split out entry drawing to draw_table_html().  

Thu Jul  1 13:06:28 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	in_viewx() -> link_in_view_x().  

Thu Jul  1 12:48:49 2004  Laurent Monin <zas@norz.org>:

	* AUTHORS:

	lindi email address was updated at his request.  

Thu Jul  1 12:22:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* Unicode/gen-cp, src/intl/charsets.c, src/intl/codepage.h,
	src/intl/codepage.inc:

	Move N_CODEPAGES #define to intl/codepage.inc and remove the .h
	file.  

Thu Jul  1 12:13:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/: charsets.c, charsets.h:

	Move intl/codepages.h include.  

Thu Jul  1 11:58:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.c, terminal.c, terminal.h:

	Move {struct terminal} members used for internal communication to a
	new {struct terminal_interlink}. It is only used by terminal/event.c
	so define it there and allocate the input queue bytes at the end of
	the struct so that interlink cleanup is simply a matter of free()ing
	term->interlink.  

Thu Jul  1 11:56:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/renderer.c, terminal/screen.c:

	Add missing includes.  

Thu Jul  1 11:41:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/charsets.h:

	Standardize #include guards.  

Thu Jul  1 10:54:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/README:

	CSS is compile time configurable.  

Wed Jun 30 23:19:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	All hail goto removing code duplication.  

Wed Jun 30 23:17:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	distribute_widths(): Split out the @stretch_method handling to
	apply_stretch_method().  

Wed Jun 30 22:44:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	stretch_columns(): Use while loop instead of gotos. Break if no
	@stretch_col is found.  

Wed Jun 30 22:39:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	distribute_widths(): Split out column stretching to
	stretch_columns().  

Wed Jun 30 21:42:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	distribute_widths(): Mark visited columns by setting the
	@widths[col] entry to zero so the ending stretch looping will skip
	it. Removes need for @visited_cols array.  

Wed Jun 30 21:11:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	distribute_widths(): Allocate visited_cols last and simplify the
	error path.  

Wed Jun 30 16:56:41 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser.h:

	Move ln_break() prototype from document/html/internal.h to
	document/html/parser.h, and drop inline from its declaration (?).  

Wed Jun 30 16:46:44 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	line_break(): @t -> @tag.  

Wed Jun 30 16:44:56 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	set_pos_y(): @yl -> @height.  

Wed Jun 30 16:10:26 2004  Laurent Monin <zas@norz.org>:

	* src/: document/document.h, document/html/renderer.c,
	document/html/renderer.h, viewer/text/draw.c:

	Move find_tag() from viewer/text/draw.c to document/html/renderer.c,
	do not export struct tag anymore (removed from document/document.h),
	export find_tag() instead.  

Wed Jun 30 15:35:46 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	@xl -> @width, @yl -> @height.  

Wed Jun 30 14:38:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/td-width.html:

	Add test for spacer cells.  

Wed Jun 30 14:03:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Tidy up comment. Move split TODO.  

Wed Jun 30 08:43:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Keep only functions with a reasonable speed_sensitivity/size factor
	inline.  

Wed Jun 30 06:00:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Support 'white-space: normal' too.  

Wed Jun 30 05:51:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c, src/document/css/property.c,
	src/document/css/property.h, src/document/css/value.c,
	src/document/css/value.h, test/css/simplefont.html:

	Add support for 'white-space: pre' CSS property.  

Wed Jun 30 05:33:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/style.h, document/html/internal.h,
	document/html/parser.c, document/html/parser.h,
	document/html/renderer.c, document/html/tables.c,
	document/html/parser/parse.c:

	Replace ALIGN_NONE enum format_align value with AT_PREFORMATTED enum
	format_attr flag. Also make it possible to align preformatted text.
	Fixes bug 472.  

Wed Jun 30 03:26:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, document.h, renderer.c:

	Introduce doucment->css_magic variable. It is calculated from the
	ids of all the imported cache entries that is imported. Fixes
	rerendering triggered by available CSS import. Hope this hack will
	do until we get CSS stylesheet cache or something even more scary.  

Wed Jun 30 03:00:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cell(): Fix line expansion to cover the whole cell height
	and not just the one containing formatted text. This is done by
	using already calculated @height variable. Fixes various background
	table glitches. Most note worthy the cell backgrounds on
	http://www.videohelp.com/capturecards.php now looks ok.  

Wed Jun 30 02:11:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: renderer.c, renderer.h, tables.c:

	Reintroduce usefull expand_lines() that does and replaces the
	expand_line() looping.  

Wed Jun 30 01:52:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: renderer.c, renderer.h, tables.c:

	Drop useless expand_lines(). It is implied by expand_line(). Drop
	return value from expand_line() since it is not used.  

Wed Jun 30 01:31:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cells(): Use already calculated @row_height.  

Wed Jun 30 01:09:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/table.c:

	Trivial space tidyup.  

Wed Jun 30 01:07:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Trivial space tidyup. Describe draw_table_bad_html().  

Wed Jun 30 00:47:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Missing part of @u -> @visited_cols renaming.  

Wed Jun 30 00:28:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Cleanup SSL configuring. OpenSSL don't need to disallow yes dir but
	GNUTLS does because the ssldir is not actually used.  

Tue Jun 29 23:15:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	@margin -> @indent in get_table_margin() and format_table(),
	get_table_margin() -> get_table_indent().  

Tue Jun 29 23:13:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	format_table(): @ww -> @total_width 

Tue Jun 29 23:12:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	@x -> @margin in get_table_margin() and format_table().  

Tue Jun 29 23:08:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Move has_*line_width() below get_hline_width().  

Tue Jun 29 23:04:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	distribute_widths(): @max -> @stretch_width, @max_index ->
	@stretch_col, @max_width -> @col_spare_width 

Tue Jun 29 22:58:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	distribute_widths(): @cols_size -> @cols_array_size 

Tue Jun 29 22:55:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	distribute_widths(): Tidyup.  

Tue Jun 29 22:54:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	distribute_widths(): @wq -> @did_stretch, @om -> @stretch_method 

Tue Jun 29 22:51:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	@u -> @visited_cols 

Tue Jun 29 22:49:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	distribute_widths(): @d -> @spare_width, @dd -> @total_spare_width 

Tue Jun 29 22:48:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	distribute_widths(): Correct the description.  

Tue Jun 29 22:47:02 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	distribute_widths(): Describe what does it do (hopefully).  

Tue Jun 29 22:45:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	distribute_widths() tail: Tidyup.  

Tue Jun 29 22:45:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	distribute_widths() tail: Remove now redundant @q and thus simplify
	the assertm().  

Tue Jun 29 22:44:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	More simplifications of distribute_widths() tail.  

Tue Jun 29 22:41:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Minor simplification of distribute_widths().  

Tue Jun 29 21:28:53 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	First try Lua 4.0, then Lua 5.0 - that's what we still tune it for.  

Tue Jun 29 15:39:19 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Introduce has_hline_width(table, row) macro.  

Tue Jun 29 15:29:59 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_widths(): @p -> @total_width.  

Tue Jun 29 15:27:00 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_widths(): use int_bounds().  

Tue Jun 29 15:25:09 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_widths(): minor tidyup.  

Tue Jun 29 15:23:25 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_widths(): @ss -> @max_width.  

Tue Jun 29 15:19:45 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_widths(): @mss -> @max, @mii -> @max_index.  

Tue Jun 29 15:09:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Drop commented out check_cell_widths(), cvs will keep it for us.  

Tue Jun 29 15:06:14 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_table_margin(): comment cleanup.  

Tue Jun 29 13:44:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.c:

	get_bordercolor(): Ditch return value. It is never handled.  

Tue Jun 29 13:09:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cell(): xw -> width, yw -> height.  

Tue Jun 29 13:06:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cell(): xp -> x, yp -> y.  

Tue Jun 29 11:18:22 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Revert part of last get_table_margin() patch, use of int_bounds()
	here causes segfault here. Why ?.  

Tue Jun 29 10:56:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	draw_table_cells(): Split out the height sanity checking to
	check_table_height().  

Tue Jun 29 10:43:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Move the inner parts of draw_table_cells() loop to
	draw_table_cell(). Caching of struct variables in local ones was
	ditched to simplify draw_table_cell() calling.  

Tue Jun 29 10:29:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table_bad_html() -> draw_table_bad_html(),
	display_complicated_table() -> draw_table_cells(),
	display_table_frames() -> draw_table_frames().  

Tue Jun 29 10:24:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Improve handling of <caption> (bug 432) (and other bad html ;) tags
	by formatting them to be within the real_width of the table. It now
	looks more like the way cells are formatted.  

Tue Jun 29 09:20:51 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_table_margin(): @ww -> @width, >>1 -> /2, use int_bounds().  

Tue Jun 29 08:14:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	display_complicated_table() tail check: table->part->cy +
	table->real_height -> @old_height.  

Tue Jun 29 08:12:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	display_complicated_table() tail check: @yp -> @our_height.  

Tue Jun 29 08:10:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Separate table->real_height calculation from get_table_heights() to
	get_table_real_height() but only moan about the impossibility of
	using it in display_complicated_table() tail check.  

Tue Jun 29 07:50:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Separate the tail display_complicated_table() sanity check to a
	separate block, compiled in only ifndef CONFIG_FASTMEM (since in
	that case the assertm() will be thrown away anyway so it'd be quite
	pointless).  

Tue Jun 29 07:46:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Simplify the assertion check at the tail of
	display_complicated_table().  

Tue Jun 29 07:20:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	format_bad_table_html() -> format_table_bad_html() 

Tue Jun 29 07:16:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/table.c:

	It's bad HTML, not bad table, dammit! ;-). add_bad_table_html_*() ->
	add_table_bad_html_*() 

Tue Jun 29 04:06:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.c, parser/table.h:

	Initialize table->bgcolor in parse_table_attributes().  

Tue Jun 29 03:48:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	get_table_cellpadding(): Return -1 as error code.  

Tue Jun 29 03:47:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Split out something that looks like cellpadding
	fixup to get_table_cellpadding().  

Tue Jun 29 03:33:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	get_table_margin(): Switch the alignment.  

Tue Jun 29 03:29:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Move table x offset aka. margin calculation to
	get_table_margin().  

Tue Jun 29 03:25:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.c, parser/table.h:

	Add table->align member and parse the value the generic way.  

Tue Jun 29 03:23:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/table.c:

	Group attribute get functions.  

Tue Jun 29 03:07:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Move align attribute checking used for x offset
	calculation + local @al variable to block.  

Tue Jun 29 03:01:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Remove @cye local variable by rearranging
	calculations.  

Tue Jun 29 02:46:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.c:

	format_table(): Move attribute parsing to parse_table_attributes().  

Tue Jun 29 02:43:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Initialize table->border directly.  

Tue Jun 29 02:42:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Initialize table->vcellpadding directly.  

Tue Jun 29 02:41:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Initialize table->cellpadding directly.  

Tue Jun 29 02:37:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Initialize table->cellspacing directly.  

Tue Jun 29 02:35:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Initialize table->rules directly.  

Tue Jun 29 02:34:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Initialize table->frame directly.  

Tue Jun 29 02:31:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Parse before extracting attributes.  

Tue Jun 29 02:30:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Tidyup.  

Tue Jun 29 02:29:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.c, parser/table.h:

	parse_table_attributes(), get_bordercolor(): Move.  

Tue Jun 29 02:24:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.h:

	struct table: has_width -> full_width, since we set it to
	par_format.width - margins and original name was 'wf'.  

Tue Jun 29 02:21:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.h:

	parse_table_attributes(): Handle width. Reintroduce
	table->has_width.  

Tue Jun 29 02:11:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	parse_table_attributes(): Handle id.  

Tue Jun 29 02:09:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Introduce parse_table_attributes().  

Tue Jun 29 01:54:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Prospone border color initialization to after table
	parsing.  

Tue Jun 29 01:48:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_bad_table_html(): Cleanup. Use start/end local variables and
	don't modify the table pointers. There's no need to.  

Tue Jun 29 01:43:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	format_table(): Move formatting of bad html to separate function. Do
	the formatting after the various table formatting members has been
	initialized (especially table->part).  

Tue Jun 29 01:37:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.c, parser/table.h:

	Make bad_html array and size members of struct table. Define
	functions to add start and end pointers.  

Tue Jun 29 01:22:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/table.c:

	Oops fix off by oner in last patch.  

Tue Jun 29 01:17:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/table.c:

	parse_html(): Cleanup bad html end setup. Just check if end pointer
	is missing instead of using local state variable.  

Tue Jun 29 00:45:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/table.c:

	parse_html(): Cleanup bad html position adding.  

Mon Jun 28 22:52:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/table.c:

	Add a warning at the top that this file does not fit to the general
	HTML parser infrastructure.  

Mon Jun 28 22:51:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Add the 'const' qualifier to the border tables, to help the compiler
	to optimize them.  

Mon Jun 28 22:49:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: tables.c, parser/table.c:

	Keep only functions with a reasonable speed_sensitivity/size factor
	inline.  

Mon Jun 28 22:39:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/rewrite/.cvsignore:

	Ugh, looks like .cvsignore got blank. Funny.  

Mon Jun 28 21:42:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	has_vline_width() macro introduced.  

Mon Jun 28 20:23:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.c, parser/table.h:

	Cleanup includes and such.  

Mon Jun 28 20:16:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: tables.c, parser/table.c, parser/table.h:

	Oops we only need one free_table().  

Mon Jun 28 20:12:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: Makefile.am, html/tables.c,
	html/parser/Makefile.am, html/parser/table.c, html/parser/table.h:

	Split out HTML table parsing. A lot of the table internals will have
	to be exposed. But it should make it more easy to split functions
	which zas would like. Unused check_cell_widths() #if 0'ed.  

Mon Jun 28 18:35:03 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	draw_frame_point(): @i,@j -> @col,@row.  

Mon Jun 28 18:31:15 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	draw_frame_vline(): @i,@j -> @col,@row.  

Mon Jun 28 18:30:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	draw_frame_hline(): @i,@j -> @col,@row.  

Mon Jun 28 18:28:03 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	display_table_frames(): @i,@j -> @col,@row.  

Mon Jun 28 18:17:25 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	new_table(): rearrange code is a more logical fashion,
	@real_(cols|rows) are related to cells, while @real_columns_count is
	related to columns.  

Mon Jun 28 15:31:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	Fix for parsing of numerical values in get_num() when the attribute
	value is the empty string. Introduced in document/html/parser.c
	(1.374 -> 1.375) 
	
	Spotted and tracked down by zas, one-liner by pasky and I get to be
	the lucky one commiting it.  

Mon Jun 28 13:29:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Revert get_{v}align() changes.  

Mon Jun 28 11:14:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/style.h, document/css/value.c, document/html/parser.c,
	document/html/renderer.c, document/html/tables.c:

	enum format_align: ALIGN_BLOCK -> ALIGN_JUSTIFY, since that's
	what'tis used for.  

Mon Jun 28 11:07:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/button.c, bfu/dialog.c, bfu/group.c, bfu/hierbox.c,
	bfu/inpfield.c, bfu/style.h, bfu/text.c, config/dialogs.c,
	cookies/cookies.c, cookies/dialogs.c, dialogs/document.c,
	dialogs/download.c, dialogs/info.c, dialogs/menu.c,
	dialogs/options.c, document/css/value.c, document/html/parser.c,
	document/html/renderer.c, document/html/tables.c,
	document/html/parser/parse.c, formhist/dialogs.c,
	formhist/formhist.c, mime/dialogs.c, protocol/user.c,
	protocol/auth/dialogs.c, sched/connection.c, sched/download.c,
	sched/session.c, sched/task.c, scripting/lua/core.c,
	terminal/tab.c, viewer/text/draw.c, viewer/text/form.c,
	viewer/text/search.c, viewer/text/textarea.c, viewer/text/view.c:

	enum format_align: AL_* -> ALIGN_* 

Mon Jun 28 10:50:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/terminal.h:

	Tidyup.  

Mon Jun 28 10:38:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/header.h:

	Fix standard header.  

Mon Jun 28 10:33:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h:

	Move VALID_PROTOCOL() macro to c-file.  

Mon Jun 28 10:07:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	get_valign(): Return alignment.  

Mon Jun 28 10:02:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	get_align(): Return alignment.  

Mon Jun 28 07:55:16 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	new_cell(), expand_cells(): @dst_col, @dst_row -> @dest_col,
	@dest_row. Idea by pasky ;).  

Mon Jun 28 02:27:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: codes.c, codes.h:

	Make http_code_to_string() static.  

Sun Jun 27 21:37:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/about.c:

	Oops fix file header.  

Sun Jun 27 21:36:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: Makefile.am, about.c, about.h, protocol.c:

	Move about_protocol_handler to separate file so it will be easier to
	add useless junk to it.  

Sun Jun 27 20:43:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, uri.c:

	about:bloat 

Sun Jun 27 19:30:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/frames.c, protocol/protocol.c,
	protocol/protocol.h:

	Introduce about: protocol backend and use about:blank to fix the
	remaining part of bug 473.  

Sun Jun 27 19:07:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/view.c:

	Fix crash when pressing the up arrow in a document with no links
	reported by zas.  

Sun Jun 27 18:36:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/frames.c:

	Partially fix bug 473. Now it ain't barfing stack traces anymore.
	But a deeper bug has to be solved and which this thing reveals.
	<frame>-tags with no 'src'-attribute is badly handled since no frame
	struct is created for them.  

Sun Jun 27 18:34:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/listbox.c, config/cmdline.c, config/options.inc,
	document/html/renderer.c, document/html/tables.c,
	document/html/parser/forms.c, document/html/parser/parse.c,
	document/plain/renderer.c, globhist/globhist.c, osdep/generic.h,
	osdep/beos/overrides.c, protocol/rewrite/.cvsignore, util/conv.c,
	viewer/text/link.c, viewer/text/search.c:

	MAXINT -> INT_MAX, MAXLONG -> LONG_MAX 

Sun Jun 27 18:34:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/: cookies.c, dialogs.c, parser.c:

	All hail automake conditionals.  

Sun Jun 27 17:19:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/osdep.c:

	At least reset the window title to a blank one, if we cannot restore
	the original one. Idea by Solar Designer.  

Sun Jun 27 17:14:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/osdep.c:

	When printing the terminal title, avoid also ISO-8859-* control
	characters and 0x7f, insuring the whole thing by iscntrl(). Patch by
	Solar Designer.  

Sun Jun 27 17:08:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/osdep.c:

	Skip invalid characters in terminal title altogether, don't just
	substitute them by a space. Also add an explanation why do we do
	this at the right place.  

Sun Jun 27 14:06:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Fix a forgotten stupidity in get_link_x_bounds(). Unbelievable.  

Sun Jun 27 13:20:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	ssl_connect(): Cleanup client_cert setup.  

Sun Jun 27 13:13:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ssl/connect.c:

	English fix.  

Sun Jun 27 13:13:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	Introduce ssl_do_close() wrapper.  

Sun Jun 27 13:10:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.c:

	isalpha() || isdigit() -> isalnum() and clarify lowalpha in the
	surrounding comment.  

Sun Jun 27 13:09:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	Introduce also ssl_do_{read,write} wrappers.  

Sun Jun 27 13:06:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Simplify the -default-keys--conditioned bind_do() call.  

Sun Jun 27 13:03:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ssl/connect.c:

	How are we not handling certificates w/ GNUTLS.  

Sun Jun 27 13:01:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ssl/connect.c:

	get_ssl_error() -> ssl_do_connect(), because that is what it does
	;-).  

Sun Jun 27 12:59:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	Group OpenSSL code in same #ifdef.  

Sun Jun 27 12:55:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/ssl/connect.c:

	A little cleanup of over-switched ssl #ifdef'ing.  

Sun Jun 27 12:29:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.h:

	Describe KBDB_DEFAULT flag.  

Sun Jun 27 09:49:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Merge add_keymap_default_keybindings() intor
	add_default_keybindings() and use default_keybindings[] table.  

Sun Jun 27 09:45:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Introduce default keybinding info table.  

Sun Jun 27 09:41:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Fix keybinding saving. It is not possible to simply check if
	KBDB_DEFAULT flag is set and keybinding is not bound to
	'none'-action since the flag is apparently used for something else.
	It is inherited when the key combo belongs to a default keybinding.
	Instead introduce a default keybinding table iterator to check if
	...  

Sun Jun 27 09:21:04 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	H_FRAME_POSITION, V_FRAME_POSITION: @tt -> @table, @xx -> @col, @yy
	-> @row.  

Sun Jun 27 09:17:53 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	display_complicated_table(): get_vline_width(table, row) is a non
	sense, fixed. This was an old typo imho.  

Sun Jun 27 09:13:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	display_complicated_table(): @row -> @row2, @i,@j -> @col,@row. A
	possible bug was detected.  

Sun Jun 27 09:06:20 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_table_heights(): @i, @j -> @col, @row.  

Sun Jun 27 09:03:30 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	check_table_widths(): @i, @j -> @col, @row.  

Sun Jun 27 08:58:15 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_widths(): label a -> again.  

Sun Jun 27 08:56:57 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_widths(): reduce indentation in switch().  

Sun Jun 27 08:49:43 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_widths(): @w -> @widths, @mx -> @max_widths.  

Sun Jun 27 08:43:05 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_widths(): @i -> @col.  

Sun Jun 27 08:36:17 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_column_widths(): @i,@j -> @col,@row.  

Sun Jun 27 08:32:44 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_vline_width(): @w -> @width.  

Sun Jun 27 08:30:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_cell_widths(): tidy up.  

Sun Jun 27 08:28:23 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	format_cell(): @column -> @col.  

Sun Jun 27 08:25:42 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	new_cell(), expand_cells(): @x -> @dst_col, @y -> @dst_row.  

Sun Jun 27 02:26:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/parser.c:

	Rewrite and comment parse_cookie_str() to make it more readable,
	compliant and tolerant.  
	
	- Allow empty or missing value token which is mentioned in the rfc.  
	
	- Allow (non-ending) spaces in value token. Fixes bug 174 (BZ change
	column).  

Sat Jun 26 23:19:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Rewrite the next_link_in_dir()'s verical movement inner loop - it's
	simpler and faster now.  

Sat Jun 26 23:18:52 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Jun 26 23:10:36 2004  Laurent Monin <zas@norz.org>:

	* NEWS:

	Add -default-keys option.  

Sat Jun 26 23:09:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Tidyup.  

Sat Jun 26 23:09:10 2004  Laurent Monin <zas@norz.org>:

	* src/config/cmdline.c:

	Improve -default-keys description.  

Sat Jun 26 23:09:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Simplify the inner loop for vertical movement in next_link_in_dir().  

Sat Jun 26 23:06:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/: link.c, link.h, search.c, view.c:

	in_view() -> link_in_view(), in_viewy() -> link_in_view_y() 

Sat Jun 26 23:03:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/: link.c, link.h, view.c:

	next_in_dir() -> next_link_in_dir() 

Sat Jun 26 23:03:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/: link.c, link.h, search.c, view.c:

	next_in_view() -> next_link_in_view() 

Sat Jun 26 22:59:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/view.c:

	Note that wrapping over page boundary in move_link_dir() will break.  

Sat Jun 26 22:57:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/view.c:

	Un-inline move_link() and move_link_dir().  

Sat Jun 26 22:57:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	next_in_dir(): Fix misnavigation in tabular design.  

Sat Jun 26 22:34:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Fix a plain stupidity in get_link_*_intersect().  

Sat Jun 26 22:05:20 2004  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	Directional links navigation.  

Sat Jun 26 22:03:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	next_in_dir(): Make sure get_link_*_intersect() never returns zero
	on success. Dear diary, pasky is again trying to attain the CIA top
	committer position.  

Sat Jun 26 22:02:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	next_in_dir(): Fix of the minute - do not enter infinite loop when
	going left from a link starting at the 0th column.  

Sat Jun 26 21:58:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	next_in_dir(): Now fix move-link-left not working at all (or working
	plain weird).  

Sat Jun 26 21:55:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	next_in_dir(): Fix infinite loop when trying to move right from the
	last link on the line.  

Sat Jun 26 21:53:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Fix down-at-the-document-bottom link wraparound.  

Sat Jun 26 21:31:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	next_in_dir(): Fix an off-by-one error in vertical movement,
	crashing when hitting the document bottom.  

Sat Jun 26 21:29:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c,
	viewer/text/link.c, viewer/text/link.h, viewer/text/view.c:

	Introduced directional links navigation - actions
	move-link-(up,down,left,right), move_link_dir() and next_in_dir().
	Requested by Matus Lovecky of Siemens.  

Sat Jun 26 21:25:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/document.h:

	Whoops, fix get_link_index().  

Sat Jun 26 20:33:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/document.h:

	Introduced get_link_index().  

Sat Jun 26 19:23:14 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_widths(): @mmax_c -> @max_cols_width.  

Sat Jun 26 19:20:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@tx_size -> @cols_size.  

Sat Jun 26 19:18:48 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@n_links -> @new_link_num.  

Sat Jun 26 19:17:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cookies/cookies.c:

	Sort cookie servers alphabetically. Makes the cookies manager
	usable.  

Sat Jun 26 19:15:39 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@i -> @col, @j -> @row, (@nl, @n_link) -> @link_num, @n_links ->
	@new_link_num.  

Sat Jun 26 19:03:09 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	INIT_X -> INIT_REAL_COLS, INIT_Y -> INIT_REAL_ROWS, @rx ->
	@real_cols, @ry -> @real_rows.  

Sat Jun 26 18:39:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/header.c:

	parse_http_header_param(): Trim ending spaces. It will help to fix
	174, parsing cookie paths from '... path=/ ;...' strings and ending
	spaces in filenames extracted from Content-Disposition.  

Sat Jun 26 16:52:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Statify get_visible_links_range().  

Sat Jun 26 15:44:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	get_visible_links_range(): Tidyup.  

Sat Jun 26 15:43:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	get_visible_links_range(): Cleanup.  

Sat Jun 26 15:43:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Split get_visible_links_range() from next_in_view().  

Sat Jun 26 14:40:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/parser.c:

	parse_cookie_str(): Use memset().  

Sat Jun 26 14:36:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/: cookies.c, parser.c, parser.h, parsetst.c:

	Pass cookie string to parse_cookie_str().  

Sat Jun 26 14:35:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/parsetst.c:

	Use stack allocated strings.  

Sat Jun 26 14:27:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/document.h:

	Describe link.points.  

Sat Jun 26 14:25:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/parser.c:

	parse_cookie_str(): s/return 0/return NULL/.  

Sat Jun 26 13:06:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/link.c:

	Describe a bit what's going on in next_in_view().  

Sat Jun 26 12:45:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/document.h:

	Describe document.lines{1,2}.  

Sat Jun 26 11:53:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/parser.c:

	Improve the stepwise debug printing.  

Sat Jun 26 10:53:49 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	parse_table(): @p -> @in_cell.  

Sat Jun 26 10:48:50 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	parse_table(): @qqq -> @cols, @rows.  

Sat Jun 26 10:45:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	struct table: @x -> @cols, @y -> @rows.  

Sat Jun 26 10:37:15 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	struct cell: @mx -> @col, @my -> @row.  

Sat Jun 26 10:33:30 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	parse_table(): @x -> @col, @y -> @row, @l_col -> @last_bgcolor.  

Sat Jun 26 10:25:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Pop up 'No links in current document' error when doing link
	typeahead with no links. Idea by Kalle Olavi Niemitalo (debian bug
	238281).  

Sat Jun 26 10:21:32 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	skip_table(): tidy up.  

Sat Jun 26 10:17:37 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	skip_table(): move @name and @namelen declarations to inner loop.  

Sat Jun 26 10:12:55 2004  Laurent Monin <zas@norz.org>:

	* src/config/cmdline.c:

	Typo fix.  

Sat Jun 26 09:52:17 2004  Laurent Monin <zas@norz.org>:

	* src/config/: cmdline.c, conf.c:

	New command line option: -default-keys, which permit to override
	user-defined keybindings and restoring default ones. Until now, it
	was not possible to restore default keybindings but by manually
	deleting entries from conf file. Please improve.  

Sat Jun 26 03:45:15 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In frame_ev_kbd_number, return FRAME_EVENT_OK instead of
	FRAME_EVENT_REFRESH after calling input_field for the 'Enter link
	number' box: delete_window will trigger the necessary redraw, and,
	anyway, the BFU is asynchronous, so input_field will return before a
	link is selected.  

Sat Jun 26 03:17:08 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In frame_ev_kbd_number, split the if-else-if block into two if
	blocks as each ends with a return statement.  

Sat Jun 26 03:14:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Add a missing blank line before a return.  

Sat Jun 26 03:13:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In frame_ev_kbd_number, return FRAME_EVENT_OK instead of
	FRAME_EVENT_REFRESH if we're to open the 'Enter link number' box but
	there are no links on the page.  

Sat Jun 26 03:10:30 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Change frame_ev_kbd_number to return an |enum frame_event_status|
	value 
	(whoops, it already has that type!) and remove that silly nested
	switch from frame_ev_kbd.  

Sat Jun 26 03:02:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Set |ses->kbdprefix.repeat_count| to 0 in frame_ev_kbd_number 
	instead of signalling to the caller to do it.  

Sat Jun 26 02:58:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In frame_ev_kbd_number, introduce the local variable doc_opts.  

Sat Jun 26 02:50:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In frame_ev_kbd_number, move the declaration and initialisation of
	|document| to the start of the routine so that both the if-block and
	the else-block can use it.  

Sat Jun 26 02:47:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Introduce frame_ev_kbd_number to reduce indentation.  

Sat Jun 26 02:26:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Remove FIXME comment for what I just fixed.  

Sat Jun 26 02:22:09 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Allow user key-bindings to over-ride 0-9 and the same in combination
	with alt, which by default are used to select links or specify
	command prefixes.  Clean-ups are forthcoming.  

Sat Jun 26 02:11:50 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	If document.browse.accesskey.priority = 1, allow user key-bindings 
	to over-ride document accesskeys, per the option's description.  

Fri Jun 25 21:03:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	move_link(): Do the session repeat_count looping and get rid of
	macro wrappers.  

Fri Jun 25 18:49:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Fixed 1.232 (smart keystrokes parsing) so that it's more readable,
	more logical and doesn't potentially look after the end of the
	string.  

Fri Jun 25 17:05:55 2004  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	read_key(): with the help of new strcasetonum(), be more tolerant
	about keystroke format, accept f1 for F1, doWn for Down, etc.  

Fri Jun 25 17:01:24 2004  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	parse_keystroke(): be more tolerant about keystroke format, shift,
	ctrl and alt prefixes are now case insensitive, and separator can be
	+ as well as -. Entry is normalized before further treatment.  

Fri Jun 25 16:16:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listbox.c:

	init_listbox(): Tidyup.  

Fri Jun 25 16:09:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/view.c:

	Compilation fix.  

Fri Jun 25 16:01:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/view.c:

	Factor out some duplicate code in the move_link_*() functions, using
	a prefactored macro instead. Will become more useful with the
	directional link navigation.  

Fri Jun 25 15:31:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Improve comment.  

Fri Jun 25 14:58:33 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	parse_html(): statement was not so useless, just fix last patch to
	prevent infinite parser loop.  

Fri Jun 25 14:32:40 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	new_cell(): @i -> @col, @j -> @row, use for() instead of while().  

Fri Jun 25 14:27:43 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	expand_cells(): @i -> @col, @j -> @row, @tx -> @last_col, @ty ->
	@last_row.  

Fri Jun 25 13:36:43 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	check_cell_widths(): @i -> @col, @j -> @row.  

Fri Jun 25 13:34:38 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_cell_widths(): @i -> @col, @j -> @row.  

Fri Jun 25 13:32:13 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_column_widths(): set @i to 0 in for().  

Fri Jun 25 13:30:34 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	parse_html(): drop useless @html assigment. Weird.  

Fri Jun 25 10:52:29 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/menu.c, cookies/cookies.c,
	document/renderer.c, document/html/frames.c,
	document/html/parser.c, document/html/renderer.c,
	document/html/tables.c, document/plain/renderer.c,
	formhist/formhist.c, intl/charsets.c, osdep/generic.h,
	osdep/osdep.c, protocol/header.c, protocol/uri.c,
	protocol/file/cgi.c, protocol/ftp/ftp.c, protocol/http/http.c,
	sched/download.c, sched/event.c, scripting/lua/core.c,
	terminal/color.c, terminal/draw.c, terminal/event.c,
	terminal/screen.c, util/base64.c, util/color.c, util/conv.c,
	util/conv.h, util/fastfind.c, util/hash.c, util/string.c,
	viewer/text/draw.c, viewer/text/form.c, viewer/text/link.c,
	viewer/text/search.c, viewer/text/textarea.c:

	Drop most register variable attribute.  

Fri Jun 25 10:18:50 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	distribute_values(): @n -> @count, @w -> @wanted, @s -> @sum.  

Fri Jun 25 10:09:20 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	dst_width() -> distribute_values().  

Fri Jun 25 10:06:08 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	dst_width(): minor optimization, introducing @delta.  

Fri Jun 25 10:04:43 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	dst_width(): @p -> @values, @lim -> @limits.  

Fri Jun 25 09:54:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: terminal/window.c, util/lists.h, viewer/text/form.c,
	bfu/menu.c, cache/cache.c, sched/connection.c, sched/history.c:

	Introduce list_has_next(list, item) macro.  A little extra cleanup
	in delete_window_ev() removing bogus check.  

Fri Jun 25 09:27:40 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	set_td_width(): @x -> @col, @f -> @force.  

Fri Jun 25 09:20:23 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@min_t -> @min_width, @max_t -> @max_width, minor fields
	reorganization in struct table.  

Fri Jun 25 09:11:33 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@max_c -> @max_cols_widths, @min_c -> @min_cols_widths.  

Fri Jun 25 09:03:13 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_column_widths(): @s -> @colspan, @ns -> @new_colspan.  

Fri Jun 25 08:25:17 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_table_heights(): @xw -> @width.  

Fri Jun 25 08:22:27 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_table_heights(): @s -> @rowspan, @ns -> @new_rowspan.  

Fri Jun 25 08:18:44 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	check_table_widths(): make @new_colspan local to the loop.  

Fri Jun 25 08:15:53 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	check_table_widths(): @s -> @colspan, @ns -> @new_colspan. Use
	different names for different purposes: @s -> @width, @ns ->
	@new_width.  

Fri Jun 25 01:49:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Don't add link numbers for non accessible links. It seems to be
	caused by the parser putting a space char after stuff like
	<img>-tags or comments wrapped in <a>-tags. Fixes bug 30.  

Fri Jun 25 01:06:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	A little stupid perhaps but quite annoying if using '_' as a name
	for autocreated options.  
	
	Always ensure that them _template_ options are before anything else
	so a lonely autocreated option (with _template_ options set to 
	invisible) will be connected with an upper corner (ascii: `-)
	instead of a rotated T (ascii: +-) when displaying it.  

Fri Jun 25 00:48:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	add_opt_sort(): Do the @bpos updating in the start of the loop so we
	correctly ignore options marked as deleted or which have NULL box
	item member. This should fix the overflow assertion failure filed as
	bug 471. Note the test case in the bug description was invalidated
	by the last patch.  

Fri Jun 25 00:25:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	Only mark built-in options as deleted or in other words if
	option->flags & OPT_ALLOC do a real deletion. Inspired by something
	Miciah and zas discussed on irc today.  

Thu Jun 24 23:49:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	render_html_document(): Only set document->title if the title string
	in non empty so the fallback to using document->uri in
	render_document() will be used.  

Thu Jun 24 18:15:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.c, config/kbdbind.c, config/kbdbind.h:

	Add ACT_MENU_SEARCH action by default bound to '/'.  Implement menu
	searching by using input lines and strcasestr(). A little bloated
	perhaps but ...  
	
	Fixes bug 24.  

Thu Jun 24 15:43:13 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@xcols -> @cols_x, @xc -> @cols_x_count, @nc -> @new_cols_x.  

Thu Jun 24 15:36:28 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Use plural for columns widths array and rows heights array:
	@columns_width -> @cols_widths, @rows_height -> @rows_heights,
	@rows_height (local variable) -> @row_height. Perhaps clearer.  

Thu Jun 24 15:32:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	menu_kbd_handler(): Cleanup default label.  

Thu Jun 24 15:29:45 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_table_heights(): make more obvious table->rows_height is an
	array.  

Thu Jun 24 15:26:07 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_column_widths(): make more obvious table->(max_c|min_c) are
	arrays.  

Thu Jun 24 15:22:00 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	check_table_widths(): make more obvious table->max_c is an array.  

Thu Jun 24 15:16:38 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	check_table_widths(): @w -> @widths.  

Thu Jun 24 15:15:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	Fix fix for bug 52 to only output chars before the first &#13; 

Thu Jun 24 15:12:21 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@m -> @max, @mi -> @max_index. An extra space in a comment was
	dropped too.  

Thu Jun 24 15:09:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	Really nasty hack to make &#13; handling in <pre>-tags
	lynx-compatible. It works around the entity handling done in the
	renderer, since checking #13 value there would require something
	along the lines of NBSP_CHAR or checking for '\n's in AL_NONE text.  
	
	Fixes bug 52 (and 387) 

Thu Jun 24 15:05:46 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Use for() instead of while() loop.  

Thu Jun 24 13:17:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Don't save default keybindings that has not been deleted. Should fix
	bug 337 although I don't know if it breaks the config style saving
	or that requires some more complex changes. If not please close the
	bug.  

Thu Jun 24 11:11:06 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Change the default value for document.browse.accesskey.priority from
	1 to 2.  Anyone who wants alt-h to select the 'Home' link on
	freshmeat.net instead of opening the Help menu can figure out how to
	change the setting.  

Thu Jun 24 11:02:28 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Refresh when an access key is used and
	document.browse.accesskey.priority = 1.  

Thu Jun 24 11:01:13 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Fix access-key code to work when document.browse.accesskey.priority
	= 2.  

Thu Jun 24 09:48:14 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Translation fix.  

Thu Jun 24 09:07:06 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_cell_width(): @w -> @width.  

Thu Jun 24 09:04:34 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	@m -> @margin, @xs -> @x, @ys -> @y.  

Thu Jun 24 08:39:21 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Jun 24 07:35:34 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Remove find_tag, which was 'moved' to src/viewer/text/draw.c.  

Thu Jun 24 06:35:32 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: main.c, config/options.c, config/options.h:

	Update option box-items to reflect the value of config.show_template 
	when they are first loaded.  

Wed Jun 23 20:33:18 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update again, so that I beat the feeble pl.po.  

Wed Jun 23 20:31:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	Fix goto-url event hook for all the cool people using scriptingless
	URI rewriting. :) 

Wed Jun 23 20:24:50 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update.  

Wed Jun 23 20:17:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/leds.c:

	We usually say 'status bar' to the user, not 'statusbar'.  

Wed Jun 23 20:16:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.c, src/scripting/lua/hooks.c,
	src/scripting/perl/hooks.c, doc/events.txt:

	Fix up the goto-url event hooks to accept NULL @ses (and described
	that case in the documentation) and clean up remnants of current_uri
	passing in decode_session_info(). Motivated by zas.  

Wed Jun 23 15:14:25 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	Tidy up.  

Wed Jun 23 15:09:25 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	Remaining global variables were moved to renderer_context struct.  

Wed Jun 23 14:54:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	struct renderer_context was introduced. @table_cache_entries,
	@last_link_to_move, @last_tag_to_move, @last_tag_for_newline,
	@link_state_info were moved to it.  

Wed Jun 23 14:51:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/forms.c:

	Introduce init_form_control().  

Wed Jun 23 14:02:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c, textarea.h:

	Revert last patch.  

Wed Jun 23 13:18:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c, textarea.h:

	textarea_edit(): Take session arg.  

Wed Jun 23 12:44:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: internal.h, parser.c, parser/forms.c:

	Remove eofff from struct html_context. It is only used by
	find_form_for_input() which already uses @i variable as eof pointer.
	@i is passed by html_*() form field handlers and is a pointer to the
	current form field's attributes and find_form_for_input() is
	supposed to search for previous <form> tag and load values into the
	struct form variable so it should be ok.  

Wed Jun 23 12:29:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	sched/action.c:

	{next,previous,zoom}-frame -> frame-{next,prev,maxmize} 

Wed Jun 23 12:13:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: internal.h, parser.c, parser/forms.c,
	parser/link.c, parser/parse.c, parser/stack.c:

	html_context.ff -> html_context.part 

Wed Jun 23 10:53:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/css.c, css/stylesheet.h, html/internal.h,
	html/parser.c, html/parser/link.c, html/parser/parse.c:

	Add css_styles to struct html_context.  

Wed Jun 23 10:33:06 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/parse.c,
	parser/stack.c:

	struct html_context: @html_stack -> @stack.  

Wed Jun 23 10:28:12 2004  Laurent Monin <zas@norz.org>:

	* src/: dialogs/menu.c, document/html/parser.c:

	Fix trailing spaces.  

Wed Jun 23 10:26:16 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/parse.c,
	parser/stack.c:

	@html_stack was added to struct html_context.  

Wed Jun 23 10:07:33 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, renderer.c, renderer.h:

	@margin was added to struct html_context.  

Wed Jun 23 08:50:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/draw.c:

	check_document_fragment(): Complete make over.  

Wed Jun 23 08:46:44 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/renderer.c:

	Fix an off-by-one error in insert_spaces_in_link that could result 
	in a leading added space being erroneously marked as a part of a
	link.  Thanks to Jonas for finding the problem and pointing out the
	fix.  

Wed Jun 23 08:41:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/draw.c:

	draw_doc(): Split out fragment handling to
	check_document_fragment().  

Wed Jun 23 08:18:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/draw.c:

	Fix title.  

Wed Jun 23 08:16:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, document/css/css.c,
	protocol/http/codes.c, sched/action.c, sched/session.c,
	viewer/text/Makefile.am, viewer/text/draw.c, viewer/text/draw.h,
	viewer/text/form.c, viewer/text/search.c, viewer/text/view.c,
	viewer/text/view.h:

	Move drawing functions.  

Wed Jun 23 08:01:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/stub.c:

	Cleanup.  

Wed Jun 23 07:50:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	move_link(): Don't set @current_link local variable to -1 but test
	against @wraparound_bound instead. So set_textarea() will again be
	called when no link is selected and we move to one in the view.  

Wed Jun 23 07:38:26 2004  Laurent Monin <zas@norz.org>:

	* src/sched/task.c:

	Compilation fix.  

Wed Jun 23 04:43:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/renderer.c:

	Fix bug 60: Spaces inserted by align="justify" get bad attributes.  
	The function insert_spaces_in_link is introduced.  

Tue Jun 22 23:24:16 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c,
	parser/parse.c:

	@special_f was added to struct html_parser.  

Tue Jun 22 23:16:29 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c,
	parser/link.c, parser/parse.c, parser/stack.c:

	@line_break_f was added to struct html_parser.  

Tue Jun 22 23:11:18 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/events.txt, src/protocol/rewrite/rewrite.c,
	src/sched/session.c, src/sched/task.c, src/sched/task.h,
	src/scripting/guile/hooks.c, src/scripting/lua/hooks.c,
	src/scripting/perl/hooks.c:

	Revert Jonas' change of passing current URI to goto-url event hooks
	instead of session. Hope that gets him more motivated for making
	some patches today... ;-) 

Tue Jun 22 23:08:32 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c,
	parser/link.c, parser/parse.c:

	@put_chars_f was added to struct html_parser.  

Tue Jun 22 22:56:51 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c,
	parser/link.c, parser/parse.c, parser/stack.c:

	@ff was added to struct html_parser.  

Tue Jun 22 22:42:25 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, renderer.c, tables.c,
	tables.h, parser/parse.c:

	@table_level was added to struct html_parser.  

Tue Jun 22 22:33:00 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c:

	@last_input_tag was added to struct html_parser.  

Tue Jun 22 22:30:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c:

	@last_form_attr was added to struct html_parser.  

Tue Jun 22 22:28:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c:

	@last_form_tag was added to struct html_parser.  

Tue Jun 22 22:24:18 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c:

	@startf was added to struct html_parser.  

Tue Jun 22 22:21:08 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c:

	@eofff was added to struct html_parser.  

Tue Jun 22 22:18:52 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/link.c:

	@has_link_lines was added to struct html_parser.  

Tue Jun 22 22:13:50 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/parse.c:

	@was_xmp was added to struct html_parser.  

Tue Jun 22 22:11:04 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/parse.c:

	@was_li was added to struct html_parser.  

Tue Jun 22 22:05:29 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c,
	parser/parse.c:

	@was_br was added to struct html_parser.  

Tue Jun 22 21:53:16 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/parse.c:

	@putsp was added to struct html_parser.  

Tue Jun 22 21:49:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/: dialogs.h, backend/default.h:

	Cleanup #includes.  

Tue Jun 22 21:47:14 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/parse.c:

	@position was added to struct html_parser.  

Tue Jun 22 21:43:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/: mime.h, backend/common.h:

	Remove unneeded #includes.  

Tue Jun 22 21:43:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/parse.c:

	@line_breax was added to struct html_parser.  

Tue Jun 22 21:39:01 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: internal.h, parser.c, parser/forms.c,
	parser/parse.c:

	struct html_context was introduced. For now, it has only one field
	@eoff, more is coming.  

Tue Jun 22 15:47:48 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c:

	get_convert_table(): move @a declaration near its use.  

Tue Jun 22 15:45:52 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c:

	get_convert_table(): skip header parsing if @ignore_server_cp is
	set.  

Tue Jun 22 15:38:58 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c:

	get_convert_table(): @b -> @ct_charset.  

Tue Jun 22 15:37:15 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c:

	get_convert_table(): @from -> @cp_index.  

Tue Jun 22 15:25:40 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c:

	get_convert_table(): reduce indentation level.  

Tue Jun 22 14:42:18 2004  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	Size of action_box_items[KM_MAX] array was put in ACTION_BOX_SIZE,
	and reduced to 128. Two assertions were added to check for
	sufficient array size.  

Tue Jun 22 14:12:50 2004  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	Compilation fix, last patch was incomplete, move-link-(up,down) ->
	move-link-(prev,next).  

Tue Jun 22 11:21:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/search.c:

	Two blank lines reintroduced.  

Tue Jun 22 10:53:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/view.c:

	move_link_{up,down}() -> move_link_{prev,next}() 

Tue Jun 22 10:52:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/info.c,
	sched/action.c, viewer/text/view.c:

	Main actions move-link-(up,down) renamed to move-link-(prev,next),
	because that's what they really do. Since the old names are quite
	recent, no compatibility aliases introduced (also since I intend to
	reuse move-link-(up,down) soon).  

Tue Jun 22 07:10:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/stub.c, osdep/beos/beos.c, protocol/uri.c:

	Missing upcase() -> toupper() stuff.  

Tue Jun 22 06:46:15 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: main.c, bfu/button.h, bfu/inpfield.c, bfu/listmenu.c,
	bookmarks/dialogs.c, bookmarks/backend/xbel.c, cache/cache.c,
	cache/dialogs.c, config/dialogs.c, cookies/dialogs.c,
	dialogs/download.c, dialogs/menu.c, dialogs/options.c,
	document/css/value.c, document/html/frames.c,
	document/html/parser.c, document/html/renderer.c,
	document/html/tables.c, document/html/parser/parse.c,
	document/html/parser/stack.c, formhist/dialogs.c,
	globhist/dialogs.c, intl/charsets.c, lowlevel/connect.c,
	lowlevel/interlink.c, lowlevel/select.c, lowlevel/signals.c,
	osdep/stub.c, osdep/beos/beos.c, osdep/beos/overrides.c,
	osdep/os2/os2.c, protocol/auth/dialogs.c, protocol/ftp/ftp.c,
	protocol/http/http.c, sched/connection.c, sched/session.c,
	sched/task.c, scripting/lua/core.c, scripting/lua/hooks.c,
	terminal/event.c, terminal/kbd.c, terminal/terminal.c,
	util/color.c, util/memory.h, viewer/text/form.c:

	Put a space after each type-cast that lacks one.  

Tue Jun 22 05:02:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/scripting/lua/core.c:

	Remove uchar typedef and substitute unsigned char.  

Tue Jun 22 04:54:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	Rename get_succesful_controls to get_successful_controls.  

Tue Jun 22 04:48:57 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.h:

	Update area_cursor's prototype, reflecting that its first parameter 
	was renamed from |frm| to |fs| in textarea.c revision 1.81.  

Tue Jun 22 00:59:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/: connect.c, connect.h:

	Unexport struct write_buffer.  

Tue Jun 22 00:50:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Revert zas' 1.419, dropping some 'useless' blank lines. I could also
	imagine a line I could drop... :E CCMAIL: zas@norz.org 

Tue Jun 22 00:36:26 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/bookmarks.txt:

	Mention that it's incomplete.  

Mon Jun 21 21:43:45 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Minor fixes: in french, a space has to be inserted before
	question/exclamation marks. This rule do not apply to english,
	german or french as used in french-speaking Switzerland.  

Mon Jun 21 21:28:33 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Minor fixes.  

Mon Jun 21 21:24:26 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jun 21 19:43:42 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	How many characters does your English alphabet have? 

Mon Jun 21 18:23:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/error.c:

	usrerror() now prefixes the messages with 'ELinks' instead of
	'elinks', because that's the real name of what we are developing,
	after all.  

Mon Jun 21 18:10:27 2004  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	.po files were resynced.  

Mon Jun 21 17:11:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	get_width(): polish the description comment.  

Mon Jun 21 17:08:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	get_width(): @limit_it -> @limited 

Mon Jun 21 16:56:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.h:

	Remove string declaration.  

Mon Jun 21 15:00:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Mon Jun 21 14:40:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Internationalize cursor position status message.  

Mon Jun 21 14:24:19 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/parse.c:

	Use int_lower_bound in get_width.  

Mon Jun 21 14:21:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Oops off by one error as usual.  

Mon Jun 21 14:21:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Show cursor coordinates when doing cursor routing and cursor is not
	over a link.  

Mon Jun 21 14:19:21 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser/parse.c:

	Use int_upper_bound in get_width.  

Mon Jun 21 14:03:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/hierbox.c:

	If removing the last item in a folder move focus to previous item in
	the folder or the root.  

Mon Jun 21 13:56:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Rearrange the blank lines slightly.  

Mon Jun 21 13:26:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	get_width(): Store allocated attribute value in @value variable
	since we modify the original @str variable. Should fix bug when
	parsing value string with space chars in it reported by Steven
	Stocker.  

Mon Jun 21 12:55:44 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Explain the meaning of draw_doc's |active| parameter.  

Mon Jun 21 12:52:50 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Correct and expand the description of move_cursor.  

Mon Jun 21 12:43:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Fix move_document_end to really go to the last line in
	cursor-routing navigation mode.  

Mon Jun 21 12:23:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	s/RFC 2391/RFC 2396/. Spotted by pasky.  

Mon Jun 21 12:20:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Comment the behaviour of move_document_start and move_document_end 
	when in cursor-routing navigation mode.  

Mon Jun 21 12:08:35 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	When the user presses move-document-start or move-document-end while
	using the cursor navigation mode (cursor routing), move the cursor,
	respectively, to the first line and column, or to the last line
	while preserving the column.  
	
	This required either re-ordering some routines or introducing a
	prototype; I chose the latter.  

Mon Jun 21 12:05:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Don't #include terminal/screen.h, it was used by initial cursor
	routing patch but no more. Spotted by Miciah.  

Mon Jun 21 12:01:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	add_opt_rec(): Split out the sorting algorithm to add_opt_sort().  

Mon Jun 21 11:08:54 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/link.c:

	In draw_current_link, do not call get_link_cursor_offset if we do
	not need its return value.  

Mon Jun 21 11:02:53 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/: kbdbind.c, kbdbind.h:

	Sort main_action, edit_action, menu_action, main_action_table, 
	edit_action_table, and menu_action_table.  

Mon Jun 21 09:59:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/link.c:

	Tidy up the comments in get_link_at_coordinates.  

Mon Jun 21 09:54:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/link.c:

	In get_link_at_coordinates, update comments to reflect that |x| and
	|y| are not necessarily the coordinates of the mouse pointer. (Part
	of this change was included in the last commit; sorry.) 

Mon Jun 21 09:50:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/link.c:

	Fix last patch.  

Mon Jun 21 09:49:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/link.c:

	In get_link_at_coordinates, modify the arguments |x| and |y| instead
	of using the temporary variables |mouse_x| and |mouse_y|.  

Mon Jun 21 09:49:19 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jun 21 09:47:40 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: link.c, link.h, view.c:

	Rename choose_mouse_link to get_link_at_coordinates as the new name
	is clearer and the routine is not mouse-specific and is now used
	with cursor navigation.  

Mon Jun 21 07:23:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Fix bug 328 and change the wording of ui.startup_goto_dialog option
	to say '... new tabs'.  

Mon Jun 21 07:03:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	redirect_cache(): Don't test existence of cache->uri. If it wasn't
	there we'd never be here.  

Mon Jun 21 00:22:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cache/cache.c:

	Microtidyup.  

Sun Jun 20 21:37:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Oops no need to declare redir_cmd() anymore.  

Sun Jun 20 21:36:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Mark command line aliases with OPT_HIDDEN flags and ignore them when
	printing full help.  

Sun Jun 20 21:19:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/dialog.c, bfu/hotkey.c, cookies/cookies.c,
	document/html/parser.c, document/html/tables.c,
	document/html/parser/parse.c, document/html/parser/stack.c,
	protocol/header.c, protocol/http/http.c, terminal/event.c,
	util/conv.c, util/conv.h, util/fastfind.c, util/string.c,
	viewer/text/link.c:

	upcase() -> toupper().  

Sun Jun 20 21:08:56 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	parse_table(): replace a goto/label by a for() loop.  

Sun Jun 20 21:02:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/info.c,
	dialogs/menu.c, sched/action.c, viewer/text/link.c,
	viewer/text/view.c:

	
	{download,download-image,enter,enter-reload,resume-download,pass-uri} -> link-{download,download-image,follow,follow-reload,download-resume,external-command}. No alias for pass-uri added since it hasn't been released yet.

Sun Jun 20 20:11:23 2004  Petr Baudis <pasky@ucw.cz>:

	* doc/: man/man5/elinks.conf.5, tools/help2doc:

	Fixed trailing comma in the SEE ALSO section, by Solar Designer.  

Sun Jun 20 19:22:16 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS:

	Entry for Solar Designer.  

Sun Jun 20 18:26:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/auth/auth.h:

	Fix HTTP auth to work if either the username or the password is
	empty. Reported by yanek.  

Sun Jun 20 18:22:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ssl/: connect.c, ssl.c:

	Merged Debian's GNUTLS tweaks to make it work with newer versions.
	They should know what are they doing, being probably the only GNUTLS
	users in the world ;-).  

Sun Jun 20 18:08:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Tidyup witek's 1.131 (support for saving deleted options).  
	CCMAIL:witekfl@poczta.gazeta.pl 

Sun Jun 20 18:00:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/info.c,
	dialogs/menu.c, sched/action.c:

	{back,unback} -> history-move-{back,forward} 

Sun Jun 20 17:23:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Fix core dump for 'elinks -stdin' and double-printing of the
	warning.  

Sun Jun 20 16:15:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Fixed -stdin emulation, spotted by Jonas' gcc.  

Sun Jun 20 16:12:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Rename {page_up, page_down, home, x_end} -> {move_page_up,
	move_page_down, move_document_start, move_document_end}.  

Sun Jun 20 16:08:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/info.c,
	sched/action.c, viewer/text/view.c:

	Introduce keybinding action aliases. {up,down} ->
	move-link-{up,down}, home/end -> move-document-{start,end},
	page-{up,down} -> move-page-{up,down}.  

Sun Jun 20 15:57:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/text.c:

	kbd_text(): Use menu mapping.  

Sun Jun 20 15:49:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/uri.c:

	Revert 1.81 - lousy workaround for buggy wget -r which prevented
	decoding of %7E (~).  

Sun Jun 20 15:44:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Reintroduce -stdin as a compatibility measure. Beeps and annoys the
	user so that she removes it, but doesn't trigger fatal error.  

Sun Jun 20 15:28:23 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/osdep.c:

	get_input_handle() returns the same as get_ctl_handle() 

Sun Jun 20 15:25:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: main.c, viewer/dump/dump.c, viewer/dump/dump.h:

	dump_pre_start() -> dump_next() 

Sun Jun 20 15:21:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/file/cgi.c:

	Complement witekfl's 1.49 (first parameter is just basename) by
	chdir()ing to the script's directory first. This makes that
	behaviour correct and mirrors w3m's behaviour.  

Sun Jun 20 15:10:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c:

	Remove unused ACT_MAIN_{LEFT,RIGHT}.  

Sun Jun 20 15:08:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	Remove unused ACT_MAIN_DELETE.  

Sun Jun 20 13:57:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	Partially revert last patch and allow readonly buttons to be
	'entered'. Check return value of find_form_state().  

Sun Jun 20 13:30:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	enter(): Even buttons can be disabled so we have to check if form
	field is readonly. Return FRAME_EVENT_OK if it is readonly since
	there is no need to redraw anything.  

Sun Jun 20 13:29:39 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Don't change navigation mode when the user presses home or end.  

Sun Jun 20 13:13:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: view.c, view.h:

	Make down() static.  

Sun Jun 20 13:11:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, link.c:

	Do all the submit handling in field_op() and don't fall back to
	enter(). ACT_EDIT_ENTER and ACT_MAIN_ENTER might not be bound to the
	same thing, so this is more correct. However we should probably add
	ACT_EDIT_ENTER_RELOAD to keep the feature set complete.  

Sun Jun 20 12:43:23 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Abandon rep_ev(), page_up()/page_down()/up()/down() now handle
	repeat_count.  

Sun Jun 20 12:37:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Don't use rep_ev() for mouse scrolling. They already move using
	value of option.  

Sun Jun 20 12:35:35 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	rep_ev() is a non sense for home/end actions. Dropped.  

Sun Jun 20 12:22:16 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Do not use rep_ev() for scroll_right()/scroll_left(). Spotted by
	Miciah.  

Sun Jun 20 11:58:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Don't change navigation mode when scrolling. Idea by Miciah.  

Sun Jun 20 11:27:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	set_textarea(): Decrease indentation.  

Sun Jun 20 11:24:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	move_link(): Fix wraparound of cursor position in textareas when it
	is either first or last link.  

Sun Jun 20 11:22:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Introduce move_link(). Common backend for up() and down().  

Sun Jun 20 10:24:29 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	get_width(): free @str on error, and improve parsing by
	re-introducing @end, now parsing string like "  12a45 %" will fail
	instead of using 12 as width.  

Sun Jun 20 10:10:04 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	Merge parse_width() and get_width().  

Sun Jun 20 10:06:16 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	get_column_width(): decrease indentation level.  

Sun Jun 20 09:59:00 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	parse_width(): drop @end, we dont use it.  

Sun Jun 20 09:55:14 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	parse_width(): fix comment and undefine macro as it should.  

Sun Jun 20 09:51:05 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	get_width(), parse_width(): @trunc -> @limit_it, perhaps more
	explicit.  

Sun Jun 20 09:44:19 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	parse_width(): @value -> @width, improve comments.  

Sun Jun 20 09:31:52 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	parse_width(): only calculate @maxwidth if @trunc is set, introduce
	WIDTH_PIXELS2CHARS(), make function inlined since used by only one
	caller.  

Sun Jun 20 09:08:23 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	parse_width(), get_width(): variables were renamed.  

Sat Jun 19 21:27:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	move_cursor(): Only bound x and y when they are not inside the
	current view.  

Sat Jun 19 21:21:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	move_cursor(): Fix off by one errors in the scrolling mechanism.  

Sat Jun 19 18:41:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	Add cursor routing. Altho' it is nothing big patchwise it is
	hopefully an improvement of usability.  

Sat Jun 19 18:26:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	move_cursor*(): Always use tab position for cursor routing. Much
	simpler. Minor tidyup that pasky will like ;-).  

Sat Jun 19 18:16:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	draw_current_link(): Fix issue with mode less text-input link
	drawing when doing cursor routing.  

Sat Jun 19 17:58:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/session.h,
	viewer/text/link.c, viewer/text/view.c, viewer/text/vs.c:

	Support for cursor routing. It should be fairly complete already
	altho' we should ofcourse get some feedback from an expert. It is
	based on patch by Witold Filipczyk, available at [1], which
	introduces cursor moving actions.  
	
	The session struct maintains whether we are doing cursor routing so
	setting the terminal cursor and window pointer is done correctly.
	Also, current link is only updated by check_vs() if navigating
	link-wise.  
	
	When in cursor routing mode, the cursor position is maintained in
	the session tab and restored from it after things like doing the
	link menu. All cursor updating is done in new move_cursor() function
	which updates current link when cursor is over one and scrolls when
	moving outside the view.  
	
	[1]
	
	http://archive.linuxfromscratch.org/mail-archives/elinks-dev/2003-November/000596.html

Sat Jun 19 17:11:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	draw_doc(): Since it now gets passed the current session use
	ses->tab when updating the window position.  

Sat Jun 19 16:12:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Sanitize '//' joined URIS. It apparently has been
	broken for some time. Even 0.9.1 is affected.  

Sat Jun 19 15:45:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, link.h, view.c:

	choose_mouse_link(): No need to pass term_event just pass x and y
	values.  

Sat Jun 19 13:57:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.h:

	Move enum insert_mode out of struct session.  

Sat Jun 19 13:42:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: textarea.c, textarea.h:

	Real menu functions don't return anything so make
	menu_textarea_edit() return void.  

Sat Jun 19 13:21:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_edit(): Only set static state vars on 'startup' (op == 0).  

Sat Jun 19 13:10:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_edit(): Split out saving of the textarea value to file.
	read_textarea_file() -> load_textarea_file() to better pair it with
	new function and also possibly indicate that file is destroyed.  

Sat Jun 19 13:02:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_edit(): At start up checks no need to goto free_and_return.  
	
	Annotation by Miciah, 2004-06-21: This also fixes a bug whereby a
	slave session could inhibit the master session from loading the
	modified file, thereby leaving intact the original contents in the
	master session's text area, if one tried to edit a text area in the
	slave session with an external editor (which would result in an
	error box) while one was already editing the text area of the master
	session with an external editor: |fs| is no longer set to NULL when
	that error box is displayed.  

Sat Jun 19 12:58:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: terminal/terminal.c, viewer/text/form.c,
	viewer/text/textarea.c, viewer/text/textarea.h:

	textarea_edit(): No need to pass form control.  

Sat Jun 19 12:46:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_edit(): Split out reading of the modified file.  

Sat Jun 19 12:27:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	Add comments.  

Sat Jun 19 12:14:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Rearrange members of itrm struct and add comments.  

Sat Jun 19 12:04:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Add altscreen boolean member to itrm instead of flags.  

Sat Jun 19 12:00:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	itrm.tm -> itrm.timer 

Sat Jun 19 08:39:38 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	Fix a bug introduced in the last revision: Do not delete the
	preceding line if the cursor is positioned immediately after a
	new-line character; only delete that new-line character.  

Sat Jun 19 07:00:18 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	Use the -= operator in textarea_op_bob.  

Sat Jun 19 06:59:36 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	In textarea_op_bob, set an upper bound on |fs->state|, the actual
	cursor position, rather than |state|, the cached cursor position. 
	This fixes a bug introduced in revision 1.109 whereby
	beginning-of-buffer would not go all the way to the first line when
	the cursor started on a longer line.  

Sat Jun 19 00:13:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Reverted last chunk of zas' 1.33 tidyup, I find the original version
	more tidy.  

Fri Jun 18 23:53:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/link.c:

	Move put_link_line() to a more appropriate place.  

Fri Jun 18 23:26:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Trivial microtidyup.  

Fri Jun 18 21:24:33 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	Tidy up.  

Fri Jun 18 21:00:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	draw_textarea(): Use temporary variable to get rid of weird
	wrapping.  

Fri Jun 18 20:56:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	draw_textarea(): No need to test fs->value. format_text() already
	asserts it.  

Fri Jun 18 20:53:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	draw_textarea(): Decrease indentation.  

Fri Jun 18 20:53:04 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Ooops, forgot to use @nlen, fixed.  

Fri Jun 18 20:35:38 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	html_li(): code simplification and tidy up.  

Fri Jun 18 20:22:05 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Minor optimizatio: cache strlen(n).  

Fri Jun 18 20:19:28 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Really fix <li value=12345><li> bug.  

Fri Jun 18 20:11:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Fixed <li value=12345><li>, the next <li> didn't have number 12346.
	Reported by zas.  

Fri Jun 18 19:16:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	Fix last patch. Stupid brain.  

Fri Jun 18 19:05:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	Fix format_text() to preallocate the ending entries since it is
	possible to bypass the loop obviously.  

Fri Jun 18 18:48:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix translation of 1.2.3.4:5 so IP address part won't be interpreted
	as the protocol name. Spotted by pasky.  

Fri Jun 18 16:38:35 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Use isspace(), ASCII_LF, ASCII_CR where applicable.  

Fri Jun 18 16:22:51 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Restore old scroll right behavior, it was a feature, not a bug.
	Sorry, pasky ;).  

Fri Jun 18 16:02:55 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Drop allocation of memory for parsed line, just use si->text one.
	Get rid off @line_end2.  

Fri Jun 18 15:05:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Add check of memrchr().  

Fri Jun 18 15:04:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/stub.c:

	elinks_memrchr(): Fix off by one thing .. I hope.  

Fri Jun 18 15:02:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	format_text(): Use memrchr() for handling wrapping.  

Fri Jun 18 15:00:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op(): Use memrchr() for kill-to-bol handling.  

Fri Jun 18 14:59:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: stub.c, stub.h:

	Introduce memrchr() stub.  

Fri Jun 18 14:27:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	format_text(): Wrap the wrap handling in a not so deep way.  

Fri Jun 18 14:20:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_op_end(): Cleanup wrap handling.  

Fri Jun 18 14:16:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	Improve comment situation.  

Fri Jun 18 14:00:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/color.c:

	Fix invertion when ensuring contrast for 256 color mode.  

Fri Jun 18 13:55:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser/forms.c, viewer/text/form.h,
	viewer/text/textarea.c:

	Introduce enum form_wrap used for form_control->wrap member.  

Fri Jun 18 13:48:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	Make format_text() take an extra parameter controling whether to
	modify the text value passed to it.  

Fri Jun 18 13:40:24 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Fix for bug 346: Detection of filenames/directories was greatly
	improved, now it should work in most cases (ie with files with more
	than one space in name), though stuff involved is complex and
	behavior is still not perfect. The definitive solution is to use
	libsmbclient instead of smbclient command. Please test a lot and
	report issues.  

Fri Jun 18 13:33:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	format_text(): Preallocate the two last entries in the line info
	table and get rid of goto.  

Fri Jun 18 13:17:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	Make all textarea ops cache old value of fs->state and modify
	fs->state directly so that refreshing is only done when needed.  

Fri Jun 18 13:09:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	y -> current. Idea by Miciah.  

Fri Jun 18 13:04:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_op_eob(): Use get_textarea_line_number() to seek the index
	of the last.  

Fri Jun 18 12:38:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_op_eob(): Remove need for goto.  

Fri Jun 18 12:34:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_op_end(): Remove need for goto.  

Fri Jun 18 11:27:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	Wrap a long line from revision 1.93 in draw_textarea.  

Fri Jun 18 11:11:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	Remove an extra newline.  

Fri Jun 18 11:10:08 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	Introduce get_textarea_line_number, which takes a |struct line_info|
	array and a cursor position and returns the index of the line where
	the cursor is located. Idea and code by Jonas.  

Fri Jun 18 09:54:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	In area_cursor, rename |int q| to |int ret|.  

Fri Jun 18 09:46:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: textarea.c, textarea.h, view.c:

	Remove the |struct session *ses| parameter from set_textarea: It has
	been unused since revision 1.86.  

Fri Jun 18 09:33:50 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: form.c, form.h, textarea.c, textarea.h, view.c:

	Drop the |rep| parameter from field_op and textarea_op_*: Only
	textarea_op_up and textarea_op_down used the argument, and the
	effect of calling either those routines with a non-zero value for
	|rep| can be had by calling textarea_op_bob or textarea_op_eob.  

Fri Jun 18 09:30:27 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Tidy up and improved comments.  

Fri Jun 18 09:15:58 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.h:

	Update the prototypes for textarea_op_*: the parameter |struct
	form_control *frm| is now named |fc|.  

Fri Jun 18 09:13:41 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Define SMBCLIENT to handle executable name.  

Fri Jun 18 09:10:19 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	Use int_upper_bound in textarea_op_bob and textarea_op_eob.  

Fri Jun 18 08:40:35 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	In format_text, change |begin| from a pointer to an index variable.  

Fri Jun 18 08:38:02 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	In format_text, use an index variable instead of modifying |text|.  

Fri Jun 18 08:25:20 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	In format_text's inner loop, make |s| an index instead of a pointer.  

Fri Jun 18 08:23:44 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	Reformat the inner loop in format_text.  

Fri Jun 18 06:29:26 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	Change the |start| and |end| members of |struct line_info| from
	character pointers to integers.  

Fri Jun 18 06:23:52 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	In textarea_op_bob, when calculating the new cursor position by
	subtracting the start of the current line from |fs->state| (this is
	to keep the cursor on the same column while repositioning it to the
	first line), include |fs->state| in the calculation.  
	
	This fixes a bug introduced in revision 1.89 whereby
	beginning-of-buffer did not always go to the beginning of the
	buffer.  

Fri Jun 18 04:52:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/color.c:

	Use whole palette for background colors in 256 mode. It doesn't have
	same restrictions as 16 and it makes some of the backgrounds in the
	menus visible like the right menu on fm.  

Fri Jun 18 04:46:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Rename enum typeahead_code values to better match what they are
	mapped to.  

Thu Jun 17 23:53:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	draw_form_entry(): Cleanup.  

Thu Jun 17 23:51:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	draw_form_entry(): Decrease indentation.  

Thu Jun 17 23:41:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op(): In the switch's default label don.t refresh view if
	field is readonly. Use insert_in_string() to do all the dirty work
	of memory reallocation.  

Thu Jun 17 22:42:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_op_bob(): If state is the same don.t refresh.  

Thu Jun 17 22:41:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_op_home(): Use state variable to get rid of goto. If state
	is the same don.t refresh.  

Thu Jun 17 22:36:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_op_bob(): Use state variable to remove need for gotos.  

Thu Jun 17 22:24:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	textarea_op_enter(): Cleanup and use insert_in_string(). Even though
	it is a bit slower it remove a lot of code duplication.  

Thu Jun 17 21:25:50 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Move @vs initialization up, and do not check for NULL @vs twice.  

Thu Jun 17 19:16:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op(): Missing usage of form_field_is_readonly() even tho' we
	never get there if it is disabled. Spotted by Miciah.  

Thu Jun 17 13:10:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	download_link(): Check where_img before getting image download URI.
	Related to viewer/text/view.c:1.347->1.348 and spotted by Miciah.  

Thu Jun 17 11:27:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/setup.h:

	Fix last patch: s/%s/%f/.  

Thu Jun 17 11:24:04 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/setup.h:

	Add '-i "%s"' to DEFAULT_AC_OPT_MAILTO so that Mutt gets the form
	fields when one submits a form with action="mailto:foo@bar.net".  

Thu Jun 17 10:02:20 2004  Laurent Monin <zas@norz.org>:

	* src/: main.c, bfu/hierbox.c, bfu/inphist.c,
	bookmarks/bookmarks.c, config/conf.c, config/options.h,
	cookies/cookies.c, dialogs/exmode.c, dialogs/menu.c,
	dialogs/options.c, formhist/formhist.c, globhist/globhist.c,
	lowlevel/connect.c, lowlevel/home.c, lowlevel/interlink.c,
	mime/backend/mailcap.c, mime/backend/mimetypes.c,
	protocol/file/file.c, sched/action.c, sched/download.c,
	sched/session.c, scripting/lua/core.c, terminal/kbd.c,
	terminal/terminal.c, util/secsave.c, viewer/dump/dump.c,
	viewer/text/form.c, viewer/text/link.c, viewer/text/textarea.c:

	Introduce and use get_cmd_opt_*() macros instead of
	get_opt_*_tree(cmdline_options, ...).  

Thu Jun 17 09:01:20 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/dump/dump.c:

	Tidy up.  

Thu Jun 17 08:41:37 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	horizontal_scroll(): code simplification.  

Thu Jun 17 08:38:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Drop |nb_tab| from send_event and pass -1 in its place to
	switch_to_tab, which will compute the value itself.  

Thu Jun 17 08:36:32 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Fix scroll down + page down behavior.  

Thu Jun 17 07:06:11 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/dialogs.c:

	In push_kbdbind_add_button, we were assigning the selected action's
	key-map to the hop structure's action member. This prevented one
	from adding new bindings. Remove this assignment, which appeared in
	revision 1.167, entitled 'make' (really descriptive, Jonas!).  

Thu Jun 17 06:35:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: textarea.c, textarea.h, view.c:

	In set_textarea, call textarea_op_eob or textarea_op_bob directly
	instead of calling field_op with a generated up- or down-key-press
	event. The necessary setup which must be copied from field_op adds
	several lines, but this change eliminates a hack and causes a text
	area to be scrolled properly to the top or bottom when one selects
	it with the down or up actions, even when the up and down arrow-keys
	are not bound to the up and down actions in the edit map.  

Thu Jun 17 06:02:02 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	Do not refresh in set_textarea: set_textarea is only called by
	either up() or down(), which are only called by frame_ev_kbd(),
	which, when it calls up() or down(), returns FRAME_EVENT_REFRESH,
	which is passed up to frame_ev_kbd's only caller, frame_ev, which
	passes the value to its only caller, send_to_frame, which performs a
	refresh.  

Thu Jun 17 05:22:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/textarea.c:

	In textarea_op_up and textarea_op_down, the value of |fs->state| is
	modified during the loop, so assign |position = fs->value +
	fs->state| within the loop, not before.  Move the declaration of
	|position| within the loop, too, now that it is not touched outside
	the loop.  
	
	This fixes a bug whereby ELinks would freeze when one selected a
	text area.  
	
	The problem appeared with the introduction of the |position|
	variable in textarea.c 1.72 (textarea_op_down) and 1.74
	(textarea_op_up).  

Thu Jun 17 04:07:43 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	Correct an error in the next-to-last patch to this file, 'Use @fc
	instead of @frm for form control.', which substituted |fc| instead
	of |fc2| for |frm| in get_succesful_controls.  

Thu Jun 17 00:35:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser/forms.c, viewer/text/form.c,
	viewer/text/form.h, viewer/text/link.c, viewer/text/textarea.c:

	Introduce enum form_mode and replace form_control.ro with
	form_control.mode member. Macro named form_field_is_readonly() used
	to replace tests of ro. Later we can make the testing more
	finegrained if needed. Two small cleanups: remove check of not ro
	before textarea_edit() call since it is already checked in the first
	if test, in textarea_op_enter() return FRAME_EVENT_OK if area is
	readonly -- no need to refresh the view.  

Thu Jun 17 00:12:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/forms.c:

	get_form_mode(): Introduced to initialize form_control->ro value.  

Wed Jun 16 21:47:13 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Jun 16 21:39:56 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Use @fc instead of @frm for form control.  

Wed Jun 16 21:33:51 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: form.c, form.h, textarea.c:

	struct submitted_value @frm field was renamed @form_control.  

Wed Jun 16 21:30:07 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	Use @fc instead of @frm for form control.  

Wed Jun 16 21:25:45 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	area_cursor(): use int_bounds().  

Wed Jun 16 21:21:55 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	area_cursor(): cleanup and optimization.  

Wed Jun 16 21:16:19 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	@form is a misleading name for a form control, just use @fc.  

Wed Jun 16 21:13:26 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	@l, @l_ -> @link, @link_.  

Wed Jun 16 21:11:29 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	Label x -> free_and_return.  

Wed Jun 16 21:07:47 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	textarea_op_home(): code cleanup and optimization.  

Wed Jun 16 20:59:27 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	textarea_op_up(): code cleanup and optimization.  

Wed Jun 16 20:55:24 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	textarea_op_end(): reduce indentation level.  

Wed Jun 16 20:53:32 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	textarea_op_down(): code cleanup and optimization.  

Wed Jun 16 20:49:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Redo the read only stuff.  

Wed Jun 16 20:37:21 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	textarea_op_end(): code cleanup and optimization.  

Wed Jun 16 20:16:06 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	Add some hints about bob/eob, and affects @position after
	assertions.  

Wed Jun 16 20:08:47 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	textarea_op_enter(): code cleanup.  

Wed Jun 16 19:59:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/textarea.c:

	Fix textarea up and down handler so they ignore the actions when on
	the first and last line respectively.  

Wed Jun 16 19:42:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: formhist/formhist.c, viewer/text/form.c,
	viewer/text/form.h:

	s/new_/init_/ and s/free_/done_/ the new submitted value functions.  

Wed Jun 16 19:34:00 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	@b -> @begin, @sk -> @skip.  

Wed Jun 16 19:30:41 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	@en -> @end, @st -> @start, @ln -> @line, @lnn -> @line_number, @lnx
	-> @linex.  

Wed Jun 16 19:19:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	get_current_link_info(): Move form handling up front.  

Wed Jun 16 18:50:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Fix indentation in last patch. Improve information given for read
	only fields.  

Wed Jun 16 18:44:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Split out code to add_form_attr_to_string() used
	for adding name and default value info.  

Wed Jun 16 18:33:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	... and finally after 2 and a freaking half hour he picks up his
	patchooka .. aims .. with a roaring speed it moves towards the
	target .. hey it looks like a winner ... he actually got it right
	this time .. insert mode highlights in the g, fm and bug sector ..
	'twill be a most joyful experience.  

Wed Jun 16 17:21:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c, textarea.h:

	Make the rest of the textarea_op_*() functions return
	frame_event_status. A lot of 0 return values for assertion and
	allocation failure was changed to *_OK and 1 values is also *_OK.  

Wed Jun 16 17:11:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c, textarea.h:

	textarea_op_eob(): Return frame_event_status. Tiny enforcement by
	the space police.  

Wed Jun 16 17:07:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c, textarea.h:

	textarea_op_enter(): Return frame_event_status.  

Wed Jun 16 16:56:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	It don.t make sense to return submit label for FC_HIDDEN in
	get_form_label() so return NULL. Idea by zas. Make ending switch in
	get_form_info() complete with labels for all values of enum
	form_type.  

Wed Jun 16 15:41:31 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Use @fc to handle link->form_control.  

Wed Jun 16 15:32:42 2004  Laurent Monin <zas@norz.org>:

	* src/formhist/formhist.c:

	Drop free_form_in_list() and use free_submitted_value_list()
	instead.  

Wed Jun 16 15:28:42 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: form.c, form.h:

	free_succesful_controls() was renamed free_submitted_value_list()
	and we now export it.  

Wed Jun 16 15:26:14 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	free_succesful_controls(): use free_submitted_value().  

Wed Jun 16 15:20:15 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	add_submitted_value_to_list(): use new_submitted_value() and get rid
	of label fi_rep.  

Wed Jun 16 14:51:44 2004  Laurent Monin <zas@norz.org>:

	* src/: formhist/formhist.c, viewer/text/form.c,
	viewer/text/form.h:

	new_submitted_value(): let it be a complete constructor.  

Wed Jun 16 14:47:44 2004  Laurent Monin <zas@norz.org>:

	* src/: formhist/formhist.c, viewer/text/form.c,
	viewer/text/form.h:

	Move new_submitted_value() and free_submitted_value() to
	viewer/text/form.h. Later it will move to document/form/.  

Wed Jun 16 14:43:19 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.h:

	struct submitted_value int @type -> enum form_type.  

Wed Jun 16 14:24:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	new_link(): Remove a bit of the noise.  

Wed Jun 16 13:53:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: terminal/color.c, terminal/color.h, viewer/text/link.c:

	A best effort attempt at fixing text-input form-field insert mode
	highlighting by introducing COLOR_ENSURE_INVERTED_CONTRAST flag and
	applying it when inverting text-input links. This fixes the issue
	for me with -no-home. When using document colors it might still be
	possible for some color combos to get it wrong.  

Wed Jun 16 10:34:00 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: link.c, link.h:

	enter(): @a -> @do_reload.  

Wed Jun 16 10:23:39 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: view.c, view.h:

	Make clear (using xxxx) that parameter is unused.  

Wed Jun 16 10:18:03 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Do not inline rep_ev(), and make try_jump_to_link_number() static.  

Wed Jun 16 09:51:47 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: form.h, link.h:

	Remove sched/action.h inclusions.  

Wed Jun 16 09:43:40 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/action.h, viewer/text/view.h:

	Move enum frame_event_status from sched/action.h to
	viewer/text/view.h.  

Wed Jun 16 09:20:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/leds.c:

	Revert my next-to-last patch to leds.c because I'm stupid. Thanks,
	zas, for noticing.  

Wed Jun 16 09:15:57 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: form.c, textarea.c, view.c:

	Before I changed its return value from an integer to enum
	frame_event_status, field_op returned either 0 (event not handled)
	or 1 (event handled, redraw).  Now that field_op uses the enum, it
	can return any of FRAME_EVENT_IGNORED, FRAME_EVENT_REFRESH, and
	FRAME_EVENT_OK. However, when I changed the return value to the
	enum, I did a straight conversion from return values of 0 to 
	FRAME_EVENT_IGNORED and return values of 1 to FRAME_EVENT_REFRESH.
	Now I'll improve on that...  
	
	Modify frame_ev and set_textarea to work properly when field_op
	returns FRAME_EVENT_OK.  
	
	Change field_op to return FRAME_EVENT_OK instead of
	FRAME_EVENT_IGNORED when the event is handled (where 'handled' means
	'should not be handled elsewhere') but a redraw is not necessary: 
	
	 - when an assertion fails; 
	 - when one of the textarea_op_* functions fails; or 
	 - when malloc fails.  
	
	Prevent unnecessary redraws: 
	
	 - when one tries to backspace, to delete, to kill-to-bol, or to
	   kill-to-eol when there is nothing to delete; 
	 - when one tries to enter text into a text field that has reached 
	   its maximum length; or 
	 - when one copies a text-field's contents to clipboard.  
	
	Return FRAME_EVENT_IGNORED, allowing key-presses to fall back to the
	main key-map, when one tries to edit text in a read-only text-field.  
	
	Two bugs have been fixed: 
	
	 - When one presses a key while editing a text field that has reached
	   its maximum capacity, return FRAME_EVENT_OK instead of
	   FRAME_EVENT_IGNORED, so that the key press does not fall back to the
	   main map (imagine if you entered a given field's maximum of forty
	   characters and then proceeded to type in a sentence beginning with
	   'Q'). This bug appeared with src/viewer/text/form.c:1.156->1.157,
	   'field_op_do(): Cleanup the default label.' 
	
	 - The handler for the redraw action would return
	   FRAME_EVENT_IGNORED, even tho it handles the redraw, leading to an
	   extra redraw. Note that handle_interlink_event grabs Ctrl-L before
	   it reaches field_op, so this was unlikely to happen in practice.
	   This bug appeared with the introduction of ACT_REDRAW,
	   src/viewer/text/form.c:1.66->1.67, 'Introduce ACT_REDRAW used for
	redrawing the terminal. Bound to ctrl-(l|L) in all mappings.' 

Wed Jun 16 08:12:23 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Jun 16 07:26:23 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In frame_ev, do not initialise |status| as it is always set later
	before it is used.  

Wed Jun 16 07:15:50 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/: form.c, form.h:

	Change the return value type of field_op to enum frame_event_status.  

Wed Jun 16 06:34:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	In field_op, return 0, not 1, when the key press is not handled, so
	that the key press can be handled elsewhere (e.g., by the code for
	the main key-map). This corrects a bug introduced in
	src/viewer/text/form.c:1.156->1.157, 'field_op_do(): Cleanup the
	default label.' 

Wed Jun 16 06:06:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	s/press %s to enter insert mode/press %s to edit/ 

Wed Jun 16 06:02:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/leds.c:

	Update the comment listing the allocated LEDs: change the SSL
	indicator's listed value from 1 to 0 (as 0 is the base index) and
	list the insert-mode indicator, which is allocated LED 1.  

Wed Jun 16 05:58:56 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/leds.c:

	In register_led, fail not only when |number >= LEDS_COUNT| but also
	when |number > LEDS_COUNT|. LEDs are indexed from 0.  

Wed Jun 16 05:49:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Tweak the description for document.browse.forms.insert_mode.  

Wed Jun 16 05:23:16 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.c:

	Split the call to update_status from change_hook_html into a new
	hook, change_hook_insert_mode. This might not save more than a few
	cycles, but it is clearer and eliminates the need for a comment.  

Wed Jun 16 05:02:30 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.h:

	Trivial correction to a comment on get_opt_type_tree().  

Wed Jun 16 04:56:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/dialogs.c:

	In check_valid_option, slightly simplify the loop that calls the
	change-hooks for the changed option and its ancestors.  

Wed Jun 16 04:11:42 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/form.c:

	In field_op, |ses| was asserted after it was dereferenced to get the
	terminal, which was saved to |term|. As |term| was subsequently used
	only twice, substitute |ses->tab->term|.  

Wed Jun 16 03:07:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Remove a stale comment.  

Tue Jun 15 22:56:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	frame_ev_kbd(): Cleanup and decrease indentation in goto link dialog
	setup.  

Tue Jun 15 22:54:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, view.c:

	frame_ev_kbd(): Cleanup goto link dialog setup.  

Tue Jun 15 22:18:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Split out label setup switch to get_form_label().  

Tue Jun 15 22:13:07 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Group cursor navigation and scrolling actions.  

Tue Jun 15 22:12:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_into(): Now the switch noodling is complete also for
	LINK_BUTTON handling.  

Tue Jun 15 22:08:00 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Indentation fix and code aeration.  

Tue Jun 15 22:04:00 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	try_jump_to_link_number() was introduced, it is used to make one
	action switch only in frame_ev_kbd().  

Tue Jun 15 21:58:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_into(): Cleanup.  

Tue Jun 15 21:48:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_into(): Make LINK_BUTTON handling part of the switch
	noodle.  

Tue Jun 15 21:37:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Cleanup use of _(). It is inlined so better just
	use it once. 300b saved ;) 

Tue Jun 15 21:22:21 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	Fix off by one in comparaisons.  

Tue Jun 15 21:05:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Make itrm->blocked a boolean member.  

Tue Jun 15 20:36:00 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	A comment was added about kbdprefix.repeat_count.  

Tue Jun 15 20:03:35 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/session.h, viewer/text/view.c:

	Drop kbdprefix.rep, and rename kbdprefix.rep_num to
	kbdprefix.repeat_count, code was simplified a lot, and cancelling
	repeat count is now possible by pressing 0 six times or less.  

Tue Jun 15 19:28:02 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Explode long frame_ev() among new frame_ev_kbd() and
	frame_ev_mouse().  

Tue Jun 15 16:49:14 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.inc:

	A scrolling step of 0 doesnt make much sense, let the lower limit be
	1.  

Tue Jun 15 16:44:16 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	vertical_scroll(),horizontal_scroll(): code cleanup, honour right
	margin limit for horizontal scrolling.  

Tue Jun 15 12:14:33 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Drop useless test.  

Tue Jun 15 09:15:58 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Jun 15 02:18:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	setup_first_session(): Oops. setup_session() stuff removed.  

Tue Jun 15 02:17:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	Add dumb prefix: cia -> http://cia.navi.cx/ 

Tue Jun 15 02:10:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Make the text input form field info more uniform.  

Tue Jun 15 01:48:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, config/options.inc, dialogs/status.c,
	sched/session.c, sched/session.h, viewer/text/form.c,
	viewer/text/link.c, viewer/text/view.c:

	Introducing insert mode for text input form fields. The tristate is
	stored in session struct with the values mode less, on and off. All
	is configurable via the document.browse.forms.insert_mode option.
	field_op() takes care of entering insert_mode. Canceling insert mode
	is done either when changing the current link in frame_ev() or when
	field_op() gets ACT_EDIT_CANCEL.  
	
	Nifty stuff. A LED is registered and shows 'I' for mode less, 'i'
	for on and '-' for off. Finally when insert mode is off the input
	field is drawn with inverted colors to make it stand out.  
	
	Patch by Miciah and me.  

Tue Jun 15 01:28:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, viewer/text/form.c:

	get_keystroke(): Wrapping add_keystroke_to_string(). Use by
	get_form_info() to correctly report how to submit form.  

Tue Jun 15 01:18:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Use switch for adding the last part of the form
	field info.  

Tue Jun 15 01:12:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Improve the 'hit ENTER ...' message from an i18n
	perspective.  

Tue Jun 15 01:05:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Fix logics. has_form_submit() -> add 'hit ENTER to
	submit'.  

Tue Jun 15 00:12:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, link.h, view.c:

	Pass session all the way down to draw_current_link().  

Mon Jun 14 22:32:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	add_new_win_to_menu(): Don't allow -no-home to open current link
	either.  

Mon Jun 14 22:29:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	open_uri_in_new_window(): If we are cloning an instance with no URI
	defined which is possible for -no-connect pass command line options
	from the master to the new instance.  

Mon Jun 14 22:15:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Don't allow opening new windows when -anonymous is specified.  

Mon Jun 14 22:03:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, sched/session.c:

	bookmark_terminal_tabs(): Just continue if either current URI or
	title fails to be initialized. Requested by Miciah.  

Mon Jun 14 19:58:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	enter(): Cleanup. Patch by Miciah.  

Mon Jun 14 19:35:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Merge field_op() and field_op_do().  

Mon Jun 14 19:31:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op(): Cleanup.  

Mon Jun 14 19:29:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c:

	field_op() is called two places. In frame_ev() where we wil signal
	FRAME_EVENT_REFRESH if it returns non zero, and in set_textarea().
	Since frame_ev() will make sure refresh_view() is called there is no
	need to redraw form entry and lower top windows.  

Mon Jun 14 19:17:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op_do(): Take session arg instead of terminal.  

Mon Jun 14 19:15:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op_do(): Cleanup.  

Mon Jun 14 19:09:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op_do(): Cleanup ACT_EDIT_DELETE label.  

Mon Jun 14 19:05:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op_do(): Cleanup ACT_EDIT_BACKSPACE label.  

Mon Jun 14 19:01:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op_do(): Cleanup the default label.  

Mon Jun 14 18:55:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op_do(): Cleanup ACT_EDIT_KILL_TO_EOL label.  

Mon Jun 14 18:53:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op_do(): Cleanup ACT_EDIT_KILL_TO_BOL label.  

Mon Jun 14 18:51:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op_do(): Use length variable to cleanup
	ACT_EDIT_PASTE_CLIPBOARD label.  

Mon Jun 14 18:47:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op_do(): Cleanup ACT_EDIT_KILL_TO_BOL label.  

Mon Jun 14 18:44:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	field_op_do(): Move local text varible out of switch and cleanup
	ACT_EDIT_PASTE_CLIPBOARD label.  

Mon Jun 14 18:13:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	add_new_win_to_menu(): It is not possible to open links in new
	windows with -no-connect anymore.  

Mon Jun 14 18:04:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	done_session_info(): Check URI before calling done_uri().  

Mon Jun 14 17:39:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	add_session_info(): URI can be NULL for clean open in new windows.  

Mon Jun 14 13:16:50 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	next_in_view(): doc_view->document -> document, doc_view->vs -> vs.  

Mon Jun 14 13:09:17 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Sort document.browse.scrolling.*.  

Mon Jun 14 13:06:43 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Moving document.browse.scrolling up with the other folders.  

Mon Jun 14 12:56:58 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	In display_mainmenu, substitute arithmetic for the loop to scroll
	the main menu horizontally to keep the selected menu on the screen.  

Mon Jun 14 12:15:40 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation fix: entête -> en-tête.  

Mon Jun 14 10:28:37 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jun 14 10:16:27 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	find_link(): minor optimization and cleanup, move @direction test
	outside loop.  

Mon Jun 14 10:08:58 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Rearrange scroll-related functions, group mouse-related functions.  

Mon Jun 14 10:05:28 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Drop TODO.  

Mon Jun 14 10:02:56 2004  Laurent Monin <zas@norz.org>:

	* src/: config/options.inc, viewer/text/view.c:

	Group scrolling options under document.browse.scrolling tree, and
	introduce horizontal_step sub-option, cleanup.  

Mon Jun 14 09:33:39 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	scroll() -> vertical_scroll(), hscroll() -> horizontal_scroll(),
	drop buggy MacOS nameclash workaround scrool (not scroll).  

Mon Jun 14 08:02:29 2004  Laurent Monin <zas@norz.org>:

	* src/osdep/: os2/os2.c, unix/unix.c:

	Compilation fixes: include "terminal/mouse.h".  

Mon Jun 14 03:58:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Since init_session() and init_remote_session() is no longer called
	in tabwin_func() there is no need to open goto URL dialogs using
	bottom halves.  

Mon Jun 14 03:46:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): End loop after URI has been released.  

Mon Jun 14 02:21:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: Makefile.am, kbd.c, key.inc:

	Move key data to key.inc file.  

Mon Jun 14 01:27:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: kbd.h, terminal.h:

	Move declaration to correct header.  

Mon Jun 14 00:58:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/dialog.c:

	elinks.h includes setup.h 

Mon Jun 14 00:53:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/hotkey.c, bfu/inpfield.c,
	bfu/listbox.c, bfu/menu.c, bfu/text.c, bfu/widget.c,
	bookmarks/dialogs.c, cache/dialogs.c, cookies/dialogs.c,
	dialogs/menu.c, formhist/dialogs.c, globhist/dialogs.c,
	osdep/osdep.c, osdep/unix/unix.c, terminal/Makefile.am,
	terminal/event.h, terminal/kbd.c, terminal/kbd.h, terminal/mouse.h,
	viewer/text/view.c:

	Move terminal mouse stuff to terminal/mouse.h and remove a lot of
	unneded #includes of terminal/kbd.h which probably goes back to when
	hardcoded dialog keybinding was reworked.  

Mon Jun 14 00:18:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Compile fix.  

Mon Jun 14 00:08:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/event.h:

	Move comments about interlink information to terminal_info struct.  

Sun Jun 13 23:50:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): We do need to substract 2 * sizeof(int) for
	the old format to get the length of the URI data.  

Sun Jun 13 23:42:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Cleanup.  

Sun Jun 13 23:30:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Improve comments.  

Sun Jun 13 22:55:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	draw_current_link(): Merge with draw_link_do(). Zas I hope you agree
	that with the other things split out this is ok. Also add missing
	check of init_link_drawing() return value.  

Sun Jun 13 22:50:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	init_link_drawing(): Introduced. Sets up the template char with all
	the funky document option checking.  

Sun Jun 13 22:46:45 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	find_link(): @normal -> !@page_mode.  

Sun Jun 13 22:43:53 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: link.c, link.h, search.c:

	Use find_link_*() and make find_link() static.  

Sun Jun 13 22:42:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, view.c:

	draw_view_status(): Apart from the bad name it draws form, search
	and link stuff. Replaces old draw_current_link(). draw_link()
	renamed to draw_current_link().  

Sun Jun 13 22:37:56 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/vs.c:

	Use find_link_page_down().  

Sun Jun 13 22:37:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	draw_link(): Don't take current link number but use
	get_current_link() macro.  

Sun Jun 13 22:36:50 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Use find_link_{up|page_up|down|page_down}().  

Sun Jun 13 22:31:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	get_link_cursor_offset(): Introduced.  

Sun Jun 13 22:26:06 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: link.c, link.h:

	find_link_{up|page_up|down|page_down}() were introduced.  

Sun Jun 13 22:19:01 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	@p -> @direction, @s -> @normal.  

Sun Jun 13 22:08:30 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: link.c, view.c, view.h:

	Drop now useless rep_ev() parameter.  

Sun Jun 13 22:02:23 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	scroll_{mouse_}{left|right}() were introduced.  

Sun Jun 13 21:49:36 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	scroll_mouse_{up|down}() were introduced.  

Sun Jun 13 21:37:09 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Make scroll() static and introduce scroll_{up|down}().  

Sun Jun 13 21:19:02 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	move_{up|down}() were introduced, logic from page_{up|down}() was
	moved to them. Third parameter of up(),down(),page_up(), page_down()
	is not used, it will help to cleanup find_links().  

Sun Jun 13 20:20:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Fix the comments to reflect that most of the
	session info is now part of the terminal_info struct.  

Sun Jun 13 19:00:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): No need for ugly casting anymore.  

Sun Jun 13 18:56:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, sched/session.c, terminal/event.h, terminal/kbd.c,
	terminal/kbd.h, terminal/terminal.c:

	Pass the remote session flags by using special
	INTERLINK_REMOTE_MAGIC to figure out what the session info integer
	holds.  

Sun Jun 13 18:45:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Cleanup magic varialbe usage.  

Sun Jun 13 18:43:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Only check saved sessions when handling the
	'new' format. Comment updated.  

Sun Jun 13 18:39:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/event.h, terminal/kbd.c:

	Define INTERLINK_NORMAL_MAGIC macro.  

Sun Jun 13 18:08:16 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	next_in_view(): @p -> @current, @d -> @direction, @p1 -> @start, @p2
	-> @end, tidy up.  

Sun Jun 13 17:58:53 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	next_in_view(): @yl -> @height, use int_max() instead of
	int_upper_bound().  

Sun Jun 13 17:55:39 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	in_view{x|y}: minor optimizations.  

Sun Jun 13 17:51:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/event.h, terminal/kbd.c:

	Make base session id and magic part of the terminal_info struct.
	Much easier. SESSION_MAGIC() -> INTERLINK_MAGIC().  

Sun Jun 13 17:43:38 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	get_{first|last}_link(): tidy up and minor optimizations.  

Sun Jun 13 17:42:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/event.c:

	Pass terminal_info struct to decode_session_info().  

Sun Jun 13 17:22:12 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	Draw_link() was splitted to draw_link_do(), @l -> @number.  

Sun Jun 13 14:53:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Another bug introduced by me in my clueless patch rampage. No
	freaking data in HTTP Auth URIs.  

Sun Jun 13 13:57:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/: auth.c, auth.h, dialogs.c:

	Store URI struct in the auth info struct.  

Sun Jun 13 13:43:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/auth.c:

	Simplify the auth URI passing.  

Sun Jun 13 13:25:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/terminal.c:

	destroy_all_terminals(): Use list_empty().  

Sun Jun 13 12:48:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, sched/session.c, sched/session.h:

	Move stuff away from init() to encode_session_info().  

Sun Jun 13 12:29:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	Fix comment.  

Sun Jun 13 12:20:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	Pass the terminal_info to check_terminal_name().  

Sun Jun 13 12:18:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.c, event.h, kbd.c:

	Change terminal_info->term to ->name.  

Sun Jun 13 12:14:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.c, screen.c, terminal.h:

	Remove the term->term member. We can just use term->spec->name and
	it will even make more sense for the screen driver thing.  

Sun Jun 13 12:04:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Fix off by one error in handling of query part in the
	base URI. Spotted by zas.  

Sun Jun 13 04:03:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	handle_interlink_event(): Use redraw_terminal_cls() for hanling
	Ctrl-L even though it is not as fast it is more clear what is going
	on.  

Sun Jun 13 03:57:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	handle_interlink_event(): Cleanup KBD_CTRL_C handling.  

Sun Jun 13 03:49:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	check_terminal_name(): Make error handling simpler.  

Sun Jun 13 03:47:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	check_terminal_name(): Use for loop. Group strcpy() with strcat().  

Sun Jun 13 03:45:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	check_terminal_name(): Cleanup.  

Sun Jun 13 03:43:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	handle_interlink_event(): Split out terminal name checking to
	check_terminal_name().  

Sun Jun 13 03:37:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	in_term(): Compile fix ;) but most important a cleanup and
	description of the loop. We now add stuff back to the
	term->qfreespace counter before stopping the loop if term->qlen gets
	zeroed.  

Sun Jun 13 03:25:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	in_term(): r -> event_size in the loop.  

Sun Jun 13 03:23:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	in_term(): Make goto loop into while loop.  

Sun Jun 13 03:21:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	Oops forgot the crucial part of last patch.  

Sun Jun 13 03:13:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	in_term(): Move switch to separate function.  

Sun Jun 13 00:54:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/: menu.c, menu.h:

	Compile fix.  

Sun Jun 13 00:46:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, viewer/text/link.c:

	link_menu(): Add submit form and open in new tab items. Make the
	open in new window action implicit.  

Sun Jun 13 00:39:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	link_menu(): Use switch.  

Sun Jun 13 00:30:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/listmenu.c, viewer/text/form.c, viewer/text/form.h,
	viewer/text/link.c, viewer/text/link.h:

	get_current_state(): Move to form file.  

Sun Jun 13 00:25:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, link.h:

	Remove print_current_link().  

Sun Jun 13 00:24:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	frame_ev(): Use get_current_link_info() for the copy clipboard
	thing.  

Sun Jun 13 00:24:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	display_status_bar(): Optimize current_frame() calling and use
	get_current_link_info() so we don.t call it 3 times.  

Sun Jun 13 00:17:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, viewer/text/form.c, viewer/text/form.h,
	viewer/text/link.c, viewer/text/link.h:

	Pass session to get_form_info() and get_current_link_info().  

Sun Jun 13 00:12:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, viewer/text/link.c, viewer/text/link.h:

	get_current_link_title(): No use to pass term.  

Sun Jun 13 00:06:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, viewer/text/link.c, viewer/text/link.h,
	viewer/text/link.c:

	print_current_link_title_do() -> get_current_link_title(),
	print_current_link_do() -> get_current_link_info().  

Sat Jun 12 23:50:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	init_remote_session(): Assert that remote session flags is not
	masked out.  

Sat Jun 12 19:43:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Tidyup.  

Sat Jun 12 19:29:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Outdent last part.  

Sat Jun 12 19:28:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	get_form_info(): Cleanup. Unify use of local variables.  

Sat Jun 12 19:24:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, form.h, link.c:

	Split form stuff in print_current_link_do() out into
	get_form_info().  

Sat Jun 12 19:23:19 2004  Laurent Monin <zas@norz.org>:

	* src/: dialogs/menu.c, document/document.h:

	Trim trailing spaces.  

Sat Jun 12 19:14:20 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	Drop extra whitelines.  

Sat Jun 12 19:07:48 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	print_current_link_do(): code cleanup.  

Sat Jun 12 18:51:21 2004  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/signals.c, lowlevel/signals.h, viewer/text/form.c,
	viewer/text/link.c, viewer/text/link.h, viewer/text/textarea.c,
	viewer/text/textarea.h, viewer/text/view.c:

	@t -> @term.  

Sat Jun 12 18:43:15 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/lua/core.c:

	Drop redundant sig_ctrl_c() prototype.  

Sat Jun 12 18:06:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Make field_op_do() static.  

Sat Jun 12 18:05:53 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/session.c, viewer/dump/dump.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/link.h, viewer/text/textarea.c,
	viewer/text/textarea.h:

	@l -> @link.  

Sat Jun 12 17:55:38 2004  Laurent Monin <zas@norz.org>:

	* src/: document/document.h, document/html/renderer.c,
	viewer/text/form.c, viewer/text/link.c, viewer/text/textarea.c:

	struct link: @form -> @form_control.  

Sat Jun 12 17:42:57 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c:

	Drop dead code.  

Sat Jun 12 17:39:56 2004  Laurent Monin <zas@norz.org>:

	* src/document/: document.h, renderer.c, html/renderer.c:

	struct link: @num -> @number.  

Sat Jun 12 17:29:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, dialogs/document.h, sched/action.c:

	Merge loc_msg() and state_msg() into document_info_dialog(). Rename
	head_msg() to protocol_header_dialog().  

Sat Jun 12 17:28:43 2004  Laurent Monin <zas@norz.org>:

	* src/: document/docdata.h, document/document.c,
	document/document.h, document/renderer.c, document/html/renderer.c,
	document/plain/renderer.c, viewer/text/form.c, viewer/text/link.c,
	viewer/text/search.c, viewer/text/textarea.c:

	struct link: @n -> @npoints, @pos -> @points.  

Sat Jun 12 17:19:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/document.c:

	loc_msg(): Use find_in_cache() instead of get_cache_entry(). We
	don't want to create a new entry but only look at existing one.
	Spotted by pasky.  

Sat Jun 12 16:59:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.h:

	Remove fc_len member of struct submitted_value.  

Sat Jun 12 16:31:42 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.h:

	Normalize function declarations.  

Sat Jun 12 16:29:05 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	field_op(): use struct terminal *term to shorten lines.  

Sat Jun 12 16:27:39 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	field_op(): code simplification.  

Sat Jun 12 16:26:15 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	field_op(): @frm -> @fc, this name is more common among code for
	struct form_control pointer.  

Sat Jun 12 16:23:52 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	field_op(): @l -> @link.  

Sat Jun 12 16:06:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, sched/session.c:

	get_current_url(): Also try ses->loading_uri so that slow loading
	pages (like bz) will show up earlier when pressing 'G'.  

Sat Jun 12 15:55:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	redirect_cache(): Use get_uri_string() when doing the fake '/'
	redirects. It is safer and I can trim away some of that confusing
	comment I wrote once.  

Sat Jun 12 15:46:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	rewrite_uri(): Use add_uri_to_string() when adding current URI.  

Sat Jun 12 15:43:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	... and free the URI string too.  

Sat Jun 12 15:43:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	Use get_uri_string() instead of accessing URI directly. It will also
	make sure that password is not shown on the screen.  

Sat Jun 12 15:34:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/dialogs.c:

	Use add_uri_to_string().  

Sat Jun 12 15:26:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Tidyup.  

Sat Jun 12 15:25:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Merge init_session_info_string() into open_uri_in_new_window().  

Sat Jun 12 15:19:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/: conv.c, conv.h:

	Remove now unused add_encoded_shell_safe_url() and
	decode_shell_safe_url().  

Sat Jun 12 15:16:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, dialogs/menu.c, sched/session.c, sched/session.h:

	Introduce session_info struct that is basicly like the old
	initial_session_info struct but is only used for openning instances
	in new windows. The new instance connects and the base_session id is
	used to look up saved session info from which we can initialize. The
	id member of struct session can then be removed. More can be removed
	but that will happen in later patch.  

Sat Jun 12 15:03:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.h:

	Remove initial_session_info struct declaration.  

Sat Jun 12 15:02:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.h:

	Cleanup #include.  

Sat Jun 12 12:33:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Cleanup.  

Sat Jun 12 12:24:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Cleanup the loop. Comment on why warning
	about bad URL syntax is not needed.  

Sat Jun 12 12:14:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	in_term(): This little hack is needed to make sure that the terminal
	is initialized and ready to draw on.  

Sat Jun 12 11:54:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Hmm.  

Sat Jun 12 11:45:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Cleanup init_session() calling for multiple
	loops. Just break out if allocation fails.  

Sat Jun 12 11:35:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): base_session -> ses. It made the code too
	readable and we can't have that.  

Sat Jun 12 11:30:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	init_remote_session(): Make it even more evil by making it mangle
	reference to remote flags.  

Sat Jun 12 11:24:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h:

	decode_session_info(): Return int. Much simpler with term not being
	destroyed anymore.  

Sat Jun 12 11:19:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/event.c:

	Move the destroy_terminal() back to in_term()'s EV_INIT handler. It
	is the only thing really using it since decode_session() will be
	called for all terminal creation. Besides it fixes -remote support
	;) 

Sat Jun 12 11:00:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Don't break if next NUL char is not found so
	ELinks' using the old format can connect again.  

Sat Jun 12 01:17:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Reduce code duplication by doing allocation and URI
	normalization if length is set to something meaningful. It means
	'//' branch will also call normalization but we shouldn't trust the
	web authors in the first place.  

Sat Jun 12 01:10:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Also use memacpy() for '//' joining instead of the
	get_uri_string() beast.  

Sat Jun 12 01:07:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Comments and breathing room.  

Sat Jun 12 01:01:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): tmp -> length, n -> uristring 

Sat Jun 12 00:55:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Simplify the URI normalization interface a bit.  

Sat Jun 12 00:50:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Make better use of fragment and post member when
	joining '?' relative URI.  

Sat Jun 12 00:43:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Make better use of fragment and post member when
	joining '#' relative URI.  

Sat Jun 12 00:35:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Check return value of get_uri_string().  

Sat Jun 12 00:16:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	URI_FORM_GET should not have URI_FRAGMENT flag set since query was
	removed before and fragment part is after query part.  

Sat Jun 12 00:14:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	get_no_post_url_length(): Remove.  

Sat Jun 12 00:12:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser/forms.c, protocol/uri.h:

	Be smarter by using get_uri_string() when initializing form->action.  

Sat Jun 12 00:09:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Allow URI_PATH to be used with other URI components.  

Fri Jun 11 23:48:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/dialogs.c, protocol/uri.c, protocol/uri.h:

	Generalize adding of '(POST DATA)' for strings returned by
	get_uri_string(..., URI_PUBLIC); Don't know it might be helpful for
	some but should maybe be disabled for non debug builds.  

Fri Jun 11 23:24:46 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jun 11 23:16:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Fix broken session setup. setup_first_session() now returns bool
	whether to also call setup_session().  

Fri Jun 11 23:05:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	setup_first_session(): Move the juicy stuff last.  

Fri Jun 11 23:05:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	tabwin_func(): Don't break on EV_INIT we want those main menu and
	status bar drawn on the screen.  

Fri Jun 11 23:03:48 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	Drop commented out dead code.  

Fri Jun 11 23:03:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Introduce init_boundary().  

Fri Jun 11 21:58:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	BL -> BOUNDARY_LENGTH 

Fri Jun 11 21:56:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	check_range(): Fix a few comments and only initialize the boundary
	counter once. The reason to do it twice before was that we could
	match the boundary but we don't search them anymore.  

Fri Jun 11 21:48:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	check_boundary(): Code bloat and optimization. But it is mostly
	comments. The boundary string 'incrementation' was split out to
	separate function.  

Fri Jun 11 19:38:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Make the bound string part of the boundary_info struct.  

Fri Jun 11 19:32:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Use boundary_info struct to pass boundary offset info around. Fixes
	file uploading (and other multipart post handling). Guilty code was
	the *nbound_ptrs++ which didn't do what was expected.  

Fri Jun 11 19:21:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	check_boundary(): Outdent the loop. Bad idea.  

Fri Jun 11 19:05:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	check_boundary(): Indent the loop nothing else.  

Fri Jun 11 19:04:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	check_boundary(): Use string pointers.  

Fri Jun 11 18:58:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	check_boundary(): Use memcmp().  

Fri Jun 11 18:54:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Move boundary check to separate function.  

Fri Jun 11 17:35:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Send Content-Type header for file uploads if the MIME subsystems
	knows it. Make autodetection of bugzilla attachment creation
	possible.  

Fri Jun 11 14:56:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/tab.c, terminal/tab.h:

	init_tab(): No need to take in_background arg.  

Fri Jun 11 14:55:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/tab.c:

	Do all the tab switching in init_session() since we have more
	control there.  

Fri Jun 11 14:43:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/event.c:

	Only destroy the terminal if first tab fails to be created.  

Fri Jun 11 14:39:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/tab.c, terminal/tab.h:

	Merge create_session() into init_session(). init_tab() now takes
	data pointer. The reverse order of initialization of sessions should
	help improve error handling.  

Fri Jun 11 14:12:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/event.c:

	Remove the need for initial_session_info by calling create_session()
	in init_session(). Ahh :)) 

Fri Jun 11 14:02:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h:

	Make tabwin_func static.  

Fri Jun 11 14:00:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/interlink.c, terminal/terminal.c,
	terminal/terminal.h:

	init_term(): No need to take root_window arg anymore.  

Fri Jun 11 13:58:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/terminal.c:

	Make init_session() do all the tab creation.  

Fri Jun 11 13:54:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h:

	init_session(): Return initial_session_info for no good reason.  

Fri Jun 11 13:29:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/tab.c, terminal/tab.h,
	terminal/terminal.c:

	init_tab(): Take the handler as arg.  

Fri Jun 11 13:04:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	follow_url(): Also send fragment stuff to the event.  

Fri Jun 11 12:36:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	follow_url(): Use URI_BASE instead of URI_ORIGINAL so we get the
	post stuff right in the returned URI. Note added about a possible
	future scenario where post data should be fixed up. Spotted by
	pasky.  

Fri Jun 11 10:30:52 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	search_dlg_do(): drop more constant parameters.  

Fri Jun 11 10:13:10 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/inpfield.h:

	add_dlg_field_do(): use struct widget * and reduce code redundancy.  

Fri Jun 11 10:02:45 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	search_dlg_do(): drop unused parameters and simplify code a lot.  

Fri Jun 11 03:22:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Revert last patch. It is too unpredictable.  

Fri Jun 11 03:03:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Make link typeahead searching honor links in the current view. Idea
	by Miciah altho' it still doesn't fix his problem since links in the
	lower half of the view will become centered so scrolling is done
	even though it might not be what you want.  

Fri Jun 11 02:00:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	request_additional_file(): URIs can potentially contain fragments so
	compare using URI_BASE.  

Fri Jun 11 01:21:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	setup_first_session(): Only greet people on first_use if they don't
	pass any URI on the command line. Is this bad practice? 

Fri Jun 11 01:06:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	get_real_uri_length(): Fix off by one error.  

Fri Jun 11 00:54:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	setup_first_session(): Dammit. Goto URL home.  

Fri Jun 11 00:47:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, sched/session.c, sched/session.h:

	create_session_info() -> encode_session_info().  

Fri Jun 11 00:44:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	handler_remote_session() -> init_remote_session().  

Fri Jun 11 00:42:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Shorten lines but using temporary variable.  

Fri Jun 11 00:39:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	dialog_goto_url_open_first() was removed and the s/_first// one is
	used instead and first_use is set to zero right away. I can't see
	why it has to be done in the button handler.  

Fri Jun 11 00:28:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	setup_session(): Cleanup and describe. No need to check first_use
	before showing goto URL dialog.  

Fri Jun 11 00:22:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	process_session_info() -> setup_session() and merge in
	copy_session().  

Fri Jun 11 00:18:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	setup_first_session(): Only open goto URL dialog if no URL was
	passed on the command line.  

Fri Jun 11 00:10:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	setup_first_session(): Take URI arg and duplicate code a bit. It
	will help fix a bug and makes the session autosave stuff much saner.  

Thu Jun 10 23:55:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	create_session(): Only copy session if not the first one.  

Thu Jun 10 23:52:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Fix possible leak of initial_session_info.  

Thu Jun 10 23:47:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	create_session(): session_info can never be NULL. We check for it at
	initialization time.  

Thu Jun 10 23:43:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Cleanup.  

Thu Jun 10 23:22:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Move functions around so they don't have to be predeclared.  

Thu Jun 10 22:56:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	init_session_info(): No remote arg is needed.  

Thu Jun 10 22:28:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Random cleanups.  

Thu Jun 10 22:21:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Fix start up with no URIs on the command
	line.  

Thu Jun 10 22:11:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Small cleanup.  

Thu Jun 10 21:55:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	initial_session_info->uri_list replaced by URI pointer.  

Thu Jun 10 21:49:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Use init_session() to open all URIs but the
	first one.  

Thu Jun 10 21:45:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/tab.c:

	Reintroduce the eye-rolling init_session().  

Thu Jun 10 18:44:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Also call handle_remote_session() when there
	are no URIs. Fixes xfeDoCommand(openBrowser) command.  

Thu Jun 10 18:18:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	handle_remote_session(): Doh. Fix logics.  

Thu Jun 10 18:15:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/event.c:

	Remove the remote_session_flags from initial_session_info.
	decode_session_info() now does all the fun stuff.  

Thu Jun 10 17:59:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Move remote handling up so it can be used in session info decoding.  

Thu Jun 10 17:57:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	handle_remote_session(): Introduced. Note -remote is currently
	broken.  

Thu Jun 10 17:19:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	A little cleanup of remote handling.  

Thu Jun 10 17:02:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Revert last patch. Again.  

Thu Jun 10 16:59:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	decode_session_info(): Work on local uri_list variable.  

Thu Jun 10 16:49:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, util/conv.c, util/conv.h:

	decode_session_info(): Unify URI string parsing.  

Thu Jun 10 16:06:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/tab.c:

	Revert last patch.  

Thu Jun 10 16:05:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/tab.c:

	init_session(): Introduced. It is mostly just open_uri_in_new_tab().  

Thu Jun 10 15:40:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Damn open in new window stuff needs to decode the URI string.  

Thu Jun 10 15:37:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Use initial_session_info->uri_list (part three).  

Thu Jun 10 15:30:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/tab.c:

	Use initial_session_info->uri_list (part one). init_session_info()
	now takes URI struct.  

Thu Jun 10 15:27:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Use initial_session_info->uri_list (part one). Call get_hooked_uri()
	in decode_session_info().  

Thu Jun 10 15:21:01 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	Comment out int num field in struct form, it is unused, though this
	is weird.  

Thu Jun 10 15:15:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/event.c:

	decode_session_info(): Take term arg. Unused for now.  

Thu Jun 10 14:54:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, task.c, task.h:

	Dejavu, get_hooked_uri() now takes the lot of args (like CWD and
	current URI) again.  

Thu Jun 10 14:27:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/tab.c:

	Make initial_sesssion_info->base_session a session struct pointer.  

Thu Jun 10 14:19:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h:

	Move struct initial_session_info declaration to C file.  

Thu Jun 10 14:12:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	process_session_info(): 'unblock' last part.  

Thu Jun 10 14:10:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	create_session(): Take the initial_session_info and call
	process_initial_session().  

Thu Jun 10 13:51:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	create_session() -> setup_first_session(), create_basic_session() ->
	create_session(). Basicly what the comment says.  

Thu Jun 10 13:46:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Move create_basic_session().  

Thu Jun 10 13:35:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h:

	create_basic_session(): Make static.  

Thu Jun 10 13:23:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/tab.c:

	open_uri_in_new_tab(): Use init_session_info().  

Thu Jun 10 13:16:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	init_session_info(): Introduced.  

Thu Jun 10 12:21:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/: link.c, link.h, parse.c:

	Add support for <embed> tags. Like <object> support it just uses
	html_img() and html_iframe(). Requested by Stephen Stocker.  

Thu Jun 10 12:10:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/: mime.c, mime.h:

	get_extension_content_type(): Make public. It will be used for
	<embed> tag support.  

Thu Jun 10 12:09:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	get_content_type(): Cleanup the debug code.  

Thu Jun 10 12:00:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	Fix the ctype debuggin'.  

Thu Jun 10 11:57:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	get_content_type(): Do the get_content_filename() checking in the
	cached->head branch.  

Thu Jun 10 11:55:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	get_content_filename(): Take optional cache entry arg to speed up
	things.  

Thu Jun 10 11:51:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/: mime.c, mime.h:

	get_content_filename(): Make static and move up.  

Thu Jun 10 11:21:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/imgmap.html:

	Link to test/ documents.  

Thu Jun 10 01:26:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	init_file_download(): Add error handling for last patch.  

Thu Jun 10 01:18:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	init_file_download(): The URI is passed using ses->download_uri that
	originates from both vs->uri and link->where_img so better ensure
	that no fragments are in it.  

Thu Jun 10 01:12:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	do_move(): Assertion about base URI should compare using URI_BASE.  

Thu Jun 10 01:10:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	Oops. Some missing LINK_MAP stuff. ;) 

Thu Jun 10 00:02:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	parse_uri(): Fix POST_CHAR bug.  

Wed Jun  9 22:54:23 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Minor tidy up, label nb -> next_boundary.  

Wed Jun  9 22:42:45 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	@subm -> @list, @nx -> @next, @ch -> @changed.  

Wed Jun  9 22:36:45 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Move code from get_succesful_controls() to new
	sort_submitted_values().  

Wed Jun  9 22:12:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.h, viewer/text/link.c, viewer/text/link.h,
	viewer/text/view.c:

	enum frame_event_status introduced as return value for frame_ev()
	and send_to_frame().  

Wed Jun  9 21:42:19 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/action.c, viewer/text/form.c, viewer/text/view.c,
	viewer/text/view.h:

	Add an int frames arg to refresh_view(). Idea by Jonas.  

Wed Jun  9 21:29:00 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Revert part of last patch: draw_frames() has to be called after
	draw_doc().  

Wed Jun  9 21:22:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	menu_url_shortcut(): Use get_uri() and goto_uri().  

Wed Jun  9 21:14:31 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/view.c:

	Trailing spaces fix.  

Wed Jun  9 21:13:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bookmarks/bookmarks.c, document/refresh.c,
	sched/session.c, sched/task.c, sched/task.h, viewer/text/link.c,
	viewer/text/view.c:

	Introduce goto_uri() to battle against 'leaking' of referrer caused
	by goto_url() -> goto_url_frame() changes. Also rename
	goto_url_frame() to goto_uri_frame().  

Wed Jun  9 21:12:32 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/action.c, viewer/text/view.c:

	Use refresh_view() where applicable.  

Wed Jun  9 21:05:53 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/listmenu.c, viewer/text/form.c, viewer/text/form.h,
	viewer/text/link.c, viewer/text/link.h, viewer/text/view.c,
	viewer/text/view.h:

	Move selected_item() from link.c to form.c, and make
	init_form_state() static.  refresh_view() was introduced to help
	this move, and to reduce code redundancy.  

Wed Jun  9 20:49:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	goto_url_with_hook(): Bail out if passed empty string (from goto-url
	dialog).  

Wed Jun  9 20:48:47 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	init_ctrl() -> init_form_state().  

Wed Jun  9 07:49:55 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.h:

	Use enum form_type for type field in struct form_state, and
	rearrange fields in related structs.  

Wed Jun  9 00:22:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	follow_url() stuff now tries to pass the URI struct all the way.  

Tue Jun  8 23:26:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/session.c:

	open_url_in_new_window(): Rename to open_uri_in... and take clean
	URI.  

Tue Jun  8 23:22:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bookmarks/bookmarks.c, sched/action.c,
	sched/session.c, terminal/tab.c, terminal/tab.h:

	open_url_in_new_tab(): Rename to open_uri_in... and take clean URI.  

Tue Jun  8 23:16:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/bookmarks.c:

	open_bookmark_folder(): Use URI structs.  

Tue Jun  8 23:05:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, task.c, task.h:

	process_session_info(): Use get_hooked_uri().  

Tue Jun  8 22:54:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	get_hooked_uri(): Pass the session so it can do all the dirty work.  

Tue Jun  8 19:33:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/listbox.h, bookmarks/dialogs.c,
	cache/dialogs.c, config/dialogs.c, cookies/dialogs.c,
	dialogs/download.c, formhist/dialogs.c, globhist/dialogs.c,
	protocol/auth/dialogs.c:

	Add a get_uri() method to the listbox operations.  

Tue Jun  8 17:01:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	get_hooked_uri(): Use oneliner.  

Tue Jun  8 16:54:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	get_translated_uri(): Don't be so anal about @cwd.  

Tue Jun  8 16:51:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Move event stuff from goto_url_with_hook() to get_hooked_uri().  

Tue Jun  8 16:36:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: view.c, vs.c:

	Oops vs->did_fragment should be touched now.  

Tue Jun  8 16:21:23 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	@yw -> @height, and is_in_range_*() interface uniformization.  

Tue Jun  8 16:14:02 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	Move lowered_string() near its user.  

Tue Jun  8 16:13:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h:

	The free_syntax member of the protocol_backend structure is not used
	anymore.  

Tue Jun  8 16:12:35 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	@s -> @text, @l,@len -> @textlen.  

Tue Jun  8 16:10:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix and improve file:// handling. Especially '#' handling.  

Tue Jun  8 15:12:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Hrmf.  

Tue Jun  8 15:08:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser.c, document/html/parser.h,
	sched/task.c:

	Pass the loading session URI deep into the HTML parser so no
	allocation is needed.  

Tue Jun  8 14:51:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h, task.c:

	Remove session member imgmap_href_base and simply use loading_uri.  

Tue Jun  8 14:46:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h, task.c:

	Remove session member imgmap_target_base and simply use
	task.target_frame.  

Tue Jun  8 14:26:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: proxy.c, proxy.h, uri.h:

	Move get_proxied_uri() to proxy subsystem and make it into a real
	function.  

Tue Jun  8 14:20:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: proxy.c, proxy.h, uri.h:

	Merge get_proxy_uri() macro stuff into get_proxy() and name it all
	get_proxy_uri().  

Tue Jun  8 14:15:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, document/refresh.c, protocol/proxy.c,
	protocol/uri.h, sched/download.c, sched/download.h,
	sched/session.c, sched/session.h, sched/task.c:

	Remove lots of those new goto_uri members. Now the fun begins to see
	what it breaks. Also we have to 'rethink' stuff like how
	get_current_url() should behave. Should bookmarking add the fragment
	or not.  

Tue Jun  8 13:54:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, document/html/parser.c, protocol/uri.c,
	protocol/uri.h, sched/task.c, viewer/dump/dump.c:

	Remove extract_fragment() and cleanup get_translated_uri()
	interface.  

Tue Jun  8 13:49:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, dialogs/document.c, protocol/uri.c,
	sched/download.c, sched/download.h, sched/history.c,
	sched/session.c, sched/session.h, sched/task.c, sched/task.h,
	viewer/text/view.c, viewer/text/vs.c, viewer/text/vs.h:

	Actually use the new URI fragment member. All the way down the goto
	chain previous goto_position member that contained the fragment part
	of the URI has been replaced by goto URI. Only exception is
	view_state and find_in_cache()'s URI comparison has been changed to
	reflect this.  
	
	Note: A lot of error checking has not been added since a lot is
	still temporary.  

Tue Jun  8 13:37:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	compare_uri(): Compile fix.  

Tue Jun  8 13:34:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	find_in_cache(): Remove clever optimization. With fragments in URIs
	assuming not in cache when refcount is one is no longer correct.  

Tue Jun  8 13:32:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	compare_uri(): Fix post comparison.  

Tue Jun  8 12:42:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	compare_uri(): Only check special and idn URI flag.  

Tue Jun  8 12:23:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	compare_uri(): Add support for compare the remaining URI members.  

Tue Jun  8 12:19:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Add fragment member to URI struct.  

Tue Jun  8 11:30:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Only free vs->goto_position when the cache entry is complete.  

Tue Jun  8 10:54:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/lua/hooks.c:

	Fix compilation failure spotted by zas.  

Tue Jun  8 00:04:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: proxy.c, uri.h:

	Oops URI_PROXY needs URI_IDN even though it only works in theory.  

Tue Jun  8 00:00:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: proxy.c, uri.h:

	A little cleanup in the URI components.  

Mon Jun  7 23:38:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, document/refresh.c, document/html/frames.c,
	document/html/parser.c, protocol/proxy.c, protocol/uri.c,
	protocol/uri.h, sched/task.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/view.c:

	get_uri(): Take uri_component flags instead of length. Uses
	get_composed_uri() as backend.  

Mon Jun  7 23:21:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	redirect_cache(): Correctly renew @redirect member.  

Mon Jun  7 17:46:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	document/document.c, document/document.h:

	id_tag -> id.  

Mon Jun  7 17:39:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	delete_cache_entry(): Group done_uri()s.  

Mon Jun  7 16:36:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: marks.c, marks.h, view.c:

	goto_mark(): Introduced to make marks interface 'cleaner'. Stuff
	from frame_ev() moved to it.  

Mon Jun  7 16:25:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/dialogs.c, sched/connection.c,
	viewer/text/view.c:

	More compare_uri() usage. Hmm 

Mon Jun  7 16:18:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, document.h, renderer.c:

	Simplify init_document() and get_cached_document() by passing
	cache_entry.  

Mon Jun  7 15:58:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/events.txt, src/protocol/rewrite/rewrite.c, src/sched/task.c,
	src/scripting/guile/hooks.c, src/scripting/lua/hooks.c,
	src/scripting/perl/hooks.c:

	Pass current URI to goto-url event instead of current session.  

Sun Jun  6 13:19:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Fix URI referencing. Reported by Stephen Stocker.  

Sun Jun  6 12:34:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Cleanup checking whether @rel contains protocol.  

Sun Jun  6 12:21:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Cleanup case when relative string start with '//'.  

Sat Jun  5 21:14:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, document/html/parser.c,
	document/html/parser/forms.c, document/html/parser/link.c,
	protocol/uri.c, protocol/uri.h:

	join_urls(): Take base as URI struct. Lots of cleanups needed.  

Sat Jun  5 21:03:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: parser.c, parser.h, parser/forms.c,
	parser/link.c, parser/stack.c:

	Make (HTML) format.href_base reference a URI.  

Fri Jun  4 13:44:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Introduced get_composed_uri(). Not used yet.  

Fri Jun  4 13:43:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	find_tag(): Take length arg.  

Fri Jun  4 13:36:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Make room for URI_FRAGMENT flag.  

Fri Jun  4 13:27:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/frames.c, sched/session.c, sched/session.h,
	sched/task.c:

	ses_change_frame_uri(): Remove it. Two users. Better inline it IMO.
	Plus the format_frame() one we already have the frame so ...  

Fri Jun  4 13:04:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Space fix.  

Fri Jun  4 12:48:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_formatted(): Don't use get_cache_uri() when passing URI to
	init_vs(). It assumes it is non-NULL and besides the cache_entry
	should never be incomplete at this point.  

Fri Jun  4 12:46:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	request_frame(): Even though something might not use it pass the CWD
	to get_translated_uri().  

Fri Jun  4 07:54:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	clear_hchars(): Also clear color using par_format.bgcolor. Fix bug
	462.  

Fri Jun  4 07:40:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.h, sched/session.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/search.c:

	Introduce link_is_form() macro. Morning zas :) 

Fri Jun  4 07:37:51 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: search.c, search.h:

	@a, @d -> @direction.  

Fri Jun  4 07:33:37 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	Drop useless whitelines and minor reindentation.  

Fri Jun  4 07:29:53 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	lowered_string(): drop useless intermediate variables.  

Thu Jun  3 23:01:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Remove TODO about using struct string. I think it is better to keep
	the tuned sizes of integer members. Add TODO about trying
	file_exist() for URIs with fragment and query part removed.  

Thu Jun  3 22:55:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix bad handling of /.. introduced in the patch that was supposed to
	reduce the number of directory redirects.  

Thu Jun  3 21:12:41 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	search_dlg(): @a -> @direction, do test only once.  

Thu Jun  3 21:08:06 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	search_dlg_do(): make it static and reindent parameters.  

Thu Jun  3 21:01:54 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	get_searched_regex(): code cleanup and loop optimization.  

Thu Jun  3 13:47:29 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	search_link_text(): code simplification and optimization.  

Thu Jun  3 13:27:52 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	Tidy up.  

Thu Jun  3 08:08:54 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Fix a typo (CONFIG_MAKRS) that broke the mark-set action.  

Wed Jun  2 10:36:55 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	Elinksify temporary file name template: "linksarea-XXXXXX" ->
	"elinks-area-XXXXXX" 

Wed Jun  2 10:34:58 2004  Laurent Monin <zas@norz.org>:

	* src/: protocol/user.c, util/file.c, util/file.h, util/secsave.c,
	viewer/text/textarea.c:

	safe_mkstemp() was introduced to prevent a potential security issue,
	leading to permit all users to read textarea content while an user
	edit it through external editor.  

Wed Jun  2 06:38:12 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Remove some excess indentation spotted by Jonas.  

Tue Jun  1 07:14:23 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/uri.c:

	Obfuscate compare_uri(): Substitute boolean operators for some ifs
	and returns.  

Tue Jun  1 06:57:06 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Remove a TODO for what I jus' done.  

Tue Jun  1 06:40:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Revert, darnit! 

Tue Jun  1 06:35:41 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Revert the last patch: It is obviously wrong as we call
	switch_to_tab just prior.  

Tue Jun  1 06:26:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	We assert(ses->tab == get_current_tab(ses->tab->term)); in
	tabwin_func, so, in send_event, use |ses->tab| and |ses| instead of
	assigning |tab = get_current_tab(ses->tab->term);| and using |tab|
	and |tab->data|.  

Tue Jun  1 06:23:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Open the tab menu when the user right-clicks the document canvas and
	no other action is taken (i.e., the user did not click a link).  

Tue Jun  1 06:21:08 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In do_mouse_event, return the result of send_to_frame().  

Tue Jun  1 06:19:21 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In frame_ev, return 0 if the mouse event was not handled.  

Tue Jun  1 06:18:19 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Only allow scroll-margins with the left mouse-button.  

Tue Jun  1 05:55:59 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Do not redraw an extra time when the user right- or middle-clicks a
	link.  

Tue Jun  1 05:31:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	Remove a superfluous assignment.  

Tue Jun  1 04:25:06 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In draw_doc, free goto_position whether or not the fragment
	identifier is found. As it was, freeing only when the fragment
	identifier was found, there was an endless loop as draw_doc()
	displayed the 'Missing fragment' box, one clicked 'OK', draw_doc()
	was called to redraw the document, draw_doc() again tried to find
	the fragment and, not finding it, displayed the 'Missing Fragment'
	box, and so on.  
	
	(I discovered and explained this problem on IRC after I suggested 
	that we not free goto_position, remember, Jonas?) 

Tue Jun  1 00:42:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Remove get_no_post_url() and save a stack frame.  

Tue Jun  1 00:39:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Improve the fix for bug 95 by checking if the cached document is
	incomplete before poping up a message box and now we only free() the
	goto_position if we are successful like in the old code. And the
	return is complely absurd so removed.  

Tue Jun  1 00:09:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Compile fix.  

Tue Jun  1 00:03:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Remove get_uri_hostlen(). Miciah doesn't like it.  

Mon May 31 23:56:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, protocol/uri.h, sched/connection.c:

	Even use compare_uri() for comparing the port of the
	keepalive_connection.  Port member can then be removed. The default
	port case should be covered by the protocol comparison.  

Mon May 31 23:49:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, protocol/uri.h, sched/connection.c:

	get_keepalive_connection(): Use compare_uri() for checking
	keepalive_connection. Note this is a bit more fine grained than
	before because we only checked password part if uri part was
	present. This should not be a problem I hope.  

Mon May 31 23:27:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Replace keepalive_connection protocol and host member with URI
	struct.  

Mon May 31 23:19:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Why do we use protocol_handler for keepalive_connection->protocol.
	It is not like it will ever change plus just using enum protocol
	will guard against defining protocol handlers to the same (proxy
	comes to mind) even though the port number would probably guard
	against that.  

Mon May 31 17:34:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Replace host_connection->connection with a struct object to improve
	debugging.  

Mon May 31 17:19:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Use URI struct in struct host_connection instead of the host string.
	Altho' it could pin down the URI a little longer than otherwise it
	is only temporarily and I think this is a bit cleaner.  

Mon May 31 17:16:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/download.c, sched/history.c, sched/session.c,
	sched/task.c, document/refresh.c, protocol/uri.c, protocol/uri.h:

	Introduce compare_uri(uri, uri, uri_component) function to obsolete 
	uris_compare(). It is a work in progress guarded by an assertion.  
	Idea by Miciah.  

Mon May 31 12:39:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/: cookies.c, cookies.h, dialogs.c:

	Three things (yeah I know it is a bit too aggressive): 
	
	- Remove cookie->id since nothing uses it 
	
	- Remove c_server->accept since nothing uses it 
	
	- Rename c_server->server to host. It should be less confusing 
	
	The only real code changes is in the dead code.  

Mon May 31 12:19:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Fix COOKIES_DEBUG building.  

Mon May 31 12:17:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Fix overly strict cookie policy. If !c_server->accept) we always
	bailed out. I should not have reverted all the patch. ;) 

Mon May 31 12:09:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/: cookies.c, dialogs.c:

	A few fixes of cookie->server usage.  

Mon May 31 05:04:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/hierbox.h, config/kbdbind.c:

	add_listbox_item(): Add support for not updating browser dialogs by 
	passing a NULL browser. Note the root item must be non-NULL in that
	case.  Finally also add argument that controls where to add the new
	item.  
	
	init_action_listboxes(): Use add_listbox_item(). A little cleanup
	included to keep lines shorter.  

Mon May 31 03:45:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/hierbox.h, cache/cache.c,
	config/kbdbind.c, cookies/cookies.c, formhist/formhist.c,
	globhist/globhist.c, protocol/auth/auth.c, sched/download.c:

	add_listbox_item() is now the name of the common backend. Remove
	@text arg.  

Mon May 31 03:36:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/listbox.h, config/kbdbind.c:

	Remove listbox_item->translated flag. get_info() stuff should take
	care of that now.  

Mon May 31 03:34:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Use add_listbox_leaf() when setting up keybinding->box_item.  

Mon May 31 03:33:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/hierbox.c:

	A small fix for some late renaming bits in last patch.  

Mon May 31 03:27:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/listbox.c, bfu/listbox.h,
	bookmarks/bookmarks.c, config/dialogs.c, config/dialogs.h,
	config/kbdbind.c, config/options.c, cookies/dialogs.c:

	Remove listbox_item->text and only rely on get_info(...,
	LISTBOX_TEXT) calls.  

Mon May 31 02:38:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hierbox.c, hierbox.h:

	Cleanup and remove more code. Common backend moved to header again.
	Macros now wrap it for the folder and leaf adders.  

Mon May 31 02:33:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hierbox.c, listbox.h:

	Remove unused listbox_item->free_empty flag.  

Mon May 31 02:29:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/hierbox.h, cookies/cookies.c:

	add_listbox_item_at_pos() -> add_listbox_leaf(). add_listbox_item()
	now simply wraps add_listbox_leaf().  

Mon May 31 02:24:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hierbox.c, hierbox.h:

	Remove add_listbox_items(). It was a bad interface.  

Mon May 31 02:22:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/hierbox.h, cookies/cookies.c,
	cookies/cookies.h, cookies/dialogs.c:

	Use c_server struct for maintaining the 1st level box items in the
	cookie manager and also to reduce the number of cookie server
	strings to allocate.  

Mon May 31 01:24:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Fix cookie debug code cookie->server is memacpy(uri->host,
	uri->hostlen);.  

Mon May 31 01:21:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Sorry revert last patch. I am gonna use that.  

Mon May 31 01:19:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Outcomment c_servers which is always empty.  

Mon May 31 00:58:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	Add checks using listbox_item->depth. We could maybe just make them
	into assertions.  

Mon May 31 00:51:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: dialogs.c, kbdbind.c, kbdbind.h:

	Bring listbox_ops to keybinding manager. Primarily used for delete
	button. Note it might hurt usability a bit, but now all managers are
	'equally' bad. ;-).  

Sun May 30 23:43:50 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/uri.c:

	Fix a bug that prevented cookies from being sent when requesting /
	on a server.  
	
	In add_uri_to_string, when adding the path or filename to to string, 
	we had these steps: 
	
	 - assign |uri->data| to |filename|; 
	 - decrement |filename|; 
	 - if |filename| does not begin with a '/', add '/' 
	   to the string that will be returned; 
	 - if |uri->datalen| is 0, return the string; and 
	 - further steps to add the path or filename to the string.  
	
	Do not decrement |filename|: this would leave |filename| pointing at
	"/", which would keep the "/" from being added to the return-value, 
	but |uri->datalen| is 0 when the URI refers to /.  Therefore,
	|get_uri_string(uri, URI_PATH);| would return an empty string, which
	the cookie code didn't like.  

Sun May 30 22:56:23 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/cookies/dialogs.c:

	Show the cookie's path in the cookie manager's info window.  

Sun May 30 21:49:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Also assert URI_PATH and URI_FILENAME cases.  

Sun May 30 19:56:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/link.c:

	Only color the actual link text. Handling <a ...><img ..>other
	text</a> correctly would be messy. Reported by Miciah.  

Sun May 30 19:25:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/globhist/dialogs.c:

	Fix a few globhist listbox item text things.  

Sun May 30 18:52:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	Introduce check_keystroke() to improve error handling.  

Sun May 30 18:50:23 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Move code from get_succesful_controls() to
	add_submitted_value_to_list().  

Sun May 30 18:25:51 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	draw_form_entry(): @t -> @term, @l -> @link, cache box->(x|y) -
	vs->(x|y), cleanup.  

Sun May 30 18:12:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/dialogs.c:

	Remove cookie->box_item->root->text updating that obviously didn.t
	work and has been made obsolete by get_info(..., LISTBOX_TEXT).  

Sun May 30 18:06:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: dialogs.c, options.c:

	A few option manager related fixes. Don't translate anymore in
	display_listbox_item(). We do that in get_info() method. And then
	don't rely on listbox_item->text being set.  

Sun May 30 18:02:45 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Minor code simplification in find_form_state().  

Sun May 30 18:01:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/dialogs.c:

	Remove draw_cache_entry_item() and handle it using the get_info()
	op. Still we adding '(POST DATA)' at the end. Should we do that for
	the other get_info() handlers? 

Sun May 30 17:56:54 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Tidy up.  

Sun May 30 17:51:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/listbox.c, bfu/listbox.h, bookmarks/dialogs.c,
	cache/dialogs.c, config/dialogs.c, cookies/dialogs.c,
	dialogs/download.c, formhist/dialogs.c, globhist/dialogs.c,
	protocol/auth/dialogs.c:

	Introduce LISTBOX_TEXT flag for the get_info() function. This will
	lead us to abandon listbox_item->text in the long run but for now
	keybinding dialog needs it. It should fix garbage text shown as the
	cookie folder name (reported by Miciah and me) and also more
	genericly remove post data from globhist manager reported by zas.  

Sun May 30 17:21:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/dialogs.c, cache/dialogs.c, config/dialogs.c,
	cookies/dialogs.c, dialogs/download.c, formhist/dialogs.c,
	globhist/dialogs.c, protocol/auth/dialogs.c:

	switch the listbox_ops->get_info() functions.  

Sun May 30 17:10:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/dialogs.c:

	Wtf get_uri_string(.., ~0); Hey man we have them URI_* things for a
	reason. Use URI_ORIGINAL instead.  

Sun May 30 16:11:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/auth.c:

	Fix patch dated Fri May 21 12:22:14, auth.c (1.80 -> 1.81) and
	http.c (1.289 -> 1.290). Only add auth dialog to question queue if
	we have realm.  

Sun May 30 15:27:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, terminal/window.h:

	Fix bug 176 (Performance waste when resizing w/ multiple tabs open)
	so we schedule resizing and don't redrawing if tabwin_func() is not
	called for the current tab.  

Sun May 30 13:18:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Recalculate the filename length after the URI decoding. This should
	not have been removed in (1.167 -> 1.168).  

Sun May 30 12:42:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, mime/mime.c, mime/mime.h, protocol/uri.c,
	protocol/uri.h, sched/download.c:

	Move add_uri_filename_to_string() to mime/ and rename to
	add_mime_...  

Sun May 30 12:39:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Merge stuff from add_uri_filename_to_string() into the URI component
	framework. Use URI_FILENAME to get it.  

Sun May 30 12:01:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	set_cookie(): Doh. Stupid error. Reported by Stephen Stocker.  

Sun May 30 10:12:26 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun May 30 03:11:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c:

	Rename the tab-move-* actions to tab-move-{left,right} inspired by
	bug 131. Altho' I can get the tab moving to work anymore. :( 

Sun May 30 02:46:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, bookmarks/bookmarks.h,
	config/options.inc, document/html/parser/link.c:

	Add support for coloring bookmarks URIs. It could be quite expensive
	for some people but it's easy to make it optional but adding option
	and extending the check_bookmark_cache() macro to check the option.
	Bookmarks are checked before globhist because bookmarks are more
	'important'. Note that CSS support seems to override any bookmark
	link colors. Again the bookmark color is not cached in
	document_options. Finally a small fix in html_a() adding a dummy if
	(0) so that when neither globhist nor bookmarks are enabled the
	ending 'else' won't get mixed up with the previous if-else
	construct.  

Sun May 30 01:49:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, document/html/parser/link.c:

	Display image links with a distinct colour. Default is
	darkolivegreen but please change it if it is too annoying ;-). Also
	note this is a quick hack. 5 lines. So don't expect any
	document_options caching of the values which btw seems to be normal
	behaviour for image options.  

Sun May 30 00:57:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	normalize_uri(): Unfold the ending '/.' and '/..' cases and handle
	them specialized. Before they stripped also the '/' causing
	unnecessary redirects.  

Sat May 29 19:44:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	end_of_dir(): Is now passed URI struct and uses it to ignore '?' as
	end of dir for file:// URIS. Problem with this was reported by
	Grzegorz Adam Hankiewicz Thu, May 27, 2004 on elinks-users.  

Sat May 29 19:28:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Use get_uri_string(..., URI_PATH); to get path. Even though it means
	an allocation it should be safer since fragments for sure is removed
	and it removes the bad presumption that uri->data[-1] == '/'.  

Sat May 29 19:17:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/css.c, encoding/encoding.c,
	encoding/encoding.h, protocol/file/file.c:

	I am well aware that this is quite a big patch, but the previous way
	to call read_encoded_file() was so damn stupid and I don't know why
	I ever thought about passing the filename in a buffer. Now filename
	is passed using a string struct much cleaner and much safer.  

Sat May 29 19:09:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Whoops. Fix logic and wtf is file:// restricted in
	add_uri_to_string() anyway undone.  

Sat May 29 18:28:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Rewrite the dsep() *hint hint* thing to is_uri_dir_sep(uri, char)
	which wraps dir_sep() more elegantly.  

Sat May 29 18:14:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: user.c, file/cgi.c:

	Use get_uri_string(..., URI_QUERY); and clean things up a bit.  

Sat May 29 18:14:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Introduce URI_QUERY component and cleanup URI_PATH component.  

Sat May 29 17:44:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Use conn->proxied_uri when adding globhist entries.  

Sat May 29 17:42:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Move end_of_dir() to c file.  

Sat May 29 17:37:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	Minor simplification.  

Sat May 29 17:36:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	execute_cgi(): Use get_uri_string(..., URI_PATH); 

Sat May 29 17:29:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/ftp/ftp.c:

	add_file_cmd_to_str(): Use add_uri_to_string(..., URI_PATH); 

Sat May 29 17:23:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Only optionally add '/' 

Sat May 29 17:12:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, protocol/uri.c, protocol/uri.h:

	Introduce URI_PATH component and use it for cookies.  

Sat May 29 16:15:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, viewer/text/link.c, viewer/text/view.c:

	Since we encode URIs internally we have to decode them before
	showing them on the screen. Mentioned in bug 358. Also a little
	curious comment and light cleanup.  

Sat May 29 15:41:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Add TODO items.  

Sat May 29 15:36:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, config/options.inc,
	dialogs/menu.c, dialogs/menu.h, sched/action.c, viewer/text/link.c:

	Add support for passing URIs to external commands filed as bug 124.
	It is really just a mix of URI rewrite and open_in_new_window code.
	Option tree name should be reviewed and whether to execute in fore-
	or background on terminal.  

Sat May 29 14:03:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Pop msg_box() when fragment is missing. Fixes bug 95.  

Sat May 29 13:54:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/link.c, viewer/text/view.c,
	viewer/text/view.h:

	Pass session to draw_doc(). Use term variable in draw_doc(). We
	should start writting out usage of term unless in the very lowlevel
	parts.  

Sat May 29 13:36:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Fix indentation.  

Sat May 29 13:33:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	With the newly introduced get_validated_cache_entry() bug 304 ("Do
	you want to post form data to URL" when cloning tab) should be
	fairly easy to fix by simple doing the same check that load_uri()
	will do to see if the existing cache entry can be 'reused'. Note
	this had me fooled at first because I have WWW_HOME set which is
	loaded in the background and I was so used to having the confirm
	post submit dialog load the 'post'-document of the cloned session.  

Sat May 29 13:26:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Fix comments.  

Sat May 29 13:21:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, sched/connection.c:

	Move the cache entry checking in load_uri() to separate function.
	The fact that it 'mangles' the cache makes it a bit more
	complicated. This is one of the scariest part of the code and
	putting it in a function should hopefully make it either more clear.
	Please check the logics.  

Sat May 29 11:38:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Make tabwin_func sanity checking related to bug 296 into an
	assertion.  

Sat May 29 04:25:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	formhist/dialogs.h, protocol/auth/auth.c, protocol/auth/auth.h,
	protocol/auth/dialogs.c, protocol/auth/dialogs.h, sched/action.c:

	Skeleton for HTTP Auth manager.  

Sat May 29 03:40:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	Fix bad dereference.  

Sat May 29 02:44:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: history.c, task.c, task.h:

	Remove two args to ses_goto() that is always the same: The priority
	(PRI_MAIN) and end handler (end_load).  

Sat May 29 02:28:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Initialize form control list in the declaration.  

Sat May 29 02:26:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Initialize post data string in get_form_uri() and fix possible leak
	if @go initialization failed.  

Sat May 29 01:08:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	encode_text_plain(): Cleanup and make the code more compact but more
	commented.  

Sat May 29 00:53:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, document/html/parser/forms.c,
	protocol/user.c, viewer/text/form.c, viewer/text/form.h:

	Add support for saving form data to temporary file that can be
	included from external handlers.  It also adds (crappy) support for
	<form enctype="text/plain">.  
	
	This should kind of fix bug 450 although there are probably a few
	things to improve: 
	1) The form data file is always created.  
	2) I don't know if it is correct to use \r\n for each encoded form
	line.  

Sat May 29 00:45:50 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Get rid of many labels/gotos by introducing add_boundary().  

Sat May 29 00:45:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: util/file.c, util/file.h, viewer/text/textarea.c:

	Introduce get_tempdir_filename() and use it in textarea_edit().  

Fri May 28 23:44:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/user.c:

	subst_cmd(): Various fixes related to 450 so that for example
	POST_CHAR + post data is not addes as subject and not for %u
	substitution either.  

Fri May 28 23:43:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	get_current_url(): Use get_real_uri_length() and rewrite it a little
	too.  

Fri May 28 23:42:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	get_real_uri_length(): Takes URI struct and returns the 'no post
	length'.  

Fri May 28 23:34:14 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri May 28 21:18:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_uri(): Take URI port into consideration when calculating
	the offset where to add the missing host slash.  

Fri May 28 21:16:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.h, sched/connection.c:

	Don't know if it is worth it but factor out host length calculation
	to get_uri_hostlen().  

Fri May 28 20:19:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Changed protocol.http.referer.policy default from 1 to 3. Another
	user just got burnt by that (thanks to dsuch for an impuls), so
	let's be RFC compliant for once! 

Fri May 28 18:39:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/options.c:

	comare_opt(): Compare x and y members. This is as far as I recall
	the old behaviour. Before I moved the x and y members of document
	options so they would not be compared. I did that out of ignorance.
	This I fully regret. Fixes bug 452.  

Fri May 28 17:35:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Clearify uri->form usage instead of uri->post.  

Fri May 28 16:51:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Fix confirm submit URI string. Now it uses the URI_PUBLIC class.  

Fri May 28 16:50:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.h, sched/task.c, viewer/text/form.c:

	Check if ses->referrer is incomplete when posting stuff. The patch
	adds a new URI flag named 'form' which is set by get_form_uri(), it
	is needed because uri->post might be empty.  

Fri May 28 16:37:08 2004  Laurent Monin <zas@norz.org>:

	* ABOUT-NLS, doc/color-model.txt:

	Remove trailing spaces.  

Fri May 28 15:43:00 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: listmenu.c, text.c:

	Drop trailing spaces.  

Fri May 28 15:40:39 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/listmenu.c:

	Cache and assert (@order - 1).  

Fri May 28 15:40:04 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/text.c:

	Code simplification.  

Fri May 28 13:42:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/: dcigettext.c, dgettext.c, dngettext.c,
	gettext.c, ngettext.c:

	Always include locale.h via the libgnuintl.h. Fixes compilation of
	solaris.  

Fri May 28 13:02:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/: bzip2.c, encoding.c, encoding.h, gzip.c:

	Revert putting the extensions in the encoding backend. Older gcc
	don't like it.  

Fri May 28 11:57:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* autogen.sh:

	Revert bad things.  

Fri May 28 11:55:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* autogen.sh, configure.in, src/encoding/Makefile.am,
	src/encoding/bzip2.c, src/encoding/bzip2.h,
	src/encoding/encoding.c, src/encoding/encoding.h,
	src/encoding/gzip.c, src/encoding/gzip.h:

	Split up encoding backends.  

Thu May 27 12:54:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Fix buggy reference counting breaking URI list stuff.  

Thu May 27 12:19:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h, task.c:

	Revert goto_rewritten_uri(). It broke to many things to fix easy.  

Wed May 26 21:31:01 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Fix a bug in not_so_hot_keys scrolling in goto url history scrolling
	introduced in rev 1.184: list didnt scroll on first key press as it
	should when list was greater than terminal height.  

Wed May 26 21:12:37 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hotkey.c:

	Tidy up.  

Wed May 26 20:40:44 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hotkey.c:

	Cache *used - 1 since it is used 3 times.  

Wed May 26 20:35:28 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	Indentation fixes.  

Wed May 26 17:25:03 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/checkbox.c:

	Tidy up.  

Wed May 26 16:43:31 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/widget.h:

	Comment gid and gnum fields of "checkbox" widget.  

Wed May 26 16:37:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h, task.c:

	get_rewritten_uri(): Introduced. Basicly it envokes the goto-url
	event and get_uri()s it.  

Wed May 26 16:35:58 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/checkbox.h:

	Code redundancy was reduced regarding add_dlg_radio() and
	add_dlg_checkbox().  

Wed May 26 16:32:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	import_css_stylesheet(): Use get_translated_uri() so that #fragments
	are removed.  

Wed May 26 16:22:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.c, document/document.h,
	document/css/css.c, document/css/css.h, document/html/parser.c,
	document/html/renderer.c, protocol/uri.c, protocol/uri.h,
	sched/session.c:

	Add support for real URI lists and make document->css_imports use
	it.  

Wed May 26 14:53:33 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed May 26 13:59:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: opttypes.c, opttypes.h:

	Remove unused option_type_info->remove function and make
	option_types[] const.  

Wed May 26 13:45:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: cmdline.c, conf.c, options.h:

	Introduce --verbose stuff to silent config loading.  

Wed May 26 13:00:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	Only autocreate 256 color options when needed.  

Wed May 26 10:34:54 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/form.c:

	Comments about field names and values currently missing correct
	encoding were added.  

Wed May 26 07:54:12 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Random tidyup: use width,height instead of x,y where applicable,
	rename resize_term_x() to resize_term_from_str().  

Tue May 25 23:06:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	write_ev_queue(): Random cleanup.  

Tue May 25 23:00:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Make process_queue() static and fix comment.  

Tue May 25 22:56:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Alphabetize includes.  

Tue May 25 18:08:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/encoding.c:

	SSL is now nicely contained, so remove header defence.  

Tue May 25 18:05:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/color.c:

	Whoops. What is COLOR_MODE_DUMP doing there it is not for stuff like
	that.  

Tue May 25 17:40:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix to use CONFIG_IDN.  

Tue May 25 17:39:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: osdep.c, unix/sysinfo.h, unix/unix.c:

	Fix to use CONFIG_GPM.  

Tue May 25 17:35:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: encoding/encoding.c, modules/version.c,
	protocol/http/http.c:

	Use CONFIG_GZIP and CONFIG_BZIP2 instead of *_H variants. Reported
	by Stephane CHAZELAS.  

Tue May 25 17:34:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_CHECK_OPTIONAL_LIBRARY(): #define CONFIG_* macros.  

Tue May 25 16:47:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/: bindtextdom.c, dcgettext.c, dcigettext.c,
	dcngettext.c, dgettext.c, dngettext.c, explodename.c, finddomain.c,
	gettext.c, gettextP.h, intl-compat.c, l10nflist.c, loadmsgcat.c,
	localealias.c, ngettext.c, plural.c, textdomain.c:

	Normalize subdir includes by specifying the complete path. This
	should hopefully fix libintl.h inclusion conflicting with system
	libintl.h .. I thought I already fixed this on another solaris box
	but Stephane Chazelas reported it May 11 2004 on elinks-dev.  

Tue May 25 16:29:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, config/options.inc, terminal/color.c,
	terminal/color.h, terminal/screen.c:

	Make the option system with its tremendous min/max value ensurance
	guard us against malicious values in term->spec->color_mode. Me
	thinks that is where it belongs, plus this completely wipes _all_
	traces of 256 color support when disabled oh and then it is less
	code too ;) 

Tue May 25 15:07:10 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/: date.c, date.h:

	date.{c,h} were removed.  

Tue May 25 07:14:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: action.c, session.c, task.c, task.h:

	Move goto_url_home() to task file. Merge in get_homepage_url().  

Tue May 25 06:54:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: search.c, view.c, view.h:

	Use goto_current_link() in do_typeahead() and
	text_typeahead_handler(). Remove send_enter().  

Tue May 25 06:46:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	save_as(): Make it into a frame action.  

Tue May 25 06:38:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, viewer/text/view.c, viewer/text/view.h:

	Move save_url() closer to save_url_as().  

Tue May 25 04:48:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bookmarks/bookmarks.c, dialogs/menu.c,
	dialogs/menu.h, sched/session.c, terminal/tab.c, terminal/tab.h:

	Revert the last 4 patches. I hate this crap.  

Tue May 25 04:20:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/session.c:

	open_url_in_new_window(): Take URI struct as arg.  

Tue May 25 04:17:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	process_session_info(): Use URI struct in the url_list loop.  

Tue May 25 04:13:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bookmarks/bookmarks.c, sched/session.c,
	terminal/tab.c, terminal/tab.h:

	open_url_in_new_tab(): Take URI struct as arg.  

Tue May 25 04:03:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/hierbox.c:

	get_listbox_uri() introduced.  

Tue May 25 03:52:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser.c, document/html/parser.h,
	sched/task.c:

	Pass session->imgmap_href_base as URI struct all the way down the
	call path.  

Tue May 25 03:45:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	uri->protocol_str -> uri->string.  

Tue May 25 03:40:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.h, sched/session.c:

	Last user of get_cache_uri_string() looks bogus too so remove it
	completely.  

Tue May 25 03:37:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: parser.c, parser.h, renderer.c:

	Push the cache_entry URI all the way down to init_html_parser() even
	if the cache entry is incomplete making it easier to track the URI
	and finally fix the old behaviour so that the href_base is always
	properly initialized.  

Tue May 25 01:19:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, viewer/text/view.c:

	Never ever do we want to struri() something headed for follow_url().  

Tue May 25 01:00:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/task.c, sched/task.h,
	viewer/text/link.c:

	goto_url_frame(): Take URI arg. Damn I forgot to rename it ;(.  

Tue May 25 00:55:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/task.c, sched/task.h,
	viewer/text/link.c:

	Merge goto_url_frame() and goto_url_frame_reload() by adding an
	extra enum cache_mode arg to to former.  

Tue May 25 00:48:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, link.c, link.h:

	goto_link() -> goto_current_link() and now graps current links from
	passed doc_view.  

Tue May 25 00:28:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, link.h:

	goto_link(): Return type changed to void. Nothing can go wrong in
	there.  

Tue May 25 00:26:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, sched/task.c,
	sched/task.h, viewer/text/link.c:

	session->imgmap_href_base changed to be a URI struct. goto_imgmap()
	now takes URI struct.  

Tue May 25 00:19:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, link.c, link.h:

	goto_link(): Now takes URI struct.  

Tue May 25 00:16:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, form.h, link.c:

	get_form_url() -> get_form_uri() and now returns URI struct.
	get_link_url() was merged into get_link_uri().  

Tue May 25 00:08:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, link.c:

	Let the caller of goto_link() free the URL.  

Mon May 24 23:59:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, link.h:

	get_link_url(): Make it static.  

Mon May 24 23:57:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	open_current_link_in_new_tab(): What a long name .. anyway use
	get_link_uri().  

Mon May 24 23:52:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Let.s get the ball rolling. Use get_link_uri() in
	open_url_in_new_window().  

Mon May 24 18:18:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Be smart? and save one line so we only have ~79239 ;-) 

Mon May 24 18:06:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/event.c:

	Use struct terminal_info when reading EV_INIT data. It removes all
	those ugly offset calculations. decode_session_info() now takes
	length and data pointer.  

Mon May 24 18:05:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.h, kbd.c, terminal.h:

	Introduce struct terminal_info that holds all the stuff sent over
	the interlink. It makes it possible to batch all the queue stuff
	together.  

Mon May 24 17:29:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	handle_trm(): Use stack allocated buffer for writing the cwd so
	queue_ts() can be removed.  

Mon May 24 17:23:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	handle_trm(): Use stack allocated buffer for writing the TERM env
	variable so we can bypass queue_ts() that allocated cleared memory
	so MAX_TERM_LEN chars are always written.  

Mon May 24 13:12:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.h:

	end_token_scanning(): Allow @end to be <= scanner->table.
	scanner->tokens will become <= 0 meaning empty. Triggered by empty
	<style>-tags. Reported by sstar.  

Mon May 24 09:02:21 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon May 24 02:30:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, viewer/text/form.c, viewer/text/form.h:

	Introduce auto_submit_form() that uses submit_form() as backend and
	make doc_end_load() use it.  

Mon May 24 01:55:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, link.h, view.c:

	Introduce get_link_uri() that for now just wraps
	get_uri(get_link_url()).  

Mon May 24 01:43:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	download_link(): Remove map@-URL left over. LINK_MAP URL are now
	downloadable don't know if it is correct.  

Mon May 24 00:52:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_to_string(): Add POST_CHAR before adding post data. The bug
	was triggered by proxy related changes lately. Patch kindly donated
	by Zardoz.  

Sun May 23 17:13:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.h, document/html/renderer.c,
	sched/session.c, viewer/dump/dump.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/link.h, viewer/text/search.c:

	Introduce LINK_MAP link->type. It removes the 'map@' prefix from
	anything but the document/html parser and renderer. All places that
	depended on LINK_HYPERTEXT now also depends on LINK_MAP (it should
	maybe be reviewed more carefull).  

Sun May 23 16:58:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.h, document/html/renderer.c,
	sched/session.c, viewer/text/form.c, viewer/text/link.c,
	viewer/text/link.h, viewer/text/search.c:

	Revert LINK_MAP introduction.  

Sun May 23 16:56:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.h, document/html/renderer.c,
	protocol/uri.c, sched/session.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/link.h, viewer/text/search.c:

	Fix issue concerning uri->ipv6 setup.  

Sun May 23 15:47:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	s/--dump/-dump/ in the description for -no-numbering. We use one
	dash for all the other descriptions. Reported by by sstar.  

Sun May 23 15:43:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Disable keybinding translation. It is not correct in it's current
	form. Reported by sstar.  

Sun May 23 14:51:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Distribute the base URL to _all_ members of the HTML stack.
	Apparently the stack layout has changed. Maybe the unfinished title
	tag fix did it.  

Sun May 23 14:15:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Limit uri->portlen to 8 bits and use the 8 spare bits to flags such
	as ipv6.  

Sun May 23 02:39:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, protocol/uri.h, sched/download.c,
	sched/history.c, sched/session.c, sched/task.c:

	Wrap URI comparing in macro.  

Sun May 23 01:31:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS, configure.in, src/lowlevel/connect.c, src/protocol/proxy.c,
	src/protocol/uri.c, src/protocol/uri.h:

	Whee .. internationalized domain name is now available. The real
	magic is done in add_uri_to_string(). Only lowlevel stuff (like DNS
	queries and proxy assembling) uses it so it is quite simple
	actually. The proxy stuff is untested (as usual).  

Sat May 22 19:27:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, protocol/date.c, protocol/date.h,
	protocol/http/date.c, sched/download.c:

	parse_http_date() -> parse_date() 

Sat May 22 19:20:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.h:

	Normalize header.  

Sat May 22 19:15:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix xbel configuration spotted by pasky.  

Sat May 22 18:48:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/gettext/: plural.c, plural.y:

	Compilation fix. I wonder how were you able to build it? 

Sat May 22 13:44:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c, ssl/connect.h:

	ssl_write(): Take data + len args instead of write buffer.  

Sat May 22 13:18:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/dialogs.c, config/options.inc, cookies/cookies.c,
	cookies/dialogs.c:

	Make the UI date format configurable. Closes my part of bug 448.  

Sat May 22 13:12:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/: conv.c, conv.h:

	Wrap add_date_to_string() in #ifdef HAVE_STRFTIME.  

Sat May 22 13:06:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/dialogs.c, cookies/cookies.c, cookies/dialogs.c,
	protocol/file/file.c, util/conv.c, util/conv.h:

	Introduce add_date_to_string() and use it to wrap buffered
	strftime() calls.  

Fri May 21 15:33:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.h:

	Whoops. DOM has not been merged yet ;) 

Fri May 21 13:44:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, util/scanner.h:

	Move generic token scanning handling to begin and end rutines.  

Fri May 21 12:43:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/backend/mimetypes.c:

	Doh! elinks.h includes setup.h ;) 

Fri May 21 12:29:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, config/m4/features.m4:

	Move macros to m4/.  

Fri May 21 12:22:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: auth/auth.c, http/http.c:

	Minor simplification. Make add_auth_entry() register the auth dialog
	in the question queue.  

Fri May 21 12:04:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	Remove unneeded #ifdefs 

Fri May 21 12:03:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, protocol/Makefile.am,
	protocol/file/Makefile.am:

	Hurrah! Link file and cgi objects into libprotocol and conditionally
	build cgi object.  

Fri May 21 11:57:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/css.c, encoding/encoding.c,
	encoding/encoding.h, protocol/file/file.c, protocol/file/file.h:

	Pretty ugly patch that moves read_encoded_file() to encoding/ which
	I think makes sense but maybe a better interface for reading local
	files without connection_state being needed would be great.  

Fri May 21 11:46:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, protocol/Makefile.am:

	Links in auth objects in the libprotocol archive.  

Fri May 21 11:39:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, cookies/cookies.c, dialogs/document.c,
	document/renderer.c, document/html/parser.c, mime/mime.c,
	protocol/Makefile.am, protocol/http/Makefile.am,
	protocol/http/date.c, protocol/http/date.h, protocol/http/header.c,
	protocol/http/header.h, protocol/http/http.c, sched/download.c:

	Move header and date library to protocol/ so http objects can be
	linked into libprotocol.a and http support could even be optional.  

Fri May 21 11:38:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: date.c, date.h, header.c, header.h:

	Prepare to move prototol/http header and date files to protocol/.
	Pasky to keep the history just cp it from protocol/http/Attic/ ASAP
	and it should be fine I hope.  

Fri May 21 11:21:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser.c, document/html/renderer.c,
	document/html/parser/forms.c, document/html/parser/parse.c,
	document/plain/renderer.c, intl/charsets.c, intl/charsets.h,
	viewer/text/form.c:

	Make it possible to pass int pointer to convert_string() that will
	be set to the new length.  

Fri May 21 11:11:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/: charsets.c, charsets.h:

	No need for us to suffer more than needed. Let the macro rename
	convert_string to convert_string_elinks.  

Fri May 21 10:54:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: renderer.c, renderer.h, html/parser.c,
	html/renderer.c, html/renderer.h, plain/renderer.c:

	Move get_convert_table() to generic document renderer file.  

Thu May 20 23:02:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/dialogs.c:

	get_cookie_info(): Simplify expire info adding.  

Thu May 20 21:35:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Update exmode description.  

Thu May 20 12:49:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, bookmarks/dialogs.c,
	formhist/formhist.c, globhist/dialogs.c, globhist/globhist.c,
	protocol/rewrite/rewrite.c, protocol/smb/smb.c,
	scripting/scripting.c, scripting/guile/core.c,
	scripting/guile/hooks.c, scripting/lua/core.c,
	scripting/lua/hooks.c, scripting/perl/core.c,
	scripting/perl/hooks.c, ssl/connect.c, ssl/ssl.c:

	Remove unneeded #ifdefs 

Thu May 20 12:42:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/leds.c, dialogs/exmode.c, mime/backend/mailcap.c,
	mime/backend/mimetypes.c:

	Remove unneeded #ifdefs 

Wed May 19 16:09:05 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon May 17 10:47:03 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Fix bad move causing crash on diku.dk.  

Mon May 17 10:38:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/Makefile.am:

	Oops s/rect.h/box.h 

Sun May 16 14:34:13 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	Bad move was fixed.  

Sun May 16 14:27:15 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@c -> @cell, @sc -> @span_cell.  

Sun May 16 14:13:28 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@wf -> @has_width. Correspondant field in struct table was commented
	out since it is unused.  

Sun May 16 14:08:32 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	struct table @rh field was renamed @real_height.  

Sun May 16 14:04:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	struct table @rw field was renamed @real_width.  

Sun May 16 14:01:17 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@p -> @part.  

Sun May 16 13:57:32 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@t -> @table.  

Sun May 16 13:14:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Group @part and code using it.  

Sun May 16 13:08:29 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@p -> @part.  

Sun May 16 13:03:59 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	struct table @p field was renamed @part.  

Sun May 16 12:57:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: renderer.c, renderer.h, tables.c:

	Use struct box in struct part.  

Sun May 16 12:40:34 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Drop useless white lines.  

Sun May 16 12:13:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.h:

	Remove (now) useless declaration of struct download.  

Sun May 16 12:11:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/: dump.c, dump.h:

	Make dump_start() and dump_end() static and move dump_pre_start()
	below them so they don't have to be declared.  

Sun May 16 11:41:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Better initialize events before main_modules if one should ever want
	to register hooks.  

Sun May 16 10:29:18 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	Invisible text in textarea was fixed (bug 454). This was due to
	inverted tests introduced in rev 1.51.  

Sat May 15 23:40:13 2004  Laurent Monin <zas@norz.org>:

	* src/intl/: charsets.c, charsets.h:

	Name clash with Samba should be fixed. Filed as bug 453, reported by
	Derek Poon.  

Sat May 15 17:20:14 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	is_in_box() doesn't work here. Revert part of rev 1.163 patch to fix
	the bug concerning not clickable links on first line of document.
	Need more work.  

Fri May 14 14:59:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	Don't allow empty names when adding options. Mentioned by sstar.  

Fri May 14 11:39:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Elaborate on CONFIG_MARKS description.  

Fri May 14 11:39:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/leds.c:

	Oops get the correct static option for get_leds_clock_format().  

Fri May 14 10:24:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/window.c:

	Pass references of the windows x and y members directly to
	get_parent_ptr().  

Fri May 14 10:19:19 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: link.c, view.c:

	Revert last "fix", it was not one.  

Fri May 14 10:12:01 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: link.c, view.c:

	Clicking on links on first line of document was broken. It should
	now be fixed.  

Fri May 14 09:32:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: dialog.c, group.c:

	Fix indentation of set_box().  

Fri May 14 08:49:07 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/inpfield.c, bfu/menu.h, dialogs/status.c,
	document/renderer.c, document/html/frames.c,
	document/html/tables.c, util/memdebug.c, viewer/text/form.c,
	viewer/text/search.c, viewer/text/view.c:

	Trailing spaces cleanup.  

Fri May 14 08:42:09 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c:

	Fix incorrect change introduced in rev 1.46: not document->options
	but doc_view 

Fri May 14 00:43:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/options.c, document/options.h,
	document/renderer.c, document/html/frames.c,
	document/html/parser.c, document/html/renderer.c,
	document/html/parser/forms.c, document/plain/renderer.c,
	viewer/dump/dump.c, viewer/text/view.c:

	Use struct box for struct document_options.  

Fri May 14 00:18:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/dialog.c, bfu/dialog.h,
	bfu/group.c, bfu/inpfield.c, bfu/listbox.c, bfu/menu.c, bfu/menu.h,
	bfu/text.c, bfu/widget.c, bfu/widget.h, dialogs/download.c,
	dialogs/status.c, document/document.h, document/renderer.c,
	document/view.h, document/html/frames.c, document/html/frames.h,
	document/html/parser.c, document/html/renderer.c,
	document/html/tables.c, document/plain/renderer.c, terminal/draw.c,
	terminal/draw.h, util/box.h, util/rect.h, viewer/text/form.c,
	viewer/text/link.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c:

	s/dimensions/box/ && s/rect/box/ 

Thu May 13 20:40:06 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/menu.c, terminal/draw.c, terminal/draw.h:

	draw_area() -> draw_box(), draw_border_box() -> draw_border(),
	draw_shadow_box() -> draw_shadow().  

Thu May 13 20:31:24 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Use draw_border_box().  

Thu May 13 13:26:01 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/menu.c, terminal/draw.c, terminal/draw.h:

	draw_border_box() was introduced, it is now used by menus.  

Thu May 13 09:33:22 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.c:

	Use draw_box() instead of draw_area().  

Thu May 13 09:22:50 2004  Laurent Monin <zas@norz.org>:

	* src/: viewer/text/view.c, dialogs/download.c:

	Use draw_box() instead of draw_area().  

Thu May 13 09:15:38 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/text.c:

	Use draw_box() instead of draw_area().  

Thu May 13 09:08:06 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: menu.c, inpfield.c, listbox.c:

	Use draw_box() instead of draw_area().  

Thu May 13 09:07:44 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Use draw_box() instead of draw_area(), and use draw_shadow_box().  

Thu May 13 09:06:32 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/: draw.c, draw.h:

	Draw_box() and draw_shadow_box() were introduced.  

Thu May 13 01:29:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Peek at $enable_xbel and do all the expat checking _before_
	CONFIG_XBEL_BOOKMARKS is set up so it can depend properly on it and
	report the correct value to the feature log.  

Thu May 13 01:08:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/Makefile.am:

	Fix trailing \ in last patch.  

Thu May 13 00:53:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/Makefile.am:

	Only add scanner object if building with CSS support.  

Thu May 13 00:19:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf, src/main.c, src/sched/session.h,
	src/viewer/text/Makefile.am, src/viewer/text/view.c:

	Make document marks optional.  

Wed May 12 19:43:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Mention pasky's ode to the almighty bookmarks.  

Wed May 12 19:35:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Mention doc/small.txt in CONFIG_SMALL description.  

Wed May 12 15:08:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* .cvsignore, Makefile.am, configure.in:

	Log the feature summary to features.log file. It ensures settings
	for all features are shown and simplifies the code plus the file
	might be useful for someone.  

Tue May 11 23:22:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Move a few cleanup functions to the 'init_b' sequence. They should
	all be empty when running in client mode.  

Tue May 11 19:45:23 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/text.c:

	Fix scrollable text widget.  

Tue May 11 19:23:17 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/group.c:

	Fix wrong widget dimensions, revealed by broken radio buttons
	changing in search dialog.  

Tue May 11 18:43:37 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	Fix bad move introduced in rev 1.163. Mouse click detection on
	certain links was broken.  

Tue May 11 17:50:40 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Italian translation update.  

Tue May 11 14:59:10 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	new_table(): set rx,ry,real_columns_count only if table was
	successfully allocated.  

Tue May 11 14:56:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	new_columns(): tidy up.  

Tue May 11 14:50:08 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	new_table(): really allocated values (rx,ry,real_columns_count)
	should not be changed before allocation attempts.  

Tue May 11 14:45:52 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Field @rc of struct table was renamed @real_columns_count.  

Tue May 11 13:00:21 2004  Laurent Monin <zas@norz.org>:

	* configure.in:

	Use AC_CHECK_FILE macro to test for features.conf file, "test -e" is
	not portable. Issue pointed out by Stephane Chazelas.  

Tue May 11 09:56:22 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/frames.h:

	Unused field @line was removed from struct frame_desc.  

Tue May 11 09:32:59 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/frames.c, document/html/frames.h,
	document/html/parser.c, viewer/text/view.c:

	Use struct rect in struct frameset_desc.  

Mon May 10 23:12:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, protocol/Makefile.am:

	Merge ftp objects in the protocol/ dir.  

Mon May 10 17:15:22 2004  Laurent Monin <zas@norz.org>:

	* src/: dialogs/status.c, document/renderer.c, document/view.h,
	document/html/frames.c, util/rect.h, viewer/text/form.c,
	viewer/text/link.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c:

	Use struct rect in struct document_view, changes were made
	accordingly with the help of two new little helpers:
	(row|col)_is_in_rect().  

Mon May 10 15:34:32 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/checkbox.c:

	Use struct rect, set_rect() and is_in_rect().  

Mon May 10 15:15:03 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/button.c:

	display_button(): use struct rect * and precalculated label length
	value instead of strlen( ) call.  

Mon May 10 12:56:13 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/dialog.c, bfu/group.c, bfu/inpfield.c,
	bfu/listbox.c, bfu/menu.c, bfu/text.c, document/html/renderer.c,
	document/html/tables.c, document/plain/renderer.c, util/rect.h:

	Convert set_rect() and is_in_rect() macros to static inline
	functions.  

Mon May 10 05:17:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Drop the 'support' word for the configuration summary.  

Mon May 10 01:51:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.h, document/html/renderer.c,
	document/html/tables.c, document/plain/renderer.c,
	viewer/text/search.c:

	Use struct rect in struct node. I propose to rename it box though it
	is shorter and a bit more descriptive IMO.  

Sun May  9 23:33:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, sched/connection.h, sched/error.c:

	A little advertisement shouldn't hurt anyone so pop up 'this version
	does not support ... protocol' message for finger and smb. Or is
	this too bloated\? 

Sun May  9 23:04:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf, src/protocol/Makefile.am,
	src/protocol/finger.h:

	Make finger protocol support optional. Maybe it should be disabled
	by default since I don't think so maybe people use it and it more
	serves as a protocol implementation reference.  

Sun May  9 22:27:36 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: menu.c, menu.h:

	Use struct rect in struct menu.  

Sun May  9 21:46:23 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/widget.h, util/Makefile.am, util/rect.h:

	Add util/rect.h and move struct rect related stuff to it.  

Sun May  9 21:38:41 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Fix set_rect() call.  

Sun May  9 21:17:12 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/dialog.h, bfu/group.c, bfu/text.c,
	dialogs/download.c:

	Use struct rect in struct dialog_data.  

Sun May  9 01:18:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/auth.c:

	Semi-fix the HTTP auth related crash caused by http_send_header()
	being called more times than before [from run_connection()] instead
	of select_loop() which means more find_auth() calls that would end
	up free()ing the entry and the dialog accessing freed memory.  
	
	I still don't know when the call pattern to changed and auth is
	still pretty broken since I had to type user/password twice.  

Sun May  9 00:59:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/: auth.c, auth.h:

	Allocate http_auth_basic->{user,password} as part of the struct.  

Sun May  9 00:56:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Make connected() static.  

Sat May  8 13:40:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memdebug.c:

	Include the full copyright header here because this file can be
	frequently distributed separately from the rest of ELinks.  

Sat May  8 01:18:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, util/scanner.c, util/scanner.h:

	Make scanner mapping and scan table info const.  

Sat May  8 01:17:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Make exmode handler table const.  

Fri May  7 23:33:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix adding of -Werror when CONFIG_DEBUG is set.  

Fri May  7 18:14:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Undent the code.  

Fri May  7 18:05:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Move unknown_protocol_handler closer to the user and rename to
	generic_external_protocol_handler.  

Fri May  7 18:01:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Remove protocol_backend->external_handler member since it is now
	only user or unknown handler so this is less bloated IMO.  

Fri May  7 17:53:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h:

	Move struct protocol_backend to .c file.  

Fri May  7 17:47:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: Makefile.am, https.c, https.h:

	Only conditionally build HTTPS else simply #define the HTTPS
	protocol handler to NULL like SMB does and let the generic unknown
	protocol handler do the work.  

Fri May  7 17:40:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Use common handler for unknown and javascript protocol backend.
	Prepare for HTTPS backend to use it as well.  

Fri May  7 17:36:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	If both external and regular protocol handler is NULL return the
	unknown protocol handler so that disabled (but otherwise known)
	protocols can use a common handler.  

Fri May  7 17:31:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/https.c:

	Fix HTTPS building.  

Fri May  7 17:30:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h:

	Move the lua protocol backend last so it doesn't match user:// URIs
	and cause assertion failures. Hope this doesn't break anything? 

Fri May  7 17:27:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: finger.c, finger.h, protocol.c, user.c, user.h,
	file/file.c, file/file.h, ftp/ftp.c, ftp/ftp.h, http/http.c,
	http/http.h, http/https.c, http/https.h, smb/smb.c, smb/smb.h:

	Centralize protocol_backends again. It makes more sense when
	building with conditionals.  

Fri May  7 16:32:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Only check for expat and link with -lexpat when needed. Reported by
	fredlwm.  

Fri May  7 12:28:40 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/text.c:

	Use set_rect().  

Fri May  7 12:21:20 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/listbox.c:

	Use set_rect() and is_in_rect().  

Fri May  7 12:15:40 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: group.c, inpfield.c:

	Use set_rect() and is_in_rect().  

Fri May  7 11:24:20 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, group.c, inpfield.c, listbox.c,
	text.c, widget.c, widget.h:

	Struct rect was introduced, as well as convenience macros set_rect()
	and is_in_rect(). It is currently used by struct widget_data only.  

Fri May  7 09:05:59 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri May  7 08:58:27 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	Comment out HTML_ATTR_NO_CONV stuff since it is not used yet.  

Fri May  7 08:55:31 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	get_attr_val(), get_url_val() and has_attr() are now macros wrapping
	get_attr_value() calls.  

Fri May  7 08:49:31 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	Declare and describe get_attr_value() in parse.h.  

Fri May  7 08:45:35 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	get_attr_val_() was renamed get_attr_value().  

Fri May  7 08:42:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	enum html_attr_flags was introduced to control get_attr_val_()
	behavior.  

Fri May  7 01:46:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h, smb/smb.h:

	Move macro conditions for SMB protocol backend to smb header.  

Thu May  6 23:50:05 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	Previous patch was a commit error. Sorry....  

Thu May  6 23:39:37 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	enum gav_flags was introduced, and is now used by get_attr_val_(),
	it is now possible to disable conversion though convert_string(). It
	may help to fix bug 451.  

Thu May  6 22:35:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* config/m4/gettext.m4, src/intl/Makefile.am:

	If --disable-nls don't enter src/intl/gettext 

Thu May  6 22:06:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Fix keybinding toggling that was broken by the int <-> void *
	removal.  

Thu May  6 15:32:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/finger.c:

	Rearrange functions so it is not necessary to declare any.  

Thu May  6 15:26:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix typo.  

Thu May  6 14:39:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/options.c:

	Use get_cp_mime_name() instead of get_cp_name() as the name key for
	the charset menu.  

Thu May  6 14:39:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/charsets.c:

	Use N_CODEPAGES and remove define of CODEPAGES.  

Thu May  6 00:15:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Add header to the config pretty printing area.  

Thu May  6 00:14:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* INSTALL, NEWS, README, THANKS:

	Capital letter files got aspelled.  

Wed May  5 17:52:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	More CONFIG_CSS tuning.  

Wed May  5 12:39:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	m11p 

Wed May  5 12:37:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Don't assume anything is simple, elaborate on CONFIG_CSS
	description.  

Wed May  5 12:26:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	More CONFIG_CSS stuff.  

Tue May  4 11:45:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: options.c, options.h:

	Don't get CSS options if it is disabled.  

Tue May  4 10:50:08 2004  Laurent Monin <zas@norz.org>:

	* src/: dialogs/info.c, util/memdebug.c, util/memdebug.h:

	Count and show memory truly allocated (including memory used by
	memory debug itself).  

Tue May  4 07:55:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf, src/document/Makefile.am,
	src/document/html/parser.c, src/document/html/parser/link.c,
	src/document/html/parser/parse.c, src/modules/module.c:

	Make CSS optional.  

Tue May  4 01:48:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	Avoid int <-> void * conversion by passing strtonum pointers ... ok
	this is getting too ugly so I will stop this now besides it is
	passed my bedtime.  

Tue May  4 01:46:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/: menu.c, menu.h:

	Yucky hacks to fix compile errors >:).  

Tue May  4 01:43:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	make 

Tue May  4 01:22:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/: menu.c, menu.h:

	Avoid int <-> void * conversion by passing the open_in_new pointer
	instead of term_env enum.  

Tue May  4 01:21:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/options.c:

	Avoid int <-> void * conversion by passing the codepage name and
	looking up the index.  

Tue May  4 01:10:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, util/scanner.c, util/scanner.h:

	Avoid int <-> void * conversion by storing the start of the a
	scanner table range in a string. A bit ugly but ...  

Tue May  4 01:08:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/charsets.c:

	Make @strings static.  

Tue May  4 00:55:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/charsets.c:

	Avoid int <-> void * conversion by storing the codepage_desc pointer
	as the fastfind data.  

Mon May  3 23:04:08 2004  Laurent Monin <zas@norz.org>:

	* src/cache/dialogs.c:

	Add a space before ... when url is truncated, it is less ambiguous.  

Mon May  3 22:57:42 2004  Laurent Monin <zas@norz.org>:

	* src/cache/dialogs.c:

	draw_cache_entry_item() was added to display only "public" parts or
	uri in cache manager. Post data do not appear as is, but an
	indication is left to user in the form of " (POST DATA)" aooended to
	uri string. Password info will be hidden too. It fixes bug 445.  

Mon May  3 21:40:29 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/button.c:

	Use macros to make calculations explicit, clarifying things.  

Mon May  3 14:32:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix sed magic on FreeBSD.  

Mon May  3 13:11:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/modules/version.c:

	Try to wrap the module feature listing between 70-80 to make it more
	readable.  

Mon May  3 13:10:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Improve the feature pretty printing to be more portable and faster
	by using sed exclusively.  

Sun May  2 23:05:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	All hail to the bloat. Print configuration summary _after_ the
	'creating' messages and in a pretty printed way.  

Sun May  2 13:49:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/Makefile.am:

	Only conditionally build memdebug and fastfind objects.  

Sun May  2 13:30:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, modules/module.c, protocol/Makefile.am,
	protocol/protocol.c, protocol/protocol.h:

	A little kludgy. Introduce protocol module (which I think we should
	have anyway) because it removes a bit of the symbol resolving mess
	in the top level Makefile and make URI rewriting a submodule.
	Finally only conditionally build URI rewriting.  

Sun May  2 13:08:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/: Makefile.am, backend/Makefile.am:

	Only conditionally build mailcap and mimetypes backends.  

Sun May  2 13:07:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/backend/: common.c, xbel.c:

	Fix building without xbel.  

Sun May  2 13:01:22 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: msgbox.c, msgbox.h:

	msg_text_ni() is not used at all, so it was removed.  

Sun May  2 12:59:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/: Makefile.am, backend/Makefile.am:

	Only conditionally build xbel.  

Sun May  2 12:59:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/Makefile.am:

	Cleanup 

Sun May  2 12:58:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Dejavu: $withval -> $enableval.  

Sun May  2 12:53:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	$srcdir should be initialized by autoconf for us so clean it up.  

Sun May  2 12:52:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/Makefile.am:

	Only conditionally build exmode.  

Sun May  2 12:52:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, protocol/Makefile.am:

	Only conditionally build smb.  

Sun May  2 12:51:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/Makefile.am:

	Cleanup.  

Sun May  2 12:45:15 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/inpfield.c:

	Label dsp_f was renamed display_field.  

Sun May  2 11:55:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Remove usage of changequote() since it is discouraged.  

Sun May  2 10:53:33 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Explode dialog_func() switch: smaller functions were introduced.  

Sun May  2 10:29:43 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	Explode hierbox_dialog_event_handler() big switch in smaller
	functions: hierbox_ev_kbd(), hierbox_ev_init(), hierbox_ev_abort().  

Sun May  2 09:56:58 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	hierbox_browser(): minor code simplification.  

Sun May  2 03:05:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix XBEL dependency.  

Sun May  2 00:49:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Doh. Revert last patch.  

Sun May  2 00:28:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Rename variables used by the new configuration scheme to have
	CONFIG_ prefix.  

Sun May  2 00:13:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	We have to figure out a way to autogenerate this crap. Explicitly
	define AM_CONDITIONAL()s.  

Sat May  1 23:31:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/Makefile.am:

	Only conditionally build LEDs code.  

Sat May  1 23:16:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, scripting/Makefile.am:

	Use conditionals for scripting/ stuff.  

Sat May  1 22:59:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/Makefile.am:

	Yes mamma. Introducing autobreak conditionals. <rant> for no good
	reason (well ok who wants to run a m4 macro processor from a perl
	script) automake reports that 'CONFIG_FOO does not appear in
	AM_CONDITIONAL' but this is a lie and it works perfect so it just
	seems that automake make a few lazy and false checks </rant> 

Sat May  1 22:26:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Ahh yes there is this distinction between --with and --enable args.
	;-) 

Sat May  1 19:29:58 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	Reduce code redundancy by introducing put_button().  

Sat May  1 19:26:30 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	html_input(): allocate @fc only if needed, but not twice ;)) 

Sat May  1 19:25:42 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	html_input(): allocate @fc only if needed.  

Sat May  1 19:20:48 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	html_button(): allocate @fc only if needed.  

Sat May  1 19:16:07 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	Minor tidyup and labels renaming.  

Sat May  1 18:16:59 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Tidyup.  

Sat May  1 18:12:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	File got aspelled and reformatted.  

Sat May  1 18:03:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Try to sort out this mesh of misinformation. Take 2.  

Sat May  1 18:01:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/: conf.c, dialogs.c, opttypes.c, opttypes.h:

	Add an |int *line| parameter to reader procedures in the options
	code.  In |str_rd|, increment |line| for each new-line character
	encountered.  This fixes bug 443: Multi-line option values throw off
	line-numbers in conf.-file errors 

Sat May  1 17:58:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Try to sort out this mesh of misinformation.  

Sat May  1 17:39:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* INSTALL:

	feature.h -> features.conf 

Sat May  1 17:33:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	feature.h -> features.conf 

Sat May  1 17:24:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* Makefile.am:

	Oops make features.conf appear in distributed tarballs.  

Sat May  1 16:39:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, config/m4/iconv.m4:

	Try to normalize some of the configure args.  

Sat May  1 16:08:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf:

	Setup CONFIG_IPV6 using EL_ARG_DEPEND(). Please pasky or someone
	elaborate a bit in the descriptiong since all I am good for are
	rants. ;-) 

Sat May  1 15:50:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/configure.txt:

	These now live in feature.conf file.  

Sat May  1 15:49:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf:

	Always set CONFIG_* defined via EL_ARG_*() macros to either yes or
	no so they can be used in dependency checking. CONFIG_FASTMEM is now
	defined via EL_ARG_DEPEND().  

Sat May  1 15:31:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Make the CONFIG_* dependencies and explicit by using
	HAVE_<name>=<value> notation.  

Sat May  1 15:00:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf:

	Add CONFIG_{DEBUG,OWN_LIBC,SMALL} to feature.conf.  

Sat May  1 14:48:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Add -lexpat to LIBS.  

Sat May  1 14:09:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, feature.h, features.conf:

	Feature configuration is now done using a simple shell script file
	named features.conf containing default values for all features.  

Sat May  1 10:01:10 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Handle invalid colors mode is a cleaner way, especially when 256
	colors mode was enabled and saved in elinks.conf, then a 16 colors
	only elinks is launched, attempting to use that now illicit mode. It
	was exiting with internal error, now it just emits an error and fall
	back to 16 color mode.  

Sat May  1 05:29:36 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in, src/scripting/lua/core.c:

	In init_lua(), call lua_mathlibopen() so as to have mod() available 
	to Lua scripts, and delete the definition of mod() in hooks.lua.in.  

Sat May  1 05:14:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* configure.in:

	Doh, '/usr' and '/usr/local' were doubled, too.  Remove one '/usr'
	and one '/usr/local'.  

Sat May  1 05:11:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* configure.in:

	I guess that the doubled '"$withval"' was part of the piggy-switch
	hack, as hinted by the comment. Remove one '"$withval"'.  

Sat May  1 05:05:52 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* configure.in:

	Try -llua$suffix and -I$luadir/include/lua$suffix where $suffix is
	'', '40', and '50' in succession until one or none are found to
	work.  
	
	This fixes Lua detection with Lua 5 as packaged by Debian (which
	gives the headers directory and libraries the suffix '50').  
	
	Who wrote that brain-dead piggy-switch hack?  Hm, rev. 1.135--ohh,
	sorry pasky! 

Fri Apr 30 21:41:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix typo.  

Fri Apr 30 14:30:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	Since we now rely on autoconf 2.13 lets also do these *DIR defines
	the right way.  

Fri Apr 30 13:56:21 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_char_color(): x += 1; -> ++x; 

Fri Apr 30 13:53:05 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_char_color(): optimization and cleanup.  

Fri Apr 30 13:46:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Try to clearify bitmembers.  

Fri Apr 30 13:45:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/dialog.c:

	Remove empty line.  

Fri Apr 30 13:33:50 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_char16(): if (ch->attr & SCREEN_ATTR_BOLD) -> if (bold).  

Fri Apr 30 13:27:14 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_chars(): update comment.  

Fri Apr 30 13:18:56 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_chars(): tidy up.  

Fri Apr 30 12:44:31 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Revert wrong patch: even if nothing was redrawn, we possibly still
	need to move cursor. It fixes issue reported by sstar on irc, thanks
	to Jonas to pointed it out.  

Fri Apr 30 12:25:56 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated, an hotkey conflict was fixed.  

Fri Apr 30 09:26:22 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	update_screen_driver(): test for utf8_io only once.  

Fri Apr 30 09:05:36 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Move cases more likely to occur first in switch().  

Fri Apr 30 09:03:11 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Do not test @image.length if this is not needed.  

Fri Apr 30 08:48:55 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Only call get_screen_driver() if needed.  

Fri Apr 30 08:39:56 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Typo fix in add_chars() macro: @term -> @term_.  

Fri Apr 30 08:38:29 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Indentation level reduction.  

Fri Apr 30 03:44:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Cleanup.  

Fri Apr 30 03:41:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Doh. Fix CONFIG_SSL dependency ;).  

Fri Apr 30 03:13:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Be more conforming. Use AC_MSG_WARN() when guile configuration
	fails.  

Fri Apr 30 03:02:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix EL_CONFIG_DEPENDS() macro and a few tests.  

Fri Apr 30 01:06:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	Add EL_CONFIG_DEPENDS() macro for handling scripting and SSL
	CONFIG_* setup.  

Fri Apr 30 00:19:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Use EL_CONFIG() for CONFIG_IPV6.  

Fri Apr 30 00:17:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	Use EL_CONFIG() to define CONFIG_* variables.  

Thu Apr 29 23:53:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h:

	Remove seemingly unused defines.  

Thu Apr 29 23:32:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, src/main.c, src/config/kbdbind.c,
	src/config/kbdbind.h, src/dialogs/menu.c, src/modules/module.c,
	src/protocol/proxy.c, src/sched/action.c, src/sched/session.c,
	src/sched/task.c, src/scripting/scripting.c,
	src/scripting/scripting.h, src/scripting/guile/core.c,
	src/scripting/guile/core.h, src/scripting/guile/hooks.c,
	src/scripting/guile/hooks.h, src/scripting/lua/core.c,
	src/scripting/lua/core.h, src/scripting/lua/hooks.c,
	src/scripting/lua/hooks.h, src/scripting/perl/core.c,
	src/scripting/perl/core.h, src/scripting/perl/hooks.c,
	src/scripting/perl/hooks.h, src/viewer/text/view.c:

	HAVE_{SCRIPTING,LUA,PERL,GUILE} -> CONFIG_{...}.  

Thu Apr 29 23:22:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, src/lowlevel/connect.c,
	src/modules/module.c, src/protocol/http/http.c,
	src/protocol/http/https.c, src/sched/connection.c,
	src/sched/error.c, src/ssl/connect.c, src/ssl/connect.h,
	src/ssl/ssl.c, src/ssl/ssl.h:

	HAVE_{SSL,OPENSSL,GNUTLS} -> CONFIG_{SSL,OPENSSL,GNUTLS}.  

Thu Apr 29 23:11:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/config/cmdline.c, src/lowlevel/connect.c,
	src/lowlevel/connect.h, src/lowlevel/dns.c, src/modules/version.c,
	src/osdep/getifaddrs.c, src/protocol/uri.c, src/protocol/ftp/ftp.c:

	IPV6 -> CONFIG_IPV6.  

Thu Apr 29 23:04:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/getifaddrs.c:

	Fix HAVE_IPV6 to be IPV6.  

Thu Apr 29 23:02:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, src/config/kbdbind.c,
	src/config/options.h, src/modules/version.c, src/osdep/stub.h,
	src/protocol/http/codes.c, src/util/color.c, src/util/error.h,
	src/util/fastfind.h, src/util/memory.c, src/util/memory.h,
	src/util/snprintf.h:

	FASTMEM -> CONFIG_FASTMEM, USE_OWN_LIBC -> CONFIG_OWN_LIBC,
	ELINKS_SMALL -> CONFIG_SMALL.  

Thu Apr 29 17:04:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	The color mapping seems to work fine now.  

Thu Apr 29 16:01:25 2004  Laurent Monin <zas@norz.org>:

	* src/util/: color.c, color.inc:

	Fix colors stuff: always include color_s.inc before (optionnal)
	color.inc, which was stripped down. It should fix the white ->
	0xFFFFFF -> gray100 issue reported by Jonas.  

Thu Apr 29 15:06:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Thu Apr 29 15:03:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/tools/help2doc:

	More help2doc tool fixing.  

Thu Apr 29 14:24:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/tools/help2doc:

	Fix elinks version extraction.  

Thu Apr 29 14:17:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* Makefile.base:

	Tidyup.  

Thu Apr 29 14:11:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* Makefile.base:

	Yay .. get rid of that `dirname ...` hack and just include .  

Thu Apr 29 14:07:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/Makefile.in:

	Apply last chunk of Harold L Hunt II's patch fixing bug 353.  

Thu Apr 29 13:52:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/Makefile.am:

	Try to improve builddir != srcdir situation.  

Thu Apr 29 13:30:00 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: parser.c, parser/forms.c, parser/forms.h:

	Do not export struct form, introduce and use done_form() instead,
	use enum form_method as type for struct form method field.  

Thu Apr 29 13:15:31 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	get_html_form():  char *ax -> unsigned char *enctype, tidy up.  

Thu Apr 29 13:09:38 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	do_html_select(): @val -> @values, tidy up.  

Thu Apr 29 12:40:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	EL_DEFINE() a few variables.  

Thu Apr 29 12:17:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_CHECK_TYPE() -> EL_CHECK_CODE(). Use it for variadic macro
	checking.  

Thu Apr 29 11:50:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_CHECK_SPECIAL_TYPE() -> EL_CHECK_INT_TYPE().  

Thu Apr 29 11:49:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h:

	Whoops forgot to remove HAVE_SA_STORAGE declaration.  

Thu Apr 29 11:48:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Add EL_CHECK_NET_TYPE() for all the sockaddr_* and addrinfo struct
	checking.  

Thu Apr 29 11:41:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	Use EL_CHECK_SYS_TYPE() for regex_t and HAVE_REGEX_H config.  

Thu Apr 29 11:37:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Add EL_CHECK_SYS_TYPE() which #includes <sys/types.h> and tries to
	do sizeof(type).  

Thu Apr 29 11:32:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Use EL_CHECK_TYPE() for typeof() checking.  

Thu Apr 29 11:28:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_CHECK_TYPE(): Takes care of the messaging an type checking.  

Thu Apr 29 11:23:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_DEFINE(): Wraps AC_DEFINE() to shorten lines.  

Thu Apr 29 11:18:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Group macros.  

Thu Apr 29 00:37:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Use EL_* namespace for own macros.  

Wed Apr 28 19:54:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Define macro for testing gpm, zlib and bzlib.  

Wed Apr 28 19:27:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix size check of long long.  

Wed Apr 28 19:22:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	Define macro for testing 'exotic' types. It also takes care of
	registering the config variable.  

Wed Apr 28 18:43:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/gettext.c:

	Fix compilation with --disable-nls. Patch by Felix von Leitner.  

Wed Apr 28 18:09:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	We don't use these GUILE_* make variables so why substitute them? 

Wed Apr 28 18:05:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Doh, first search for guile-config in user supplied path.  

Wed Apr 28 18:01:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Improve guile configuration by first checking guile-config (using
	possible supplied path). If guile-config is not found simply emit
	failure notice else emit the incomplete message.  

Wed Apr 28 17:31:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Simplify guile autoconf.  

Wed Apr 28 17:17:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/guile/core.c:

	A little tidyup.  

Wed Apr 28 17:15:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/guile/core.c:

	Make it possible to start elinks with guile compiled in without
	~/.elinks/internal-hooks.scm available.  

Wed Apr 28 16:34:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	I should have known not to trust autoconf. Setup prefix and
	exec_prefix before usage. Should make find it's .mo files.  

Wed Apr 28 10:58:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	AC_{SAVE,RESTORE}_FLAGS: Add ending comma.  

Wed Apr 28 08:45:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/Makefile.am:

	Fix archive name.  

Tue Apr 27 23:12:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	AC_{SAVE,RESTORE}_FLAGS introduced.  

Tue Apr 27 22:30:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Cleanup LOCALEDIR and LIBDIR exporting. This is the way other
	packages do and I think we should trust autoconf or who ever to set
	up the variables for us. Oh yes and remove debug echo.  

Tue Apr 27 17:46:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/Makefile.am:

	More fine tuning. Only dist clean charset.alias. Use
	install-data-local for installing it.  

Tue Apr 27 17:06:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, src/intl/gettext/Makefile.am:

	Define and export LIBDIR via config.h to get rid of special build
	rules for gettext.  

Tue Apr 27 16:28:25 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Fix corrupted display on terminals that to not have
	"eat_newline_glitch (xn)", ie. cons25 family of terminals, and
	cygwin terminal.  

Tue Apr 27 16:23:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/.cvsignore:

	Ignore Makefile.in 

Tue Apr 27 16:23:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/Makefile.am:

	Remove generated charset.alias when cleaning. Remove autogenerated
	files from EXTRA_DIST.  

Tue Apr 27 16:05:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/intl/gettext/Makefile.am,
	src/intl/gettext/Makefile.in, src/intl/gettext/ref-add.sed.in,
	src/intl/gettext/ref-add.sin, src/intl/gettext/ref-del.sed.in,
	src/intl/gettext/ref-del.sin:

	Try to use Makefile.am for building int/gettext .. will be
	interesting if it works ;P 

Tue Apr 27 14:11:58 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Minor optimization: only call strstr() if needed.  

Tue Apr 27 13:48:08 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Use an enum for @type, minor tidyup.  

Tue Apr 27 13:29:59 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Code simplification and optimization: find_strs() function was
	introduced to match sequence of strings.  

Mon Apr 26 16:46:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Fix bug 431 and make underlining work properly when splitting lines
	(in table cells).  

Mon Apr 26 15:56:11 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Apr 26 15:48:28 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/download.c, util/file.c, util/file.h:

	Pop up an error message if attempting to save a file which is a fact
	a directory. file_is_dir() function was added to util/file.{c,h}, it
	tests if its argument is a readable directory.  

Mon Apr 26 13:30:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Untangle mem_free_set() casting pointer code.  

Mon Apr 26 13:18:53 2004  Laurent Monin <zas@norz.org>:

	* src/intl/gettext/: loadmsgcat.c, localealias.c:

	Workaround compilation failure under cygwin and debian stable, when
	using --with-perl: alloca() is not detected at configure time but
	still included from some perl headers files.  

Mon Apr 26 12:51:29 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/hooks.c:

	Perl-specific code was moved to appropriate local functions, @err
	was renamed to non-misleading @count, dSP and PUSHMARK are needed
	even if no parameter is passed (hook_quit case, conform to perlcall
	doc), tidyup.  

Mon Apr 26 11:38:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	query_file(): Check only the URI passed and not ses->download_uri.
	Maybe the checking should be moved back to start_download() but it
	shouldn't hurt the other users. Besides I like the fact that we not
	check URI _before_ users have provided a filename so they don't
	waste their time. FIXME added. Somebody please act as to what is
	best because I don't know. ;) 

Mon Apr 26 09:05:46 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	An assertion was added: for now, this one is triggered when saving a
	preformatted document. This was reported by Stephen Stocker. Jonas
	please have a look at this one.  

Mon Apr 26 08:49:10 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	Fix wrapping of lines due to a change introduced in
	document/html/parser.c 1.385 -> 1.386: we want to match only space
	char. It restores correct rendering of freshmeat.net index page.  

Mon Apr 26 03:37:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/leds.c:

	Fix and improve led option handling.  

Sun Apr 25 17:32:44 2004  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/backend/xbel.c, document/document.c,
	document/html/parser.c, document/html/parser/forms.c,
	document/html/parser/link.c, document/html/parser/parse.c,
	sched/action.c, sched/connection.c, sched/download.c,
	sched/history.c, sched/task.c, viewer/text/search.c:

	Miscelleanous trivial tidyups: indentation, whitespaces fixes,
	hacking document conformance.  

Sun Apr 25 16:28:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cookies/dialogs.c:

	Microscopic tidyup.  

Sun Apr 25 09:52:34 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Apr 25 09:49:44 2004  Laurent Monin <zas@norz.org>:

	* src/sched/error.c:

	Typo fix: external -> external programs.  

Sun Apr 25 05:58:17 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/scripting/perl/hooks.c:

	Maybe we should C++. Use dSP only when Perl is initialized.  

Sat Apr 24 23:48:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	parse_html(): Commit unput data to the document upon reaching @eof
	only if we really want to commit them (therefore cycle with
	@noupdate set). This fixes random tags shown inside of <table>s and
	possibly other weirdness. Introduced by me, pinpointed by Jonas,
	fixed it together :).  

Sat Apr 24 22:22:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/hooks.c:

	Reverted witekfl's 1.5 (movind dSP). This breaks compilation
	(declaration not at the start of block).  

Sat Apr 24 16:15:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	First check content-type of Content-Disposition filename. Problem is
	we still fall back to also checking the content type of the filename
	in the URI and thus the what-to-do dialog will still report wrong
	content type.  

Sat Apr 24 16:13:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	Move extension content type checking to separate function.  

Sat Apr 24 16:03:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, mime/mime.h, protocol/uri.c:

	Move Content-Disposition extraction to separate function in mime/.  

Sat Apr 24 15:39:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, sched/download.c:

	Fix problems regarding servers sending empty Content-Type values
	which means the extension is never checked.  

Sat Apr 24 15:31:00 2004  Laurent Monin <zas@norz.org>:

	* src/intl/gettext/l10nflist.c:

	Awful hack to make cygwin happy, it has no impact on other
	environments.  

Sat Apr 24 14:51:41 2004  Laurent Monin <zas@norz.org>:

	* configure.in:

	AC_PREREQ(2.13) was added, it prevents issues on systems having both
	autoconf2.13 and 2.5x or more (debian, cygwin).  

Sat Apr 24 14:44:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	process_element() and family now returns new value of html, because
	it can shift it forth.  

Sat Apr 24 14:39:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: Makefile.am, html/internal.h, html/parser.c,
	html/parser/Makefile.am, html/parser/forms.c, html/parser/forms.h,
	html/parser/parse.c:

	Factored out forms parser from document/html/parser.c to
	document/html/parser/forms.*.  

Sat Apr 24 14:36:13 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/scripting/perl/hooks.c:

	Moved "dSP;". Now dSP is called only when Perl interpreter is
	properly initialized. The crash should disappear.  

Sat Apr 24 12:21:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, sched/connection.h, sched/download.c,
	sched/error.c:

	Fix bug 440 by checking for external hanlders in query_file()
	through where all downloads are routed. S_EXTERNAL_PROTOCOL
	introduced for the error message mapping.  

Sat Apr 24 11:50:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Update documentation of addBookmark().  

Sat Apr 24 11:46:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Documented the rest of struct element_info.  

Sat Apr 24 11:41:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, sched/session.c, sched/session.h:

	Rename -remote bookmark() method to addBookmark(). enum also updated
	to reflect this change.  

Sat Apr 24 11:39:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	end_element(): Minor XMP handling simplification.  

Sat Apr 24 11:31:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	start_element(): @ali -> @restore_format, @pa -> @old_format 

Sat Apr 24 11:29:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Reindented start_element().  

Sat Apr 24 11:27:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Separated start_element() and end_element() from process_element().  

Sat Apr 24 10:59:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, mime/mime.h, sched/download.c:

	Pass the cache entry to get_content_type().  

Sat Apr 24 10:35:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	process_element(): Make links work again by breaking like the old
	code did instead of returning so we end up at the killing spree
	below.  

Sat Apr 24 02:52:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	Compile fix for the currently fubar'd html parser ;) 

Sat Apr 24 02:13:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Shorten examples in the -remote description.  

Sat Apr 24 02:11:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, sched/session.c, sched/session.h:

	Add support for -remote 'bookmark(URL)'. Let the bloating begin.
	Dunno if xfeDoCommand(bookmark, URL) would be a better way? 

Sat Apr 24 01:43:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Fix leak when passing unknown openurl() parameter.  

Sat Apr 24 01:39:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Unify openurl() remote_url allocation.  

Sat Apr 24 01:35:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Use strstr() to scan openURL() args.  

Sat Apr 24 01:31:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Tidyup.  

Sat Apr 24 01:30:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Use strcspn() to simplify.  

Sat Apr 24 01:25:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	@inv -> @endingtag in parse_html() and process_element().  

Sat Apr 24 01:23:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	In parse_html() merged set_lt to the main loop.  

Sat Apr 24 01:20:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Comments in process_element() reformatted.  

Sat Apr 24 01:19:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Moved element processing off parse_html() to process_element().  

Sat Apr 24 01:13:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Cleanup.  

Sat Apr 24 01:10:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): If no remote session flags was applied it can only
	mean the method is not supported. This nicely centralizes error
	returning.  

Sat Apr 24 01:07:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	parse_html(): @lt -> @base_pos 

Sat Apr 24 01:07:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Add missing break.  

Sat Apr 24 01:05:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	More tidyup of parse_html().  

Sat Apr 24 01:05:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	I'm a sucker for this data driven thing so make -remote method
	parsing data driven and use switch.  

Sat Apr 24 01:00:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Removed some ancient commented out relicts.  

Sat Apr 24 00:57:23 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: Makefile.am, html/internal.h, html/parser.c,
	html/parser/Makefile.am, html/parser/link.c, html/parser/link.h,
	html/parser/parse.c:

	Moved link-related functions from document/html/parser.c to
	document/html/parser/link.*.  

Sat Apr 24 00:51:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Emit 'Remote method not supported' instead of 'Command
	not supported'. Should hopefully be less confusing.  

Sat Apr 24 00:38:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Restored get_num() which got... lost in an accident.  

Sat Apr 24 00:36:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Removed idiotic static inline from html_*().  

Sat Apr 24 00:33:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/: parse.c, parse.h:

	Separated core parser stuff from document/html/parser.* to
	document/html/parser/parse.*.  

Sat Apr 24 00:32:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/core.c:

	Use PERL_EXIT_DESTRUCT_END only if it's defined, I don't have it in
	my pet perl-5.6.1.  

Sat Apr 24 00:31:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, sched/session.c:

	Fix -remote 'openurl()' so it again prompt for URL in current tab.  

Sat Apr 24 00:28:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Oops it is @comma that should be strimmed from ending
	space.  

Sat Apr 24 00:25:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/core.c:

	Fix include modules/module.h.  

Sat Apr 24 00:25:24 2004  Petr Baudis <pasky@ucw.cz>:

	* Makefile.base:

	Remove CPPFLAGS usage. That shouldn't hurt anything and it's all
	mostly redundant anyway.  

Sat Apr 24 00:24:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Improve -remote long-help description. Fix incorrect description of
	openurl(). Take 4.  

Sat Apr 24 00:23:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	skipback_whitespace(): Don't go off by one.  

Sat Apr 24 00:20:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Cleanup looping. Introduce skipback_whitespace().  

Sat Apr 24 00:20:09 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in, src/document/html/Makefile.am:

	Connect document/html/parser/ to the build infrastructure.  

Sat Apr 24 00:18:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: Makefile.am, document.c, css/apply.c,
	html/internal.h, html/parser.c, html/parser.h, html/renderer.c,
	html/tables.c, html/parser/Makefile.am:

	Separated core parser stuff from document/html/parser.* to
	document/html/parser/parse.*.  

Sat Apr 24 00:18:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Added missing util/conv.h.  

Sat Apr 24 00:03:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/internal.h:

	parser/stack.c needs ln_break().  

Fri Apr 23 23:56:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, util/error.c:

	usrerror() now prefixes error messages with 'elinks: '. Change
	-remote 'ping()' to be more mozilla compliant and in the spirit of
	Unix and only emit error message when ping failed.  

Fri Apr 23 23:30:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Emit error message when -remote failed to connect.  

Fri Apr 23 23:23:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Trim down includes.  

Fri Apr 23 23:23:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/internal.h:

	Declare @ff and @line_break_f as extern.  

Fri Apr 23 23:22:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/internal.h:

	@ff and @line_break_f are needed by parser/stack.c.  

Fri Apr 23 23:18:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Cleanup the gotos a little.  

Fri Apr 23 23:16:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	kill_html_stack_until(): Reindentation.  

Fri Apr 23 23:14:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Tidyup.  

Fri Apr 23 23:12:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: parser.c, parser/stack.c, parser/stack.h:

	Removed debug_stack(), dump_html_stack() is now the official HTML
	stack debugging dumper.  

Fri Apr 23 23:10:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Enhanced dump_html_stack().  

Fri Apr 23 23:08:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.h:

	Removed redundant struct html_element declaration.  

Fri Apr 23 23:08:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/: stack.c, stack.h:

	search_html_stack() prototype: (char *) -> (unsigned char *) 

Fri Apr 23 23:06:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: parser.c, parser/stack.c, parser/stack.h:

	kill_until() -> kill_html_stack_until() 

Fri Apr 23 23:05:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Improve -remote long-help description. Take 3. Please stop me ;) 

Fri Apr 23 23:05:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: Makefile.am, html/parser.c,
	html/parser/Makefile.am, html/parser/stack.c, html/parser/stack.h:

	Moved HTML stack related functions from document/html/parser.c to
	document/html/parser/stack.*.  

Fri Apr 23 23:04:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/: .cvsignore, .vimrc:

	Fairies.  

Fri Apr 23 22:58:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Improve -remote long-help description. Take 2 

Fri Apr 23 22:54:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Improve -remote long-help description.  

Fri Apr 23 22:48:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Small parse_html() tidyup.  

Fri Apr 23 22:43:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Attempt to at least roughly document element_info.nopair.  

Fri Apr 23 22:30:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Moved process_head() and skip_comment() above the elements list.  

Fri Apr 23 22:28:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Few strategically placed blank lines.  

Fri Apr 23 22:24:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	elinks -version now prints out the full version string - including
	build date and features list.  

Fri Apr 23 22:21:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/modules/version.c:

	In case @more isn't set but we're debugging still show (built on),
	but on the same line as ELinks VERSION_STRING.  

Fri Apr 23 22:05:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/cmdline.c, sched/session.h:

	Remove -ping and only provide -remote 'ping()'.  

Fri Apr 23 22:04:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Check element type by relational operators now, so that ELEMENT_WEAK
	is considered as ELEMENT_KILLABLE in various considerations. This
	should fix the <head><title>moo</head>.  

Fri Apr 23 22:01:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: parser.c, parser.h:

	_The_ definitive fix for any and all <title> problems which could
	ever occur. Removed the weak'n'hackish <title /> workaround, instead
	ELEMENT_WEAK element type was introduced with the special property
	that any attempt to put new element inside will terminate the
	element (<title>foo<body> will do the right thing), even for
	invisible elements where we do not normally permit other elements to
	nest. <head> also owns own dummy stack level so that
	<head><title>foo</head> does the right thing as well. You can't get
	any better than *that* ;).  

Fri Apr 23 20:44:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: elinks.h, bfu/button.c, bfu/dialog.c, bfu/dialog.h,
	bfu/group.c, bfu/inpfield.c, bfu/inphist.c, bfu/listbox.c,
	bfu/listmenu.c, bfu/menu.c, bfu/text.c, bfu/widget.c,
	bookmarks/backend/default.c, config/kbdbind.c, config/opttypes.c,
	dialogs/download.c, dialogs/menu.c, dialogs/options.c,
	dialogs/status.c, document/refresh.c, document/css/scanner.c,
	document/css/value.c, document/html/frames.c,
	document/html/parser.c, document/html/renderer.c,
	document/html/tables.c, document/plain/renderer.c,
	osdep/getifaddrs.c, protocol/auth/auth.c, protocol/http/http.c,
	sched/event.c, sched/session.c, terminal/draw.c, terminal/screen.h,
	util/math.h, util/scanner.c, util/snprintf.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c, viewer/text/vs.c:

	#include util/math.h back in elinks.h. Its whole *point* was to be
	around and available everytime. Besides, it includes a system
	header.  

Fri Apr 23 20:39:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/math.h:

	Blank lines.  

Fri Apr 23 20:30:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/error.c:

	Fixed usrerror() mindtwist, I forgot to derive @params first :).
	Noticed by Jonas.  

Fri Apr 23 19:42:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.c:

	Trivial decode_session_info() tidyup.  

Fri Apr 23 19:38:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/main.c:

	Exclaim appropriate messages when create_session_info() or
	attach_terminal() failed.  

Fri Apr 23 19:37:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/main.c:

	Report -ping outcome to stderr.  

Fri Apr 23 19:32:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Try to honour the 80 chars boundary where it makes sense.  

Fri Apr 23 19:30:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	_parse_options() -> parse_options_() 

Fri Apr 23 19:30:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Cleaned up _parse_options() - reduced level of indentation and
	moving error handling.  

Fri Apr 23 19:26:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: main.c, bookmarks/backend/xbel.c, config/cmdline.c,
	intl/gettext/libintl.h, lowlevel/home.c, lowlevel/interlink.c,
	lowlevel/select.c, mime/backend/mailcap.c, terminal/kbd.c,
	viewer/dump/dump.c:

	Introduced convenience G_() -> gettext() alias for use in
	multi-level printing statements when we don't have a terminal
	around.  

Fri Apr 23 19:20:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bookmarks/backend/xbel.c, config/cmdline.c,
	lowlevel/home.c, mime/backend/mailcap.c, scripting/lua/core.c,
	terminal/event.c, util/error.c, util/error.h, viewer/dump/dump.c:

	Introduced usrerror() which acts for ERROR() in the cases where user
	can trigger the error. It doesn't sleep, it doesn't beep and it
	doesn't contain information about where in the source the error
	occured, which could be quite confusing for the user (and she
	doesn't care anyway).  

Fri Apr 23 18:57:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_filename_to_string(): Use get_filename_position(). I rule!
	;P 

Fri Apr 23 18:44:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: util/file.c, util/file.h, viewer/text/form.c:

	Move strip_file_name() and rename to get_filename_position(). ;) 

Fri Apr 23 18:40:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	strip_file_name(): Cleanup.  

Fri Apr 23 18:23:46 2004  Laurent Monin <zas@norz.org>:

	* src/intl/gettext/: bindtextdom.c, dcgettext.c, dcigettext.c,
	dcngettext.c, dgettext.c, dngettext.c, explodename.c, finddomain.c,
	gettext.c, intl-compat.c, l10nflist.c, loadmsgcat.c,
	localcharset.c, localealias.c, ngettext.c, textdomain.c:

	Fix wrong inclusion of header. We want "config.h" not <config.h>.  

Fri Apr 23 18:04:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_filename_to_string(): Use parse_http_header_param().  

Fri Apr 23 16:42:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Improve Content-Disposition handling by trimming any following
	fields.  

Fri Apr 23 16:29:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_filename_to_string(): Use strstr() to find 'filename='
	substring.  

Fri Apr 23 15:52:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/core.c:

	Generic tidyup and some more includes.  

Fri Apr 23 15:51:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/core.h:

	Remove some strange irrelevant includes.  

Fri Apr 23 15:45:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memdebug.c:

	Ensure the main pointer is aligned (otherwise we go nuts on some
	archs) and put the XFLOW underflow mark to the alloc_header aligned
	reserved space.  

Fri Apr 23 15:28:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libgnuintl.h:

	Compile fix.  

Fri Apr 23 15:11:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libgnuintl.h:

	#define _LIBINTL_H to avoid including system <libintl.h>. Last patch
	will hopefully still fix issue with including <locale.h> in main.c 

Fri Apr 23 15:08:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libgnuintl.h:

	Standardize header file include guard.  

Fri Apr 23 15:02:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libgnuintl.h:

	Since libgnuintl.h is not included directly simplify LC_MESSAGE
	#define.  

Fri Apr 23 14:25:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/getifaddrs.c:

	More SunOS compile fixes. #include <sys/socket.h> and <sys/types.h>
	before <net/if.h>.  

Fri Apr 23 14:20:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.h:

	I''n psaky./ O"m fxiing ytops.  

Fri Apr 23 14:19:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.h:

	Me pasky. I be fixed error grammars.  

Fri Apr 23 14:11:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/: bindtextdom.c, dcgettext.c, dcigettext.c,
	dcngettext.c, dgettext.c, finddomain.c, gettext.c, intl-compat.c,
	ngettext.c, textdomain.c:

	Always include own libintl.h instead of own libgnuintl.h. Fixes
	building on sparc when the include magic will make system
	<libintl.h> include our own libintl.h instead.  

Fri Apr 23 13:55:15 2004  Laurent Monin <zas@norz.org>:

	* src/ssl/connect.c:

	Cast @sock to (gnutls_transport_ptr) type, as indicated in recent
	gnutls documentation.  

Fri Apr 23 13:48:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/file.c:

	Trivial file_exists() tidyup.  

Fri Apr 23 13:47:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: scripting/lua/core.c, util/file.c, util/file.h:

	Introduced file_can_read() similiar in spirit to file_exists(). Use
	that instead of the hyperweird Lua5 Debianish bugfix using fopen()
	(while assimiliating that for fallback unless HAVE_ACCESS).  

Fri Apr 23 13:21:10 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/session.c, protocol/uri.c:

	Use int type instead of size_t, preventing warnings on some
	platforms.  

Fri Apr 23 12:29:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: Makefile.am, vernum.c, vernum.h, modules/version.c:

	Introduce vernum.* which contains currently build date/time
	information. It is rebuilt everytime to ensure we have the latest
	data for this. In the future I'd like to invent some CVS trigger
	which also keeps the latest commit date/time there (which is
	somewhat more useful and accurate than just build time info).  

Fri Apr 23 12:27:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/modules/version.c:

	Simplify the condition for inclusion of the build date/time and make
	explicit that it is date/time of the build.  

Fri Apr 23 11:44:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/file.h:

	Restored a removed newline. Evil zas! 

Fri Apr 23 11:39:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	SOME PEOPLE here should be taught the alphabet properly (moved
	-no-numbering, -config-help, -localhost to their proper place).  
	CCMAIL: pasky@ucw.cz CCMAIL: zas@norz.org 

Fri Apr 23 11:36:47 2004  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	Further weeding out and slight tuning of the items, plus reordering.  

Fri Apr 23 11:31:09 2004  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	Adjust some items and weed out some (IMHO) too unimportant ones.  

Fri Apr 23 11:23:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/action.c:

	Unrolled ACT_MAIN_TAB_MOVE* handling.  

Fri Apr 23 11:22:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/action.c:

	Reverted Jonas' 1.56 (Group similar action handler calling using a
	magic variable.). We agreed that it's not so clever as it might
	seem...  

Fri Apr 23 10:28:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.c, download.c, session.c, task.c:

	More is_in_progress_state() usage.  

Fri Apr 23 08:41:56 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Apr 22 23:56:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	doc_end_load(): Yay digging into the cvsweb archive showed that a
	little too clever cleanup broke -auto-submit handling. Readd the
	first form grabbing and improve error handling if get_form_url()
	fails.  

Thu Apr 22 23:50:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Pointing out brokeness of -auto-submit handling.  

Thu Apr 22 22:51:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_filename_to_string(): Strip extracted filename of any
	directories so only the clean filename is added. Fallback to old
	filename resolving if whole extracted filename is stripped.  

Thu Apr 22 22:37:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_filename_to_string(): It is only used by query_file() and
	do_type_query() dialog functions for local saving so add naive
	support for Content-Disposition by checking the associated
	cache_entry's header. I hope add_shell_safe* will make up for any
	security issues.  

Thu Apr 22 22:09:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	More is_in_progress_state() usage.  

Thu Apr 22 21:32:45 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Compile fix: done_pre_format_html_hook -> preformatted. Jonas forgot
	this one... ;) 

Thu Apr 22 21:14:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Fix last patch. Don't initialize cache_entry->preformatted to one.
	;) 

Thu Apr 22 21:12:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, sched/session.c:

	cache_entry->done_pre_format_html_hook -> cache_entry->preformatted.
	Now always a member since it is boolean and should be padded nicely
	with the other of it's kind.  

Thu Apr 22 21:04:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.h:

	Try to describe struct cache_entry.  

Thu Apr 22 21:02:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Tidyup.  

Thu Apr 22 19:53:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Document the possible 'System' value of various codepage/charset
	options.  

Thu Apr 22 19:50:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/charsets.c:

	get_cp_index(): @n -> @name 

Thu Apr 22 19:50:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/charsets.c:

	Fixed get_cp_index() so that it falls back to us-ascii when you
	abuse it by using System charset while locale has some exotic
	charset unknown to ELinks set.  

Thu Apr 22 19:46:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/charsets.c:

	Unroll the fastfind get_cp_index()'s return statement.  

Thu Apr 22 19:40:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Sanitized a (boolean < 1) relict.  

Thu Apr 22 19:38:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Tidyup.  

Thu Apr 22 19:36:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Reverted zas' 1.239 (Fix: copy http_version structure contents not
	structure pointer.). I'm probably stupid but I can't see any
	pointers there and the old code is fine.  CCMAIL: zas@norz.org 

Thu Apr 22 18:50:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/dump/dump.c:

	More tidy. XXX comment also added.  

Thu Apr 22 18:45:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Revert patch by Christian Haggstrom and add proper detection of
	these internal directory redirects.  

Thu Apr 22 18:14:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/dump/dump.c:

	Tidyup.  

Thu Apr 22 18:09:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/leds.c, config/options.inc:

	Move the ui.clock options to the leds module.  

Thu Apr 22 18:07:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.h:

	Describe struct menu_item.  

Thu Apr 22 18:05:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/leds.c:

	Precompute a base X position for the clock.  

Thu Apr 22 18:04:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Changed ui.clock.format default value to also contain the angle
	brackets like all other statusbar items.  

Thu Apr 22 18:02:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/leds.c, config/options.inc:

	Options subtree rename: ui.timer.clock -> ui.clock. This has nothing
	to do with the timer at all.  

Thu Apr 22 17:48:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	display_status_bar(): Add FIXME regarding progress bar being drawn
	on top of the digital clock.  

Thu Apr 22 17:47:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/leds.c:

	@l -> @timerlen 

Thu Apr 22 17:46:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/leds.c:

	Include <time.h> only when it's available and also try <sys/time.h>.
	Should enhance portability. Somehow.  CCMAIL:
	witekfl@poczta.gazeta.pl 

Thu Apr 22 16:13:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.c, sched/session.c,
	sched/session.h:

	ses->tq => ses->type_queries.  

Thu Apr 22 16:10:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.c, sched/download.h,
	sched/session.c:

	tq -> type_query, type_query() -> do_type_query().  

Thu Apr 22 16:08:11 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	scan_http_equiv(): free memory as soon it is no more needed.  

Thu Apr 22 16:06:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_element(): drop useless ().  

Thu Apr 22 16:05:25 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	element_has_implicit_end(): minor optimization.  

Thu Apr 22 16:00:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.h, sched/session.h:

	Move struct tq to more central header.  

Thu Apr 22 15:44:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Fix <title /> handling so pasky can enjoy
	http://cia.navi.cx/historical/first-24-hours.html 

Thu Apr 22 15:03:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	done_tq(): Fix tq->download teardown by calling change_connection().  

Thu Apr 22 12:51:30 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/document.c:

	Make headers info dialog scrollable.  

Thu Apr 22 12:39:46 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	Assert absence of POST_CHAR before appending post data, may be
	useless.  

Thu Apr 22 12:38:10 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	Bug fix proposed by Christian Haggstrom for issue related to POST +
	Location: / was applied.  

Wed Apr 21 22:43:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	destroy_session(): Use done_tq() when freeing ses->tq list.  

Wed Apr 21 22:39:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, download.h:

	tp_free() -> done_tq() to complete init/done interface. Maybe we
	should s/tq/type_query/.  

Wed Apr 21 22:35:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Move tq initialization to init_tq(). Removes goto and reduces the
	ses_chktype() confusion.  

Wed Apr 21 22:19:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, download.h:

	Make subst_file() static.  

Wed Apr 21 22:15:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	|V|4|{3 6070_U|21_}{0/\/\3 57471(.  

Wed Apr 21 13:48:00 2004  Laurent Monin <zas@norz.org>:

	* src/util/string.c:

	strlcmp_device(): @n is useless so removed, @d was introduced to
	prevent double calculation of difference.  

Wed Apr 21 13:27:15 2004  Petr Baudis <pasky@ucw.cz>:

	* Makefile.am:

	Remove configure-do relict from EXTRA_DIST. It looks like this was
	breaking -current tarballs build for some three months... :( 

Wed Apr 21 09:21:31 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/core.c:

	Minor cleanup.  

Wed Apr 21 09:07:41 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/core.c:

	Let preprocessor do the job: snprintf() is useless to concatenate
	constant strings.  

Wed Apr 21 08:59:29 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/core.c:

	Fix usage of PERL_SYS_INIT3() and PERL_SYS_TERM() macros, prevent
	unused variables warnings, cleanup + comments.  

Wed Apr 21 01:10:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_mouse_handler(): Specialize loop to only care if the item
	has left text.  

Wed Apr 21 00:42:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_mouse_handler(): fubar'ed patch that rewrites the menu item
	loop moving testing of whether mouse button was pressed so we should
	scroll out of the loop. Comments should hopefully make it more
	clear.  

Wed Apr 21 00:21:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_mouse_handler(): Use foreach_menu_item.  

Wed Apr 21 00:00:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_mouse_handler(): Decrease indentation.  

Tue Apr 20 23:54:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	Use minor hacked scroll_menu() for mainmenus.  

Tue Apr 20 23:32:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	Menu drawing cleanups.  

Tue Apr 20 23:23:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	draw_menu_left_text(): Use draw_text().  

Tue Apr 20 17:02:49 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	Use int_max() for overlap() macro.  

Tue Apr 20 15:53:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	That hack was a bad idea. It forces too much rerendering ;).  

Tue Apr 20 15:31:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	doc_end_load(): Use ugly hack to force rerendering of document when
	a requested stylesheet has been loaded.  

Tue Apr 20 15:03:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Make 3 functions static.  

Tue Apr 20 13:48:12 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hotkey.c:

	Fix compilation due to field name changes made by Jonas in menu
	stuff. Reported by Stephen Stocker.  

Tue Apr 20 07:45:48 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	do_lookup(): remove two goto and a label -> code simplification.  

Tue Apr 20 07:35:32 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	end_dns_lookup(): @q -> @query, already used in other related
	functions.  

Mon Apr 19 15:56:44 2004  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/dialogs.c, cache/cache.c, config/options.c,
	cookies/dialogs.c, dialogs/status.c, document/html/parser.c,
	document/html/renderer.c, document/html/tables.c,
	globhist/dialogs.c, globhist/globhist.c, lowlevel/connect.c,
	lowlevel/dns.c, protocol/uri.c, protocol/auth/auth.c,
	protocol/file/file.c, protocol/http/codes.c, protocol/http/http.c,
	sched/connection.c, sched/download.c, sched/event.c,
	sched/history.c, sched/task.c, terminal/terminal.c, util/memory.h,
	viewer/text/form.c, viewer/text/link.c, viewer/text/search.c,
	viewer/text/textarea.c, viewer/text/view.c:

	mem_free_set_if(x, v) -> mem_free_set(&x, v) as proposed on irc,
	mem_free_if() do not set pointer to NULL anymore since this is a
	bloat, programmers just have to change  #if 0 to #if 1 in memory.h
	to force pointers nullification (for debugging purposes only).  

Mon Apr 19 14:39:40 2004  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/dialogs.c, config/options.c, cookies/dialogs.c,
	dialogs/status.c, document/html/parser.c, document/html/renderer.c,
	document/html/tables.c, globhist/globhist.c, lowlevel/connect.c,
	protocol/file/file.c, protocol/http/codes.c, protocol/http/http.c,
	sched/task.c, terminal/terminal.c:

	Use mem_free_set_if() where applicable.  

Mon Apr 19 09:41:16 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	Unify read/write loops style, shorten lines by introducing @todo,
	initialize @done just before loops, tidy up.  

Mon Apr 19 08:58:15 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	end_dns_lookup(): assert dnsentry before it is used, use mem_alloc()
	instead of mem_calloc() where zeroing is useless, cleanup.  

Mon Apr 19 08:50:03 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	find_host(): assert dnsentry before using it, assert
	dnsentry->addrno is positive, remove a goto and a label, and use
	mem_alloc() since zeroing is useless due to memcpy() few lines
	later.  

Sun Apr 18 14:24:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	Compile fix.  

Sun Apr 18 14:01:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Fix possible bug I encountered yesterday by caching
	old stack_size.  

Sun Apr 18 13:52:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Move menu item adding at the stack bottom case up
	front.  

Sun Apr 18 07:13:34 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation update.  

Sun Apr 18 01:35:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	menu_kbd_handler(): Cleanup home/end handling.  

Sun Apr 18 01:30:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	menu_kbd_handler(): Cleanup.  

Sun Apr 18 01:27:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	do_menu_selected(): Use mem_calloc().  

Sun Apr 18 01:24:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: menu.c, menu.h:

	Unify the menu->view and menu->first_displayed members to
	menu->first and rename menu->last_displayed to menu->last. Hope it
	is not too short.  

Sun Apr 18 01:18:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.h:

	Describe members of struct menu.  

Sun Apr 18 00:59:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Handle more actions. It might be of use for
	some people and is really not a lot of code.  

Sun Apr 18 00:44:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Cleanup usage of temp. variables. @fwd now
	simply means select_menu() 

Sun Apr 18 00:41:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Move hotkey checking and window deletion
	under the default switch label.  

Sun Apr 18 00:31:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Group more left and right action stuff.  

Sun Apr 18 00:28:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Handle right and left action together.  

Sun Apr 18 00:22:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Use switch statement for action.  

Sun Apr 18 00:10:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: listmenu.c, menu.h:

	Revert the latest listmenu patch introducing usage of FREE_* flags.
	We only need to free the member when freeing the form control which
	I overlooked.  

Sat Apr 17 18:56:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, form.h:

	Remove unused member submitted_value->file_content.  

Sat Apr 17 18:06:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: listmenu.c, menu.h:

	Introduce FREE_RECURSIVE_DATA and make free_menu() check the flags.  

Sat Apr 17 18:01:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Use new_menu() and add_to_menu(). There are
	probably some issues with the fact that allocation failure in
	add_to_menu() will result in leak and add_to_menu() enables hotkeys
	I think.  

Sat Apr 17 17:52:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Decrease indentation by returning if data != -1 and
	stack size is zero.  

Sat Apr 17 17:49:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Group data == -1 code and improve error handling.  

Sat Apr 17 17:04:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/optgroup.html:

	Add test for <optgroup> handling.  

Sat Apr 17 16:26:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.h, dialogs/menu.c, viewer/text/link.c:

	add_separator_to_menu() -> add_menu_separator().  

Sat Apr 17 15:35:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	count_menu_size(): Use foreach_menu_item().  

Sat Apr 17 15:11:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Use @size for updating @item after reallocation of
	top.  

Sat Apr 17 14:54:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	Kill line.  

Sat Apr 17 14:50:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Use foreach_menu_item() to make code look more
	normal.  

Sat Apr 17 14:37:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	do_select_submenu(): Get rid of goto by asigning @sel if
	menu_contains() the item.  

Sat Apr 17 14:35:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	do_select_submenu(): Use int_min() for @def < 0.  

Sat Apr 17 14:29:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	Apparently menu_labels() is the only place this MENU_FULLNAME flag
	is used and it only actually means anything for ordinary items and
	not submenu items.  

Sat Apr 17 14:20:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	menu_labels(): Cleanup base label allocation.  

Sat Apr 17 14:17:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	menu_labels(): Rename m -> item. We should consider what name to use
	for menu_item through out the code.  

Sat Apr 17 14:15:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	More foreach_menu_item usage.  

Sat Apr 17 14:14:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: menu.c, menu.h:

	Introduce foreach_menu_item iterator.  

Sat Apr 17 11:58:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hotkey.c, menu.c, menu.h:

	Ni wtf is ni ;) ahh it is the number of items. Renamed menu->ni to
	menu->size for shortness and descriptive value.  

Sat Apr 17 11:52:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hotkey.c, hotkey.h, menu.c, menu.h:

	Blast menu_head.  

Sat Apr 17 11:47:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	Use select_menu() and remove select_mainmenu().  

Sat Apr 17 11:39:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: menu.c, menu.h:

	Add struct mainmenu member to struct menu. The little extra added
	memory usage is on temporary dialog code. Now we can remove some of
	that stupid code duplication and it will be needed anyway when we
	introduce tabs for dialogs.  

Sat Apr 17 11:36:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memory.h:

	Warn about mem_free_*if() possibly obfuscating their users.  

Sat Apr 17 11:34:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memory.h:

	Always set freed pointer to NULL, as was discussed on #elinks.  

Sat Apr 17 11:28:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	struct main_menu's sp member is only asigned to which much mean it
	is bloat of the evil kind.  

Sat Apr 17 11:19:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Handle name is NULL case up front.  

Sat Apr 17 03:07:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/event.c:

	Doh. realloc_event() off by one error :|.  

Sat Apr 17 02:48:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	Fix mem_free_set_if_leak_debug() bug. We test @name right after so
	it should not be cleared.  

Sat Apr 17 02:39:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.c, bfu/text.c, document/docdata.h,
	document/html/parser.c, document/html/renderer.c,
	document/html/tables.c, sched/event.c, util/memory.h,
	util/string.h, viewer/text/form.c, viewer/text/search.c,
	viewer/text/textarea.c:

	Make the mem_align_alloc() macro apply the sizeof() to the object.  

Sat Apr 17 02:20:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: newwin.c, newwin.h:

	Describe this little piece of code.  

Sat Apr 17 02:09:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, osdep/newwin.c, osdep/newwin.h,
	util/memory.h:

	This is a good example of how abstractions can make code harder to
	work with. Expose _const_ open_in_new so no copy allocation is
	needed. It is just another example of my if-it-works-$(do)-it-anyway
	where $(do) could be try-to or even play-with.  

Sat Apr 17 01:52:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	oinw -> open_in_new.  

Sat Apr 17 01:37:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	Make them open_in_new data static.  

Sat Apr 17 01:35:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	open_new_window(): Inline exec_new_elinks().  

Sat Apr 17 01:30:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: newwin.c, newwin.h, beos/beos.c, os2/os2.c,
	win32/win32.c:

	Centralize all them open in new functions by putting the default
	command in the open_in_new structure.  

Sat Apr 17 01:19:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	Let the code breathe a bit.  

Sat Apr 17 01:13:15 2004  Laurent Monin <zas@norz.org>:

	* src/util/memory.h:

	When LEAK_DEBUG is defined, mem_free_if(p) set p to NULL after
	freeing it. This will cause some issues ;).  

Sat Apr 17 01:10:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, osdep/newwin.c,
	osdep/newwin.h, sched/session.c:

	Don't pass callbacks around but term_env_type for open in new window
	functions.  

Fri Apr 16 23:39:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	do_action() was moved so include obsolete.  

Fri Apr 16 17:41:01 2004  Karsten Schölzel <kuser@gmx.de>:

	* src/protocol/uri.c:

	Fix a bug in normalize_uri triggered if you enter
	"javascript:gourl('../../../');" as new url.  

Fri Apr 16 16:36:59 2004  Laurent Monin <zas@norz.org>:

	* src/: terminal/kbd.c, terminal/screen.c, terminal/tab.c,
	terminal/terminal.c, terminal/window.c, mime/dialogs.c,
	mime/backend/mailcap.c, mime/backend/mimetypes.c,
	scripting/lua/core.c, formhist/formhist.c:

	Populate with mem_free_if() and mem_free_set_if().  

Fri Apr 16 16:33:27 2004  Laurent Monin <zas@norz.org>:

	* src/: cache/cache.c, globhist/dialogs.c, globhist/globhist.c,
	lowlevel/connect.c, lowlevel/dns.c, lowlevel/home.c,
	lowlevel/interlink.c, protocol/proxy.c, protocol/uri.c,
	protocol/user.c, protocol/auth/auth.c, protocol/file/file.c,
	protocol/http/codes.c, protocol/http/http.c, sched/connection.c,
	sched/download.c, sched/event.c, sched/history.c, sched/session.c,
	sched/task.c, ssl/connect.c, util/fastfind.c, util/file.c,
	util/secsave.c, viewer/dump/dump.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c, viewer/text/vs.c:

	Populate with mem_free_if() and mem_free_set_if().  

Fri Apr 16 16:29:58 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/listmenu.c, bfu/menu.c,
	bfu/style.c, bookmarks/bookmarks.c, bookmarks/dialogs.c,
	bookmarks/backend/xbel.c, config/cmdline.c, config/dialogs.c,
	config/options.c, cookies/cookies.c, cookies/dialogs.c,
	dialogs/info.c, dialogs/status.c, document/document.c,
	document/css/stylesheet.c, document/html/parser.c,
	document/html/renderer.c, document/html/tables.c:

	Populate with mem_free_if() and mem_free_set_if().  

Fri Apr 16 16:27:01 2004  Laurent Monin <zas@norz.org>:

	* src/util/memory.h:

	mem_free_if_set() -> mem_free_set_if(), idea by Pasky.  

Fri Apr 16 16:26:39 2004  Karsten Schölzel <kuser@gmx.de>:

	* src/: document/html/parser.c, viewer/text/search.c:

	Compile fix.  

Fri Apr 16 16:16:43 2004  Laurent Monin <zas@norz.org>:

	* src/util/memory.h:

	mem_free_if(pointer) and mem_free_if_set(pointer, newpointer) were
	introduced.  

Fri Apr 16 11:10:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Minor simplification: use memacpy() instead of mem_alloc() +
	sprintf().  

Fri Apr 16 10:16:53 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	A minor compilation warning was fixed, using explicit type casting.  

Fri Apr 16 10:09:43 2004  Laurent Monin <zas@norz.org>:

	* src/: cache/cache.c, sched/session.c, sched/task.c:

	Trailing whitespaces were removed.  

Fri Apr 16 10:02:06 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/dialog.c, bfu/group.c, bfu/inpfield.c,
	bfu/inphist.c, bfu/listbox.c, bfu/text.c, bfu/widget.c,
	bookmarks/backend/default.c, config/kbdbind.c, config/opttypes.c,
	dialogs/download.c, dialogs/menu.c, dialogs/options.c,
	dialogs/status.c, osdep/getifaddrs.c, protocol/http/http.c,
	sched/session.c, util/scanner.c, util/snprintf.c,
	viewer/text/form.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c:

	Include util/math.h where it is needed (last bits).  

Fri Apr 16 09:44:12 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.h, bfu/menu.c, document/refresh.c,
	document/css/scanner.c, document/css/value.c,
	document/html/frames.c, document/html/parser.c,
	document/html/renderer.c, document/html/tables.c,
	document/plain/renderer.c, protocol/auth/auth.c, sched/event.c,
	terminal/draw.c, terminal/screen.h, viewer/text/link.c,
	viewer/text/vs.c:

	Include util/math.h where it is needed.  

Fri Apr 16 09:42:13 2004  Laurent Monin <zas@norz.org>:

	* src/: elinks.h, util/Makefile.am, util/math.h:

	int_bounds() family was moved to new util/math.h.  

Fri Apr 16 09:23:40 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/: core.c, hooks.c:

	Perl scripting module compilation issues were fixed.  

Fri Apr 16 09:20:52 2004  Laurent Monin <zas@norz.org>:

	* src/: elinks.h, osdep/generic.h:

	Include system headers before redefining macros, it fixes some
	compilation failures on some systems.  

Thu Apr 15 17:30:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Fix assertion failure.  

Thu Apr 15 16:57:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Make everybody use open_url_in_new_window() as backend.  

Thu Apr 15 16:44:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, viewer/text/link.c:

	Hmm try to centralize newwin.h usage a bit more.  

Thu Apr 15 16:32:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, viewer/text/link.c,
	viewer/text/view.c, viewer/text/view.h:

	Move all the nice open in new window code.  

Thu Apr 15 16:16:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, viewer/text/view.c, viewer/text/view.h:

	Fully support the -remote 'openurl(..., new-win)' thing.  

Thu Apr 15 16:13:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	Damn zas was right. I did break something :(.  

Thu Apr 15 15:35:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	foreach_oinw(): Everything to save a line of code. ;) .. fix bug
	from last patch.  

Thu Apr 15 15:28:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: newwin.c, newwin.h:

	Gross memory waste by adding term_env_type to open_in_new struct.
	But it simplifies a lot.  

Thu Apr 15 15:25:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/newwin.c, osdep/newwin.h, viewer/text/view.c:

	get_open_in_new(): Take term arg and do one allocation by getting
	size from can_open_in_new().  

Thu Apr 15 14:58:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	can_open_in_new(): No need to allocate when a simple loop will do.  

Thu Apr 15 14:31:25 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Make debugging code more obviously separated from true code, got rid
	of awful and misleading accif() macro, all debuggung macros are now
	prefixed with FF_DBG_. It improves readibility of non-debugging
	code.  

Thu Apr 15 14:27:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/backend/default.c, osdep/osdep.c, protocol/user.c:

	get_system_str(): Return static string and shrink using code.  

Thu Apr 15 14:21:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/user.c:

	get_user_program(): Use temp instead of wrapping funny code.  

Thu Apr 15 09:29:40 2004  Laurent Monin <zas@norz.org>:

	* NEWS:

	New options -remote and -ping were added.  

Thu Apr 15 09:18:57 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Apr 15 08:32:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.h:

	Whoops bug in binary flag.  

Thu Apr 15 08:28:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/cmdline.c, sched/session.c, sched/session.h:

	-remote-session was replaced by lazy mozilla compliant -remote
	handling. elinks -remote <urls> will just open <urls> in new
	backgrounded tabs and elinks -remote openURL(<url>, ...) will make
	it possible to do more finegrained control. Open in new window is
	still not supported.  

Thu Apr 15 02:39:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Move session info comments.  

Thu Apr 15 02:24:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, main.h, config/cmdline.c, sched/session.c,
	sched/session.h:

	Add support for -remote-session that will connect to an already
	running ELinks (or bail out) and open all the provided URIs. Again
	the intension is to support -remote argument similar to that of
	mozilla and either this can be a backend for that or just be a
	starting point for it.  

Thu Apr 15 00:55:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, main.h, config/cmdline.c, terminal/event.c:

	Implement a -ping command line argument that will hopefully help to
	make -remote handling easier. Else we can remove it later when
	-remote is running.  

Thu Apr 15 00:36:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.c, terminal.c:

	Improve the term->spec reference counting by also locking the
	default one. Else assertion failure can appear if the connecting
	ELinks exists immediately.  

Wed Apr 14 23:35:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/osdep.c, osdep/osdep.h, terminal/terminal.c,
	terminal/terminal.h:

	Move get_cwd() and set_cwd() to osdep department.  

Wed Apr 14 22:59:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	in_term(): The joy of switch statements. Decrease indentation.  

Wed Apr 14 22:55:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	Ctrl+L should now be a RESIZE event in order to always force
	redrawing.  

Wed Apr 14 22:50:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	term_send_event():Move comment.  

Wed Apr 14 22:47:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.c, terminal.c, terminal.h:

	redraw_terminal_ev(): Use term_send_event() as backend an removing
	code duplication.  
	
	redraw_terminal_cls(): Was the only user of redraw_terminal_all()
	and is now the defined as the old redraw_terminal_all which just
	calls redraw_terminal_ev() and lets term_send_event() handle screen
	erasing and resizing.  

Wed Apr 14 22:35:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	term_send_event(): Only resize and erase screen when handling INIT
	and RESIZE events. Inspired by redraw_terminal_ev().  

Wed Apr 14 22:30:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	term_send_event(): Handle INIT, RESIZE and REDRAW events by sending
	them to all windwows.  

Wed Apr 14 22:10:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Evil hacks to restore appearance of input field lines.  

Wed Apr 14 22:03:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: dialog.c, dialog.h, inphist.c:

	tab_compl_n(): Use redraw_terminal() instead of lowlevel terminal
	event sending. It bypasses any possible dialog->handle_event() by
	that should not be a problem with the current usage. Makes it
	possible to make dialog_func() static.  

Wed Apr 14 21:53:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/terminal.c:

	redraw_terminal_ev(): Propagate EV_RESIZE even to inactive tabs like
	we do in in_term().  

Wed Apr 14 21:38:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	in_term(): Use switch statement and breaks to get rid of ifs and
	gotos.  

Wed Apr 14 21:17:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, main.h, scripting/perl/core.c:

	Look mama I'm coding perl. Make ac ang av static. WTF are they
	handed to PERL_SYS_INIT() we don't support perl args on the command
	line anyway and the day we do I will fork my own ELinks ;).  

Wed Apr 14 21:01:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Update comment and more usage of connection state macros.  

Wed Apr 14 20:51:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Use add_string_to_stirng().  

Wed Apr 14 20:50:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Cleanup.  

Wed Apr 14 20:21:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_end(): Group -dump specific stuff.  

Wed Apr 14 20:14:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_start(): Maybe do it some other way but show which one (of
	multiple URLs) is the problem.  

Wed Apr 14 20:12:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_start(): Error reporting now handles unknown protocols.  

Wed Apr 14 20:11:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_start(): Show error for unsupported URI protocols.  

Wed Apr 14 20:07:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Cleanup.  

Wed Apr 14 20:02:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_formatted(): No need to return anything.  

Wed Apr 14 19:46:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: select.c, select.h:

	@terminate belongs to main.h 

Wed Apr 14 19:43:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, main.h:

	Make init() static.  

Wed Apr 14 19:40:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): More comments.  

Wed Apr 14 19:04:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, sched/session.c, sched/session.h:

	create_session_info(): Take string argument.  

Wed Apr 14 19:03:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/string.c:

	done_string(): Make it possible to call it multiple times on a
	string by only checking the magic if free()ing something.  

Wed Apr 14 18:55:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	create_session_info(): Use string utils.  

Wed Apr 14 06:30:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Improve signal handling logic.  

Wed Apr 14 06:08:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Replace obsolete FIXME with comment.  

Wed Apr 14 06:06:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Code duplication forever. Gotos never.  

Wed Apr 14 05:55:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Make distant goto users duplicate the code.  

Wed Apr 14 05:50:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, terminal/terminal.c, terminal/terminal.h:

	Unify signal setup and session info freeing in init().
	attach_terminal() now returns the created terminal.  

Wed Apr 14 05:44:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Cleanup2.  

Wed Apr 14 05:35:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Cleanup.  

Wed Apr 14 05:31:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Cleanup variable usage.  

Wed Apr 14 05:25:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Rearrange the connecting to an already running instance so
	it is grouped together with the -no-connect part.  

Wed Apr 14 05:12:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Use no-connect option for storing no connect info.  

Wed Apr 14 03:14:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/select.c:

	Uhh I love that funky code. Iterate while timer list is not empty
	and interval is less than or equal to zero.  

Wed Apr 14 03:04:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/select.c:

	Ehm .. cache_entry != timer.  

Wed Apr 14 02:35:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: select.h, signals.c:

	Fix includes? 

Wed Apr 14 02:21:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.h:

	Fix is_system_error() logic.  

Wed Apr 14 00:42:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	Add stop member to file_download struct and remove stop arg from
	abort_download.  

Wed Apr 14 00:35:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.c, sched/connection.h, sched/download.c,
	viewer/dump/dump.c:

	Last batch of state macros.  

Wed Apr 14 00:11:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, task.c:

	More is_in_result_State() usage.  

Wed Apr 14 00:09:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.c, connection.h, error.c:

	Move connection state macros and add/use is_system_error().  

Tue Apr 13 23:43:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	Goto return madness. Sorry I couldn.t resist. ;) 

Tue Apr 13 23:15:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	Make get_real_opt() take care of all the option name translation.  

Tue Apr 13 22:47:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_add_ext(): Group @fcp dependant code.  

Tue Apr 13 22:42:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_add_ext(): Them string can never be empty if we have the
	extension option.  

Tue Apr 13 22:38:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_add_ext(): Move option name translation and simplify error
	handling.  

Tue Apr 13 22:36:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_add_ext(): Cleanup.  

Tue Apr 13 22:31:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_add_ext(): Simplify dialog data initialization by making the
	struct extension strings be MAX_STR_LEN.  

Tue Apr 13 22:27:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/options.c:

	charset_list(), menu_language_list(): Cleanup.  

Tue Apr 13 18:58:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	read_file(): Use string utils for reallocation and avoid nasty
	hacks.  

Tue Apr 13 18:44:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Remove old comment.  

Tue Apr 13 18:38:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, protocol/file/file.c:

	Fix bug 377 by allowing reading from /dev/stdin when it is a pipe.  

Tue Apr 13 18:27:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	read_encoded_file(): Abuse switch noddle to handle errors.  

Tue Apr 13 18:11:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	read_encoded_file(): Minor simplification removing saved_errno.  

Tue Apr 13 16:36:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/dialogs.c, config/dialogs.c:

	Fix text before input fields with floating labels bottom padding.  

Tue Apr 13 16:30:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Right align floating labels up against the input field.  

Tue Apr 13 16:20:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Bitpicking.  

Tue Apr 13 16:17:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, protocol/auth/dialogs.c:

	Fix the input field floating label thing and convert last user.  

Tue Apr 13 16:00:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/file.h, document/css/css.c:

	Remove unused header and fix side fx.  

Tue Apr 13 15:59:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	More isspace() usage.  

Tue Apr 13 10:15:40 2004  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/connect.c, osdep/getifaddrs.h:

	System headers should be included before any local headers, this is
	fixing bug 439 reported by Victor Sahlstedt.  

Tue Apr 13 10:10:09 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation: typo fixes.  

Tue Apr 13 10:06:47 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Apr 12 23:28:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_url(): Cleanup.  

Mon Apr 12 23:01:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Check if the @rel[ative] parameter contains a protocol
	name and use translate_url() to 'set it up'.  

Mon Apr 12 22:49:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, config/dialogs.c, cookies/dialogs.c:

	By default add ': ' string to floating input field labels to reduce
	memory usage and needed error hanling.  

Mon Apr 12 21:38:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	check_number(): Make the error message guide the user.  

Mon Apr 12 08:22:43 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Apr 11 23:06:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	Cleanups.  

Sun Apr 11 22:58:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_del_ext(): Make better usage of printf format.  

Sun Apr 11 21:11:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/conf.c:

	write_config_file(): Final cleanup.  

Sun Apr 11 20:46:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: conf.c, dialogs.c, dialogs.h:

	Rename write_config_error() -> write_config_dialog().  

Sun Apr 11 20:44:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: dialogs.c, dialogs.h:

	Merge write_config_success() into write_config_error().  

Sun Apr 11 20:41:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: conf.c, dialogs.c, dialogs.h:

	Move write config dialog message composing.  

Sun Apr 11 20:13:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: conf.c, dialogs.c, dialogs.h:

	Avoid allocating args to msg_text() for the write_config_* dialogs.
	Also fixes potential leak when term was NULL for successfull writes.  

Sun Apr 11 17:24:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, viewer/text/form.c, sched/download.c:

	Avoid allocating args to msg_text().  

Sun Apr 11 17:23:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, mime/dialogs.c, protocol/user.c:

	Free args to msg_text() instead of adding them to getml().  

Sun Apr 11 16:10:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	download_error_dialog(): Decrease indentation.  

Sun Apr 11 16:08:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	download_error_dialog(): With msg_text() there is no need to
	stracpy() stuff.  

Sun Apr 11 15:47:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Remove useless test.  

Sun Apr 11 15:32:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, protocol/protocol.h, protocol/uri.c,
	sched/connection.c, sched/task.c:

	Introduce an unknown_protocol_backend that will pop up an unknown
	protocol dialog as the external handler.  

Sun Apr 11 14:38:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	continue_download_do(): Fix access of free()d memory.  

Sun Apr 11 14:35:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	continue_download_do(): Remove useless file_download cleanup. We
	only ever go there if i is NULL.  

Sun Apr 11 14:34:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	continue_download_do(): Move tq initialization up so it can be used
	to shorten lines in the whole function.  

Sun Apr 11 14:28:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	common_download_do(): Cleanup and remove goto usage by extracting
	members from and freeing cmdw_hop early.  

Sun Apr 11 14:22:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Cleanup and remove double check of resume to get last_pos.  

Sun Apr 11 14:18:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Unify file_download initialization.  

Sun Apr 11 12:43:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	save_as(): Cleanup error handling.  

Sun Apr 11 12:42:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	common_download_do(): Cleanup error handling.  

Sun Apr 11 03:03:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Don't allow exmode when anonymous.  

Sun Apr 11 00:59:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, protocol/auth/dialogs.c:

	Fix bug 392 (badly formatted HTTP auth dialog) properly.  

Sun Apr 11 00:40:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Fix bug 390 caused by incompatibility in session info after support
	for multiple URIs on the commandline was added. This is done by
	introducing some basic session magic data that should make it
	possible in the future to detect what version the client is using
	and decode the session info appropriate. With this patch a new
	ELinks will not be able to pass URIs when connecting to an old
	ELinks however it will work the other way around. It is not perfect
	but I see no other clean way to fix this bug.  

Fri Apr  9 16:42:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Add FIXME about problems reading stuff from stdin to be viewed in
	text viewer (and not dump viewer) because of not allowing special
	files.  

Fri Apr  9 16:33:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Like if !isatty(stdin) also check if !isatty(stdout) and make -dump
	implicit.  This should fix debian bug #231663 "-dump 0 to stdout
	doesn't dump; -dump 0 to pager segfaults". The segfault was by Out
	of memory error that was fixed by previous patch setting x and y
	vars before calling get_terminal_size(). This will further fix it by
	improving usability of elinks in UNIX environment.  

Fri Apr  9 13:34:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Use STDIN_FILENO macro instead of just 0. Don't know if it is
	something we should test for in configure.  

Fri Apr  9 13:33:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	get_terminal_size() might not actually assign anything to the
	referenced arguments but will still return 0. This is a bit safer
	when stdout is a pipe.  

Fri Apr  9 04:37:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Proper fix for the unchecked allocated variable freeing.  

Fri Apr  9 03:43:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Use same procedure for sending same URI as referrer as sanding true
	URI. It is alreay the proxied URI so why all the fuzz.  

Fri Apr  9 03:40:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	The data member of URI is always set.  

Fri Apr  9 03:39:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, http/http.c:

	Proposed fix for bug 436 leaking auth data through true referrer.  

Fri Apr  9 03:20:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Format enum members properly.  

Fri Apr  9 03:19:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.h, auth/auth.c, http/http.c:

	Add HTTP URI formatting classes.  

Fri Apr  9 03:13:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.h, scripting/lua/core.c:

	Introduce URI_ORIGINAL formatting class.  

Fri Apr  9 03:10:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/dialogs.c, dialogs/document.c, dialogs/download.c,
	dialogs/menu.c, document/renderer.c, protocol/uri.h,
	protocol/file/cgi.c, sched/download.c, viewer/text/link.c:

	Introduce URI_PUBLIC formatting class that should be used for all
	the URIs showed in dialogs an stuff. Is that too strict or should it
	maybe be configurable whether to show password in public URIs? It is
	even used for CGI referrer altho' I don't if that is too strict.  

Fri Apr  9 03:05:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Revert URI component strangeness. Classes will be introduced
	shortly.  

Fri Apr  9 03:03:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Move unchecked allocated var passed to getml() to the end so it
	won't keep the other ml args from being registered and cause a leak.  

Fri Apr  9 02:19:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Decrease indentation.  

Thu Apr  8 19:47:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	add_url_to_http_string(): Rewrite to not allocate no post url copy.  

Thu Apr  8 19:36:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Small workaround for URI_DEFAULT_PORT adding. Hmm I will have to
	figure out something better.  

Thu Apr  8 19:21:48 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Translation updated.  

Thu Apr  8 14:38:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h, http/http.c:

	Add support for adding default port if the URI has no port specified
	using new URI_DEFAULT_PORT component.  

Thu Apr  8 14:14:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.c, task.c:

	Fix bug in URI reference counting and add assertion about
	ses->loading_uri. Thanks to iSteve for his irc presence that lead to
	triggering the bug.  

Thu Apr  8 13:17:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	Initialize option lock.  

Thu Apr  8 13:05:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Comment out is_object_used(file_download) assertion and describe why
	we need to make it not fail when the time comes.  

Thu Apr  8 04:33:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix assertion failure when calling protocol function with unknown
	protocol.  

Thu Apr  8 02:52:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c:

	More download consistency checking. Should fix bug 399 (pasting crap
	into goto url dialog) caused by the input to start downloads and
	aborting them (using bottom halves) and then deleting before the
	bottom half gets called. Well we already know how racy the whole
	download code is so ...  

Thu Apr  8 02:00:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, util/types.h:

	Remove gross INFO_LIST hack.  

Wed Apr  7 22:24:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/dialogs.c:

	Show proxy URI info for cache entries.  

Wed Apr  7 22:14:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	parse_uri(): Remove useless test. If the protocol is unknown we bail
	out after skipping the '//'s.  

Wed Apr  7 22:10:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Improve and add comments.  

Wed Apr  7 21:53:15 2004  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	.po files were resynced, if anyone cares.  

Wed Apr  7 21:45:25 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS:

	Style fix.  

Wed Apr  7 21:15:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Add support for translating proxied URIs so even
	proxy://proxy.stuff/elinks.or.cz will work. And this proxy patch is
	even reasonably well tested. ;-) 

Wed Apr  7 21:05:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/core.c:

	What the hell does it here?!? 

Wed Apr  7 20:06:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Assert it is file:// URI that is past to transform_file_url().
	Update comment.  

Wed Apr  7 20:01:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Remove TODO/FIXME about first trying file:// since we infact do
	that.  

Wed Apr  7 19:58:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup.  

Wed Apr  7 19:53:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Clearify why we default to file:// when finding protocol.  

Wed Apr  7 19:44:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Add FIXME about translating proxied URIs.  

Wed Apr  7 19:34:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, protocol/uri.h, sched/connection.c:

	Add support for proxy:// URIs on the command line. Before it caused
	an assertion failure and it is really not that much code.  

Wed Apr  7 19:12:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix need slash after host checking introduced a few patches ago.  

Wed Apr  7 16:15:43 2004  Laurent Monin <zas@norz.org>:

	* AUTHORS:

	Kalle Olavi Niemitalo was added to AUTHORS, for its Accept-Charset
	bug fix.  

Wed Apr  7 16:11:28 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Bug #242524(Debian) was fixed. Accept-Charset header was incorrect
	with protocol.http.bugs.accept_charset = 0. Thanks to Kalle Olavi
	Niemitalo and Peter Gervai.  

Wed Apr  7 15:46:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Add FIXME about handling of irc. and other common protocol specific
	hostnames.  

Wed Apr  7 15:43:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	find_uri_protocol(): Cleanup and remove unneeded gotos.  

Wed Apr  7 15:40:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Move and properly indent find_uri_protocol().  

Wed Apr  7 15:38:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Move protocol detection to separate find_uri_protocol() function.  

Wed Apr  7 15:32:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_url(): Maintain which protocol name to add using enum
	protocol.  

Wed Apr  7 15:22:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Work on the allocated URI string. All tho' the protocol name finding
	will most certainly be run first you never know.  

Wed Apr  7 15:15:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Simplify tilde_expansion by doing it on entering translate_url().  

Wed Apr  7 15:06:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup.  

Wed Apr  7 15:03:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix detection of protocol name for URIs like www.sunpoint.net?k=1.
	Don't brainlesly add ending '/' but handle it using the
	URI_ERRNO_NO_HOST_SLASH.  

Wed Apr  7 14:24:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Improve host after slash handling by changing parse_uri() to assign
	URI host members before checking if slash is missing and
	translate_url() will now use URI host members to insert missing
	slash at the right position. http://www.sunpoint.net?k=1 will be
	translated to http://www.sunpoint.net/?k=1 and squid should be happy
	as well.  

Wed Apr  7 14:09:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/dialogs.c:

	Fix redirect info.  

Wed Apr  7 13:57:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix dir normalization for URIs like http://elinks.or.cz//bla to
	normalize to http://elinks.or.cz/bla 

Wed Apr  7 13:29:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Hrmpfh. Fix normalize dir example.  

Wed Apr  7 13:04:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Describe the dir nomalization loop. Simplify ending logic.  

Wed Apr  7 12:50:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	A little simplification and optimization. Move end_of_dir() check
	inside loop so we don't do it both in the loop invariant? and after
	it.  

Wed Apr  7 12:46:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Rewrite the direcory normalization loop without use of gotos. Fixes
	bug reported by lindi- and zas.  

Tue Apr  6 12:29:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix bug triggered on FreeBSD. Safeguarding against passing the wrong
	URI string to normalize_uri() by simplifying noparse macro.  

Tue Apr  6 11:13:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/refresh.c:

	This should fix bug 434 another sf download using document
	refreshing related thing. At least downloading w3m no longer spawns
	an extra type query box.  

Tue Apr  6 10:35:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c:

	Revert buggy insert_in_string() usage in form fields and areas.  

Tue Apr  6 09:50:42 2004  Laurent Monin <zas@norz.org>:

	* src/util/string.c:

	Assert add_to_string_list() and free_string_list() parameters.  

Tue Apr  6 09:36:10 2004  Laurent Monin <zas@norz.org>:

	* src/main.c:

	Redundant test was removed: free_string_list() checks for empty
	list.  

Tue Apr  6 07:59:48 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/viewer/dump/dump.c:

	elinks -dump did not finish.  

Tue Apr  6 07:46:30 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/viewer/dump/dump.c:

	Fix for bug 433 (unknown protocol or bad uri with -dump).  

Tue Apr  6 07:07:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix directory normalization bug by handling // used by
	translate_file_url().  

Tue Apr  6 07:04:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	First part of directory normalization loop sanification.  

Tue Apr  6 01:35:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_url(): Fix leak.  

Tue Apr  6 01:34:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Rename translate_directories() to normalize_uri() since it now does
	more work. Macros are used for controlling whether to reparse or
	not. I am aware that directory translation is currently broken and
	intent to rewrite it in a sane way ASAP.  

Tue Apr  6 01:20:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	m33p.  

Tue Apr  6 01:20:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c:

	Use insert_in_string() for text fields and areas.  

Tue Apr  6 01:13:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_url(): Make @expanded the new URI string as soon as
	possible to simplyfy.  

Tue Apr  6 01:08:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix some strange double free error.  

Tue Apr  6 00:30:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, util/string.c, util/string.h:

	Rename insert_in_uri()  to insert_in_string() and move to string
	utils.  

Tue Apr  6 00:08:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_directories(): Always pass URI struct as argument and
	instead use uristring arg to signal whether to reparse.  

Mon Apr  5 17:41:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_send_header(): Don't modify the URI. Should hopefully fix bug
	with webmail posting that rely on getting content-type header. part
	3.  

Mon Apr  5 17:38:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_send_header(): Don't modify the URI. Should hopefully fix bug
	with webmail posting that rely on getting content-type header. part
	2 

Mon Apr  5 17:35:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_send_header(): Don't modify the URI. Should hopefully fix bug
	with webmail posting that rely on getting content-type header.  

Mon Apr  5 16:58:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.h, sched/connection.c:

	Disallow NULL args to get_uri_reference().  

Mon Apr  5 16:06:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	init_connection(): Assert that proxied_uri is not PROTOCOL_PROXY.  

Mon Apr  5 10:02:40 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Apr  5 05:35:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Shorten code by returning uristring from translate_directories().  

Mon Apr  5 05:31:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Use uri_errno switch.  

Mon Apr  5 05:22:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	A few assertions.  

Mon Apr  5 05:18:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Try to optimize away some of the calls to parse_uri() by making it
	possible to hand an already parse URI to translate_directories().  

Mon Apr  5 05:06:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Pass uri struct to translate_file_url().  

Mon Apr  5 04:57:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup translate_file_url() by using insert_in_uri().  

Mon Apr  5 04:44:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Move up insert_in_uri().  

Mon Apr  5 04:33:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup transform_file_url() calling.  

Mon Apr  5 04:27:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	All that inlining is no good.  

Mon Apr  5 03:33:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Scary stuff. Complete (eek!) rewrite (Eek!) of translate_url()
	(EEK!). It now goto-loops (ehm since using a while loop would indent
	things too much? ;) a parse_uri() call + switch (the returned
	uri_errno) saving the previous uri_errno to check that progress is
	actually being made. The core part of translate_url() that figures
	out how to handle URIs without protocols is only changed to make use
	of new allocation scheme. Lots of duplicate code is removed and now
	even I can understanding what it does.  

Mon Apr  5 01:17:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, protocol/uri.c, protocol/uri.h,
	protocol/user.c, util/conv.h:

	Add support for case insensitive protocol and hostnames in the URI
	cache. It should be pretty cheap meaning no additional allocation
	needed. The basic idea is to ``prepare'' all URI strings before they
	are handed to get_uri().  
	
	It abuses that all URI composing ends up in translate_directories()
	which already mangles the string and now also lowercases the
	protocol and hostname part of the URI. The remaining part is that
	get_protocol() has been changed to use case insensitive comparing
	against known protocol names and get_user_program() will do an
	option lookup using the lowercased protocol name.  Strings handed to
	get_uri() is sanity checked before the URI is returned.  

Sun Apr  4 22:30:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/plain/renderer.c, protocol/uri.c, protocol/uri.h:

	Make parse_uri() return new uri_errno that will hopefully make
	translate_url() more efficient by pinpointing the error.  

Sun Apr  4 22:00:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	object_nolock() cached URIs.  

Sun Apr  4 22:00:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Fix bad URI reference taking in -dump redirects. Thanks to lindi-.  

Sun Apr  4 20:51:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix bug introduced in the struct uri introduction in translate_url()
	when it lived in src/protocol/url.c, revision 1.89->1.90 change.  

Sun Apr  4 17:42:01 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	Compilation fix: @url -> @uri in maybe_pre_format_html().  

Sun Apr  4 17:31:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, http/http.c:

	Make add_uri_to_string() only add slash after host if URI_DATA or
	URI_POST was specified. This makes it possible to use it instead of
	add_uri_host_to_string() in the HTTP code. I hope the it's not a
	security problem sending the real protocol string of the referrer.  

Sun Apr  4 17:04:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Fix bug in ses_goto() TASK_IMGMAP case where the new
	ses->goto_position would be point to free()d memory. Instead
	ses_goto() now allocates it.s own position pointer.  

Sun Apr  4 16:38:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	destroy_vs(): Takes care of free()ing the goto_position member.  

Sun Apr  4 16:26:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Cleanup and remove dead code.  

Sun Apr  4 16:05:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	More sanity checking before requesting frame.  

Sun Apr  4 16:02:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Check length of URI string before + assert() string. Reported by
	lindi-.  

Sun Apr  4 07:40:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	I mean now cleanup and fix leak in get_uri_string().  

Sun Apr  4 07:34:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup get_uri_port().  

Sun Apr  4 07:19:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup get_protocol_length().  

Sun Apr  4 06:15:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Move extract_fragment() up and static inline it.  

Sun Apr  4 06:12:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, protocol/uri.h, sched/session.c:

	Turn get_translated_uri() into a Swiss army knife that can also just
	extract fragment and return URI from cache.  

Sun Apr  4 05:55:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, protocol/uri.h, sched/task.c,
	viewer/dump/dump.c, viewer/text/view.c:

	Introduce get_translated_uri() which get_uri() from translate_url()s
	and possibly extract_fragment().  

Sun Apr  4 05:22:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/http/http.c, sched/connection.c,
	sched/connection.h:

	Like for the cache entry store both (proxy) uri and proxied uri for
	connections. The new member is named proxied_uri. It should
	hopefully not cost more than an extra reference and it simplifies
	the HTTP code a bit.  

Sun Apr  4 04:49:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Optimize the common case where there is no fragment in the requested
	frame uri.  

Sun Apr  4 04:44:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.c, document/html/frames.c,
	document/html/frames.h, sched/session.c:

	Make the frame description struct reference an URI.  

Sun Apr  4 04:28:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	do_follow_url(): Cleanup useless test if protocol is invalid. It can
	never be at this point.  

Sun Apr  4 04:24:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	parse_uri(): Cleanup. get_protocol_end() is now
	get_protocol_length() to save lines.  

Sun Apr  4 04:15:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h, uri.c, uri.h:

	Cleanup the uri <-> protocol interface. Since the uri parsing is the
	only user of known_protocol() it allows us to make the URI parser
	figure out the protocol part first and then query whether it is a
	known protocol. And then why not rename known_protocol() to
	get_protocol().  

Sun Apr  4 03:51:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Fix leading spaces.  

Sun Apr  4 03:46:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, protocol/uri.c, protocol/uri.h,
	sched/download.c:

	add_string_uri_filename_to_string() -> add_uri_filename_to_string()
	and take URI arg.  

Sun Apr  4 03:41:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/download.c,
	viewer/text/view.c:

	query_file(): Take URI as arg.  

Sun Apr  4 03:37:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/download.c, sched/session.c, sched/session.h,
	viewer/text/view.c:

	Rename ses->dn_url to ses->download_uri and make it an URI struct
	pointer.  

Sun Apr  4 03:18:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Fix last patch.  

Sun Apr  4 03:15:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	download_link(): Change code layout.  

Sun Apr  4 03:09:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: util/conv.c, util/conv.h, viewer/text/view.c:

	I hope this is correct. send_open_in_new_window() now adds
	-base-session and -session-ring args to the parameter string.
	encode_shell_safe_url() renamed to add_encoded_shell_safe_url() and
	now works directly on the parameter string it gets passed.  

Sun Apr  4 02:56:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_open_in_new_window(): Change code layout.  

Sun Apr  4 02:50:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_open_in_new_window(): Same as for send_open_new_window(). Do
	not use ses->dn_url to store parameters. The new elinks instance
	will request the URI we could ofcourse preload it already but that
	is not the case anyway but added as a possible TODO.  

Sun Apr  4 02:44:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Introduce init_session_info_string() to initialize string and add
	-base-session and -session-ring parameters to it.  

Sun Apr  4 02:34:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_open_new_window(): dn_url -> parameters.  

Sun Apr  4 02:31:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_open_new_window(): Hmm puzzling why we assign the parameters of
	the new elinks instance to ses->dn_url. It makes no sense and let.s
	see what will happen if we simply remove that. The only sane usage
	of dn_url is for query_file() calls as a way to keep the string
	around for possible callbacks.  

Sun Apr  4 02:07:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	do_follow_url(): Unify error handling.  

Sun Apr  4 01:48:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, sched/connection.h, sched/error.c:

	We might as well use the print_error_dialog() function for the
	javascript-not-supported popup.  

Sun Apr  4 01:40:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/error.c:

	More ænglish? 

Sun Apr  4 01:40:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.h, download.c, error.c, session.c,
	session.h, task.c:

	Introduce S_UNKNOWN_PROTOCOL and use it to substitute
	print_unknown_protocol_dialog() with print_error_dialog(..,
	S_UNKNOWN_PROTOCOL, ..).  

Sun Apr  4 01:26:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, sched/task.c,
	viewer/text/view.c:

	Simplify the error dialog interface so only the state and priority
	needs to be passed. If retry should be supported an additional URI
	arg can be passed as well.  

Sat Apr  3 20:26:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/history.c:

	Fix redirect comparison.  

Sat Apr  3 17:42:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/object.h:

	Make lock debug output more human readable.  

Sat Apr  3 17:40:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, bookmarks/bookmarks.h,
	cache/cache.c, cache/cache.h, cache/dialogs.c, config/options.h,
	cookies/cookies.c, cookies/cookies.h, document/document.c,
	document/document.h, formhist/formhist.c, formhist/formhist.h,
	globhist/globhist.c, globhist/globhist.h, protocol/uri.c,
	protocol/uri.h, sched/download.c, sched/download.h, util/object.h:

	Improve object refcount debugging by introducing an object struct
	that holds the counter and if debugging is enabled also the type
	name of the object.  

Sat Apr  3 14:54:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Indentation fixes.  

Sat Apr  3 14:51:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/: cache.c, cache.h:

	Maintain the proxy URI in the cache entry. It should not cost
	anything but a reference and a little extra when deleting but cleans
	and speeds ups things quite nicely.  

Sat Apr  3 14:32:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, protocol/finger.c, protocol/file/cgi.c,
	protocol/file/file.c, protocol/ftp/ftp.c, protocol/http/http.c,
	protocol/smb/smb.c, sched/connection.c, sched/connection.h,
	sched/download.c, sched/history.c, sched/session.c, sched/task.c,
	viewer/dump/dump.c:

	Rename download->ce to download->cached and connection->cache to
	conneciton->cached.  

Sat Apr  3 14:13:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, dialogs/status.c, document/document.c,
	document/document.h, document/renderer.c, document/css/css.c,
	document/html/frames.c, document/html/renderer.c,
	document/html/renderer.h, document/plain/renderer.c,
	document/plain/renderer.h, lowlevel/select.c, protocol/finger.c,
	protocol/file/file.c, sched/connection.c, sched/download.c,
	sched/session.c, sched/task.c, scripting/lua/core.c,
	viewer/dump/dump.c:

	Re-rename cache entry variables to cached to improve grepability.  

Sat Apr  3 13:51:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/dialogs.c:

	Re-rename cache entry variables to cached to improve grepability.  

Sat Apr  3 13:49:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/: cache.c, cache.h:

	Rename-rename cache entry variables to cached to improve
	grepability.  

Sat Apr  3 13:41:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, session.c, session.h:

	Rename cache entry variables to cached to improve grepability.  

Sat Apr  3 13:32:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 13:29:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: viewer/dump/dump.c, scripting/lua/core.c, sched/task.c:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 13:25:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/select.c, protocol/finger.c, sched/connection.c,
	sched/download.c, sched/download.c:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 13:14:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: html/renderer.c, html/renderer.h, document.c,
	html/renderer.c, plain/renderer.c, plain/renderer.h:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 13:10:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/dialogs.c, dialogs/document.c,
	document/html/frames.c:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 13:08:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Rename cache -> cache_entries.  

Sat Apr  3 13:06:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/document.c:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 12:58:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/conf.c:

	Fix assertion failure when trying to save config file an -no-home
	was specified.  

Sat Apr  3 12:33:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.h, document/html/renderer.c, sched/download.c,
	sched/session.c, sched/task.c, viewer/dump/dump.c:

	get_cache_uri_struct() is more used so rename it to get_cache_uri()
	which is then renamed to get_cache_uri_string().  

Sat Apr  3 12:20:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/: cache.c, cache.h:

	redirect_cache(): Return URI being redirected to and document it.  

Sat Apr  3 12:11:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Fix assertion failure reported by Stephen Stocker.  

Sat Apr  3 07:43:23 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	Compilation fix: return 0 instead of NULL pointer.  

Sat Apr  3 03:06:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/history.c:

	Whoopsy .. missing part of last patch.  

Sat Apr  3 03:04:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Make ses_goto() take its own URI reference.  

Sat Apr  3 02:24:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/frames.c:

	Removing an assertion that is clearly useless.  

Sat Apr  3 02:21:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, document/html/frames.c,
	sched/download.c, sched/task.c, viewer/dump/dump.c:

	Make cache_entry->redirect point to an URI struct. This nicely
	cleans things up.  

Sat Apr  3 02:11:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, protocol/http/http.c:

	Change cache redirecting to resolve the URI being redirected to at
	the redirection time meaning either when the HTTP Location header is
	handled or when appending "/" to the directory path. Hopefully it is
	clear from the patch that it is just the body of
	get_cache_redirect_uri() that has been hacked a bit to behave.  

Sat Apr  3 01:35:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, document/html/frames.c,
	sched/download.c, sched/task.c, viewer/dump/dump.c:

	Always resolve redirects relative to the cache entry. Assertions
	added to see if this is not always the case .. well anyway next
	patch (that will be quite a treat) will make it all more clear I
	hope. ;-) 

Sat Apr  3 01:22:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, protocol/file/file.c,
	protocol/ftp/ftp.c, protocol/smb/smb.c:

	Redo the cache redirection interface to be more generic. Now it is
	all relative to the cache entry which makes sense because the
	connection uri is used anyway for creating the cache entry.  

Sat Apr  3 00:13:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	request_additional_file(): URI can never be invalid so remove that
	test.  

Sat Apr  3 00:10:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	request_additional_file(): Take URI arg.  

Fri Apr  2 23:52:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/frames.c, sched/session.c, sched/session.h,
	sched/task.c:

	ses_change_frame_url(): Rename to ses_change_frame_url() and take
	URI struct arg.  

Fri Apr  2 23:43:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/frames.c:

	format_frame(): Use the cache redirect URI facility. It should be
	more correct.  

Fri Apr  2 23:38:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Fix compile error from last patch and get rid of stupid @head
	assertions.  

Fri Apr  2 23:33:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Cleanup connection cache assignment.  

Fri Apr  2 23:30:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, protocol/file/file.c,
	protocol/ftp/ftp.c, protocol/smb/smb.c:

	Unify cache redirects to directories by appending /.  

Fri Apr  2 22:51:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Remove unused post_data_start().  

Fri Apr  2 22:48:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	Remove useless post char mangling.  

Fri Apr  2 22:35:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Remove unparse_uri().  

Fri Apr  2 22:31:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Remove dead code that is getting really outdated.  

Fri Apr  2 22:27:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Oops more forgotten find_in_cache() calls this time in led land.  

Fri Apr  2 22:18:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/lua/core.c:

	Oops forgotten find_in_cache() call in lua land.  

Fri Apr  2 22:16:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	A little cleanup to improve readability by passing URI struct to
	rewrite_uri().  

Fri Apr  2 22:05:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Remove extract_proxy().  

Fri Apr  2 22:04:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, protocol/protocol.h, protocol/user.c,
	sched/task.c:

	A nicish patch that should hopefully make the last one all worth it.
	Pass URI struct to external protocol handler. Makes the job easier
	for user protocol handlers.  

Fri Apr  2 21:55:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	do_follow_url(): Cleanup protocol usage.  

Fri Apr  2 21:52:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Another patch which is a bit fishy but it will all make sence in a
	moment. Move URI struct registering up before anything else in in
	do_follow_url() it is hopefully also more correct since any external
	handler will be passed the translated URI with all the file://,
	http:// etc crap (or will break some user protocol settings?).  

Fri Apr  2 21:36:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Is it probably not so nice either but 'if you have said A ...'
	anyways try to make better usage of URI struct in find_in_cache().  

Fri Apr  2 21:21:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, dialogs/document.c,
	document/document.c, document/renderer.c, document/css/css.c,
	document/html/frames.c, protocol/http/codes.c, sched/connection.c,
	sched/task.c:

	find_in_cache(): Take URI arg.  

Fri Apr  2 21:10:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	It might look stupid and pointless at this stage but once we have
	CSS cache it will be less I hope, anyway aquire URI struct in CSS
	import handler.  

Fri Apr  2 18:58:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h:

	Merge check_protocol() into known_protocol().  

Fri Apr  2 18:41:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Removing path expansion from option parsing in the client. The bug
	is else where and it works perfectly without on FreeBSD.  

Fri Apr  2 18:15:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, document/refresh.c, protocol/proxy.c,
	protocol/uri.c, protocol/uri.h, sched/download.c, sched/session.c,
	sched/task.c, viewer/dump/dump.c:

	get_uri(): Take URI string length as arg. If -1 strlen() will be
	used.  

Fri Apr  2 18:07:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/smb/smb.c:

	Oops. Forgotten get_cache_entry(struri(..)) call.  

Fri Apr  2 18:03:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Describe the URI cache interface.  

Fri Apr  2 17:58:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, protocol/uri.h:

	get_cache_entry(): Make proper use of URI struct arg by calling new
	macro get_proxied_uri().  

Fri Apr  2 17:45:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, dialogs/document.c,
	protocol/finger.c, protocol/file/file.c, protocol/ftp/ftp.c,
	protocol/http/codes.c, protocol/http/http.c:

	get_cache_entry(): Take URI arg.  

Fri Apr  2 17:30:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, protocol/uri.c, protocol/uri.h,
	protocol/http/http.c, sched/download.c:

	get_extension_from_url(): Rename to get_extension_from_uri() and
	take URI arg. Also we now start searching for the extension at the
	uri->data position.  

Fri Apr  2 17:17:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, mime/mime.h, sched/download.c:

	get_content_type(): Take URI arg.  

Fri Apr  2 17:13:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	get_temp_name(): Take URI arg.  

Fri Apr  2 16:58:03 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/uri.c:

	Check range of port, and let display an invalid syntax error message
	if provided one is out of range.  

Fri Apr  2 16:53:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: history.c, task.c, task.h:

	ses_goto(): Take URI struct as arg.  

Fri Apr  2 16:50:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	A few fixes of accessing free()d memory and useless checking.  

Fri Apr  2 16:39:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Oops .. fix return value.  

Fri Apr  2 16:38:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	A little preparing.  

Fri Apr  2 16:35:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, sched/download.c,
	sched/task.c, viewer/dump/dump.c:

	get_cache_redirect_uri(): Return URI struct.  

Fri Apr  2 16:16:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Add TODO about lowercasing scheme and hostname part in the URI
	cache.  

Fri Apr  2 15:03:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: refresh.c, refresh.h:

	Use URI struct for document refreshing.  

Fri Apr  2 07:27:00 2004  Laurent Monin <zas@norz.org>:

	* src/: config/conf.c, document/html/tables.c,
	scripting/perl/hooks.c, terminal/kbd.c, viewer/dump/dump.c:

	Trailing spaces fixes.  

Thu Apr  1 18:34:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/proxy.c, protocol/proxy.h, sched/connection.c:

	Make get_proxy() return URI struct. Move proxy_uri validation to
	load_uri() and thus closer to the let-me-get-the-hell-out-of-here
	handler. Fix a few possible leaks in the error paths.  

Thu Apr  1 17:13:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Make the task struct use URIs.  

Thu Apr  1 16:42:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/task.c, viewer/dump/dump.c,
	viewer/text/vs.c, viewer/text/vs.h:

	Pass URI struct to init_vs() so it can never fail.  

Thu Apr  1 16:31:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Cleanup.  

Thu Apr  1 16:21:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Cleanup dead code.  

Thu Apr  1 16:19:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Remove useless allocation.  

Thu Apr  1 16:01:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	More crazy stuff.  

Thu Apr  1 15:59:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/location.c, sched/location.h, sched/session.c,
	sched/session.h, sched/task.c, viewer/dump/dump.c,
	viewer/text/marks.c, viewer/text/vs.c, viewer/text/vs.h:

	Blast vs.url and vs.url_len and flush out all the crazy code that
	made it work.  

Thu Apr  1 15:45:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	Improve zas' fix and just allow current_url to be NULL if we are
	lost.  

Thu Apr  1 15:29:38 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/rewrite/rewrite.c:

	Use have_location() to prevent segfault in goto_url_hook().  

Thu Apr  1 15:05:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/lua/core.c:

	Muddle up.  

Thu Apr  1 14:56:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, scripting/lua/core.c,
	scripting/lua/hooks.c, scripting/perl/hooks.c, viewer/text/view.c:

	XPUSHs(sv_2mortal(newSVpvn(struri(cur_loc(ses)->vs.uri),
	strlen(struri(cur_loc(ses)->vs.uri))))); 

Thu Apr  1 14:45:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, protocol/rewrite/rewrite.c,
	sched/history.c:

	Convert a few vs.url to struri(vs.uri).  

Thu Apr  1 14:44:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: renderer.c, plain/renderer.c:

	If no document title set it to the current URI.  

Thu Apr  1 14:35:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/renderer.c, document/html/frames.c,
	scripting/guile/core.c, viewer/text/view.c:

	Convert all vs->url to struri(vs->uri).  

Thu Apr  1 07:56:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/proxy.c:

	Cleanup.  

Thu Apr  1 07:53:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Pass URI struct to get_proxy().  

Thu Apr  1 06:22:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: proxy.c, proxy.h:

	get_proxy() and friends using URI structs.  

Thu Apr  1 06:08:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	ALittleCleanup.  

Thu Apr  1 06:06:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.c, sched/connection.h, sched/download.c,
	sched/session.c, sched/task.c, viewer/dump/dump.c:

	load_url() -> load_uri() and take URI struct as arg.  

Thu Apr  1 05:57:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/smb/smb.c:

	Compile fixes. Thanks to Zardoz.  

Thu Apr  1 05:18:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Translate real_url to an URI struct.  

Thu Apr  1 05:09:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, document.h, renderer.c:

	Pass vs->uri to get_cached_document() and init_document().  

Thu Apr  1 05:03:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, dialogs/menu.c, scripting/lua/core.c:

	Tune a few view state URI composing.  

Thu Apr  1 05:02:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/history.c, viewer/text/view.c:

	View state comparing optimizations.  

Thu Apr  1 05:01:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: viewer/text/vs.c, viewer/text/vs.h, sched/session.c:

	Add URI struct member to view_state.  

Thu Apr  1 04:15:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/dialogs.c, protocol/ftp/ftp.c, protocol/smb/smb.c:

	More get_uri_string() usage.  

Thu Apr  1 04:09:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	Rename http_error_info->url to ->uri and change to point to an URI
	struct.  

Thu Apr  1 03:56:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	No good patch.  

Thu Apr  1 03:22:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix the leak introduced in file:/// fallback for non existing files
	fix.  

Thu Apr  1 02:59:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, sched/download.c,
	sched/task.c, viewer/dump/dump.c:

	get_cache_redirect_uri(): Take URI struct.  

Thu Apr  1 02:48:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, sched/download.c, sched/history.c,
	sched/session.c, sched/session.h, sched/task.c:

	Change session->loading_uri to point to an URI struct.  

Thu Apr  1 01:51:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Cleanup return type checking.  

Thu Apr  1 01:47:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.c, sched/session.c,
	sched/session.h:

	type_query->url -> type_query->uri 

Thu Apr  1 01:30:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.c, sched/session.c,
	sched/session.h:

	type_query->url -> type_query->uri 

Thu Apr  1 01:25:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Change file_to_load->uri to point to an URI struct.  

Thu Apr  1 01:20:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	file_to_load->url -> file_to_load->uri 

Thu Apr  1 01:09:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, sched/download.c, sched/history.c,
	sched/session.c, sched/session.h, sched/task.c:

	session->loading_url -> session->loading_uri 

Thu Apr  1 01:01:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, sched/download.c,
	sched/task.c, viewer/dump/dump.c:

	get_cache_redirect_uri(): Generalized redirect URI composer.  

Thu Apr  1 00:37:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	Change file_download->uri to point to an URI struct. BTW there seem
	to have sneaked in a leak when aborting downloads. Well well 

Thu Apr  1 00:13:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	file_download->url -> file_download->uri 

Thu Apr  1 00:09:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/plain/renderer.c, protocol/file/cgi.c:

	get_no_post_url() -> get_uri_string(..., ~URI_POST) 

Wed Mar 31 23:47:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/cgi.c, protocol/http/http.c,
	sched/connection.c, sched/connection.h:

	Change connection referrer to point to an URI struct.  

Wed Mar 31 23:40:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	get_uri_reference(): Be lazy and handle NULL URIs too.  

Wed Mar 31 23:38:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/cgi.c, protocol/http/http.c,
	sched/connection.c, sched/connection.h:

	connection->ref_url -> connection->referrer 

Wed Mar 31 23:33:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.c, sched/connection.h, sched/download.c,
	sched/session.c, viewer/dump/dump.c:

	load_url(): Take referrer as URI struct.  

Wed Mar 31 23:32:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h:

	Change session referrer to point to an URI struct.  

Wed Mar 31 23:17:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, session.c, session.h, task.c:

	session->ref_url -> session->referrer 

Wed Mar 31 22:42:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/status.c, document/document.c, document/document.h,
	document/refresh.c, document/renderer.c, document/plain/renderer.c,
	sched/session.c, sched/session.h, sched/task.c:

	Use URI cache for documents. set_session_referrer() now takes URI
	struct.  

Wed Mar 31 22:39:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.h:

	Add macro to get the cache entry URI struct.  

Wed Mar 31 22:00:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/status.c, document/document.c, document/document.h,
	document/refresh.c, document/renderer.c, document/plain/renderer.c,
	sched/session.c, sched/task.c, viewer/text/view.c:

	document->url -> document->uri 

Wed Mar 31 21:50:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	get_uri_reference(): Returned the locked URI.  

Wed Mar 31 20:31:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	lowlevel/connect.c, protocol/finger.c, protocol/uri.c,
	protocol/uri.h, protocol/user.c, protocol/file/cgi.c,
	protocol/file/file.c, protocol/ftp/ftp.c, protocol/http/http.c,
	protocol/smb/smb.c, sched/connection.c, sched/connection.h,
	sched/session.c:

	Make the connection struct use the URI cache. Make struri() take URI
	pointer.  

Wed Mar 31 20:29:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, document/renderer.c,
	protocol/http/codes.c, sched/task.c:

	Fix URI utility includes.  

Wed Mar 31 16:53:54 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/uri.c:

	Assert parameters in get_uri_cache_entry(), safer for now, imho.  

Wed Mar 31 16:47:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	protocol/uri.c, protocol/uri.h, viewer/dump/dump.c:

	Reintroduce the URI cache. Used for cache entries only.  

Wed Mar 31 00:11:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/scripting/lua/core.c:

	Test file existence to avoid Lua error reporting (under version
	5.x).  Fixes debian bug #231760 ('dbug 231760' using URI rewrite).  
	Patch by Kevin B. McCarty. Untested.  

Tue Mar 30 23:05:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/history.c, sched/session.c, sched/session.h,
	sched/task.c, viewer/text/view.c:

	set_referrer(): Move to C file and rename to set_session_referrer().  

Tue Mar 30 15:42:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	detach_formatted(): Use free_link().  

Tue Mar 30 10:14:49 2004  Laurent Monin <zas@norz.org>:

	* test/underline.html:

	Underline tests.  

Tue Mar 30 00:50:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	We don.t support string escape seqs, yet.  

Tue Mar 30 00:47:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Temporary fix for inf. loop reported by pasky.  

Tue Mar 30 00:36:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Make background property value parsing loop look more sane.  

Tue Mar 30 00:22:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	More garbage. You can thank pasky for this.  

Tue Mar 30 00:10:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Simplify/optimize token skipping.  

Tue Mar 30 00:10:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fix typo.  

Mon Mar 29 23:03:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	In translate_url(), if file_exists() returns false setting not_file
	to true is a bad assumption since @prefix is not changed which again
	causes any URI that is not recognized as being some other protocol
	to fallback to file:///.  Changing the @prefix is also not good
	since it gives the error message "Bad URI syntax". Leaving it like
	this will give a "No such file or directory" error.  Was introduced
	in 1.83 -> 1.84. A potential memleak of expanded is still there but
	I can.t figure this messy function.  
	
	Thanks to lindi- for helping to debug this thing. ;) 

Mon Mar 29 17:42:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Expand relative filenames in the client so they will always work
	when handled in the master. Idea by lindi-.  

Sun Mar 28 19:01:48 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/file/file.c:

	Fix: do not show .. for / directory.  

Sun Mar 28 18:37:01 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	One more use for table_frames stuff.  

Sun Mar 28 18:29:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Use bitfields in struct table_frames.  

Sun Mar 28 18:25:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@tf -> @table_frames.  

Sun Mar 28 18:23:31 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Assert @result too in get_table_frames().  

Sun Mar 28 18:21:39 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Struct table_frames was introduced, it helps to get frames info from
	table frame fields through new get_table_frames() function.  

Sun Mar 28 18:00:41 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Minor code cleanup.  

Sun Mar 28 17:58:22 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Table frames related calculations cleanup.  

Sun Mar 28 17:48:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Unwanted background color appearing at left of tables was fixed (bug
	398). Patch by Jonas.  

Sat Mar 27 16:31:21 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/bfu/hierbox.c:

	Brainless workaround for bug 397. Real fix is needed.  

Fri Mar 26 18:15:02 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Minor tidyup. A useless FIXME was removed.  

Fri Mar 26 18:05:45 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Do not call safe_hard_write() if there is no byte to write.  

Fri Mar 26 17:56:53 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Label fr was renamed free_and_return.  

Fri Mar 26 17:55:50 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/signals.c:

	Fix wrong #include: kbd.c -> kdb.h.  

Fri Mar 26 17:49:52 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	@c -> @bytes_read 

Fri Mar 26 17:46:10 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	RD() macro was moved near the place where it is used.  

Fri Mar 26 17:42:05 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Code redundancy was slightly reduced by introducing
	safe_hard_write().  

Thu Mar 25 17:34:59 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* contrib/elinks.spec.in:

	A lot of bconds. Added hooks.pl.  

Thu Mar 25 17:33:57 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* contrib/: Makefile.am, perl/.cvsignore, perl/hooks.pl:

	Stubs for perl scripting engine.  

Wed Mar 24 19:35:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Revert wrong encoding optimization. I must be getting out of shape.  

Wed Mar 24 15:10:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Minor optimization of file encoding guessing.  

Tue Mar 23 20:44:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	ses_forward(): A little clarity and optimization of why we lower
	bound the URL length of the created location.  

Tue Mar 23 20:33:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Tidyup.  

Tue Mar 23 13:50:54 2004  Laurent Monin <zas@norz.org>:

	* test/tablebg.html:

	Table bgcolor test.  

Mon Mar 22 14:35:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	cookies/cookies.c, dialogs/document.c, dialogs/download.c,
	dialogs/menu.c, dialogs/status.c, document/document.c,
	document/document.h, document/refresh.c, document/renderer.c,
	document/html/frames.c, document/plain/renderer.c,
	lowlevel/connect.c, mime/mime.c, mime/mime.h, protocol/finger.c,
	protocol/uri.c, protocol/uri.h, protocol/user.c,
	protocol/auth/auth.c, protocol/file/cgi.c, protocol/file/file.c,
	protocol/ftp/ftp.c, protocol/http/blacklist.c,
	protocol/http/blacklist.h, protocol/http/codes.c,
	protocol/http/http.c, protocol/rewrite/rewrite.c,
	sched/connection.c, sched/connection.h, sched/download.c,
	sched/download.h, sched/history.c, sched/location.c,
	sched/location.h, sched/session.c, sched/session.h, sched/task.c,
	util/string.h, viewer/dump/dump.c, viewer/text/marks.c,
	viewer/text/view.c, viewer/text/vs.c, viewer/text/vs.h:

	Revert the lot of struct uri changes. Pasky warned me that it
	sounded scary and the very first bug report plus the fact that it
	was all made in a proof of concept manner was too convincing. We
	should still persue the idea tho' because they rock.  

Mon Mar 22 04:51:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, document.h, renderer.c:

	Pass URI directly to init_document() to avoid error handling.  

Mon Mar 22 04:32:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	done_uri(): Optimize to only lookup in the map when releasing URIs.  

Mon Mar 22 04:15:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	Use URI struct for http error code handling.  

Mon Mar 22 04:03:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/location.c, sched/session.c, sched/task.c,
	viewer/text/marks.c:

	Cleanup and don't allocate extra memory for the URI string.  

Mon Mar 22 04:00:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Oops clear local view state variable.  

Mon Mar 22 03:59:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: location.h, session.h:

	Remove deprecated comments.  

Mon Mar 22 03:58:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Cleanup and use local view state variable.  

Mon Mar 22 03:47:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, dialogs/menu.c, document/renderer.c,
	document/html/frames.c, sched/location.h, sched/session.c,
	sched/task.c, viewer/dump/dump.c, viewer/text/view.c,
	viewer/text/vs.c, viewer/text/vs.h:

	Use struct URI for view states. Removing lots of dangerous code and
	simplifying things.  

Mon Mar 22 03:23:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, protocol/rewrite/rewrite.c,
	sched/history.c, sched/location.h, sched/session.c, sched/task.c:

	Use get_location_url() macro when dealing with view states.  

Mon Mar 22 03:01:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, document/renderer.c,
	document/html/frames.c, viewer/text/vs.h:

	Use get_vs_cache_entry() macro when dealing with view states.  

Mon Mar 22 02:51:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/location.c, sched/session.c, viewer/dump/dump.c,
	viewer/text/marks.c:

	Getting ready for a hostile take over. Use mem_calloc() when dealing
	with view states.  

Mon Mar 22 02:44:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Tidy up.  

Mon Mar 22 02:43:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/history.c, sched/session.c, viewer/text/view.c,
	viewer/text/vs.h:

	get_vs_url_copy(): Wrap the world.  

Mon Mar 22 01:18:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, protocol/uri.c, protocol/uri.h,
	protocol/http/http.c, sched/download.c:

	get_extension_from_url(): Take struct URI and rename to
	get_uri_extension().  

Mon Mar 22 01:08:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, mime/mime.h, sched/download.c:

	Pass URI to get_content_type().  

Mon Mar 22 01:04:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.c, sched/session.c,
	sched/session.h:

	Use struct URI for type queries.  

Sun Mar 21 23:55:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/cgi.c, protocol/http/http.c,
	sched/connection.c, sched/connection.h, sched/download.c,
	sched/session.c, sched/session.h, sched/task.c, viewer/dump/dump.c:

	Change both session->ref_url and connection->ref_url to use URI
	struct and rename to referrer.  

Sun Mar 21 23:26:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Use URI for file_to_load struct.  

Sun Mar 21 23:18:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	Use URI for file downloads.  

Sun Mar 21 22:57:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/renderer.c, document/plain/renderer.c,
	protocol/file/cgi.c:

	With the handy URI struct we can use get_uri_string() instead of
	get_no_post_url().  

Sun Mar 21 22:48:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Only maintain URI cache reference counter over the number of entries
	in the cache so it will be easier to reference URIs from outside.  

Sun Mar 21 22:43:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.h, sched/session.c, sched/session.h,
	sched/task.c, viewer/text/view.c:

	set_session_referrer(): Take URI struct.  

Sun Mar 21 22:26:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/history.c, sched/session.c, sched/session.h,
	sched/task.c, viewer/text/view.c:

	Move set_referrer() to .c file and rename it to
	set_session_referrer().  

Sun Mar 21 16:30:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/status.c, document/document.c, document/document.h,
	document/refresh.c, document/renderer.c, document/plain/renderer.c,
	sched/session.c, sched/task.c, viewer/text/view.c:

	Add real URI to the document struct.  

Sun Mar 21 16:16:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Move URI refcounting to the URI struct.  

Sun Mar 21 15:58:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	lowlevel/connect.c, protocol/finger.c, protocol/uri.c,
	protocol/uri.h, protocol/user.c, protocol/file/cgi.c,
	protocol/file/file.c, protocol/ftp/ftp.c, protocol/http/http.c,
	sched/connection.c, sched/connection.h, sched/session.c:

	Use URI cache for connection->uri. A lot of
	s/conn->uri\./conn->uri->/. We now always free the get_proxy() URI
	when initializing a connection.  

Sun Mar 21 15:39:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, document/plain/renderer.c,
	protocol/uri.c, protocol/uri.h, protocol/file/cgi.c,
	protocol/ftp/ftp.c, protocol/http/http.c, sched/session.c:

	Last more or less trivial users of the URI data string. Blast old
	data string members. Boooooring. But now the fun can begin. :) 

Sun Mar 21 15:29:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Use the URI data string for the HTTP protocol stuff.  

Sun Mar 21 15:23:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Use the URI data string for the cookie stuff. Plus little cleanup.
	Eek 

Sun Mar 21 15:10:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/: cgi.c, file.c:

	Use the URI data string for the file protocol stuff.  

Sun Mar 21 15:08:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/user.c:

	Use the URI data string for the user protocol stuff.  

Sun Mar 21 14:59:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Add URI data string struct and use internally in URI land.  

Sun Mar 21 14:41:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	Don't search for POST_CHAR that is the job of parse_uri().  

Sun Mar 21 14:30:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, protocol/uri.c, protocol/uri.h,
	protocol/user.c, protocol/file/cgi.c, protocol/file/file.c,
	protocol/ftp/ftp.c, protocol/http/http.c, sched/session.c:

	uri->data -> uri->datastr 

Sun Mar 21 13:39:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	protocol/uri.c, protocol/uri.h, viewer/dump/dump.c:

	Introducing an URI cache.  

Sun Mar 21 02:22:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Blast old URI host nonstrings.  

Sun Mar 21 02:21:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/http/http.c, sched/connection.c:

	Convert last users in connection land to use URI host string.  

Sun Mar 21 02:21:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Convert last users in cookie land to use URI host string.  

Sun Mar 21 02:10:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Use the URI host string for the host connection stuff.  

Sun Mar 21 02:04:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	is_in_domain(): Take server as string struct.  

Sun Mar 21 01:56:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	check_domain_security(): Take server as string struct.  

Sun Mar 21 01:49:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	More URI host string trivial usage.  

Sun Mar 21 01:45:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/plain/renderer.c, protocol/uri.h:

	Use URI host string.  

Sun Mar 21 01:41:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_to_string(): Use host string.  

Sun Mar 21 01:39:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Bleh.  

Sun Mar 21 01:37:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: blacklist.c, blacklist.h, http.c:

	Change the blacklist interface to use host strings.  

Sun Mar 21 01:31:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Make the URI host string usable.  

Sun Mar 21 00:32:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/user.c:

	Cleanup subst_cmd() by unifying adding of shell safe chars.  

Sun Mar 21 00:21:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h, user.c, http/http.c:

	Store URI port info in a string struct.  

Sun Mar 21 00:04:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Add ipv6 member to struct uri.  

Sat Mar 20 23:53:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, http/http.c:

	Remove add_uri_host_to_string() and make it possible to use
	add_uri_to_string() instead.  

Sat Mar 20 23:35:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.h, protocol/user.c, sched/connection.c:

	A little cleanup of the URI host sequence capturing.  

Sat Mar 20 21:01:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, lowlevel/connect.c, protocol/uri.c,
	protocol/uri.h, protocol/user.c, protocol/http/http.c,
	sched/connection.c:

	uri->host -> uri->hoststr 

Sat Mar 20 21:01:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/string.h:

	More (yet unused) utils.  

Sat Mar 20 18:55:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h, auth/auth.c, ftp/ftp.c:

	Store protocol password info in a string struct.  

Sat Mar 20 18:32:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/finger.c, protocol/uri.c, protocol/uri.h,
	protocol/user.c, protocol/auth/auth.c, protocol/ftp/ftp.c,
	sched/connection.c, util/string.h:

	Store protocol user info in a string struct. Add a few handy string
	struct macros.  

Sat Mar 20 14:39:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/frames.c:

	Check end pointer when using strto[u]l() to parse frame dimensions.
	Idea by Christian Haggstrom <c00chm@cs.umu.se> 

Fri Mar 19 16:10:20 2004  Petr Baudis <pasky@ucw.cz>:

	* Makefile.base:

	Polished and fixed grammar.  

Fri Mar 19 08:45:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/frames.c:

	Fix non portable use of strtoul() that caused frames not to be
	rendered. Reported by Daniel E. Macks <dmacks@netspace.org> 

Wed Mar 17 09:08:22 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	A segfault occuring while navigating through main menu was fixed
	(bug 394). It was a missing break statement.  

Tue Mar 16 15:38:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listbox.c:

	Only restore the previous listbox context when there are any boxes
	and thus the restore sanity checking will run. Fixes bug 391 -
	assertion failure when reopening download manager.  

Tue Mar 16 09:14:39 2004  Laurent Monin <zas@norz.org>:

	* src/util/: conv.c, conv.h:

	Take care of - char that may indicate a command line option, patch
	by Solar Designer.  

Sun Mar 14 06:22:01 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/cookies/dialogs.c:

	Removed draw_cookie. Set cookie->box_item->text instead.  

Sat Mar 13 17:57:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	IFrame-like handling for the <applet> tag (show alt and link to
	code).  

Sat Mar 13 17:27:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/: garbage.html, styletags.html:

	A few test cases.  

Sat Mar 13 15:17:03 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/auth/dialogs.c:

	Block auth dialog after all memory allocation tests, safer.  

Sat Mar 13 15:12:23 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/auth/dialogs.c:

	Auth dialog layout was improved a bit by using floating labels, and
	a workaround for bug 392 was provided, by using maximum width for
	dialog.  

Fri Mar 12 10:13:28 2004  Laurent Monin <zas@norz.org>:

	* NEWS:

	NEWS update: cookies creation and modification 

Thu Mar 11 13:54:09 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/dialogs.c:

	Tidy up.  

Thu Mar 11 13:43:09 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/dialogs.c:

	Do proper check for expires and secure cookies values using
	strtol().  

Thu Mar 11 04:44:23 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/cookies/: cookies.c, cookies.h, dialogs.c:

	Possibility adding new cookies, but only for "old" servers.  
	Introduced listbox draw op: draw_cookie.  

Tue Mar  9 17:44:18 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/cookies/dialogs.c:

	New feature: editing cookies.  

Tue Mar  9 15:24:46 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/inphist.c, bookmarks/backend/default.c,
	cookies/cookies.c, formhist/formhist.c, globhist/globhist.c,
	util/file.c, util/file.h:

	Get rid of weird/useless safe_fgets(), just use fgets().  

Tue Mar  9 15:05:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Add note about broken text alignment in CSS apllier.  

Tue Mar  9 14:09:13 2004  Laurent Monin <zas@norz.org>:

	* src/formhist/formhist.c:

	Minor tidy up.  

Tue Mar  9 12:24:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, src/elinks.h, src/bfu/hotkey.c,
	src/bfu/menu.c, src/cache/dialogs.c, src/config/options.c,
	src/config/options.h, src/dialogs/menu.c, src/document/document.c,
	src/modules/version.c, src/osdep/stub.h,
	src/protocol/rewrite/rewrite.c, src/sched/connection.c,
	src/util/error.c, src/util/error.h, src/util/lists.h,
	src/util/memlist.h, src/util/object.h, src/util/profile.h,
	src/util/string.h:

	DEBUG -> CONFIG_DEBUG .. it seems that perl is a namespace polluter
	.. like we didn't know that already! ;-) 

Tue Mar  9 05:32:09 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Translation update.  

Fri Mar  5 17:58:53 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/config/dialogs.c:

	Allow to add again previously deleted option.  

Fri Mar  5 10:41:10 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/config/: conf.c, options.h, options.c:

	Support for saving deleted options. Heavy use of watermarks.  
	Prevented unsetting builtin options.  

Fri Mar  5 01:05:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	Summarize new stuff for those too lazy to read the ChangeLog file.
	Please help keeping it updated (although some of the entries added
	with this patch might be to unimportant?) 

Thu Mar  4 10:57:27 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Mar  3 18:12:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: view.c, link.c:

	Cleanup and use get_current_link().  

Wed Mar  3 18:10:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c:

	Use get_current_link() and shorten lines.  

Wed Mar  3 18:07:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	Cleanup and use get_current_link().  

Wed Mar  3 18:03:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/view.h:

	Better checking before looking up the current link.  

Wed Mar  3 17:42:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/view.h, sched/session.c:

	Introduce get_current_link() macro.  

Wed Mar  3 17:27:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, scripting/lua/core.c:

	get_current_link() -> get_current_session_link().  

Wed Mar  3 17:08:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Cleanup and remove goto usage.  

Wed Mar  3 16:34:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Fix wrong width and height in comparison. Fixes bug 388.  

Wed Mar  3 12:00:05 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: config/options.inc, protocol/http/http.c:

	Information how many bars is displayed by ELinks is sent in
	User-Agent header field. Note, that this information will be
	accurate for new instances only when they run with -no-connect
	option.  

Wed Mar  3 08:21:27 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* acconfig.h, configure.in:

	Missing commit.  

Tue Mar  2 17:06:15 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: Makefile.am, main.c, main.h, scripting/Makefile.am,
	scripting/scripting.c, scripting/perl/.cvsignore,
	scripting/perl/.vimrc, scripting/perl/Makefile.am,
	scripting/perl/core.c, scripting/perl/core.h,
	scripting/perl/hooks.c, scripting/perl/hooks.h:

	Support for Perl scripting. Scripts are read from file 'hooks.pl'.  
	Example hooks.pl will be available later.  

Mon Mar  1 19:17:51 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: config/options.inc, intl/charsets.c:

	Support for System codepage.  

Sun Feb 29 02:47:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/sgml.c:

	file sgml.c was initially added on branch ECMASCRIPT.  

Sat Feb 28 06:25:18 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Spelling fixes.  

Fri Feb 27 16:22:40 2004  Laurent Monin <zas@norz.org>:

	* src/intl/: charsets.c, charsets.h:

	Make get_entity_string() static since it is only used by charsets.c
	for now.  

Fri Feb 27 11:30:15 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Fix: copy http_version structure contents not structure pointer. How
	did it remain unnoticed until now ? 

Fri Feb 27 11:20:08 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/: http.c, http.h:

	Provide and use macros to check http version, some FIXME were added.  

Fri Feb 27 10:46:27 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Minor tidyup: useless goto is gone, a typo in a comment was fixed,
	minor style changes.  

Fri Feb 27 09:27:52 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Feb 27 06:18:43 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Translation update.  

Thu Feb 26 23:47:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/tab.c:

	Select the clicked tab when the last character of the tab is
	clicked. Really this time. Quazgaa promises.  

Thu Feb 26 17:35:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Compile fix. Reported by Zardoz.  

Thu Feb 26 16:48:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Group similar action handler calling using a magic variable. Don't
	know if this kind of optimization is stupid.  

Thu Feb 26 16:12:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c,
	terminal/tab.c, terminal/tab.h:

	Add support for moving the current tab back and forth. Requested by
	Zellner.  

Thu Feb 26 01:13:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/status.c:

	In display_tab_bar, increment |tab->width| if it is the last tab so
	that the space at the end of the tab bar is counted as part of the
	last tab.  

Thu Feb 26 01:02:59 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/status.c:

	Preparatory clean-up: In display_tab_bar, store the actual tab width
	in |actual_tab_width|.  

Thu Feb 26 00:59:39 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/status.c:

	Trivial clean-up: In display_tab_bar, use @tab_ses instead of
	tab->data, as the latter has previously been assigned to the former.  

Thu Feb 26 00:50:56 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/tab.c:

	Fix behaviour when clicking on the tab-bar: ignore clicks on
	separators, and select the correct tab when clicking on the first
	character of a tab. Thanks to Quazgaa for taking my initial attempt
	at fixing this and making it work correctly when I was too stupid.
	This fixes bug 389.  

Mon Feb 23 11:20:33 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: main.c, config/cmdline.c, config/cmdline.h:

	Fixed elinks --version.  

Sun Feb 22 21:53:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/sgml.h:

	file sgml.h was initially added on branch ECMASCRIPT.  

Sun Feb 22 18:45:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/html/.vimrc:

	file .vimrc was initially added on branch ECMASCRIPT.  

Sun Feb 22 18:45:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/html/Makefile.am:

	file Makefile.am was initially added on branch ECMASCRIPT.  

Sun Feb 22 18:45:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/html/html.h:

	file html.h was initially added on branch ECMASCRIPT.  

Sun Feb 22 18:45:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/html/.cvsignore:

	file .cvsignore was initially added on branch ECMASCRIPT.  

Sun Feb 22 18:45:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/html/html.c:

	file html.c was initially added on branch ECMASCRIPT.  

Sun Feb 22 18:45:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/html/attribute.inc:

	file attribute.inc was initially added on branch ECMASCRIPT.  

Sun Feb 22 18:45:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/html/element.inc:

	file element.inc was initially added on branch ECMASCRIPT.  

Sun Feb 22 13:30:21 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Feb 21 06:29:27 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/uri.c:

	Expand tilde first, then test if file exists.  

Fri Feb 20 17:08:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/.vimrc:

	file .vimrc was initially added on branch ECMASCRIPT.  

Fri Feb 20 17:08:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/.cvsignore:

	file .cvsignore was initially added on branch ECMASCRIPT.  

Fri Feb 20 16:32:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	Gettextize HTTP error document.  

Fri Feb 20 16:03:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	Oops fix TODOer.  

Fri Feb 20 16:01:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: codes.c, codes.h, http.c:

	Use question_queuing to make it straight forward to i10n HTTP error
	messages. TODO: Freeing of http_error_info when freeing
	question_queue.  

Fri Feb 20 15:19:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.h, protocol/http/http.c:

	Fix do_auth_dialog() prototyping.  

Fri Feb 20 14:41:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, protocol/auth/dialogs.c,
	protocol/auth/dialogs.h, protocol/http/http.c, sched/session.c,
	sched/session.h:

	Make the question_queue more bottomhalf like taking data pointer.  

Fri Feb 20 14:24:48 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Updated hungarian translation.  

Fri Feb 20 10:56:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h:

	Disable exmode by default. It is not useful bloat.  

Fri Feb 20 06:26:12 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/uri.c:

	file_exists used instead of access.  

Fri Feb 20 01:49:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/html.h:

	file html.h was initially added on branch ECMASCRIPT.  

Fri Feb 20 01:49:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/html.c:

	file html.c was initially added on branch ECMASCRIPT.  

Thu Feb 19 20:43:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/dns.c:

	Make addrno writing/reading capable of dealing of partial
	write()s/read()s, this should fix random DNS failures on some
	systems with not-so-smooth-linux-glibc-like buffering.  

Thu Feb 19 17:48:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/dns.c:

	Be more paranoid about passing data from the async resolver.  

Thu Feb 19 15:43:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/stub.c:

	Fixed dangling 'unsigned'. Damn, people, this stuff has some given
	order ;-).  

Thu Feb 19 14:39:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/: stub.c, stub.h:

	Use strictly (char *) instead of (unsigned char *) in the stubs,
	because that's how these functions are defined in the system.
	Otherwise you will run into problems like different problems in
	conditional expressions on systems not having these, like fissie
	just reported.  

Thu Feb 19 14:30:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/stub.h:

	util/stub.h -> osdep/stub.h. Happenned on Jan 28 but Jonas didn't
	commit it.  

Wed Feb 18 21:52:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Remove bogus compiler bug notice, the bug is in me.  

Wed Feb 18 21:46:22 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS, src/document/html/tables.c:

	Prevent a crash caused by a compiler bug (?) on OS X 10.3.2/XCode
	1.1/gcc3.3, reported by Daniel Macks <dmacks@netspace.org>.  

Wed Feb 18 18:56:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/bookmarks.c:

	Try to fix session auto saving by using ses->loading_url if
	get_current_url() fails.  

Wed Feb 18 18:46:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix typeahead text drawing so the matched chars are properly
	highlighted.  

Wed Feb 18 14:03:10 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Feb 18 06:27:47 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/uri.c:

	When url is without protocol use file:// if file with filename ==
	url exist.  

Tue Feb 17 19:17:36 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	ETag comparaison was fixed. We now take in account weakness or
	strongness of ETags, and compare them case-sensitively, compliance
	with RFC2616 section 3.11 and 13.3.3 was improved.  

Tue Feb 17 06:03:08 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/dialogs/menu.c:

	Added "Wrap text" menu entry.  

Mon Feb 16 06:33:19 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation update.  

Sun Feb 15 16:35:21 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Feb 15 16:33:40 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.inc:

	"\%u" -> "%u". Prevent i18n issues in Info box of these options.  

Sun Feb 15 12:49:30 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/uri.c:

	Do not decode %7E in filenames.  

Sun Feb 15 12:48:48 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: config/options.inc, viewer/dump/dump.c:

	Added configuration options:
	document.dump.{header,footer,separator}.  

Sun Feb 15 12:14:19 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: renderer.c, renderer.h, tables.c:

	Add support for table bordercolor attribute. To keep this patch as
	simple as possible we do not honour bordercolor attributes in tr/td
	tags (yet). Table bgcolor applies to all cell borders.  

Sun Feb 15 06:57:09 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/main.c:

	ELinks should no connect to previous instances when act as a pager.  

Sat Feb 14 17:54:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/navigator.c:

	file navigator.c was initially added on branch ECMASCRIPT.  

Sat Feb 14 17:54:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/navigator.h:

	file navigator.h was initially added on branch ECMASCRIPT.  

Sat Feb 14 13:56:11 2004  Laurent Monin <zas@norz.org>:

	* src/util/color.inc:

	Some notes of where this color list comes from where added. It is
	unclear if there is any copyright on it. Let me know if it is the
	case. Suggested by Pasky.  

Sat Feb 14 00:53:04 2004  Laurent Monin <zas@norz.org>:

	* src/util/: color.inc, color_s.inc:

	cvs Id were added.  

Fri Feb 13 20:38:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/Makefile.am:

	file Makefile.am was initially added on branch ECMASCRIPT.  

Fri Feb 13 20:38:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/parser.c:

	file parser.c was initially added on branch ECMASCRIPT.  

Fri Feb 13 20:38:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/scanner.h:

	file scanner.h was initially added on branch ECMASCRIPT.  

Fri Feb 13 20:38:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/parser.h:

	file parser.h was initially added on branch ECMASCRIPT.  

Fri Feb 13 20:38:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/sgml/scanner.c:

	file scanner.c was initially added on branch ECMASCRIPT.  

Fri Feb 13 20:33:31 2004  Laurent Monin <zas@norz.org>:

	* src/util/: Makefile.am, color.c, color.inc, color_s.inc,
	fastfind.c:

	Color names <-> rgb was improved. ELinks now understands almost all
	color names, old and small color table was moved to
	src/util/color_s.inc and will be used if ELINKS_SMALL is defined,
	new extended one is in src/util/color.inc and is used by default.
	Fastfind stuff was changed to handle up to 1024 keys (needed).
	"gray" color value was changed from 0x808080 to correct 0xBEBEBE.  

Fri Feb 13 19:07:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.h:

	file renderer.h was initially added on branch ECMASCRIPT.  

Fri Feb 13 18:33:12 2004  Peter Samek <samek@upc.uniba.sk>:

	* po/sk.po:

	Slovak translation update.  

Fri Feb 13 18:08:21 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Feb 13 17:52:47 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/parser.c, intl/charsets.c, util/color.c,
	util/fastfind.c, util/fastfind.h:

	FastFind debugging features were improved: support for a comment,
	more stats. Tidy up.  

Fri Feb 13 17:11:30 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: bfu/leds.c, config/options.inc:

	Digital clock. Enable LEDs, timer and clock to make it work.  

Fri Feb 13 08:02:47 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: config/cmdline.c, config/cmdline.h, main.c:

	Removed obsolete option -stdin and stuff related with single url.  

Fri Feb 13 02:06:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/renderer.c:

	file renderer.c was initially added on branch ECMASCRIPT.  

Fri Feb 13 00:02:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/node.c:

	file node.c was initially added on branch ECMASCRIPT.  

Thu Feb 12 17:51:38 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/main.c:

	From now ELinks can act as pager.  

Thu Feb 12 17:11:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, search.c:

	Fix link typeahead fixups so current links will never be under the
	input line.  

Thu Feb 12 12:00:34 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Real translation update.  

Thu Feb 12 06:52:21 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Translation update.  

Wed Feb 11 11:44:24 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po, src/config/options.inc:

	A note about rename() on OS/2 and Win32 systems was added to
	secure_file_saving option description, french translation was
	updated.  

Wed Feb 11 11:22:21 2004  Laurent Monin <zas@norz.org>:

	* configure.in, src/util/secsave.c:

	Test for fflush() and fsync() presence, and act accordingly in
	secure_close().  

Wed Feb 11 10:19:31 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Feb 11 10:12:34 2004  Laurent Monin <zas@norz.org>:

	* src/: main.c, config/cmdline.c, config/options.c,
	ecmascript/core.c, lowlevel/connect.c:

	Useless spaces were trimmed.  

Wed Feb 11 09:53:31 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	Compilation fix: Define _GNU_SOURCE to have strcasestr() with glibc.  

Wed Feb 11 00:35:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/Makefile.am:

	file Makefile.am was initially added on branch ECMASCRIPT.  

Wed Feb 11 00:35:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/dom/node.h:

	file node.h was initially added on branch ECMASCRIPT.  

Tue Feb 10 23:40:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, viewer/dump/dump.c:

	Restore the old handling of the url list in init(). dump_pre_start()
	just steals all the url strings and manages it's own queue.  

Tue Feb 10 20:29:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.h:

	struct list_head is expanded to list_head_elinks and we need to
	include the lists.h file or it could lead to bad things.  

Tue Feb 10 20:25:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Cleanup.  

Tue Feb 10 20:15:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Use strstr() for link typeahead matching so we don't only match from
	the start of the link text. It is a bit buggy for wrapped links
	though. Hmm.  

Tue Feb 10 19:15:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Reintroduce usage of link->name for typeahead search because it is
	so neat and it should be made to work.  

Tue Feb 10 18:45:46 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: protocol/file/file.c, osdep/osdep.c:

	Fixed reading from stdin.  

Tue Feb 10 17:17:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Trim leading spaces from the link text. Visible at the software map
	at sf.net and making it harder to link typeahead.  

Tue Feb 10 06:35:44 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: main.c, viewer/dump/dump.c, viewer/dump/dump.h:

	Support for many urls in dump mode.  

Mon Feb  9 12:06:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	input_line_event_handler(): Catch redraw events from the history tab
	completion so new buffer data is propagated to the line handlers.  

Mon Feb  9 11:51:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/file.c:

	get_unique_name(): Replace sprintf() with longcat().  

Mon Feb  9 11:33:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inphist.c:

	Cl33nup.  

Mon Feb  9 11:13:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inphist.c:

	A little almost-spring cleaning.  

Mon Feb  9 09:29:24 2004  Laurent Monin <zas@norz.org>:

	* src/util/secsave.c:

	Cleanup and simplification of secure_close(), error handling was
	improved and a potential file-not-closed-on-flush-errore was fixed.  

Mon Feb  9 02:59:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: inpfield.c, inphist.c, inphist.h:

	Minor simplification to make history completion functions work on
	dialog_data so it looks a bit higher level.  

Mon Feb  9 01:41:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inphist.c:

	Minor simplification.  

Mon Feb  9 01:33:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Add input line buffer to history when cycling next and previous
	item.  

Mon Feb  9 01:25:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Fight badly written spaghetti code with gotos.  

Sun Feb  8 20:36:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Expand the switch noodling to make it easy to add handlers for other
	terminal events. Yes I know it is not properly indented the elinks
	hacking.txt way, but I think that the extra indentation is just
	plain stupid and punishes the use of switch statments.  

Sun Feb  8 20:29:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, viewer/text/search.c:

	Remove the prompt member of the input_line struct. All we need is
	the data member.  

Sun Feb  8 20:20:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Remove stupid test.  

Sun Feb  8 20:15:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Use local widget_data variable to shorten lines.  

Sun Feb  8 17:37:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	No need to allocate another cache entry header. Just use existing
	one or empty string.  

Sun Feb  8 13:55:41 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/.vimrc:

	file .vimrc was initially added on branch ECMASCRIPT.  

Sun Feb  8 13:55:41 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/.cvsignore:

	file .cvsignore was initially added on branch ECMASCRIPT.  

Sun Feb  8 13:54:17 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/dom/html_b.c:

	file html_b.c was initially added on branch ECMASCRIPT.  

Sun Feb  8 13:54:17 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/dom/html_a.c:

	file html_a.c was initially added on branch ECMASCRIPT.  

Sun Feb  8 13:54:17 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/dom/html_c.c:

	file html_c.c was initially added on branch ECMASCRIPT.  

Sun Feb  8 13:53:14 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/dom/core.c:

	file core.c was initially added on branch ECMASCRIPT.  

Sun Feb  8 06:29:17 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/dom/README:

	file README was initially added on branch ECMASCRIPT.  

Sun Feb  8 06:10:16 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/dom/html.h:

	file html.h was initially added on branch ECMASCRIPT.  

Sun Feb  8 06:10:16 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/dom/core.h:

	file core.h was initially added on branch ECMASCRIPT.  

Sun Feb  8 06:07:56 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/dom/.vimrc:

	file .vimrc was initially added on branch ECMASCRIPT.  

Sun Feb  8 06:07:56 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/document/dom/.cvsignore:

	file .cvsignore was initially added on branch ECMASCRIPT.  

Sun Feb  8 00:17:09 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/config/options.inc:

	s/ELINKS_LOCAL_CGI/CONFIG_CGI/ 

Sat Feb  7 10:58:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Drawin the download notification dialog when having the download
	browser open is apparently a little racy. Deleting the box item will
	update the download browser _after_ the notification dialog has been
	drawn whereby it will be hidden. This should make the download
	browser update before launcing any notification by removing the list
	box item.  

Sat Feb  7 01:39:49 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	Use stricter mask for local socket creation, so socket is only
	readable/writable by its user on systems honouring unix sockets
	permissions (see unix(7)).  

Sat Feb  7 01:04:52 2004  Laurent Monin <zas@norz.org>:

	* src/util/secsave.c:

	Comments about secure_file_saving were updated.  

Sat Feb  7 00:58:56 2004  Laurent Monin <zas@norz.org>:

	* src/util/secsave.c:

	Use fflush()/fsync()/fclose() sequence to ensure data is written to
	disk when using secure saving. This is needed since fclose() only
	calls fflush() which only flush libc buffers, so while fclose() may
	have returned, data may still be in kernel buffers. See fclose(2),
	fflush(2) and fsync(2) man pages for more information.  

Fri Feb  6 22:41:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inphist.h, config/urlhist.c, dialogs/exmode.c,
	dialogs/menu.c, globhist/globhist.c, scripting/lua/core.c,
	viewer/text/search.c:

	Use macros for input history initialization.  

Fri Feb  6 18:38:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: renderer.c, html/renderer.c, plain/renderer.c:

	Move cache entry defragmentation checking to render_document().  

Fri Feb  6 15:58:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Make sort_links() static.  

Fri Feb  6 13:03:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, config/opttypes.c, util/color.c,
	util/color.h:

	get_color_name() -> get_color_string(), and take a hex color buffer
	as arg that will be filled and returned if no color name is found.  

Fri Feb  6 12:49:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, config/opttypes.c, util/color.c,
	util/color.h:

	get_color_name(): Don't allocate the returned color name.  

Fri Feb  6 12:47:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	Cleanup.  

Fri Feb  6 12:31:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, config/options.h, globhist/dialogs.c:

	I was reading through some old patches and it reminded me that it
	would maybe be better to let the option value union have a
	big_number member of type long.  

Thu Feb  5 23:19:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix assert() failure in documents without links. Reported by Miciah.  

Thu Feb  5 23:17:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Fix assertm() reported by Daniel Macks <dmacks@netspace.org>.  

Thu Feb  5 19:47:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Make text searching also honour the show_not_found option. So
	browsing search history in typeahead mode is actually useful.  

Thu Feb  5 19:43:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Minor cleanup.  

Thu Feb  5 19:33:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Add to history if we receive an ACT_EDIT_ENTER and the widget has
	history.  

Thu Feb  5 19:26:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Minimize the (now pretty useless) mode change hacks to just call
	search_typeahead().  

Thu Feb  5 19:20:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Then of course there is this thing called search history that text
	typeahead should have.  

Thu Feb  5 19:18:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c,
	viewer/text/search.c:

	Make the various typeahead directly accessible via actions (-link,
	-text and -text-back). Fixes some of bug 378 atleast.  

Thu Feb  5 16:46:25 2004  Laurent Monin <zas@norz.org>:

	* src/formhist/Makefile.am:

	Do not add formhist.o twice to libformhist.a. Reported by Daniel
	Macks.  

Thu Feb  5 15:46:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Thou shall always check if get_next_scanner_token() returns NULL.
	Fixes reappearing of bug 372 'crashes if <style> tag is cut off in
	fragment/file'.  

Thu Feb  5 12:52:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: dialogs/exmode.c, protocol/rewrite/rewrite.c,
	protocol/rewrite/rewrite.h:

	Removed URI prefixes availability in exmode. It is wrong from the
	design standpoint, you have the goto url dialog for that (or just
	goto-url action arguments, for that matter).  

Thu Feb  5 11:03:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	fixup_typeahead_match(): Scrolling might update the current link but
	we don't want that so reset it to the matched one.  

Thu Feb  5 10:29:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix typeahead link text coloring. If something already were typed we
	need to redraw in order to remove the coloring of the link text.  

Thu Feb  5 10:18:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: search.c, view.c, view.h:

	A nice little hack that will scroll the document view if the matched
	link is under the typeahead input line.  

Thu Feb  5 10:03:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Color the typeahead text of the current link.  

Thu Feb  5 00:22:31 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* src/bookmarks/backend/xbel.c:

	Avoid crash when saving files with encoding != UTF-8.  

Wed Feb  4 23:13:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/conf.c, config/conf.h, dialogs/exmode.c:

	parse_config_command()'s @file updates propagate. This should fix
	the on-startup infinite loop.  

Wed Feb  4 16:24:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Command line options for redirects should not be listed with -help.
	Besides it looks hella ugly.  

Wed Feb  4 14:12:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/getifaddrs.c:

	max()? What max()? 

Wed Feb  4 13:58:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/exmode.c:

	Include the needed files.  

Wed Feb  4 13:58:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/conf.c, dialogs/exmode.c:

	Compilation fix.  

Wed Feb  4 13:57:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/conf.c, config/conf.h, dialogs/exmode.c:

	Allow config file commands (set, bind) to be executed from exmode.
	This involves exporting of parse_config_command() and enum
	parse_error.  

Wed Feb  4 13:27:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Random tidyup.  

Wed Feb  4 13:00:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Simplification of parse_config_file() --- removed the test_end label
	+ goto.  

Wed Feb  4 12:59:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Surged out the very command parsing multiplexer from
	parse_config_file() to parse_config_command().  

Wed Feb  4 12:51:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/exmode.h:

	Trailing whitespaces police strikes.  

Tue Feb  3 20:37:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Fix leak when viewing empty files.  

Tue Feb  3 20:31:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/search.c, viewer/text/search.h:

	Make the third arg of find_next() mean the direction. Thus making it
	possible to remove find_next_back().  

Tue Feb  3 20:12:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Try to make the @a arg to find_next() a bit more clear and remove
	the use for it.  

Tue Feb  3 20:04:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Cleanup.  

Tue Feb  3 19:28:04 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Feb  3 19:20:01 2004  Laurent Monin <zas@norz.org>:

	* configure.in, src/config/cmdline.c, src/lowlevel/connect.c,
	src/osdep/Makefile.am, src/osdep/getifaddrs.c,
	src/osdep/getifaddrs.h:

	Option -localhost now matches against all local addresses, gathered
	by getifaddrs() function, either from system or if not available
	from the new osdep/getifaddrs.{c,h} files. Please test heavily for
	cross platforms issues.  

Tue Feb  3 18:59:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: search.c, search.h:

	Make search_for and search_for_back static.  

Tue Feb  3 18:56:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/search.c, viewer/text/search.h:

	search_dlg(): Now both initiates forward and backward search dialogs
	depending on @a.  

Tue Feb  3 18:38:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Use document->nsearch as counter to get rid of disturbing macro.  

Tue Feb  3 16:00:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fix leak of selector list when the syntax is all wrong.  

Tue Feb  3 10:12:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Fix some swappage that led to an internal error when one selected
	extended regexes in the search box and searched.  

Mon Feb  2 20:36:32 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/ecmascript/core.c:

	DOM2-Core and DOM2-Html JavaScript bindings. Initialization.  

Mon Feb  2 16:20:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	detach_formatted() should already take care of these.  

Mon Feb  2 16:11:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/document.h:

	Describe tags and nodes and then move things a bit.  

Mon Feb  2 15:58:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/document.h:

	Cleanup.  

Mon Feb  2 15:40:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Typeahead is not a hack anymore.  

Mon Feb  2 15:32:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	search_link_text(): Spit and polish.  

Mon Feb  2 15:24:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	search_link_text(): Cleanup initialisation of variables.  

Mon Feb  2 15:19:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Decrease indentation level.  

Mon Feb  2 15:12:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Move link text searching to separate function.  

Mon Feb  2 15:04:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Rename charpos -> textlen, typeahead -> text, doc_view->document ->
	document.  

Mon Feb  2 13:54:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.h:

	Make dump_scanner() available if SCANNER_DEBUG is defined. Fix typo.
	Add state member to struct scanner useful for SGML scanner.  

Mon Feb  2 09:52:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Don't show error dialogs for missing CSS stylesheets.  

Sun Feb  1 16:43:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Try to fix precedence checking for background property parsing.  

Sun Feb  1 16:42:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Some more checks needed for supporting NUL chars in cache data.  

Sun Feb  1 15:56:25 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	check_if_local_address6() is only if IPV6 is defined.  

Sun Feb  1 15:11:53 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	Wrap tests for local addresses to functions.  

Sun Feb  1 13:35:29 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	Save first errno to display proper error message. Use
	@at_least_one_remote_ip to clarify things.  

Sun Feb  1 05:52:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Some more checks needed for supporting NUL chars in cache data.  

Sun Feb  1 00:13:13 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was improved a bit.  

Sun Feb  1 00:07:22 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Jan 31 14:10:41 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Translation update.  

Sat Jan 31 06:00:05 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/file/cgi.c:

	First parameter should be basename not full path.  

Sat Jan 31 00:58:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	Cleanup.  

Sat Jan 31 00:43:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: css.c, stylesheet.h:

	Ensure that the CSS @import can only be nested < MAX_REDIRECTS.  

Sat Jan 31 00:40:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/connect.c:

	Dropped @not_local_count, instead fail with S_LOCAL_ONLY only if the
	last attempt was local, because we do not have errno of previous
	non-local attempts.  

Sat Jan 31 00:37:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/connect.c:

	Tidyup.  

Sat Jan 31 00:36:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/connect.c:

	Do all the @local-testing things only if @only_local.  

Sat Jan 31 00:30:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/dialog.c:

	ACT_MENU_PREVIOUS_ITEM support, instead of the previous horrid
	ev->y+ACT_MENU_NEXT_ITEM hack.  

Sat Jan 31 00:29:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/search.c:

	ACT_EDIT_PREVIOUS_ITEM support.  

Sat Jan 31 00:28:37 2004  Laurent Monin <zas@norz.org>:

	* src/: config/cmdline.c, lowlevel/connect.c, sched/connection.h,
	sched/error.c:

	A new commandline option was introduced: -localhost, it limits
	elinks connections to loopback addresses for now, and with your help
	will limit to local addresses soon.  

Sat Jan 31 00:23:08 2004  Laurent Monin <zas@norz.org>:

	* src/config/: kbdbind.c, kbdbind.h:

	Compilation fix....  

Fri Jan 30 23:01:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Added default keybinding to previous-(item|frame) to alt-tab, idea
	by Miciah.  

Fri Jan 30 22:38:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Use option 'cache' for search dialog checkbox values.  

Fri Jan 30 19:54:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, config/options.h, dialogs/options.c:

	Generalize the terminal option cache thingy.  

Fri Jan 30 19:25:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Fix page down, scroll and end handling by using document view height
	and _not_ ... ;-) 

Fri Jan 30 19:13:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/inpfield.c,
	bfu/listbox.c, bfu/menu.c, terminal/event.h, terminal/kbd.c,
	viewer/text/view.c:

	Wrap mouse bit magic in macros. Actions too.  

Fri Jan 30 19:01:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/inpfield.c,
	bfu/listbox.c, bfu/menu.c, bfu/text.c, terminal/event.h,
	terminal/kbd.c, viewer/text/view.c:

	Wrap mouse bit magic in macros.  

Fri Jan 30 18:36:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Minor cleanup.  

Fri Jan 30 18:28:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Always compare to the current document view height and width and
	_not_ document options height or width. Fixes detection of links
	from mouse clicks when the terminal has been resized after the first
	rendering. Reported by zas.  

Fri Jan 30 18:16:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Compile fix.  

Fri Jan 30 15:25:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: css.c, parser.c, parser.h:

	css_parse_stylesheet() now takes @end variable. BTW idea by Zardoz.  

Fri Jan 30 15:15:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/apply.c, document/css/parser.c,
	document/css/scanner.c, util/scanner.c, util/scanner.h:

	Add end member to the scanner struct so we can start to support NUL
	chars in cache data.  

Fri Jan 30 10:14:25 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jan 30 08:22:23 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Standardization.  

Fri Jan 30 07:35:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Now with proper header comments and new options.  

Fri Jan 30 07:33:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/tools/help2doc:

	Out put proper .\" comments.  

Thu Jan 29 13:32:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Make the selector mirroring function take only the property list of
	the original selector so that the ruleset parser can use an empty
	list. Should fix properties of already known selectors being added
	to others in the grouping.  

Thu Jan 29 13:21:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/parser.c, util/scanner.h:

	Some lame way of skipping current token.  

Thu Jan 29 13:10:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h:

	Eh .. revert feature.h change.  

Thu Jan 29 13:08:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/document/css/parser.c, test/css/styletags.html:

	Add testing of the handling of selector groupings. It should that we
	need to pass css_parse_properties() an empty list head so that
	previous values do not end up being added to all other selectors.  

Thu Jan 29 13:02:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	Add selector grouping without block.  

Thu Jan 29 12:58:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Always check the returned value of get_scanner_token(). Don't check
	whether we skip to next ',' since the check at the start of the loop
	should catch it for us.  

Thu Jan 29 12:47:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Make the selector parsing a little less ambitious (don't allocate
	anything) and more tolerant.  

Thu Jan 29 12:16:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Raise the document.dump.width/-dump-width limits from 40/512 to
	1/65536.  

Thu Jan 29 11:09:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Only check if control char for the first char that is typed ahead.  

Thu Jan 29 07:54:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	'#?' now means search back.  

Thu Jan 29 07:49:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Make '##' mean that no more control chars should be checked .. so
	that '/' can be typed as first char in link typeahead.  

Thu Jan 29 07:31:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: inpfield.c, inpfield.h:

	Add prompt member to struct input_line.  

Thu Jan 29 07:21:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Move text_typeahead_handler() up before link_typeahead_handler.  

Thu Jan 29 07:18:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, dialogs/exmode.c,
	viewer/text/search.c:

	Add data member to struct input_line.  

Thu Jan 29 07:15:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, dialogs/exmode.c,
	viewer/text/search.c:

	(Re)introduce a struct for maintaining input line data.  

Thu Jan 29 04:19:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Move selector lookup to end of loop so we don.t have to handle
	allocation if there is a syntax error.  

Thu Jan 29 04:16:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Make selector variable local.  

Thu Jan 29 04:13:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Use while loop instead of gotos so a lot of indenting.  

Thu Jan 29 04:05:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Don.t use static list head but simple pass it from the ruleset
	parser.  

Wed Jan 28 22:03:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/main.c:

	Fixed memory leak in case of wrong option.  

Wed Jan 28 20:06:50 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Translation update.  

Wed Jan 28 19:38:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Experimental support for the 'unset' command. It is useful in order
	to be able to get rid of the default external protocol handlers.  

Wed Jan 28 18:41:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/textarea.c:

	Fixed a hole in the anonymous mode - user could launch the external
	editor and obviously then do whatever he wants there. Discovered by
	Solar Designer <solar@openwall.com>.  

Wed Jan 28 13:35:07 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation update.  

Wed Jan 28 10:39:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	A happy hacking verion of typeahead for text searches. Type '#/' and
	pray that you will never have to typeahead to a link text starting
	with /. :P 

Wed Jan 28 09:18:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c:

	Add a toggle-css action so it is easier to see what it actually adds
	to the rendering. By default bound to '_' but maybe it shouldn't
	have one.  

Wed Jan 28 08:23:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix backspacing when typing ahead.  

Wed Jan 28 08:13:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, dialogs/exmode.c,
	viewer/text/search.c:

	Use enum for return values of input line handlers.  

Wed Jan 28 07:57:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	A few comments. Thanks for cheering Quazgaa ;) 

Wed Jan 28 07:53:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, viewer/text/search.c:

	Move error function calling to typeahead input event handler.  

Wed Jan 28 07:39:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Check if there is typeahead text in the input handler.  

Wed Jan 28 07:35:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	When backspacing we just stay with the current link so let.s not
	waste any effort on it.  

Wed Jan 28 07:32:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Minor cleanup.  

Wed Jan 28 07:30:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Remove some more events that kbd_field() takes care of.  

Wed Jan 28 07:28:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, dialogs/exmode.c, viewer/text/search.c:

	Handle ACT_EDIT_CANCEL at top level.  

Wed Jan 28 07:24:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Bail out earlier if there is no chars to search for.  

Wed Jan 28 07:18:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, dialogs/exmode.c:

	Handle basic input line events. We have to do them before calling
	kbd_field().  

Wed Jan 28 06:43:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/status.c, sched/session.h, viewer/text/search.c,
	viewer/text/search.h, viewer/text/view.c:

	Use input line interface for link typeahead. Removing all the cheap
	hacks and nicely encapsulates typeahead functions. Basicly the code
	from frame_ev() is now the input line handler that just grabs
	current doc_view and uses do_typeahead() as backend. All buffer
	management was purged from do_typeahead() but it should still be
	cleaned up and fine tuned.  

Wed Jan 28 06:34:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Fix logic.  

Wed Jan 28 06:16:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Revert typeahead part of last patch.  

Wed Jan 28 06:14:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, dialogs/exmode.c,
	viewer/text/search.c:

	Make the input line dialog inteface handle the low level event
	stuff.  

Wed Jan 28 05:44:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, dialogs/exmode.c:

	Move generic input line stuff to bfu/.  

Wed Jan 28 05:40:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Also pass the event handler to the input line initializer.  

Wed Jan 28 05:30:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	A few exmode -> input_line renames.  

Wed Jan 28 05:22:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Move generic input line stuff to separate function which
	exmode_start() wraps.  

Wed Jan 28 05:18:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Get rid of the exmode_data struct and just allocate like all other
	dialogs.  

Wed Jan 28 05:07:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Make exmode_exec() take only session and command buffer.  

Wed Jan 28 05:05:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Remove unused exmode data member.  

Wed Jan 28 02:56:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	add_document_node() now takes renderer as arg. Add compress as
	renderer member.  

Wed Jan 28 02:39:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Describe other plain_renderer members.  

Wed Jan 28 02:37:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Maintain current line number in struct plain_renderer.  

Wed Jan 28 02:32:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Make the template char part of struct plain_renderer.  

Wed Jan 28 02:29:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Pass renderer struct on to add_document_line().  

Wed Jan 28 02:25:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Bail out if there is no fragment data .. add_document_lines()
	asserts(!length).  

Wed Jan 28 02:18:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Add max_width member to struct plain_renderer used for doc_width
	calculation.  

Wed Jan 28 02:13:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Minor cleanups.  

Wed Jan 28 02:09:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Introduce a plain renderer struct.  

Wed Jan 28 01:34:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.c:

	Move init_scanner_info() to initializers and inline it.  

Wed Jan 28 01:32:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, util/scanner.c, util/scanner.h:

	map_scanner_string(): Now just takes the scanner as arg.  

Wed Jan 28 01:26:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/apply.c, document/css/parser.c,
	document/css/scanner.c, document/css/scanner.h, util/scanner.c,
	util/scanner.h:

	init_css_scanner() -> init_scanner() .. and move to util/.  

Wed Jan 28 01:23:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/apply.c, document/css/parser.c,
	document/css/scanner.c, document/css/scanner.h, util/scanner.h:

	Add initialized flag to struct scanner_info. Pass scanner_info to
	scanner initializer.  

Wed Jan 28 01:16:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, util/scanner.h:

	Make the scanner struct reference the scanner_info struct and move
	the scan() function to struct scanner_info.  

Wed Jan 28 01:12:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.h:

	Move scanner info stuff up before struct scanner.  

Wed Jan 28 00:57:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, document/css/scanner.h,
	util/Makefile.am, util/scanner.c, util/scanner.h:

	Give the generic scanner utilities a temporary home in util/.  

Wed Jan 28 00:42:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: elinks.h, osdep/Makefile.am, osdep/stub.c,
	util/Makefile.am, util/stub.c, util/stub.h:

	util/stub.* -> osdep/stub.* 

Wed Jan 28 00:38:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, protocol/http/Makefile.am,
	protocol/http/blacklist.c, protocol/http/http.h, util/Makefile.am,
	util/blacklist.c, util/blacklist.h:

	util/blacklist.* -> protocol/http/blacklist.* 

Wed Jan 28 00:35:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: osdep/stub.c, util/stub.c:

	Blank lines.  

Wed Jan 28 00:27:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Groups scanner c file in a generic part and a CSS part. Moving
	macros to header.  

Wed Jan 28 00:20:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Groups scanner head in a generic part and a CSS part.  

Wed Jan 28 00:15:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make the language specific token scanner part of the scanner struct
	so it is well hidden.  

Wed Jan 28 00:11:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h, value.c:

	css_token functions -> scanner_token.  

Wed Jan 28 00:04:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, parser.c, parser.h, property.h,
	scanner.c, scanner.h, value.c, value.h:

	css_scanner -> scanner.  

Wed Jan 28 00:00:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h, value.c:

	struct css_token -> struct scanner_token.  

Tue Jan 27 23:54:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	CSS_SCANNER_* -> SCANNER_*.  

Tue Jan 27 23:51:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make precedence checking more generalized. It is now a member of the
	token struct and should be passed to the skip function.  

Tue Jan 27 23:08:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed an apparently missing break (Jonas?) in the atrule parser,
	reported by <M.Miroslaw@elka.pw.edu.pl>.  

Tue Jan 27 20:05:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Remove support for talking scanners. It has to be added in a saner
	way.  

Tue Jan 27 19:08:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Have @name of the selector extracted in the same way as everything
	else.  

Tue Jan 27 18:45:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Allow namelen==-1 for init_css_selector() ergo get_css_selector().  

Tue Jan 27 18:43:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	When parsing a selector, save id/class/pseudo to separate variables
	instead of @selector members.  

Tue Jan 27 10:37:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	Make it more clear how the action table in menu_keys() toggling is
	build.  

Tue Jan 27 02:28:33 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/selectors.html:

	Some simple selector support tests.  

Tue Jan 27 02:28:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Throw away id/class/pseudo selectors for now. They are just spoiling
	things by applying some specific styles to all the element instances
	etc. It is easy to reenable when we'll start really supporting them.  

Tue Jan 27 02:23:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	mem_free(pkg) properly even in the worst situation.  

Tue Jan 27 02:22:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Do not be so pathetic and do not free selector's id/class/pseudo
	upon syntax error... it's gonna bring us only trouble.  

Tue Jan 27 02:16:06 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/cascading.html:

	Trivial cascading testcase.  

Tue Jan 27 02:09:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Grm.  

Tue Jan 27 02:07:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Free up the selectors after we're done with them.  

Tue Jan 27 02:05:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Use kludgy wrapper struct selector_pkg to pass selectors around.  

Tue Jan 27 01:23:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Why it doesn't matter that we have multiple same properties in one
	selector.  

Tue Jan 27 01:15:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Misc. compilation fixes.  

Tue Jan 27 01:14:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Typo fix.  

Tue Jan 27 01:13:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: stylesheet.c, stylesheet.h:

	Erhm, fixed the hybridness of mirror_css_selector().  

Tue Jan 27 01:12:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Support for multi-selector rulesets (sel1,sel2,sel3{rule}).  

Tue Jan 27 01:05:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Way back, committed the wrong file. Sorry 'bout that.  

Tue Jan 27 01:03:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Fixed init_css_selector() call.  

Tue Jan 27 01:03:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c:

	Oops, clone_css_selector() is actually used.  

Tue Jan 27 00:54:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	CSS_TOKEN_HASH/HEX_COLOR already contain the token string of ident,
	as pointed out by Jonas.  

Tue Jan 27 00:52:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Disable the unused functions.  

Tue Jan 27 00:49:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: css/apply.c, css/stylesheet.c, css/stylesheet.h,
	html/parser.c:

	Mirror @default_stylesheet to @css_styles in
	init_html_parser_state() so that we will not need to let the cascade
	fall into two stylesheets but only one. The real benefits will show
	as we will start to support more complex selectors, and it should be
	faster (can you spare a bit of memory, bro'?).  

Tue Jan 27 00:42:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	If we're fixing memory leaks...  

Tue Jan 27 00:24:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Fixed init_css_stylesheet() to also initialize selectors list.  

Tue Jan 27 00:23:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, stylesheet.c, stylesheet.h:

	Support for proper styles cascading. Hopefully.  

Tue Jan 27 00:16:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Construct a virtual selector for the style attribute instead of just
	properties list.  

Tue Jan 27 00:14:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: stylesheet.c, stylesheet.h:

	Export (init|done)_css_selector().  

Tue Jan 27 00:13:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Moved (struct css_selector) destructor to done_css_selector().  

Tue Jan 27 00:11:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Make it possible to have NULL @css and/or @name passed to
	get_css_selector().  

Tue Jan 27 00:07:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Use static inlines instead of macros for token getter.  

Mon Jan 26 23:56:17 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* src/document/css/parser.c:

	Prevent a memleak.  

Mon Jan 26 23:37:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Chop indent2type to pieces. One generic part now does the table look
	up and the table is now also part of the scanner_info .. for no good
	reason it seems.  

Mon Jan 26 23:37:08 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* src/document/css/parser.c:

	s/css/scanner in get_next_css_token() calls.  

Mon Jan 26 23:30:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	struct css_indentifier -> struct scanner_string_mapping.  

Mon Jan 26 23:23:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	Fixed init_css_stylesheet() decl.  

Mon Jan 26 23:22:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: stylesheet.c, stylesheet.h:

	Introduced init_css_stylesheet().  

Mon Jan 26 23:18:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/README:

	Removed the horrible uniform indentation ;-).  

Mon Jan 26 23:03:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c:

	get_css_selector() now has init_css_selector() as internal backend
	and first does find_css_selector() and then init() if that one was
	unsuccessful; similiar to cache_entry obtainers.  

Mon Jan 26 23:01:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Add '.' to char token group. It's needed for class selectors.  

Mon Jan 26 23:00:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	Group selector functions.  

Mon Jan 26 23:00:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, stylesheet.c, stylesheet.h:

	get_css_selector() -> find_css_selector(), init_css_selector() ->
	get_css_selector() 

Mon Jan 26 22:59:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Use scanner_info struct for holding the scanner's scan table and
	scan table initialization info.  

Mon Jan 26 22:57:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Added support for some parsing of id/class/pseudo selectors.  

Mon Jan 26 22:50:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Move CSS scan table info up after the char group enum.  

Mon Jan 26 22:44:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix last patch. Only generic scanner stuff. ;) 

Mon Jan 26 22:40:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Move generic scanner stuff to start of file.  

Mon Jan 26 22:36:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	More assertions for the scan table ranges.  

Mon Jan 26 21:54:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: options.h, css/apply.c, html/parser.c,
	html/renderer.c:

	Also check color_mode != MONO in the document color macros. Rename
	so their usage is a bit more clear to use_document_(fg|bg)_colors().  

Mon Jan 26 21:15:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Improve the use of use_document_colors and color_mode options.  

Mon Jan 26 20:21:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	Blank lines.  

Mon Jan 26 18:52:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/dialogs/exmode.c, src/dialogs/menu.c,
	src/sched/action.c:

	Plug exmode into the configuration system (CONFIG_EXMODE).  

Mon Jan 26 18:27:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Surge out the selector parser to css_parse_selector().  

Mon Jan 26 18:06:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Always assume it's ruleset if it's not @rule, not only if the token
	is CSS_TOKEN_IDENT. And couple of TODOs.  

Mon Jan 26 17:20:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, scanner.c, scanner.h:

	Prefix tokens based on CSS_TOKEN_AT_KEYWORD by AT_.  

Mon Jan 26 11:58:29 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jan 26 08:14:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Fix backspace quiting so it don't all backspaces.  

Mon Jan 26 08:11:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Map ACT_MAIN_QUIT to ACT_MAIN_REALLY_QUIT.  

Mon Jan 26 08:05:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Backspace in empty buffer now quits.  

Mon Jan 26 08:05:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Cleanup.  

Mon Jan 26 07:00:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Make exmode URI rewriting a little more powerful by checking a few
	control chars. ':fm&' or ':g elinks &' will open the rewritten URI
	in a new backgrounded tab while adding a '+' to the end will open in
	a new tab.  

Mon Jan 26 06:26:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Remove leading ':'s from the exmode command.  

Mon Jan 26 06:24:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Rename end -> args.  

Mon Jan 26 06:20:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/exmode.c, protocol/rewrite/rewrite.c,
	protocol/rewrite/rewrite.h:

	Make it possible to use URI rewrite prefixes from the exmode line.
	It involves a little exposing of URI rewrite internals.  

Mon Jan 26 06:07:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Call cancel_dialog() instead of delete_window().  

Mon Jan 26 06:04:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Move action handling to new exmode_handler 'interface'. This will
	make it easier to add more bloat.  

Mon Jan 26 05:50:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/: exmode.c, exmode.h, menu.c:

	Add exmode history.  

Mon Jan 26 05:45:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Complete make-over of the exmode handling. We now plug it directly
	into the dialog matrix making it possible to remove tons of
	duplicate code. Besides it will make it easier to get history up and
	running. I don.t expect anyone to read this big patch but understand
	that I think it is justified both because the exmode code is still
	pretty new and so major change should not be a threat to any kind of
	old features and finally "let the garbage man handle the garbage".
	;) 

Mon Jan 26 05:36:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: dialog.c, dialog.h:

	Make it possible to get rid of all that fancy dialog stuff and only
	draw widgets.  

Mon Jan 26 05:06:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/README:

	We handle import now as well.  

Mon Jan 26 04:47:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Allocate the exmode buffer with together with the data.  

Mon Jan 26 04:42:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Add dialog struct to exmode_data and make inpfield member reference
	the dialog widget.  

Mon Jan 26 04:16:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Make exmode_data->inpfield_data point to
	exmode_data->dlg_data->widget_data.  

Mon Jan 26 04:10:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	get_prefix() -> get_uri_rewrite_prefix(), substitute_url() ->
	rewrite_uri().  

Sun Jan 25 15:28:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/exmode.c:

	Get the exmode rolling by supporting action execution. Also
	':goto-url fm' should work.  

Sun Jan 25 14:43:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	Fix Help -> Keys toggling.  

Sun Jan 25 14:24:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c:

	Trim the main mappings. Only those currently in use remains.  

Sun Jan 25 14:10:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	Trim the menu mappings. Only those currently in use remains.  

Sun Jan 25 14:04:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Moved delete_keybinding() in front of add_keybinding().  

Sun Jan 25 14:03:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	delete_keybinding() now drops @kb's KBDB_DEFAULT flag before
	free_keybinding() so that it's really *always* deleted. However its
	only user add_keybinding() sets KBDB_DEFAULT for the new keybinding
	taking place of the original default keybinding, so that if the new
	one is removed by the user, it is written to the configfile. This
	should fix the tons of none-binds appearing in configfile now.  

Sun Jan 25 13:59:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: inphist.c, listmenu.c:

	Fix usage of ACT_MENU_NONE for menu entry actions. We should use
	main mapping everywhere for that.  

Sun Jan 25 13:57:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	I hope this is right. Use edit key map for exmode.  

Sun Jan 25 13:53:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	Trim the edit mappings. Only those currently in use remains.  

Sun Jan 25 13:52:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: kbdbind.c, kbdbind.h:

	Do not export delete_keybinding().  

Sun Jan 25 13:51:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Use ACT_EDIT_CANCEL for bailing out of exmode.  

Sun Jan 25 13:20:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Remove actions that are clearly not ACT_MAIN_.  

Sun Jan 25 13:17:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.h, bfu/text.c, config/dialogs.c, config/kbdbind.c,
	config/kbdbind.h, dialogs/info.c, dialogs/menu.c,
	dialogs/options.c, mime/dialogs.c, sched/action.c,
	viewer/text/link.c, viewer/text/view.c:

	s/ACT_/ACT_MAIN_/. Geronimooooo!! 

Sun Jan 25 13:09:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/dialogs.c:

	Swapped action/keymap guessing from item udata, therefore fixing
	adding a keybinding.  

Sun Jan 25 13:05:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	s/ACT_MENU_NONE/ACT_MAIN_NONE/ .. all menu entry actions are really
	main actions.  

Sun Jan 25 13:03:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/dialogs.c:

	Trivial tidyup.  

Sun Jan 25 13:03:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	assert() keymap when using it to lookup in action_table[].  

Sun Jan 25 12:52:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: inphist.c, listmenu.c, menu.c:

	Use ACT_MENU_NONE for menu actions.  

Sun Jan 25 12:47:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Even more ACT_MENU_ usage.  

Sun Jan 25 12:44:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	More ACT_MENU_ usage.  

Sun Jan 25 12:38:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, viewer/text/form.c:

	s/ACT_/ACT_EDIT_/ 

Sun Jan 25 12:38:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	s/ACT_/ACT_MENU_/ 

Sun Jan 25 12:03:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Add 'Space' -> ' ' to @key_table and remove its special handling
	from make_keystroke().  

Sun Jan 25 10:19:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/kbdbind.c:

	Tiny whitespace fix.  

Sun Jan 25 10:18:48 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/kbdbind.c:

	In make_keystroke, if !escape, print '<space>' instead of ' '. This
	affects the keybinding manager and Help->Keys box.  

Sun Jan 25 09:55:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Don.t add CSS to globhist.  

Sun Jan 25 09:48:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	menu_keys() message box currently only have on button.  

Sun Jan 25 09:33:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.c, document/document.h,
	document/options.c, document/options.h, document/css/css.c,
	document/css/css.h, document/html/parser.c, document/html/parser.h,
	document/html/renderer.c, sched/connection.h, sched/session.c:

	Add support for importing external stylesheets. It is done using the
	import callback to add urls to a new document->css_imports string
	list via html_special(). The patch also introduces an option for
	controling whether external stylesheets should be imported
	(document.css.import). Downloading of stylesheets have special
	PRI_CSS priority that amongst other things is used to avoid any
	ses_chktype() calls from file_end_load() so atleast it is useful.  

Sun Jan 25 08:17:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Remove some pseudo code. It messes up the css import patch.  

Sun Jan 25 07:31:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	When reloading use the original priority for files to load and not
	the hardcoded PRI_FRAME. This is needed for importing CSS documents.  

Sun Jan 25 07:19:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Sort the many CSS options.  

Sun Jan 25 05:02:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/css.c, css/parser.c, css/stylesheet.c,
	css/stylesheet.h, html/parser.c:

	Use callback for imports. It seems more easy and straight forward
	now. Any import will then be loaded and added before the rest of the
	stylesheet it was imported from. For the html parser we will just
	check cache to see if we can go ahead and parse it or need to call
	special_f(). Oh an patch is loaded with fixes for last patch.  

Sun Jan 25 04:20:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Ok .. read_encodede_file() wants the filename in a MAX_STR_LEN
	buffer so let's give it just that so it doesn't cause memory
	corruptions in try_encoding_extensions().  

Sun Jan 25 03:42:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c:

	Support url() imports. It seems importing non existing files cases
	memory corruption.  

Sun Jan 25 03:16:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c:

	We now trim string and url() tokens so token->string and
	token->length only contains the information we are interested in.  

Sun Jan 25 02:35:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Generate url() tokens.  

Sun Jan 25 02:10:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Try to handle imports for the default stylesheet. Very inefficient.
	We need some merge_stylesheet() and some kind of rating to control
	what gets in and what not.  

Sun Jan 25 02:08:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Add string list import member to struct css_stylesheet.  

Sun Jan 25 01:33:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/css.c, css/stylesheet.h, html/parser.c:

	Use macro for static initialization of stylesheets.  

Sun Jan 25 01:27:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	css_parse_stylesheet(): Use a switch in the main loop so all @-rule
	tokens are routed to css_parse_atrule().  

Sun Jan 25 01:20:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, sched/session.c, terminal/tab.c,
	util/string.c, util/string.h:

	Make add_to_string_list() take length of added string. -1 means call
	strlen().  

Sun Jan 25 00:27:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/stylesheet.h:

	Describe stylesheet structs.  

Sun Jan 25 00:24:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/menu.c:

	Put a separator between the togglers and info/reload in the View
	menu.  

Sun Jan 25 00:23:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/menu.c:

	Moved ACT_RELOAD from File to View. This is maybe a little
	controversial, but well... ;) 

Sun Jan 25 00:21:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	sched/action.c:

	Added ACT_(MAIN_)RERENDER, by default not bound to anything, but
	available through the View menu. It rerenders the current document,
	thing useful in such a wide variety of scenarios.  

Sun Jan 25 00:11:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/info.c:

	Fixed more compilation problems.  

Sun Jan 25 00:09:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/info.c:

	Fixed misplaced #endif.  

Sun Jan 25 00:09:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Some other compilation fixes.  

Sun Jan 25 00:07:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Some compilation fixes.  

Sun Jan 25 00:04:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.h:

	...and also add the missed actions to the other keymap enums.  

Sun Jan 25 00:01:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.h:

	Reintroduced actions accidentally removed from enum main_action.  

Sat Jan 24 23:58:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/listbox.c, bfu/menu.c,
	viewer/text/search.c:

	Use keymap-specific enum names for non-main actions.  

Sat Jan 24 23:55:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Add TODO about updating format cache when default stylesheet has be
	reloaded.  

Sat Jan 24 23:50:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/listbox.c, bfu/menu.c,
	bfu/menu.h, config/kbdbind.h, dialogs/info.c, sched/action.c,
	sched/action.h, viewer/text/search.c, viewer/text/view.c:

	enum action -> enum {main,edit,menu}_action, edit,menu being just
	mindless clones of main now.  

Sat Jan 24 23:33:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/info.c:

	Removed KEYACTS, which has no business in the modern actions
	organization. This also means one dirty'n'quick hack for
	@action_box_items and temporarily disabling menu_keys() toggling
	until the water will be calm again.  

Sat Jan 24 23:25:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: dialogs.c, kbdbind.c, kbdbind.h:

	Since enum action is gonna be split, remove its usage on places
	where generic non-keymap-specific action number will be used.  

Sat Jan 24 23:14:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: kbdbind.c, kbdbind.h:

	Move ACT_SCRIPTING_FUNCTION up in the enum, so that it is grouped
	together with ACT_NONE as universal for all keymaps (by its very
	nature).  

Sat Jan 24 23:11:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/dialogs.c, config/kbdbind.c, config/kbdbind.h,
	sched/action.c:

	The action number is now keymap specific. From the outside the only
	change for now is that write_action() takes keymap along the action
	enum, from the inside the action_table was split into three yet
	identical copies (one for each keymap) and we carry enum keymap
	along enum action everywhere where we didn't yet for some reason.  

Sat Jan 24 22:52:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Fixed toggle_display_action_listboxes() to handle the new
	organization.  

Sat Jan 24 22:52:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Make document.css.stylesheet description more clear.  

Sat Jan 24 22:45:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/css.c, protocol/file/file.c,
	protocol/file/file.h:

	Purge all the crappy code I added yesterday in an attempt to import
	css and use read_encoded_file() for sucking in the default css file.  

Sat Jan 24 22:35:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Reorganized the keybinding manager - now the actions are grouped by
	keymap instead of vice versa.  

Sat Jan 24 22:32:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Move file reading specific part of file_func() to separate function.  

Sat Jan 24 21:31:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.h:

	Removed trailing comma from the always-to-be-last enum members.  

Sat Jan 24 21:17:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Compilation fixes.  

Sat Jan 24 21:09:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/dialogs.c:

	When keybinding is associated with ACT_NONE, it is like it wouldn't
	exist at all so don't ask for confirmation.  

Sat Jan 24 21:07:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: kbdbind.c, kbdbind.h:

	Default keybindings are now flagged appropriatelly and are not
	deleted but just rebound to ACT_NONE, therefore also saved so to the
	configuration file. This should fix removed default keybindings
	reappearing after ELinks restart, reported by many people over the
	ELinks history.  

Sat Jan 24 20:37:54 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation updated.  

Sat Jan 24 20:28:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Split bind_config_string() core to single_bind_config_string().  

Sat Jan 24 20:08:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Split add_default_keybindings() to three
	add_keymap_default_keybindings().  

Sat Jan 24 20:05:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	The missing braces around for() body in bind_config_string() were
	making me nervous.  

Sat Jan 24 20:04:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	add_keybinding() reindentation.  

Sat Jan 24 20:03:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: kbdbind.c, kbdbind.h:

	add_keybinding() returns (struct keybinding *) 

Sat Jan 24 19:57:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/css.c:

	Terminate a sentence :-).  

Sat Jan 24 19:55:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Moved add_keystroke_to_string() and add_actions_to_string() from
	default kbdbinds neighbourhood near make_keystroke() where they seem
	to fit more naturally.  

Sat Jan 24 19:53:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Move config file tools at the end of file, particularily after
	default keybindings.  

Sat Jan 24 19:53:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Clarification.  

Sat Jan 24 19:20:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memdebug.c:

	Support for CHECK_DOUBLE_FREE, by default enabled. It reported
	xflows before, which was quite confusing.  

Sat Jan 24 19:08:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memdebug.c:

	Minor tidyup.  

Sat Jan 24 18:24:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/Makefile.am,
	dialogs/exmode.c, dialogs/exmode.h, sched/action.c:

	Basic framework for ex-mode (command line) support, triggered by
	'exmode' action (':'). It does nothing now, some action
	parser/executer needs to be implemented, but that's already work for
	someone else ;-).  

Sat Jan 24 17:57:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/dialog.c:

	Simplify.  

Sat Jan 24 17:46:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	File style="{ ... }" testcase under garbage.  

Sat Jan 24 17:31:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Tidyup.  

Sat Jan 24 17:29:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fix infinite loop in property parser when handling style="{ ... }".
	Reported by Zas.  

Sat Jan 24 13:00:41 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	get_attr_val_(): simplify test_only mode, just return as soon we
	found matching atttribute.  

Sat Jan 24 12:52:17 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Jan 24 12:36:17 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	get_num(): use strtol() and a long variable @num, then check range
	and then only type cast to int. More correct, imho.  

Sat Jan 24 10:25:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Note one textmode User-Agent token user (OSNews.com) at least, shall
	someone even think about removing it.  

Sat Jan 24 10:25:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Describe the 'textmode' token.  

Sat Jan 24 10:09:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/error.c:

	Do not dump @full_static_version twice if CONFIG_BACKTRACE and
	segfault was forced by force_dump().  

Sat Jan 24 10:08:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/signals.c:

	Try to make the I-crashed epitaph more brief so that the actually
	useful info is less likely to scroll out of the screen.  

Sat Jan 24 03:35:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, stylesheet.c:

	Use free_list(). Hmm.  

Sat Jan 24 02:53:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Move selector initialization to separate function.  

Sat Jan 24 02:41:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: Makefile.am, css/parser.c:

	Move style sheet and selector stuff to own file.  

Sat Jan 24 02:04:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/Makefile.am, css/apply.c, css/css.c,
	css/parser.c, css/parser.h, css/stylesheet.c, css/stylesheet.h,
	html/parser.c:

	Move style sheet and selector stuff to own file.  

Sat Jan 24 01:17:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Try to hint that document.css.stylesheet is relative to ELinks' home
	dir.  

Fri Jan 23 23:59:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: css.h, parser.h:

	Add some small meditations about cascading and default stylesheets.  

Fri Jan 23 22:31:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Less confusing comment.  

Fri Jan 23 22:25:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/README:

	English fixes, little more applier info.  

Fri Jan 23 22:13:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/css.h:

	Prototypes instead of #inculdes.  

Fri Jan 23 20:59:43 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jan 23 20:26:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Fix segfault when document.css.stylesheet couldn't be loaded. Always
	empty the default stylesheet before reloading.  

Fri Jan 23 20:12:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix comment eating so we do the @string testing inside first if ().  

Fri Jan 23 20:08:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Make it possible to reimport default stylesheet. You still need to
	^R because css imports are async.  

Fri Jan 23 20:00:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, config/options.inc, document/css/css.c:

	Move CSS options and change hook to module definitions.  

Fri Jan 23 19:27:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, document/Makefile.am,
	document/css/Makefile.am, document/css/apply.c, document/css/css.c,
	document/css/css.h, modules/module.c:

	Add support for a default stylesheet from which to get info about
	HTML layout. It is still a bit buggy. E.g. don't set
	document.css.stylesheet to a file that doesn't exist. ;) 

Fri Jan 23 19:24:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Move main module initialization back. No initializer should use
	options.  

Fri Jan 23 19:18:18 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	get_attr_val() was slightly modified to be more efficient. It was
	renamed to get_attr_val_() which takes two new parameters
	@test_only, used by has_attr() and @eat_nl used by get_url_val(). In
	test_only mode, it just test for attribute existence, so it dont
	allocate any memory for value, nor it does useless parsing or string
	conversion. Global variable @get_attr_val_eat_nl is gone.  

Fri Jan 23 18:50:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Init main modules after the option system has been booted so
	initializers can access options ;).  

Fri Jan 23 17:46:41 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jan 23 17:33:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Assume sizeof(void *) == sizeof(long).  

Fri Jan 23 09:37:42 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation update.  

Fri Jan 23 06:26:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Introduce char group of other token start chars so we can bail out
	eailer if the token is garbage.  

Thu Jan 22 23:48:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	If we don't use smart checking there is no need for a smart value.  

Thu Jan 22 23:29:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Add support for URI rewriting from the command line.  

Thu Jan 22 22:55:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Put some use to the second member of scan_table_info.data.string.  

Thu Jan 22 22:26:17 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/garbage.html:

	Better garbage.  

Thu Jan 22 22:18:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Our current text-decoration parsing is invalid.  

Thu Jan 22 22:17:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: property.c, value.c, value.h:

	Introduced css_parse_text_decoration_value(). NEVER overload single
	function for disjunct properties! 

Thu Jan 22 22:01:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	English fix.  

Thu Jan 22 21:40:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	Make current->type token type checking against NONE/SKIP more
	explicit and also simpler.  

Thu Jan 22 21:38:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	English grammar fix.  

Thu Jan 22 21:37:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/inphist.c:

	Fixed memory leak in do_tab_compl() triggered when there were no
	completion possibilities.  

Thu Jan 22 21:26:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	FIXME about unbased sizeof() equivalence assumptions.  

Thu Jan 22 21:18:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Enabled document.css.enable by default. It is important to let the
	CSS support to be extensively tested by people.  

Thu Jan 22 21:14:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	In ident2type(), use strlcasecmp() for token matching so that ie.
	'me' won't match 'media' (or is that ok?).  

Thu Jan 22 21:11:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	Removed redundant identifiers2type record.  

Thu Jan 22 21:06:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.h:

	English grammar fixes.  

Thu Jan 22 20:53:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/property.c:

	Make sure someone won't pollute our nice clear simple code with
	fastfind too soon ;-).  

Thu Jan 22 20:47:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.h:

	Jonas is too French.  

Thu Jan 22 19:34:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Remove unneeded #includes.  

Thu Jan 22 19:32:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Tidyup comment.  

Thu Jan 22 19:31:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	The universal (match all) selector '*' is also a char token.  

Thu Jan 22 18:45:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Oops no revert plain render change from last patch. :/ 

Thu Jan 22 18:43:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/parser.c, css/parser.h, plain/renderer.c:

	Add comments to functions and one TODO.  

Thu Jan 22 18:34:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Add grammar info from ELusive as comments.  

Thu Jan 22 18:27:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	css_parse_selector() -> css_parse_ruleset().  

Thu Jan 22 18:19:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/osdep.c:

	Removed unused @display variable.  

Thu Jan 22 18:09:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Revert my two last patches to the renderer. The one adding link
	state enum to struct link_state_info and the one trying to remove
	link_state updating hacks from put_chars(). They broke numbered
	links.  

Thu Jan 22 17:46:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: frames.c, frames.h, parser.c:

	Moved parse_frame_widths() & co from document/html/parser.* to
	document/html/frames.*.  

Thu Jan 22 16:22:21 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS, src/osdep/osdep.c:

	Fixed xterm detection - except DISPLAY check also if either WINDOWID
	or KONSOLE_DCOP_SESSION env variable is present.  

Thu Jan 22 07:25:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Move up identifier scanning.  

Thu Jan 22 06:49:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Bug in SGML logic.  

Wed Jan 21 18:16:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Cleanup.  

Wed Jan 21 17:49:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Make the madness really end.  

Wed Jan 21 17:40:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Compile fix.  

Wed Jan 21 17:39:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Unify SGML tagsoup navigation and use native scanners to make it
	much more forgiving.  

Wed Jan 21 17:05:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Tidyup comments.  

Wed Jan 21 17:02:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Introduce a skip token and made CSS_TOKEN_NONE again mean stop
	scanning.  

Wed Jan 21 16:21:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Treat ".<number>%" as garbage so it is not broken up.  

Wed Jan 21 16:05:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Call update_link_state() those places that call put_chars(). Remove
	various hacks that did it before.  

Wed Jan 21 16:01:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Add link state enum to struct link_state_info and use that in
	put_chars(). get_link_state() is now simply an updater.  

Wed Jan 21 15:49:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Move link state information to a new struct link_state_info.  

Wed Jan 21 15:36:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Yuk .. another hack to solve memleaks because of changing link
	states. We have to globalize that thing somehow. Reported by lindi-
	and excellent test case by fabiob.  

Wed Jan 21 10:09:01 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: config/kbdbind.c, config/kbdbind.h, document/options.h,
	document/renderer.c, document/plain/renderer.c, sched/action.c,
	viewer/text/view.c, viewer/text/view.h, viewer/text/vs.h:

	Wrapping plain text support switched by Shift+W.  

Wed Jan 21 06:19:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h, value.c:

	Check precedence of the current token so we do not skip '}' when
	looking for ';'. Fixes background property strangeness.  

Wed Jan 21 06:11:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Handle numbers starting with dots.  

Wed Jan 21 05:46:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	get_css_identifier_type(): Do length calculation + rename to
	ident2type() to minimize wrapping.  

Wed Jan 21 05:39:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix skipper that didn.t break out when getting to skipto char.  

Wed Jan 21 05:20:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	get_css_identifier_type(): Drop the inline. Cleanup.  

Wed Jan 21 05:17:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Ensure ending ')' even for rgb() function tokens. Use the ident2type
	table to check for known functions.  

Wed Jan 21 05:05:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Pass base type to identifier resolver. Fixes resolving and speeds up
	the lookup.  

Wed Jan 21 04:44:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h:

	Generate specific @-keyword tokens. Required a little renaming of
	number identifier to type mapping.  

Wed Jan 21 04:29:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Tidyup definitions.  

Wed Jan 21 04:25:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h:

	CSS_TOKEN_ATRULE -> CSS_TOKEN_AT_KEYWORD.  

Wed Jan 21 04:18:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Update comments and remove CSS_TOKEN_NAME.  

Wed Jan 21 04:17:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	There is no name token. It is only used for hashes.  

Wed Jan 21 04:03:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, parser.c, parser.h:

	Make css_parse_properties() take scanner as argument. This means the
	applier needs to know about the scanner but it is really a paint to
	debug when property parsing spawns a new scanner + it is less
	efficient of course.  

Wed Jan 21 03:54:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/README:

	Tidyup.  

Wed Jan 21 03:45:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Moved dumping of scanner to dump_css_scanner().  

Wed Jan 21 03:04:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Make the scanner debugging much more powerful showing both the
	generated tokens and compressed src position.  

Wed Jan 21 01:46:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Remove the used scanner function from debug info. It don.t work very
	well.  

Wed Jan 21 01:20:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make get_css_token_() into a macro.  

Wed Jan 21 01:00:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make get_next_css_token_() into a macro.  

Wed Jan 21 00:38:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	check_next_css_token(): Make it into a macro. With the amount of
	sanity checking we have now it should be safe.  

Wed Jan 21 00:27:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Move scanner sanity checking to exits of scan_css_tokens().  

Wed Jan 21 00:11:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	scan_css_tokens(): Return the current token.  

Wed Jan 21 00:02:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Unbytesize move_to_front. I was thinking about making
	scanner->tokens a pointer but that seems stupid now.  

Tue Jan 20 22:25:37 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: text.c, widget.h:

	Handling of mouse with text scrollbar was improved. Using right
	click will make it to scroll faster, and mouse wheel is now handled.  

Tue Jan 20 20:40:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make the scanners current a css_token pointer.  

Tue Jan 20 20:09:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	scan_css_tokens(): Make move_to_front byte sized.  

Tue Jan 20 20:00:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	scan_css_tokens(): Make current a css_token pointer.  

Tue Jan 20 18:25:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Make scan table initialization data driven. It is very generic and
	more readable (I hope). A bit slower but I am really a sucker for
	data driven coding. ;) 

Tue Jan 20 18:18:40 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Italian translation update.  

Tue Jan 20 17:49:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h, value.c:

	Rearrange token types to group them better. Add comments. Rename
	CSS_TOKEN_IDENTIFIER to CSS_TOKEN_IDENT. It wouldn.t be C without
	abbreviations. ;) 

Tue Jan 20 17:28:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Generate hash tokens.  

Tue Jan 20 17:15:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Take precedence and string args into considerations when skipping
	functions.  

Tue Jan 20 17:12:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	More garbage.  

Tue Jan 20 16:40:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Improve precedence checking.  

Tue Jan 20 16:13:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Oops revert part from last patch and fix rgb comparison.  

Tue Jan 20 16:12:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Try to skip comments.  

Tue Jan 20 15:59:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h, value.c:

	Use smarter scanning of functions skipping to ')' if it is unknown
	so tokens are not generated for every arg.  

Tue Jan 20 15:18:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/README:

	m33p.  

Tue Jan 20 15:12:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/README:

	Update.  

Tue Jan 20 14:57:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Don't remove garbage token as they might be used for some kind of
	recovery. 'None token' can now be used for tokens we want to skip
	plus it should now be more obvious that scanner->position could have
	become NULL.  

Tue Jan 20 07:05:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Make link type parser more data driven.  

Tue Jan 20 06:25:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Alphabetise css token types.  

Tue Jan 20 06:22:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Treat SGML comments as garbage.  

Tue Jan 20 05:11:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fix assertion failure reported by Zardoz. It concerned string like
	"property:" with no expressions meaning skipping could not get next
	token.  

Tue Jan 20 04:54:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	Test case for the bug Zardoz pointed out.  

Tue Jan 20 04:37:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser.c:

	Tidy-up: Wrap before &&, not after, and join a hanging ')' with the
	line above.  

Tue Jan 20 04:33:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser.c:

	Drop some double-negation in look_for_tag and html_option.  

Tue Jan 20 02:37:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Add more TODOs. Will we ever be done? 

Tue Jan 20 02:30:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Handle scanning of number identifiers.  

Tue Jan 20 02:12:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Use strn* .. Doh! 

Tue Jan 20 02:09:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	First scan the number then the kind of number.  

Tue Jan 20 02:00:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h:

	In order to handle end of tags when getting style info from <style>
	tags we need better signaling of whether to keep scanning since the
	CSS source doesn't end at the string end. We now recognize SGML tag
	ends in the scanner and generate a CSS_TOKEN_NONE while also setting
	scanner->position to NULL.  

Tue Jan 20 01:42:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	scan_css_token(): Don't return anything.  

Tue Jan 20 01:05:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Two optimizations: never scan token if the scanner positon is at the
	end, never put garbage tokens in the token table.  

Tue Jan 20 00:56:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Make token types default to CSS_TOKEN_GARBAGE.  

Tue Jan 20 00:44:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix off by one error in SGML comment scanning.  

Tue Jan 20 00:43:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Scan !important tokens.  

Tue Jan 20 00:37:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Add types for all kinds of token we have to support. If not for
	usage it will make the scanning more efficient.  

Tue Jan 20 00:23:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Handle scanning of floating point numbers.  

Tue Jan 20 00:16:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix SGML comment scanning.  

Tue Jan 20 00:13:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h, value.c:

	CSS_TOKEN_DIGIT -> CSS_TOKEN_NUMBER 

Tue Jan 20 00:11:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Move css_token_type enum out of the css_token struct and describe
	tokens using patterns.  

Mon Jan 19 23:52:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make scan_css_tokens() static.  

Mon Jan 19 23:48:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Cleanup scanner validation.  

Mon Jan 19 23:31:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	More paranoia checking. Make sure never to return CSS_TOKEN_NONE
	typed token.  

Mon Jan 19 23:21:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	More usage of css_scanner_has_tokens() before accessing the scanners
	table.  

Mon Jan 19 23:10:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Be more paranoid and don't count in CSS_TOKEN_NONE tokens.  

Mon Jan 19 22:37:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Use macros in checks.  

Mon Jan 19 22:36:15 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jan 19 22:04:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/styletags.html:

	<b> tag is not also red.  

Mon Jan 19 21:56:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/styletags.html:

	E&nbsp;L&nbsp;i&nbsp;n&nbsp;k&nbsp;s 

Mon Jan 19 21:35:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Disable CSS by default. It is highly experimental and Zardoz pointed
	out that http://blogs.law.harvard.edu/tech/2004/01/19 caused a
	strange assertion failure.  

Mon Jan 19 21:33:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, document/document.c, document/document.h,
	modules/module.c, modules/module.h:

	Add a main_modules table. First entry is a module for the document
	subsystem. It will make it easy to move document options to
	document/options or even separate document/subdir file.  

Mon Jan 19 21:17:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Added assertions to check that the scanner token table is properly
	aligned, meaning checking the next token will be safer and will
	never force a rescan.  

Mon Jan 19 20:35:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, modules/module.c, modules/module.h:

	Module table handlers now take the table as arg.  

Mon Jan 19 19:58:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, config/options.inc, document/options.c,
	document/options.h, document/html/parser.c:

	Make it possible to disable CSS support. Enabled by default.  

Mon Jan 19 19:26:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Support for adding properties to already defined selectors.  

Mon Jan 19 19:25:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/styletags.html:

	Add test for adding properties to an already known selector.  

Mon Jan 19 19:20:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Revert bad part of last patch.  

Mon Jan 19 19:19:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, parser.c:

	Minor optimization if no selectors have been added.  

Mon Jan 19 19:18:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fix scary macros and loopings not enclosed in brackets.  

Mon Jan 19 19:01:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, parser.c, parser.h:

	Move CSS selector lookup to separate function.  

Mon Jan 19 18:53:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Try to handle precedens of special char tokens when skipping.  

Mon Jan 19 18:52:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	We need to stop at '}' tokens when parsing properties of selectors.  

Mon Jan 19 18:48:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/styletags.html:

	More <style> tests.  

Mon Jan 19 17:05:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Describe why to use @props and now @properties.  

Mon Jan 19 17:03:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/apply.h, css/parser.c,
	css/parser.h, html/parser.c:

	Minimal support for grabbing CSS properties from <style> tags. Only
	clean html element selectors are handled.  

Mon Jan 19 17:00:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Fix last patch.  

Mon Jan 19 16:55:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Use list_head pointers preparing for the invasion of <style>
	handling. Uh oh and some renaming too. ;P 

Mon Jan 19 16:51:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/styletags.html:

	Add a test for using properties from <style> tags.  

Mon Jan 19 16:17:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make the CSS scanner generate tokens for SGML comments.  

Mon Jan 19 14:43:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make the scanner generate atrule tokens containtin @<ident>.  

Mon Jan 19 13:35:02 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* src/document/css/apply.c:

	Don't apply colors from styles if
	document.colors.use_document_colors is 0.  

Mon Jan 19 07:05:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Set string token type.  

Mon Jan 19 06:29:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	We cannot get rid of string delimiters because token->length is set
	later in the function .. but it should not matter.  

Mon Jan 19 06:25:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Cleanup.  

Mon Jan 19 06:10:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Fix comments.  

Mon Jan 19 06:05:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Tidy up.  

Mon Jan 19 06:03:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Store debug related info in the scanner struct so they do not have
	to be passed to the functions even when CSS scanner debug is
	disabled.  

Mon Jan 19 05:52:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Update scanner comments.  

Mon Jan 19 05:49:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Remove garbage macro.  

Mon Jan 19 01:02:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Remove old TODO.  

Mon Jan 19 01:00:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/: simplefont.html, simpletext.html:

	Add text-decoration: underline tests.  

Mon Jan 19 00:56:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, property.c, property.h, value.c:

	Add support for text-decoration: underline.  

Mon Jan 19 00:43:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Add comments to the rbg() parsers loop.  

Mon Jan 19 00:30:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Even use scanner for background property expression parsing.  

Mon Jan 19 00:24:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	css_parse_color_value(): Use the scanner for parsing. This partly
	introduces spaghetti code in the rbg() handling. But we use a loop
	so it should be easy to move things to separate function if we want
	maybe even some generic function arg scanner.  

Mon Jan 19 00:20:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	Yes .. ermh buffer overflows .. that should be my apartment. This
	one got fixed tho' ;/ 

Mon Jan 19 00:02:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Also skip the % when scanning percentage tokens.  

Sun Jan 18 23:54:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Add comma to char token list. Needed for function scanning.  

Sun Jan 18 22:59:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/simplecolors.html:

	Add test cases for short hex colors.  

Sun Jan 18 22:58:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	No need to touch slen.  

Sun Jan 18 22:57:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	Add support for handling the short hexcolor format used by CSS.  

Sun Jan 18 22:48:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Check that hexcolors have the correct length. And disable debug
	flags.  

Sun Jan 18 22:38:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Add support for scanning CSS strings.  

Sun Jan 18 22:25:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Add CSS_TOKEN_FUNCTION that contains '<ident>(' string.  

Sun Jan 18 21:31:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Remove unused macro.  

Sun Jan 18 21:29:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Add position member for maintaining where in the string the scanner
	should start scanning next. Well make it easier to debug and also
	simplifies code.  

Sun Jan 18 21:04:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Ensure that move_to_front in non negative.  

Sun Jan 18 20:51:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Be a little less buggy in scan_css_tokens(). I really hate
	memmove()s and this lowlevel coding.  

Sun Jan 18 20:15:38 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Italian translation update.  

Sun Jan 18 20:11:05 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Translation update.  

Sun Jan 18 18:21:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.h, value.c:

	Introduce macro to calculate the length of 'static' strings. They
	can cause bugs + we are lazy and like simple code.  

Sun Jan 18 18:11:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Utilize the scanner when parsing font-style values.  

Sun Jan 18 18:06:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Utilize the scanner when parsing font-* weight values. We should
	maybe have some get_css_token_number() that can handle both
	CSS_TOKEN_DIGIT and CSS_TOKEN_PERCENTAGE.  

Sun Jan 18 18:01:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Utilize the scanner when parsing font-* identifier values.  

Sun Jan 18 17:57:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	css_parse_font_weight_value(): Use token types to see what to do.  

Sun Jan 18 17:54:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Digits can be part of name tokens so check if digit first when
	scanning.  

Sun Jan 18 17:48:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Utilize the scanner when parsing text-align values.  

Sun Jan 18 17:43:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: property.h, value.c, value.h:

	Pass the scanners along to the value parsers that will yet only work
	on the string of the first token. Had to backend color value
	parsing.  

Sun Jan 18 17:24:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	The scanner is so kind to skip whitespace for us so obsolete
	skip_whitespace() call.  

Sun Jan 18 17:20:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, value.c, value.h:

	Make css_parse_value() take scanner arg instead of string.  

Sun Jan 18 17:14:03 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): code simplication.  

Sun Jan 18 17:13:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Move CSS_SCANNER_DEBUG macro to c file.  

Sun Jan 18 17:12:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Group function and macro definitions with the various structs.  

Sun Jan 18 17:09:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Don't use inlined scan table accessors and mutators.  

Sun Jan 18 17:09:03 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	foreach_values() macro was dropped. Reindentation.  

Sun Jan 18 17:02:39 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simplecolors.html:

	This is a descriptive commit message.  

Sun Jan 18 17:00:50 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	extract_rows_or_cols_values(): check for @number greater than 100 if
	in percentage.  

Sun Jan 18 16:59:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Fixed superfluous @string shifting in rgb_component_parser(),
	spotted by Jonas.  

Sun Jan 18 16:59:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Sort alphabetically, spotted by Jonas.  

Sun Jan 18 16:47:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Minor cleanup and fix of scan table initialization.  

Sun Jan 18 16:45:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/property.c:

	Bound css_property_info by CSS_PT_LAST.  

Sun Jan 18 16:44:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c, src/document/css/property.c,
	src/document/css/property.h, src/document/css/value.c,
	src/document/css/value.h, test/css/simplecolors.html:

	Support for background property. It is broken in certain testcases
	but maybe it's scanner bug, I don't know, I'm not in the mood of
	tracing through 100 inlined scan_css_token() calls.  

Sun Jan 18 16:44:00 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	extract_rows_or_cols_values(): check for abnormally large @number
	values and prevent bad things by falling back to wildcard value.  

Sun Jan 18 16:35:09 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	extract_rows_or_cols_values(): initialize val to -1, use @number
	directly.  

Sun Jan 18 16:29:44 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Some now useless initializations were dropped.  

Sun Jan 18 16:26:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Trailing whitespaces cleanup.  

Sun Jan 18 16:25:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.h, scanner.h:

	Improve comment.  

Sun Jan 18 16:24:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Fix typo.  

Sun Jan 18 16:24:14 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): part of it was moved to
	extract_rows_or_cols_values(). Use static for these new functions.  

Sun Jan 18 16:22:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Describe (as pasky so gracefully suggested) css_scanner.  

Sun Jan 18 16:12:13 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): handle returned value as it should, and fix a
	typo.  

Sun Jan 18 16:12:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Comment struct css_token.  

Sun Jan 18 16:08:22 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): a part of it was moved to
	distribute_rows_or_cols_that_left().  

Sun Jan 18 15:59:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Try to make it more clear the difference between char tokens and non
	char tokens. Non char tokens now start at 256.  

Sun Jan 18 15:59:04 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): a part of it was moved to
	distribute_rows_or_cols().  

Sun Jan 18 15:53:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.h:

	Moved CSS_TOKEN_NON_ASCII_END (*shudder*) to the end of the enum,
	therefore all the other tokens will have sane enum values.  

Sun Jan 18 15:52:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.h:

	CSS_TOKENS makes no sense in arbitrarily-numbered enum, therefore
	better remove it or it will confuse someone.  

Sun Jan 18 15:47:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	#include elinks.h 

Sun Jan 18 15:46:16 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): shorter lines by using a macro as @values
	iterator.  

Sun Jan 18 15:41:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: Makefile.am, css/Makefile.am, css/parser.c,
	css/scanner.c, css/scanner.h:

	Introduce a CSS token scanner.  It maintains up to 10 tokens at a
	time to minimize the number of scans.  For scanning a scan table is
	used (idea by mozilla).  Only used in css_parse_properties() to
	minimize the impact.  

Sun Jan 18 15:38:07 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): localize @tmp_val.  

Sun Jan 18 15:34:54 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): fastmem mode minor optimization, let use
	alloca() here if possible.  

Sun Jan 18 15:32:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Removed unused variables.  

Sun Jan 18 15:32:33 2004  Petr Baudis <pasky@ucw.cz>:

	* Makefile.am:

	Removed the circular dependency hack, it results in a circular
	dependency even here now (dunno what happenned), so maybe it was
	silently resolved...  

Sun Jan 18 15:32:13 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): code flow cleanup.  

Sun Jan 18 15:30:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Assert for value_type in value parsers.  

Sun Jan 18 15:29:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: property.c, value.c, value.h:

	font-style and font-weight now uses separate value parsers.  

Sun Jan 18 15:28:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): localize and assert @divisor.  

Sun Jan 18 15:25:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: property.c, value.c, value.h:

	css_property_info.parser is now used instead of css_value_parsers[],
	which evaporated. Therefore the value parsers are now exported.  

Sun Jan 18 15:25:01 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): Use a loop instead of a goto, localize @number
	and @tmp_values.  

Sun Jan 18 15:19:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	css_value_parser_t is now redundant to css_property_value_parser 

Sun Jan 18 15:19:40 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): Use @tmp variable to cache calculations
	result.  

Sun Jan 18 15:18:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	css_value_parser_t now takes (struct css_property_info *) as its
	first argument.  

Sun Jan 18 15:14:43 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @nn -> @flag, local.  

Sun Jan 18 15:12:32 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): some comments were added.  

Sun Jan 18 15:10:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/.vimrc, src/bfu/.vimrc, src/bookmarks/.vimrc,
	src/bookmarks/backend/.vimrc, src/cache/.vimrc, src/config/.vimrc,
	src/cookies/.vimrc, src/dialogs/.vimrc, src/document/.vimrc,
	src/document/html/.vimrc, src/document/plain/.vimrc,
	src/encoding/.vimrc, src/formhist/.vimrc, src/globhist/.vimrc,
	src/intl/.vimrc, src/intl/gettext/.vimrc, src/lowlevel/.vimrc,
	src/mime/.vimrc, src/mime/backend/.vimrc, src/modules/.vimrc,
	src/osdep/.vimrc, src/osdep/beos/.vimrc, src/osdep/os2/.vimrc,
	src/osdep/riscos/.vimrc, src/osdep/unix/.vimrc,
	src/osdep/win32/.vimrc, src/protocol/.vimrc,
	src/protocol/auth/.vimrc, src/protocol/file/.vimrc,
	src/protocol/ftp/.vimrc, src/protocol/http/.vimrc,
	src/protocol/rewrite/.vimrc, src/protocol/smb/.vimrc,
	src/sched/.vimrc, src/scripting/.vimrc, src/scripting/guile/.vimrc,
	src/scripting/lua/.vimrc, src/ssl/.vimrc, src/terminal/.vimrc,
	src/terminal/graphics/.vimrc, src/terminal/text/.vimrc,
	src/util/.vimrc, src/viewer/.vimrc, src/viewer/dump/.vimrc,
	src/viewer/graphics/.vimrc, doc/.vimrc, src/viewer/text/.vimrc,
	doc/book/.vimrc, doc/book/config/.vimrc, doc/book/manpages/.vimrc,
	doc/man/.vimrc, doc/man/man1/.vimrc, doc/man/man5/.vimrc,
	doc/tools/.vimrc, po/.vimrc:

	. is now appended to 'runtimepath' instead of setting 'runtimepath'
	to .,$VIMRUNTIME, therefore evading ~/.vimrc etc.  

Sun Jan 18 15:07:51 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @m -> @maxval, @mj -> @maxpos.  

Sun Jan 18 15:06:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: .vimrc, parser.c, value.c, value.h:

	css_parse_value() now takes (struct css_property_info *) instead of
	{enum css_property_value_type}.  

Sun Jan 18 15:05:43 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @q -> @val, @qq -> @tmp_val.  

Sun Jan 18 15:03:41 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @oo -> @tmp_values, @n -> @number.  

Sun Jan 18 15:01:28 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @o -> @values, @ol -> @values_count.  

Sun Jan 18 14:58:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @op -> @new_values, @olp -> @new_values_count.  

Sun Jan 18 14:55:01 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @ww -> @max_value, @www -> @pixels_per_chars.  

Sun Jan 18 14:53:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/property.h:

	Introduced css_property_info.(parser|parser_data). Unused yet.  

Sun Jan 18 14:52:55 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @a -> @str, @aa -> @tmp_str.  

Sun Jan 18 14:50:12 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @d -> @divisor.  

Sun Jan 18 14:43:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, property.c, property.h, value.c:

	CSS_DP_* -> CSS_PT_*, CSS_DV_* -> CSS_VT_* 

Sun Jan 18 14:41:02 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/property.h:

	Clarify {struct css_property} description.  

Sun Jan 18 14:37:56 2004  Petr Baudis <pasky@ucw.cz>:

	* .cvsignore, autogen.sh, configure:

	Removed ./configure and ./configure-do -> ./configure, therefore
	restoring the original situation. This solution is not going to fly,
	./configure gets overwritten by automake rules.  

Sun Jan 18 14:25:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, property.h:

	css_property*.property -> .type 

Sun Jan 18 14:23:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: value.c, value.h:

	Tidyup.  

Sun Jan 18 14:23:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, parser.h:

	css_parse_decl -> css_parse_properties 

Sun Jan 18 14:22:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, property.h, value.c, value.h:

	css_decl_value -> css_property_value, css_decl_valtype ->
	css_property_value_type -> css_decl_property -> css_property_type 

Sun Jan 18 14:18:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/property.h:

	Try to clarify more css_property_info.value_type.  

Sun Jan 18 12:54:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.h:

	Update css_parse_decl() description.  

Sun Jan 18 12:50:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Trivial clarification.  

Sun Jan 18 03:01:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, property.c, property.h:

	Remove @namelen from property info struct. It will be useles when we
	switch to fast find and we do not use it for other string to data
	mapping structs.  

Sun Jan 18 02:55:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: Makefile.am, css/Makefile.am, css/parser.c,
	css/property.c, css/property.h:

	Move CSS property info to own file and expose css_property_info[].  

Sun Jan 18 02:40:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	css_parse_decl(): Localize loop variables.  

Sun Jan 18 02:38:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.h:

	css_parse_decl(): Update comment.  

Sun Jan 18 02:36:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Minor cleanup.  

Sun Jan 18 02:33:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	css_parse_decl(): Use while loop. Nothing changed other than
	indentation and removal of again label.  

Sun Jan 18 02:28:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fun with gotos so we don't parse declarations recursively anymore.  

Sun Jan 18 01:57:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Add css value type info to property_info struct. ObsoletesM
	prop2valtype.  

Sun Jan 18 01:50:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, parser.h:

	css_parse_decl(): Don't return anything. Caller can check
	list_empty() to see if anything was added.  

Sun Jan 18 01:48:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Remove function comment that is also in the header file.  

Sun Jan 18 00:59:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/cmdline.c, config/conf.c, lowlevel/home.c:

	Use the new confdir/conffile option names (config-dir/config-file).  

Sun Jan 18 00:56:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Fixed -confdir/-conffile.  

Sun Jan 18 00:29:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	-confdir -> -config-dir, -conffile -> -config-file, idea by Doug
	Kearns <djkea2@mugca.its.monash.edu.au>.  

Sun Jan 18 00:17:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	I'm sorry Zas, but you *knew* this is coming. Please split it up.  

Sun Jan 18 00:16:11 2004  Petr Baudis <pasky@ucw.cz>:

	* .cvsignore, Makefile.am, autogen.sh, configure:

	autoconf ./configure -> ./configure-do. ./configure is for now a
	trivial wrapper but will do some automagic feature.h rewriting and
	so. You will need to rm ./configure && cvs up && ./autogen.sh after
	this commit.  

Sun Jan 18 00:10:04 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Complete parse_frame_widths() cleanup. Changes made do not affect
	behavior. Among them, explicit variables names, minor trivial
	optimizations, got rid of a goto, comments. Sorry, this patch is
	quite big but concerns only this function, and i did not want to
	flood with cvs commits ;).  

Sat Jan 17 23:20:52 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update.  

Sat Jan 17 23:16:19 2004  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	.po files were resynced.  

Sat Jan 17 23:05:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Converted Jonas' strlcasecmp()s to strncasecmp()s, which actually
	make sense :^). Should fix 'text-align: right;' bug reported by
	Jonas.  

Sat Jan 17 22:49:40 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Hotkey conflicts fixes.  

Sat Jan 17 22:12:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Fixed string shufflink in TEXT_ALIGN value parser.  

Sat Jan 17 22:11:32 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simpletext.html:

	Jonas' div right; testcase.  

Sat Jan 17 22:04:49 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simpletext.html:

	Also a <div> test.  

Sat Jan 17 21:22:41 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simpletext.html:

	Added text-align tests.  

Sat Jan 17 21:18:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Compilation fix.  

Sat Jan 17 21:17:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, property.h, value.c:

	Added support for text-align property.  

Sat Jan 17 20:24:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, property.h, value.c:

	Fixed support for lighter and normal values of font-* properties.  

Sat Jan 17 19:59:17 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simplefont.html:

	Enhance the font-weight: normal testing.  

Sat Jan 17 19:53:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Added support for font-weight lighter, bolder and normal.  

Sat Jan 17 19:52:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/README:

	About current big design problems.  

Sat Jan 17 19:43:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Removed redundant skip_whitespace() from FONT_ATTRIBUTE parser.  

Sat Jan 17 19:40:26 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simplefont.html, src/document/css/apply.c,
	src/document/css/parser.c, src/document/css/property.h,
	src/document/css/value.c:

	font-style property support.  

Sat Jan 17 17:35:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Alphabetize.  

Sat Jan 17 16:46:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/Makefile.am:

	Fixed linking of the CSS code.  

Sat Jan 17 16:46:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Sort CSS appliers like the css_decl_propery enum.  

Sat Jan 17 16:46:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Removed obsolete TODOs.  

Sat Jan 17 16:45:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Cleaned up the spaghetti rgb() parsing code by moving the color
	component extraction to rgb_component_parser().  

Sat Jan 17 16:36:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: Makefile.am, apply.c, apply.h, parser.c,
	property.h, value.c, value.h:

	Moved {struct css_property} from apply.h to property.h.  

Sat Jan 17 16:26:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.h:

	Moved generic stuff from parser.h to README.  

Sat Jan 17 16:23:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.h:

	Removed redundant struct list_head.  

Sat Jan 17 16:23:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.h, README, Makefile.am:

	Moved generic stuff from parser.h to README.  

Sat Jan 17 16:01:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: css/Makefile.am, css/apply.c, css/apply.h,
	css/css.c, css/css.h, html/parser.c:

	document/css/css.* -> document/css/apply.* 

Sat Jan 17 15:54:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: Makefile.am, apply.c, css.c, parser.c,
	parser.h:

	Moved the current stub of future CSS parser from document/css/css.*
	to document/css/parser.*.  

Sat Jan 17 15:46:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.h:

	Typo fix.  

Sat Jan 17 15:45:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: Makefile.am, apply.c, css.c, value.c, value.h:

	Moved CSS value parser from document/css/css.* to
	document/css/value.*.  

Sat Jan 17 15:40:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Removed already obsolete TODO.  

Sat Jan 17 15:36:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.h, css.h:

	Update the _H define.  

Sat Jan 17 15:32:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Oops, include document/css/css.h.  

Sat Jan 17 15:32:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Moved value parsing to separate functions.  

Sat Jan 17 15:25:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Statify the appliers.  

Sat Jan 17 15:22:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.h, css.h:

	Include some stuff required by {struct css_property}.  

Sat Jan 17 15:21:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/document.c, document/css/apply.c,
	document/css/css.c, document/html/parser.c,
	document/html/renderer.c, document/html/tables.c, sched/session.c,
	viewer/text/form.c, viewer/text/link.c, viewer/text/textarea.c:

	Moved document/html/parser.h inclusion to the usual place, since it
	should be safe now.  

Sat Jan 17 15:18:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: Makefile.am, internal.h, parser.c, parser.h,
	renderer.c, tables.c:

	Moved the aggressive format/par_format #defines (together with
	html_top and html_stack) from document/html/parser.h to
	document/html/internal.h.  

Sat Jan 17 15:05:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, apply.h, css.c, css.h:

	Export {struct css_property}.  

Sat Jan 17 14:59:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Compilation fix.  

Sat Jan 17 14:57:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Moved proprety applying to separate functions.  

Sat Jan 17 14:49:07 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/idnes_mail.html:

	This is a nice test for font-weight, color, background-color on body
	etc. And it's all inlined in the style attributes.  

Sat Jan 17 14:44:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Make sure that background-color property on body element gets
	handled properly. Well, it's a mess.  

Sat Jan 17 14:38:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Compilation fix.  

Sat Jan 17 14:33:43 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/: simplecolors.html, simplefont.html:

	Separated font-related tests to simplefont.html, making them also
	more elaborate.  

Sat Jan 17 14:26:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c, apply.h, css.h:

	css_apply() now returns void instead of int because we do not use
	the return value anywhere anyway. Proposed by Jonas.  

Sat Jan 17 14:18:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/conf.c, config/opttypes.c, cookies/parser.c,
	document/html/parser.c, document/html/tables.c,
	protocol/http/header.c, protocol/smb/smb.c, util/string.h:

	Removed the WHITECHAR() macro, we use the standard builtin isspace()
	macro instead which should be completely equivalent.  

Sat Jan 17 14:16:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/css/apply.c, document/css/css.c, util/string.h:

	Make util/string.h directly include its prerequisite <ctype.h>.  

Sat Jan 17 14:12:34 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simplecolors.html:

	Made the bold tests a little more explicit.  

Sat Jan 17 14:09:39 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS, src/dialogs/document.c:

	Made the Document info msgbox scrollable, usable ie. for long
	titles/urls (test/longtitle.html). Patch by David A. Capello
	<dacap@users.sourceforge.net>.  

Sat Jan 17 14:06:22 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in, src/document/Makefile.am,
	src/document/html/Makefile.am, src/document/html/css.c,
	src/document/html/css.h, src/document/html/parser.c,
	src/document/css/Makefile.am:

	document/html/css.* -> document/css/css.* 

Sat Jan 17 07:49:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/css.c, html/css.c:

	Make the font-weight evaluation correct. Values pointed out by
	Miciah.  

Sat Jan 17 07:43:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/css.c, html/css.c:

	Make property name to property enum data driven.  

Sat Jan 17 07:23:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/css.c, html/css.c:

	Add support for font-weight (bold) support.  

Sat Jan 17 07:22:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/simplecolors.html:

	Add background-color and font-weight tests.  

Sat Jan 17 06:45:38 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation update.  

Sat Jan 17 02:24:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/css.c, html/css.c:

	Handle the background-color property.  

Sat Jan 17 02:09:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/css.c, html/css.c:

	Use skip_whitespace() macro.  

Sat Jan 17 01:56:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	open_current_link_in_new_tab(): Merge in get_tab_link_url(). Fix
	leak related to url list introduction previous today.  

Sat Jan 17 01:53:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, terminal/tab.c, terminal/tab.h,
	viewer/text/view.c:

	Specialize open_in_new_tab() to open current link in new tab. Rename
	to open_current_link_in_new_tab().  

Sat Jan 17 01:50:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Call open_url_in_new_tab() directly.  

Sat Jan 17 01:48:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	Merge backend for 'tab openers' with open_url_in_new_tab().  

Sat Jan 17 01:43:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, terminal/tab.c, terminal/tab.h,
	viewer/text/view.c:

	Make open_in_new_tab() more generic to also handle backgrounded
	tabs.  

Sat Jan 17 01:29:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/Makefile.am:

	We actually don't use libhtml.a anywhere, so it'd be good to say so.  

Sat Jan 17 01:26:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: Makefile.am, css/apply.c, css/apply.h, css/css.c,
	css/css.h, html/Makefile.am, html/css.c, html/css.h, html/parser.c:

	Very trivial CSS support introducted. It includes mostly the most
	basic framework for the style managment (basically just a temporary
	properties list), bunch of ideas in comments, and the initial
	css_apply(), which now just orders parsing of the element's style
	attribute (no real stylesheet yet, therefore). Oh and only 'color'
	property is supported for now, however it should be easy to
	introduce more. Have fun.  

Sat Jan 17 01:21:15 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simplecolors.html:

	Very simple test case for the 'color' property specified in the
	'style' attribute of an element.  

Sat Jan 17 01:20:11 2004  Petr Baudis <pasky@ucw.cz>:

	* test/Makefile.am:

	New css/ directory.  

Sat Jan 17 01:09:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Rename @i to @current_frame_number and initialize it to 0 if it is
	-1 (no frame has been chosen yet). This fixes drawing of title for
	backgrounded tabs containing frame documents.  

Sat Jan 17 00:27:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, util/string.c, util/string.h:

	Define a string item struct for string lists moving list members out
	of struct string. Requested by pasky.  

Sat Jan 17 00:11:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: util/color.c, util/color.h, config/options.c,
	document/html/parser.c, config/opttypes.c:

	decode_color() now takes the source string length as an additional
	argument.  

Sat Jan 17 00:05:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/color.c:

	Make more use of @slen in decode_color().  

Fri Jan 16 23:49:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/cmdline.c, sched/session.c, sched/session.h,
	terminal/tab.c:

	Use string lists instead of url_list structure and remove lot of
	trivial boring code.  

Fri Jan 16 23:48:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/: string.c, string.h:

	Add support for string lists. This adds list members to struct
	string but since we mostly use it via local variables it should not
	have a big impact.  

Fri Jan 16 22:31:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	do_open_in_new_tab(): Only add an url to list if it is non NULL
	since we test !list_empty() in process_session_info().  

Fri Jan 16 20:30:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Skip the 'MAP@' part of uris when dumping link references.  

Fri Jan 16 20:26:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Only dump link titles which are not empty.  

Fri Jan 16 20:08:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/cmdline.c, config/cmdline.h:

	Simplify the composing of the @url_list by using function variable
	and passing the list_head pointer to parse_option(). Let
	parse_option() return the first url again to simplify @url setup.  

Fri Jan 16 19:50:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	No empty @url in the case where the url list returned from
	parse_options() is empty is also a fatal error.  

Fri Jan 16 18:51:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Minor fastmem mode optimization in parser.  

Fri Jan 16 18:21:05 2004  Laurent Monin <zas@norz.org>:

	* src/: main.c, config/cmdline.c, config/cmdline.h,
	sched/session.c, sched/session.h, terminal/tab.c:

	Support for more than one url on command line. ELinks will open new
	tabs for them. For now, -dump and -source will only consider first
	url given (ideas?). Patch by Witold Filipczyk, slightly modified by
	me.  

Fri Jan 16 18:09:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	We the normal people put system include to other system includes. We
	do not want to end up again like Links or some other software
	packages, do we? 

Fri Jan 16 17:49:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: .cvsignore, .vimrc:

	Add control files.  

Fri Jan 16 16:30:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Update link_state using get_link_state() safer since there might be
	some corner cases.  

Fri Jan 16 16:29:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Fix the leak related to <sub> and <sup> the Right Way[tm].  

Fri Jan 16 16:18:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Revert last patch. It broke link numbering.  

Fri Jan 16 15:35:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Make the HTML renders link_state variable global so recursive calls
	to put_chars() also updates the outer put_chars() link_state. Should
	fix leaks related to links in <sub> and <sup> tags.  

Fri Jan 16 14:49:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Add some temporary assertions for detecting leak in the renderer.  

Thu Jan 15 22:51:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/document.c:

	Use directly @doc_view when gettin current link for globhist.  

Thu Jan 15 22:51:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/: session.c, session.h:

	Introduced get_current_link_in_view() which is same as
	get_current_link() but takes directly struct document_view as an
	argument.  

Thu Jan 15 22:36:11 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Italian translation update.  

Thu Jan 15 21:44:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/document.c:

	Use get_current_link() to get @historyitem, instead of copy of the
	code.  

Thu Jan 15 21:30:54 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	A missing header inclusion was added.  

Thu Jan 15 17:34:27 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Simplify and fix scroll_menu(). It now behaves like it should when
	paging down in View menu.  

Thu Jan 15 17:02:24 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Simplify menu_page_(up|down)().  

Thu Jan 15 16:11:18 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Move menu page up/down code to separated functions.  

Thu Jan 15 16:04:19 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Fix a segfault occuring when pressing page down on empty Link
	submenu of main menu.  

Thu Jan 15 05:01:00 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	Rename a few functions' parameters and local variables from @down to
	@file_download 

Thu Jan 15 04:41:22 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	Create a new function, is_in_downloads_list, to check whether the
	passed struct file_download * is in @downloads (the global variable
	that points into the list of running file downloads).  
	
	Replace the equivalent code in display_download with a call to this
	function.  
	
	In common_download_do and continue_download_do, only add
	@file_download to the download manager _after_ calling load_url or
	change_connection, respectively, and only if
	is_in_downloads_list(file_download).  
	
	This fixes a bug reported by dacap on IRC whereby ELinks would crash 
	when one attempted to download a file while the download manager was
	open.  

Wed Jan 14 19:54:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Add temporary fix for redrawing after calling find_next*(). It broke
	during do_action() generalization.  

Wed Jan 14 18:22:44 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/sched/download.c:

	Swap two lines. This should fix bug 366.  

Wed Jan 14 18:00:06 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Minor fix.  

Wed Jan 14 17:40:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	Bug 231 (memory corruption in html renderer) should be fixed now.
	Patch by Miciah and me.  

Wed Jan 14 17:10:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/listbox.c, bfu/menu.c,
	bfu/menu.h, config/dialogs.c, config/kbdbind.c, config/kbdbind.h,
	dialogs/info.c, sched/action.c, sched/action.h,
	viewer/text/search.c, viewer/text/view.c:

	Rename keyact enum to action. Function names changed to reflect
	this.  

Wed Jan 14 16:53:06 2004  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	Binding keys to ACT_NONE is useful to get rid of default
	keybindings. Suggested by Jonas.  

Wed Jan 14 12:25:21 2004  Peter Samek <samek@upc.uniba.sk>:

	* po/sk.po:

	Slovak translation update.  

Tue Jan 13 18:46:57 2004  Varga Balázs <vinnui@ent.hu>:

	* po/hu.po:

	Translation updated.  

Tue Jan 13 16:13:24 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Italian translation update.  

Tue Jan 13 15:37:41 2004  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	Do not display ACT_NONE action in keybinding manager, bind keys to
	this action is useless.  

Tue Jan 13 15:05:32 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Fix mouse click detection on main menu (introduced by main menu
	previous patch).  

Tue Jan 13 14:54:39 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/menu.c, bfu/menu.h, mime/dialogs.c:

	FREE_ANY macro is now used to shorten lines, it is equivalent to
	(FREE_LIST|FREE_TEXT|FREE_RTEXT|FREE_DATA).  

Tue Jan 13 14:48:51 2004  Laurent Monin <zas@norz.org>:

	* src/mime/dialogs.c:

	No need to pass @xxx to do_menu(), just use NULL instead. Safer
	imho.  

Tue Jan 13 14:41:41 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	Some assertions were added (related to bug 366).  

Tue Jan 13 14:26:48 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Fix handling of various spacing in main menu.  

Tue Jan 13 14:22:55 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/listmenu.c:

	Use macros to check end of menu.  

Tue Jan 13 14:13:15 2004  Laurent Monin <zas@norz.org>:

	* src/config/: kbdbind.c, kbdbind.h:

	Move ACT_NONE at start of enum keyact and use zero as value for it.
	It was breaking contextual menus display and perhaps other stuff.  

Tue Jan 13 08:45:53 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jan 12 18:23:07 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Updated italian translation.  

Sun Jan 11 22:16:17 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update.  

Sun Jan 11 18:18:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/info.c:

	GPLv2 only. Reminded by Jonas.  

Sun Jan 11 18:13:57 2004  Petr Baudis <pasky@ucw.cz>:

	* COPYING:

	Removed ELusive part for the foreseeable future.  

Sun Jan 11 17:48:25 2004  Petr Baudis <pasky@ucw.cz>:

	* COPYING:

	GPLv2, not any future version.  

Sun Jan 11 05:41:30 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/status.c, sched/task.c:

	Instead of zeroing the session's 'visited' flag in display_tab_bar, 
	zero it in ses_forward.  
	
	This is more logical and efficient, as we now zero the flag once, 
	when we finish loading the page, instead of repeatedly, once every
	time we update the tab bar, from when we first start trying to load
	the page to when we finish or fail.  
	
	More importantly, it fixes a bug whereby we would leave the tab
	highlighted as freshly loaded even if the page failed to load.  

Sat Jan 10 11:16:27 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Jan 10 11:03:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Made -confdir/-conffile captions more consistent and fixed -confdir
	description. Idea by Doug Kerans <djkea@mugca.its.monash.edu.au>.  

Sat Jan 10 06:10:36 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Fri Jan  9 21:30:58 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Explode count_menu_size() in 4 functions.  

Fri Jan  9 21:04:19 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Got rid of @s, and initialize mx to zero.  

Fri Jan  9 20:48:01 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	count_menu_size() was cleaned and fixed. Next step will be to cache
	text and rtext widths, as well as display-related infos, it will
	simplify things a lot (we currently make and remake many useless
	calculations) 

Fri Jan  9 15:20:59 2004  Laurent Monin <zas@norz.org>:

	* src/: setup.h, bfu/menu.c:

	Use constants and make calculations explicit, code simplification,
	MENU_HOTKEY_SPACE disappears, locally defined macros replace it,
	improving code clarity.  

Fri Jan  9 14:14:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	...except this little mistake. Fixed segfaults when opening menu
	thru kbd.  

Fri Jan  9 14:14:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Reverted bogus Miciah' fix, what we did previously was ok...  

Fri Jan  9 14:07:03 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Fix segfaults resulting from pasky's menu-handler butchering.
	(@win->data->win is _not_ the same as @win.) 

Fri Jan  9 13:12:12 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/backend/xbel.c:

	In the XBEL bookmark code, when adding a folder, do not bother to
	set ->root or ->box_item->type, as add_bookmark does that for us.  

Fri Jan  9 13:07:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/leds.c:

	Itty-bitty whitespace fix.  

Fri Jan  9 12:57:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	#undef macros once we're done with them.  

Fri Jan  9 12:38:30 2004  Petr Baudis <pasky@ucw.cz>:

	* Makefile.am:

	Added feature.h. Oops.  

Fri Jan  9 11:08:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Pass @fwd to mainmenu_kbd_handler().  

Fri Jan  9 11:08:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Moved @s from mainmenu_handler() to mainmenu_kbd_handler().  

Fri Jan  9 11:00:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Readded DIST macro, which got chopped most of it off during
	reindentation.  

Fri Jan  9 10:56:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	In draw_menu_left_text_hk, rename the @len parameter to @hotkey_pos.  

Fri Jan  9 10:51:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Remove an inaccurate comment.  

Fri Jan  9 10:44:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Moved menu/kbd event handling from mainmenu_handler() to
	mainmenu_(mouse|kbd)_handler().  

Fri Jan  9 10:40:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Blanklines.  

Fri Jan  9 10:39:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Moved menu/kbd event handling from menu_handler() to
	menu_(mouse|kbd)_handler().  

Fri Jan  9 10:38:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	#undef macros once we're done with them.  

Fri Jan  9 10:36:44 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Remove useless test. Spotted by Miciah.  

Fri Jan  9 10:27:57 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/file/file.c:

	In stat_user and stat_group, don't check for the case where a
	successful stat(2) call gives a uid or gid of -1. If it ever does,
	why not humour the system and proceed to use the values it has
	provided to us? 

Fri Jan  9 10:25:54 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Use @menu->selected instead of @s. Spotted by Miciah.  

Fri Jan  9 10:22:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Fixed the Jonas' strangeness.  

Fri Jan  9 10:09:31 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Revert last patch, it was correct. Sorry, Miciah ;).  

Fri Jan  9 09:52:55 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Start on first main menu item displayed. Suggested by Miciah.  

Fri Jan  9 09:42:25 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/dialogs.c:

	Do not give the B_ENTER flag to the 'Do not show anymore' button in
	the 'Write config success' box.  

Fri Jan  9 09:36:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/tab.c:

	When closing the current tab, switch to the previous tab _first_, so
	that the next tab doesn't lose its 'unvisited' highlighting.  

Fri Jan  9 09:31:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Fix session saving to bookmark tabs from left to right.  

Fri Jan  9 09:27:58 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Remove an obsolete comment.  

Fri Jan  9 09:26:25 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Update a comment: s/item_free/flags/ 

Fri Jan  9 09:14:21 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/tab.c:

	Remove the @link parameter from get_tab_link_url. The parameter only
	says whether to return NULL or to actually do something, so move
	that check to the callers.  

Fri Jan  9 07:20:11 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/dialogs.c:

	Include util/ttime.h for ttime.  

Fri Jan  9 01:22:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	I hope this is strange enough.  

Fri Jan  9 01:10:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Remove a few ending action description dots.  

Fri Jan  9 01:08:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Minor cleanup of action listbox initialization. No longer gettext
	action names but only the descriptions.  

Fri Jan  9 01:06:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Add description to 'none' action.  

Fri Jan  9 00:43:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Don't add listbox for ACT_SCRIPTING_FUNCTION since we hide it anyway
	and the current generic hierbox handling always unhides all root
	level boxes.  

Fri Jan  9 00:21:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Fix off by one error, which is really not my fault because we
	skipped 'none' before.  

Fri Jan  9 00:14:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	Alphabetise action_table and keyact enum. Hmm 

Thu Jan  8 23:36:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Fix startup goto dialog. Patch by Zardoz.  

Thu Jan  8 23:26:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, config/options.h, config/options.inc,
	mime/backend/mailcap.c:

	We only use alias description and captions for commandlines so no
	need to store them for 'regular' options.  

Thu Jan  8 22:26:04 2004  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	automatic session saving/restoring support 

Thu Jan  8 22:22:23 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	0.9.CVS. Please backport all the relevant bugfixes to REL_0_9_1rc1
	branch. Expected 0.9.1-final release: Sunday. What a mess.  

