Tue May 25 18:08:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/encoding/encoding.c:

	SSL is now nicely contained, so remove header defence.  

Tue May 25 18:05:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/color.c:

	Whoops. What is COLOR_MODE_DUMP doing there it is not for stuff like
	that.  

Tue May 25 17:40:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix to use CONFIG_IDN.  

Tue May 25 17:39:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: osdep.c, unix/sysinfo.h, unix/unix.c:

	Fix to use CONFIG_GPM.  

Tue May 25 17:35:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: encoding/encoding.c, modules/version.c,
	protocol/http/http.c:

	Use CONFIG_GZIP and CONFIG_BZIP2 instead of *_H variants. Reported
	by Stephane CHAZELAS.  

Tue May 25 17:34:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_CHECK_OPTIONAL_LIBRARY(): #define CONFIG_* macros.  

Tue May 25 16:47:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/: bindtextdom.c, dcgettext.c, dcigettext.c,
	dcngettext.c, dgettext.c, dngettext.c, explodename.c, finddomain.c,
	gettext.c, gettextP.h, intl-compat.c, l10nflist.c, loadmsgcat.c,
	localealias.c, ngettext.c, plural.c, textdomain.c:

	Normalize subdir includes by specifying the complete path. This
	should hopefully fix libintl.h inclusion conflicting with system
	libintl.h .. I thought I already fixed this on another solaris box
	but Stephane Chazelas reported it May 11 2004 on elinks-dev.  

Tue May 25 16:29:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, config/options.inc, terminal/color.c,
	terminal/color.h, terminal/screen.c:

	Make the option system with its tremendous min/max value ensurance
	guard us against malicious values in term->spec->color_mode. Me
	thinks that is where it belongs, plus this completely wipes _all_
	traces of 256 color support when disabled oh and then it is less
	code too ;) 

Tue May 25 15:07:10 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/: date.c, date.h:

	date.{c,h} were removed.  

Tue May 25 07:14:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: action.c, session.c, task.c, task.h:

	Move goto_url_home() to task file. Merge in get_homepage_url().  

Tue May 25 06:54:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: search.c, view.c, view.h:

	Use goto_current_link() in do_typeahead() and
	text_typeahead_handler(). Remove send_enter().  

Tue May 25 06:46:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	save_as(): Make it into a frame action.  

Tue May 25 06:38:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, viewer/text/view.c, viewer/text/view.h:

	Move save_url() closer to dialog_save_url().  

Tue May 25 04:48:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bookmarks/bookmarks.c, dialogs/menu.c,
	dialogs/menu.h, sched/session.c, terminal/tab.c, terminal/tab.h:

	Revert the last 4 patches. I hate this crap.  

Tue May 25 04:20:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/session.c:

	open_url_in_new_window(): Take URI struct as arg.  

Tue May 25 04:17:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	process_session_info(): Use URI struct in the url_list loop.  

Tue May 25 04:13:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bookmarks/bookmarks.c, sched/session.c,
	terminal/tab.c, terminal/tab.h:

	open_url_in_new_tab(): Take URI struct as arg.  

Tue May 25 04:03:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/hierbox.c:

	get_listbox_uri() introduced.  

Tue May 25 03:52:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser.c, document/html/parser.h,
	sched/task.c:

	Pass session->imgmap_href_base as URI struct all the way down the
	call path.  

Tue May 25 03:45:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	uri->protocol_str -> uri->string.  

Tue May 25 03:40:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.h, sched/session.c:

	Last user of get_cache_uri_string() looks bogus too so remove it
	completely.  

Tue May 25 03:37:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/: parser.c, parser.h, renderer.c:

	Push the cache_entry URI all the way down to init_html_parser() even
	if the cache entry is incomplete making it easier to track the URI
	and finally fix the old behaviour so that the href_base is always
	properly initialized.  

Tue May 25 01:19:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, viewer/text/view.c:

	Never ever do we want to struri() something headed for follow_url().  

Tue May 25 01:00:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/task.c, sched/task.h,
	viewer/text/link.c:

	goto_url_frame(): Take URI arg. Damn I forgot to rename it ;(.  

Tue May 25 00:55:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/task.c, sched/task.h,
	viewer/text/link.c:

	Merge goto_url_frame() and goto_url_frame_reload() by adding an
	extra enum cache_mode arg to to former.  

Tue May 25 00:48:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, link.c, link.h:

	goto_link() -> goto_current_link() and now graps current links from
	passed doc_view.  

Tue May 25 00:28:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, link.h:

	goto_link(): Return type changed to void. Nothing can go wrong in
	there.  

Tue May 25 00:26:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, sched/task.c,
	sched/task.h, viewer/text/link.c:

	session->imgmap_href_base changed to be a URI struct. goto_imgmap()
	now takes URI struct.  

Tue May 25 00:19:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, link.c, link.h:

	goto_link(): Now takes URI struct.  

Tue May 25 00:16:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, form.h, link.c:

	get_form_url() -> get_form_uri() and now returns URI struct.
	get_link_url() was merged into get_link_uri().  

Tue May 25 00:08:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, link.c:

	Let the caller of goto_link() free the URL.  

Mon May 24 23:59:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, link.h:

	get_link_url(): Make it static.  

Mon May 24 23:57:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	open_current_link_in_new_tab(): What a long name .. anyway use
	get_link_uri().  

Mon May 24 23:52:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Let.s get the ball rolling. Use get_link_uri() in
	open_url_in_new_window().  

Mon May 24 18:18:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	Be smart? and save one line so we only have ~79239 ;-) 

Mon May 24 18:06:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, terminal/event.c:

	Use struct terminal_info when reading EV_INIT data. It removes all
	those ugly offset calculations. decode_session_info() now takes
	length and data pointer.  

Mon May 24 18:05:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.h, kbd.c, terminal.h:

	Introduce struct terminal_info that holds all the stuff sent over
	the interlink. It makes it possible to batch all the queue stuff
	together.  

Mon May 24 17:29:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	handle_trm(): Use stack allocated buffer for writing the cwd so
	queue_ts() can be removed.  

Mon May 24 17:23:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	handle_trm(): Use stack allocated buffer for writing the TERM env
	variable so we can bypass queue_ts() that allocated cleared memory
	so MAX_TERM_LEN chars are always written.  

Mon May 24 13:12:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.h:

	end_token_scanning(): Allow @end to be <= scanner->table.
	scanner->tokens will become <= 0 meaning empty. Triggered by empty
	<style>-tags. Reported by sstar.  

Mon May 24 09:02:21 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon May 24 02:30:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, viewer/text/form.c, viewer/text/form.h:

	Introduce auto_submit_form() that uses submit_form() as backend and
	make doc_end_load() use it.  

Mon May 24 01:55:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, link.h, view.c:

	Introduce get_link_uri() that for now just wraps
	get_uri(get_link_url()).  

Mon May 24 01:43:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	download_link(): Remove map@-URL left over. LINK_MAP URL are now
	downloadable don't know if it is correct.  

Mon May 24 00:52:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_to_string(): Add POST_CHAR before adding post data. The bug
	was triggered by proxy related changes lately. Patch kindly donated
	by Zardoz.  

Sun May 23 17:13:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.h, document/html/renderer.c,
	sched/session.c, viewer/dump/dump.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/link.h, viewer/text/search.c:

	Introduce LINK_MAP link->type. It removes the 'map@' prefix from
	anything but the document/html parser and renderer. All places that
	depended on LINK_HYPERTEXT now also depends on LINK_MAP (it should
	maybe be reviewed more carefull).  

Sun May 23 16:58:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.h, document/html/renderer.c,
	sched/session.c, viewer/text/form.c, viewer/text/link.c,
	viewer/text/link.h, viewer/text/search.c:

	Revert LINK_MAP introduction.  

Sun May 23 16:56:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.h, document/html/renderer.c,
	protocol/uri.c, sched/session.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/link.h, viewer/text/search.c:

	Fix issue concerning uri->ipv6 setup.  

Sun May 23 15:47:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	s/--dump/-dump/ in the description for -no-numbering. We use one
	dash for all the other descriptions. Reported by by sstar.  

Sun May 23 15:43:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Disable keybinding translation. It is not correct in it's current
	form. Reported by sstar.  

Sun May 23 14:51:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Distribute the base URL to _all_ members of the HTML stack.
	Apparently the stack layout has changed. Maybe the unfinished title
	tag fix did it.  

Sun May 23 14:15:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Limit uri->portlen to 8 bits and use the 8 spare bits to flags such
	as ipv6.  

Sun May 23 02:39:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, protocol/uri.h, sched/download.c,
	sched/history.c, sched/session.c, sched/task.c:

	Wrap URI comparing in macro.  

Sun May 23 01:31:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS, configure.in, src/lowlevel/connect.c, src/protocol/proxy.c,
	src/protocol/uri.c, src/protocol/uri.h:

	Whee .. internationalized domain name is now available. The real
	magic is done in add_uri_to_string(). Only lowlevel stuff (like DNS
	queries and proxy assembling) uses it so it is quite simple
	actually. The proxy stuff is untested (as usual).  

Sat May 22 19:27:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, protocol/date.c, protocol/date.h,
	protocol/http/date.c, sched/download.c:

	parse_http_date() -> parse_date() 

Sat May 22 19:20:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/date.h:

	Normalize header.  

Sat May 22 19:15:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix xbel configuration spotted by pasky.  

Sat May 22 18:48:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/gettext/: plural.c, plural.y:

	Compilation fix. I wonder how were you able to build it? 

Sat May 22 13:44:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/connect.c, ssl/connect.c, ssl/connect.h:

	ssl_write(): Take data + len args instead of write buffer.  

Sat May 22 13:18:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/dialogs.c, config/options.inc, cookies/cookies.c,
	cookies/dialogs.c:

	Make the UI date format configurable. Closes my part of bug 448.  

Sat May 22 13:12:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/: conv.c, conv.h:

	Wrap add_date_to_string() in #ifdef HAVE_STRFTIME.  

Sat May 22 13:06:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/dialogs.c, cookies/cookies.c, cookies/dialogs.c,
	protocol/file/file.c, util/conv.c, util/conv.h:

	Introduce add_date_to_string() and use it to wrap buffered
	strftime() calls.  

Fri May 21 15:33:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.h:

	Whoops. DOM has not been merged yet ;) 

Fri May 21 13:44:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, util/scanner.h:

	Move generic token scanning handling to begin and end rutines.  

Fri May 21 12:43:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/backend/mimetypes.c:

	Doh! elinks.h includes setup.h ;) 

Fri May 21 12:29:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, m4/features.m4:

	Move macros to m4/.  

Fri May 21 12:22:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: auth/auth.c, http/http.c:

	Minor simplification. Make add_auth_entry() register the auth dialog
	in the question queue.  

Fri May 21 12:04:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	Remove unneeded #ifdefs 

Fri May 21 12:03:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, protocol/Makefile.am,
	protocol/file/Makefile.am:

	Hurrah! Link file and cgi objects into libprotocol and conditionally
	build cgi object.  

Fri May 21 11:57:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/css.c, encoding/encoding.c,
	encoding/encoding.h, protocol/file/file.c, protocol/file/file.h:

	Pretty ugly patch that moves read_encoded_file() to encoding/ which
	I think makes sense but maybe a better interface for reading local
	files without connection_state being needed would be great.  

Fri May 21 11:46:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, protocol/Makefile.am:

	Links in auth objects in the libprotocol archive.  

Fri May 21 11:39:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, cookies/cookies.c, dialogs/document.c,
	document/renderer.c, document/html/parser.c, mime/mime.c,
	protocol/Makefile.am, protocol/http/Makefile.am,
	protocol/http/date.c, protocol/http/date.h, protocol/http/header.c,
	protocol/http/header.h, protocol/http/http.c, sched/download.c:

	Move header and date library to protocol/ so http objects can be
	linked into libprotocol.a and http support could even be optional.  

Fri May 21 11:38:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: date.c, date.h, header.c, header.h:

	Prepare to move prototol/http header and date files to protocol/.
	Pasky to keep the history just cp it from protocol/http/Attic/ ASAP
	and it should be fine I hope.  

Fri May 21 11:21:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/parser.c, document/html/renderer.c,
	document/html/parser/forms.c, document/html/parser/parse.c,
	document/plain/renderer.c, intl/charsets.c, intl/charsets.h,
	viewer/text/form.c:

	Make it possible to pass int pointer to convert_string() that will
	be set to the new length.  

Fri May 21 11:11:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/: charsets.c, charsets.h:

	No need for us to suffer more than needed. Let the macro rename
	convert_string to convert_string_elinks.  

Fri May 21 10:54:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: renderer.c, renderer.h, html/parser.c,
	html/renderer.c, html/renderer.h, plain/renderer.c:

	Move get_convert_table() to generic document renderer file.  

Thu May 20 23:02:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/dialogs.c:

	get_cookie_info(): Simplify expire info adding.  

Thu May 20 21:35:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Update exmode description.  

Thu May 20 12:49:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, bookmarks/dialogs.c,
	formhist/formhist.c, globhist/dialogs.c, globhist/globhist.c,
	protocol/rewrite/rewrite.c, protocol/smb/smb.c,
	scripting/scripting.c, scripting/guile/core.c,
	scripting/guile/hooks.c, scripting/lua/core.c,
	scripting/lua/hooks.c, scripting/perl/core.c,
	scripting/perl/hooks.c, ssl/connect.c, ssl/ssl.c:

	Remove unneeded #ifdefs 

Thu May 20 12:42:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/leds.c, dialogs/exmode.c, mime/backend/mailcap.c,
	mime/backend/mimetypes.c:

	Remove unneeded #ifdefs 

Wed May 19 16:09:05 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon May 17 10:47:03 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Fix bad move causing crash on diku.dk.  

Mon May 17 10:38:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/Makefile.am:

	Oops s/rect.h/box.h 

Sun May 16 14:34:13 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	Bad move was fixed.  

Sun May 16 14:27:15 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@c -> @cell, @sc -> @span_cell.  

Sun May 16 14:13:28 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@wf -> @has_width. Correspondant field in struct table was commented
	out since it is unused.  

Sun May 16 14:08:32 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	struct table @rh field was renamed @real_height.  

Sun May 16 14:04:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	struct table @rw field was renamed @real_width.  

Sun May 16 14:01:17 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@p -> @part.  

Sun May 16 13:57:32 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@t -> @table.  

Sun May 16 13:14:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Group @part and code using it.  

Sun May 16 13:08:29 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@p -> @part.  

Sun May 16 13:03:59 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	struct table @p field was renamed @part.  

Sun May 16 12:57:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: renderer.c, renderer.h, tables.c:

	Use struct box in struct part.  

Sun May 16 12:40:34 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Drop useless white lines.  

Sun May 16 12:13:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.h:

	Remove (now) useless declaration of struct download.  

Sun May 16 12:11:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/: dump.c, dump.h:

	Make dump_start() and dump_end() static and move dump_pre_start()
	below them so they don't have to be declared.  

Sun May 16 11:41:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Better initialize events before main_modules if one should ever want
	to register hooks.  

Sun May 16 10:29:18 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/textarea.c:

	Invisible text in textarea was fixed (bug 454). This was due to
	inverted tests introduced in rev 1.51.  

Sat May 15 23:40:13 2004  Laurent Monin <zas@norz.org>:

	* src/intl/: charsets.c, charsets.h:

	Name clash with Samba should be fixed. Filed as bug 453, reported by
	Derek Poon.  

Sat May 15 17:20:14 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	is_in_box() doesn't work here. Revert part of rev 1.163 patch to fix
	the bug concerning not clickable links on first line of document.
	Need more work.  

Fri May 14 14:59:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	Don't allow empty names when adding options. Mentioned by sstar.  

Fri May 14 11:39:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Elaborate on CONFIG_MARKS description.  

Fri May 14 11:39:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/leds.c:

	Oops get the correct static option for get_leds_clock_format().  

Fri May 14 10:24:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/window.c:

	Pass references of the windows x and y members directly to
	get_parent_ptr().  

Fri May 14 10:19:19 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: link.c, view.c:

	Revert last "fix", it was not one.  

Fri May 14 10:12:01 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/: link.c, view.c:

	Clicking on links on first line of document was broken. It should
	now be fixed.  

Fri May 14 09:32:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: dialog.c, group.c:

	Fix indentation of set_box().  

Fri May 14 08:49:07 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/inpfield.c, bfu/menu.h, dialogs/status.c,
	document/renderer.c, document/html/frames.c,
	document/html/tables.c, util/memdebug.c, viewer/text/form.c,
	viewer/text/search.c, viewer/text/view.c:

	Trailing spaces cleanup.  

Fri May 14 08:42:09 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c:

	Fix incorrect change introduced in rev 1.46: not document->options
	but doc_view 

Fri May 14 00:43:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/options.c, document/options.h,
	document/renderer.c, document/html/frames.c,
	document/html/parser.c, document/html/renderer.c,
	document/html/parser/forms.c, document/plain/renderer.c,
	viewer/dump/dump.c, viewer/text/view.c:

	Use struct box for struct document_options.  

Fri May 14 00:18:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/dialog.c, bfu/dialog.h,
	bfu/group.c, bfu/inpfield.c, bfu/listbox.c, bfu/menu.c, bfu/menu.h,
	bfu/text.c, bfu/widget.c, bfu/widget.h, dialogs/download.c,
	dialogs/status.c, document/document.h, document/renderer.c,
	document/view.h, document/html/frames.c, document/html/frames.h,
	document/html/parser.c, document/html/renderer.c,
	document/html/tables.c, document/plain/renderer.c, terminal/draw.c,
	terminal/draw.h, util/box.h, util/rect.h, viewer/text/form.c,
	viewer/text/link.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c:

	s/dimensions/box/ && s/rect/box/ 

Thu May 13 20:40:06 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/menu.c, terminal/draw.c, terminal/draw.h:

	draw_area() -> draw_box(), draw_border_box() -> draw_border(),
	draw_shadow_box() -> draw_shadow().  

Thu May 13 20:31:24 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Use draw_border_box().  

Thu May 13 13:26:01 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/menu.c, terminal/draw.c, terminal/draw.h:

	draw_border_box() was introduced, it is now used by menus.  

Thu May 13 09:33:22 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/status.c:

	Use draw_box() instead of draw_area().  

Thu May 13 09:22:50 2004  Laurent Monin <zas@norz.org>:

	* src/: viewer/text/view.c, dialogs/download.c:

	Use draw_box() instead of draw_area().  

Thu May 13 09:15:38 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/text.c:

	Use draw_box() instead of draw_area().  

Thu May 13 09:08:06 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: menu.c, inpfield.c, listbox.c:

	Use draw_box() instead of draw_area().  

Thu May 13 09:07:44 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Use draw_box() instead of draw_area(), and use draw_shadow_box().  

Thu May 13 09:06:32 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/: draw.c, draw.h:

	Draw_box() and draw_shadow_box() were introduced.  

Thu May 13 01:29:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Peek at $enable_xbel and do all the expat checking _before_
	CONFIG_XBEL_BOOKMARKS is set up so it can depend properly on it and
	report the correct value to the feature log.  

Thu May 13 01:08:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/Makefile.am:

	Fix trailing \ in last patch.  

Thu May 13 00:53:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/Makefile.am:

	Only add scanner object if building with CSS support.  

Thu May 13 00:19:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf, src/main.c, src/sched/session.h,
	src/viewer/text/Makefile.am, src/viewer/text/view.c:

	Make document marks optional.  

Wed May 12 19:43:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Mention pasky's ode to the almighty bookmarks.  

Wed May 12 19:35:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Mention doc/small.txt in CONFIG_SMALL description.  

Wed May 12 15:08:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* .cvsignore, Makefile.am, configure.in:

	Log the feature summary to features.log file. It ensures settings
	for all features are shown and simplifies the code plus the file
	might be useful for someone.  

Tue May 11 23:22:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Move a few cleanup functions to the 'init_b' sequence. They should
	all be empty when running in client mode.  

Tue May 11 19:45:23 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/text.c:

	Fix scrollable text widget.  

Tue May 11 19:23:17 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/group.c:

	Fix wrong widget dimensions, revealed by broken radio buttons
	changing in search dialog.  

Tue May 11 18:43:37 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	Fix bad move introduced in rev 1.163. Mouse click detection on
	certain links was broken.  

Tue May 11 17:50:40 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Italian translation update.  

Tue May 11 14:59:10 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	new_table(): set rx,ry,real_columns_count only if table was
	successfully allocated.  

Tue May 11 14:56:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	new_columns(): tidy up.  

Tue May 11 14:50:08 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	new_table(): really allocated values (rx,ry,real_columns_count)
	should not be changed before allocation attempts.  

Tue May 11 14:45:52 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Field @rc of struct table was renamed @real_columns_count.  

Tue May 11 13:00:21 2004  Laurent Monin <zas@norz.org>:

	* configure.in:

	Use AC_CHECK_FILE macro to test for features.conf file, "test -e" is
	not portable. Issue pointed out by Stephane Chazelas.  

Tue May 11 09:56:22 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/frames.h:

	Unused field @line was removed from struct frame_desc.  

Tue May 11 09:32:59 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/frames.c, document/html/frames.h,
	document/html/parser.c, viewer/text/view.c:

	Use struct rect in struct frameset_desc.  

Mon May 10 23:12:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, protocol/Makefile.am:

	Merge ftp objects in the protocol/ dir.  

Mon May 10 17:15:22 2004  Laurent Monin <zas@norz.org>:

	* src/: dialogs/status.c, document/renderer.c, document/view.h,
	document/html/frames.c, util/rect.h, viewer/text/form.c,
	viewer/text/link.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c:

	Use struct rect in struct document_view, changes were made
	accordingly with the help of two new little helpers:
	(row|col)_is_in_rect().  

Mon May 10 15:34:32 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/checkbox.c:

	Use struct rect, set_rect() and is_in_rect().  

Mon May 10 15:15:03 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/button.c:

	display_button(): use struct rect * and precalculated label length
	value instead of strlen( ) call.  

Mon May 10 12:56:13 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/dialog.c, bfu/group.c, bfu/inpfield.c,
	bfu/listbox.c, bfu/menu.c, bfu/text.c, document/html/renderer.c,
	document/html/tables.c, document/plain/renderer.c, util/rect.h:

	Convert set_rect() and is_in_rect() macros to static inline
	functions.  

Mon May 10 05:17:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Drop the 'support' word for the configuration summary.  

Mon May 10 01:51:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.h, document/html/renderer.c,
	document/html/tables.c, document/plain/renderer.c,
	viewer/text/search.c:

	Use struct rect in struct node. I propose to rename it box though it
	is shorter and a bit more descriptive IMO.  

Sun May  9 23:33:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, sched/connection.h, sched/error.c:

	A little advertisement shouldn't hurt anyone so pop up 'this version
	does not support ... protocol' message for finger and smb. Or is
	this too bloated\? 

Sun May  9 23:04:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf, src/protocol/Makefile.am,
	src/protocol/finger.h:

	Make finger protocol support optional. Maybe it should be disabled
	by default since I don't think so maybe people use it and it more
	serves as a protocol implementation reference.  

Sun May  9 22:27:36 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: menu.c, menu.h:

	Use struct rect in struct menu.  

Sun May  9 21:46:23 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/widget.h, util/Makefile.am, util/rect.h:

	Add util/rect.h and move struct rect related stuff to it.  

Sun May  9 21:38:41 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Fix set_rect() call.  

Sun May  9 21:17:12 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/dialog.h, bfu/group.c, bfu/text.c,
	dialogs/download.c:

	Use struct rect in struct dialog_data.  

Sun May  9 01:18:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/auth.c:

	Semi-fix the HTTP auth related crash caused by http_send_header()
	being called more times than before [from run_connection()] instead
	of select_loop() which means more find_auth() calls that would end
	up free()ing the entry and the dialog accessing freed memory.  
	
	I still don't know when the call pattern to changed and auth is
	still pretty broken since I had to type user/password twice.  

Sun May  9 00:59:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/auth/: auth.c, auth.h:

	Allocate http_auth_basic->{user,password} as part of the struct.  

Sun May  9 00:56:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Make connected() static.  

Sat May  8 13:40:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memdebug.c:

	Include the full copyright header here because this file can be
	frequently distributed separately from the rest of ELinks.  

Sat May  8 01:18:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, util/scanner.c, util/scanner.h:

	Make scanner mapping and scan table info const.  

Sat May  8 01:17:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Make exmode handler table const.  

Fri May  7 23:33:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix adding of -Werror when CONFIG_DEBUG is set.  

Fri May  7 18:14:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Undent the code.  

Fri May  7 18:05:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Move unknown_protocol_handler closer to the user and rename to
	generic_external_protocol_handler.  

Fri May  7 18:01:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Remove protocol_backend->external_handler member since it is now
	only user or unknown handler so this is less bloated IMO.  

Fri May  7 17:53:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h:

	Move struct protocol_backend to .c file.  

Fri May  7 17:47:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: Makefile.am, https.c, https.h:

	Only conditionally build HTTPS else simply #define the HTTPS
	protocol handler to NULL like SMB does and let the generic unknown
	protocol handler do the work.  

Fri May  7 17:40:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	Use common handler for unknown and javascript protocol backend.
	Prepare for HTTPS backend to use it as well.  

Fri May  7 17:36:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	If both external and regular protocol handler is NULL return the
	unknown protocol handler so that disabled (but otherwise known)
	protocols can use a common handler.  

Fri May  7 17:31:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/https.c:

	Fix HTTPS building.  

Fri May  7 17:30:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h:

	Move the lua protocol backend last so it doesn't match user:// URIs
	and cause assertion failures. Hope this doesn't break anything? 

Fri May  7 17:27:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: finger.c, finger.h, protocol.c, user.c, user.h,
	file/file.c, file/file.h, ftp/ftp.c, ftp/ftp.h, http/http.c,
	http/http.h, http/https.c, http/https.h, smb/smb.c, smb/smb.h:

	Centralize protocol_backends again. It makes more sense when
	building with conditionals.  

Fri May  7 16:32:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Only check for expat and link with -lexpat when needed. Reported by
	fredlwm.  

Fri May  7 12:28:40 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/text.c:

	Use set_rect().  

Fri May  7 12:21:20 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/listbox.c:

	Use set_rect() and is_in_rect().  

Fri May  7 12:15:40 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: group.c, inpfield.c:

	Use set_rect() and is_in_rect().  

Fri May  7 11:24:20 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: button.c, checkbox.c, group.c, inpfield.c, listbox.c,
	text.c, widget.c, widget.h:

	Struct rect was introduced, as well as convenience macros set_rect()
	and is_in_rect(). It is currently used by struct widget_data only.  

Fri May  7 09:05:59 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri May  7 08:58:27 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	Comment out HTML_ATTR_NO_CONV stuff since it is not used yet.  

Fri May  7 08:55:31 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	get_attr_val(), get_url_val() and has_attr() are now macros wrapping
	get_attr_value() calls.  

Fri May  7 08:49:31 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	Declare and describe get_attr_value() in parse.h.  

Fri May  7 08:45:35 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	get_attr_val_() was renamed get_attr_value().  

Fri May  7 08:42:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	enum html_attr_flags was introduced to control get_attr_val_()
	behavior.  

Fri May  7 01:46:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h, smb/smb.h:

	Move macro conditions for SMB protocol backend to smb header.  

Thu May  6 23:50:05 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	Previous patch was a commit error. Sorry....  

Thu May  6 23:39:37 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/: parse.c, parse.h:

	enum gav_flags was introduced, and is now used by get_attr_val_(),
	it is now possible to disable conversion though convert_string(). It
	may help to fix bug 451.  

Thu May  6 22:35:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* m4/gettext.m4, src/intl/Makefile.am:

	If --disable-nls don't enter src/intl/gettext 

Thu May  6 22:06:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Fix keybinding toggling that was broken by the int <-> void *
	removal.  

Thu May  6 15:32:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/finger.c:

	Rearrange functions so it is not necessary to declare any.  

Thu May  6 15:26:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix typo.  

Thu May  6 14:39:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/options.c:

	Use get_cp_mime_name() instead of get_cp_name() as the name key for
	the charset menu.  

Thu May  6 14:39:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/charsets.c:

	Use N_CODEPAGES and remove define of CODEPAGES.  

Thu May  6 00:15:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Add header to the config pretty printing area.  

Thu May  6 00:14:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* INSTALL, NEWS, README, THANKS:

	Capital letter files got aspelled.  

Wed May  5 17:52:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	More CONFIG_CSS tuning.  

Wed May  5 12:39:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	m11p 

Wed May  5 12:37:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Don't assume anything is simple, elaborate on CONFIG_CSS
	description.  

Wed May  5 12:26:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	More CONFIG_CSS stuff.  

Tue May  4 11:45:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: options.c, options.h:

	Don't get CSS options if it is disabled.  

Tue May  4 10:50:08 2004  Laurent Monin <zas@norz.org>:

	* src/: dialogs/info.c, util/memdebug.c, util/memdebug.h:

	Count and show memory truly allocated (including memory used by
	memory debug itself).  

Tue May  4 07:55:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf, src/document/Makefile.am,
	src/document/html/parser.c, src/document/html/parser/link.c,
	src/document/html/parser/parse.c, src/modules/module.c:

	Make CSS optional.  

Tue May  4 01:48:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	Avoid int <-> void * conversion by passing strtonum pointers ... ok
	this is getting too ugly so I will stop this now besides it is
	passed my bedtime.  

Tue May  4 01:46:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/: menu.c, menu.h:

	Yucky hacks to fix compile errors >:).  

Tue May  4 01:43:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/dialogs.c:

	make 

Tue May  4 01:22:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/: menu.c, menu.h:

	Avoid int <-> void * conversion by passing the open_in_new pointer
	instead of term_env enum.  

Tue May  4 01:21:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/options.c:

	Avoid int <-> void * conversion by passing the codepage name and
	looking up the index.  

Tue May  4 01:10:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, util/scanner.c, util/scanner.h:

	Avoid int <-> void * conversion by storing the start of the a
	scanner table range in a string. A bit ugly but ...  

Tue May  4 01:08:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/charsets.c:

	Make @strings static.  

Tue May  4 00:55:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/charsets.c:

	Avoid int <-> void * conversion by storing the codepage_desc pointer
	as the fastfind data.  

Mon May  3 23:04:08 2004  Laurent Monin <zas@norz.org>:

	* src/cache/dialogs.c:

	Add a space before ... when url is truncated, it is less ambiguous.  

Mon May  3 22:57:42 2004  Laurent Monin <zas@norz.org>:

	* src/cache/dialogs.c:

	draw_cache_entry_item() was added to display only "public" parts or
	uri in cache manager. Post data do not appear as is, but an
	indication is left to user in the form of " (POST DATA)" aooended to
	uri string. Password info will be hidden too. It fixes bug 445.  

Mon May  3 21:40:29 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/button.c:

	Use macros to make calculations explicit, clarifying things.  

Mon May  3 14:32:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix sed magic on FreeBSD.  

Mon May  3 13:11:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/modules/version.c:

	Try to wrap the module feature listing between 70-80 to make it more
	readable.  

Mon May  3 13:10:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Improve the feature pretty printing to be more portable and faster
	by using sed exclusively.  

Sun May  2 23:05:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	All hail to the bloat. Print configuration summary _after_ the
	'creating' messages and in a pretty printed way.  

Sun May  2 13:49:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/Makefile.am:

	Only conditionally build memdebug and fastfind objects.  

Sun May  2 13:30:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, modules/module.c, protocol/Makefile.am,
	protocol/protocol.c, protocol/protocol.h:

	A little kludgy. Introduce protocol module (which I think we should
	have anyway) because it removes a bit of the symbol resolving mess
	in the top level Makefile and make URI rewriting a submodule.
	Finally only conditionally build URI rewriting.  

Sun May  2 13:08:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/: Makefile.am, backend/Makefile.am:

	Only conditionally build mailcap and mimetypes backends.  

Sun May  2 13:07:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/backend/: common.c, xbel.c:

	Fix building without xbel.  

Sun May  2 13:01:22 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: msgbox.c, msgbox.h:

	msg_text_ni() is not used at all, so it was removed.  

Sun May  2 12:59:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/: Makefile.am, backend/Makefile.am:

	Only conditionally build xbel.  

Sun May  2 12:59:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/Makefile.am:

	Cleanup 

Sun May  2 12:58:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Dejavu: $withval -> $enableval.  

Sun May  2 12:53:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	$srcdir should be initialized by autoconf for us so clean it up.  

Sun May  2 12:52:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/Makefile.am:

	Only conditionally build exmode.  

Sun May  2 12:52:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, protocol/Makefile.am:

	Only conditionally build smb.  

Sun May  2 12:51:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/Makefile.am:

	Cleanup.  

Sun May  2 12:45:15 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/inpfield.c:

	Label dsp_f was renamed display_field.  

Sun May  2 11:55:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Remove usage of changequote() since it is discouraged.  

Sun May  2 10:53:33 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Explode dialog_func() switch: smaller functions were introduced.  

Sun May  2 10:29:43 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	Explode hierbox_dialog_event_handler() big switch in smaller
	functions: hierbox_ev_kbd(), hierbox_ev_init(), hierbox_ev_abort().  

Sun May  2 09:56:58 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	hierbox_browser(): minor code simplification.  

Sun May  2 03:05:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix XBEL dependency.  

Sun May  2 00:49:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Doh. Revert last patch.  

Sun May  2 00:28:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Rename variables used by the new configuration scheme to have
	CONFIG_ prefix.  

Sun May  2 00:13:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	We have to figure out a way to autogenerate this crap. Explicitly
	define AM_CONDITIONAL()s.  

Sat May  1 23:31:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/Makefile.am:

	Only conditionally build LEDs code.  

Sat May  1 23:16:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: Makefile.am, scripting/Makefile.am:

	Use conditionals for scripting/ stuff.  

Sat May  1 22:59:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/Makefile.am:

	Yes mamma. Introducing autobreak conditionals. <rant> for no good
	reason (well ok who wants to run a m4 macro processor from a perl
	script) automake reports that 'CONFIG_FOO does not appear in
	AM_CONDITIONAL' but this is a lie and it works perfect so it just
	seems that automake make a few lazy and false checks </rant> 

Sat May  1 22:26:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Ahh yes there is this distinction between --with and --enable args.
	;-) 

Sat May  1 19:29:58 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	Reduce code redundancy by introducing put_button().  

Sat May  1 19:26:30 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	html_input(): allocate @fc only if needed, but not twice ;)) 

Sat May  1 19:25:42 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	html_input(): allocate @fc only if needed.  

Sat May  1 19:20:48 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	html_button(): allocate @fc only if needed.  

Sat May  1 19:16:07 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	Minor tidyup and labels renaming.  

Sat May  1 18:16:59 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/link.c:

	Tidyup.  

Sat May  1 18:12:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	File got aspelled and reformatted.  

Sat May  1 18:03:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Try to sort out this mesh of misinformation. Take 2.  

Sat May  1 18:01:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/: conf.c, dialogs.c, opttypes.c, opttypes.h:

	Add an |int *line| parameter to reader procedures in the options
	code.  In |str_rd|, increment |line| for each new-line character
	encountered.  This fixes bug 443: Multi-line option values throw off
	line-numbers in conf.-file errors 

Sat May  1 17:58:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* features.conf:

	Try to sort out this mesh of misinformation.  

Sat May  1 17:39:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* INSTALL:

	feature.h -> features.conf 

Sat May  1 17:33:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	feature.h -> features.conf 

Sat May  1 17:24:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* Makefile.am:

	Oops make features.conf appear in distributed tarballs.  

Sat May  1 16:39:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, m4/iconv.m4:

	Try to normalize some of the configure args.  

Sat May  1 16:08:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf:

	Setup CONFIG_IPV6 using EL_ARG_DEPEND(). Please pasky or someone
	elaborate a bit in the descriptiong since all I am good for are
	rants. ;-) 

Sat May  1 15:50:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/configure.txt:

	These now live in feature.conf file.  

Sat May  1 15:49:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf:

	Always set CONFIG_* defined via EL_ARG_*() macros to either yes or
	no so they can be used in dependency checking. CONFIG_FASTMEM is now
	defined via EL_ARG_DEPEND().  

Sat May  1 15:31:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Make the CONFIG_* dependencies and explicit by using
	HAVE_<name>=<value> notation.  

Sat May  1 15:00:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, features.conf:

	Add CONFIG_{DEBUG,OWN_LIBC,SMALL} to feature.conf.  

Sat May  1 14:48:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Add -lexpat to LIBS.  

Sat May  1 14:09:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, feature.h, features.conf:

	Feature configuration is now done using a simple shell script file
	named features.conf containing default values for all features.  

Sat May  1 10:01:10 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Handle invalid colors mode is a cleaner way, especially when 256
	colors mode was enabled and saved in elinks.conf, then a 16 colors
	only elinks is launched, attempting to use that now illicit mode. It
	was exiting with internal error, now it just emits an error and fall
	back to 16 color mode.  

Sat May  1 05:29:36 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* contrib/lua/hooks.lua.in, src/scripting/lua/core.c:

	In init_lua(), call lua_mathlibopen() so as to have mod() available 
	to Lua scripts, and delete the definition of mod() in hooks.lua.in.  

Sat May  1 05:14:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* configure.in:

	Doh, '/usr' and '/usr/local' were doubled, too.  Remove one '/usr'
	and one '/usr/local'.  

Sat May  1 05:11:51 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* configure.in:

	I guess that the doubled '"$withval"' was part of the piggy-switch
	hack, as hinted by the comment. Remove one '"$withval"'.  

Sat May  1 05:05:52 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* configure.in:

	Try -llua$suffix and -I$luadir/include/lua$suffix where $suffix is
	'', '40', and '50' in succession until one or none are found to
	work.  
	
	This fixes Lua detection with Lua 5 as packaged by Debian (which
	gives the headers directory and libraries the suffix '50').  
	
	Who wrote that brain-dead piggy-switch hack?  Hm, rev. 1.135--ohh,
	sorry pasky! 

Fri Apr 30 21:41:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix typo.  

Fri Apr 30 14:30:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	Since we now rely on autoconf 2.13 lets also do these *DIR defines
	the right way.  

Fri Apr 30 13:56:21 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_char_color(): x += 1; -> ++x; 

Fri Apr 30 13:53:05 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_char_color(): optimization and cleanup.  

Fri Apr 30 13:46:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Try to clearify bitmembers.  

Fri Apr 30 13:45:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/dialog.c:

	Remove empty line.  

Fri Apr 30 13:33:50 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_char16(): if (ch->attr & SCREEN_ATTR_BOLD) -> if (bold).  

Fri Apr 30 13:27:14 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_chars(): update comment.  

Fri Apr 30 13:18:56 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	add_chars(): tidy up.  

Fri Apr 30 12:44:31 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Revert wrong patch: even if nothing was redrawn, we possibly still
	need to move cursor. It fixes issue reported by sstar on irc, thanks
	to Jonas to pointed it out.  

Fri Apr 30 12:25:56 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated, an hotkey conflict was fixed.  

Fri Apr 30 09:26:22 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	update_screen_driver(): test for utf8_io only once.  

Fri Apr 30 09:05:36 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Move cases more likely to occur first in switch().  

Fri Apr 30 09:03:11 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Do not test @image.length if this is not needed.  

Fri Apr 30 08:48:55 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Only call get_screen_driver() if needed.  

Fri Apr 30 08:39:56 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Typo fix in add_chars() macro: @term -> @term_.  

Fri Apr 30 08:38:29 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Indentation level reduction.  

Fri Apr 30 03:44:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Cleanup.  

Fri Apr 30 03:41:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Doh. Fix CONFIG_SSL dependency ;).  

Fri Apr 30 03:13:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Be more conforming. Use AC_MSG_WARN() when guile configuration
	fails.  

Fri Apr 30 03:02:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix EL_CONFIG_DEPENDS() macro and a few tests.  

Fri Apr 30 01:06:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	Add EL_CONFIG_DEPENDS() macro for handling scripting and SSL
	CONFIG_* setup.  

Fri Apr 30 00:19:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Use EL_CONFIG() for CONFIG_IPV6.  

Fri Apr 30 00:17:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	Use EL_CONFIG() to define CONFIG_* variables.  

Thu Apr 29 23:53:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h:

	Remove seemingly unused defines.  

Thu Apr 29 23:32:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, src/main.c, src/config/kbdbind.c,
	src/config/kbdbind.h, src/dialogs/menu.c, src/modules/module.c,
	src/protocol/proxy.c, src/sched/action.c, src/sched/session.c,
	src/sched/task.c, src/scripting/scripting.c,
	src/scripting/scripting.h, src/scripting/guile/core.c,
	src/scripting/guile/core.h, src/scripting/guile/hooks.c,
	src/scripting/guile/hooks.h, src/scripting/lua/core.c,
	src/scripting/lua/core.h, src/scripting/lua/hooks.c,
	src/scripting/lua/hooks.h, src/scripting/perl/core.c,
	src/scripting/perl/core.h, src/scripting/perl/hooks.c,
	src/scripting/perl/hooks.h, src/viewer/text/view.c:

	HAVE_{SCRIPTING,LUA,PERL,GUILE} -> CONFIG_{...}.  

Thu Apr 29 23:22:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, src/lowlevel/connect.c,
	src/modules/module.c, src/protocol/http/http.c,
	src/protocol/http/https.c, src/sched/connection.c,
	src/sched/error.c, src/ssl/connect.c, src/ssl/connect.h,
	src/ssl/ssl.c, src/ssl/ssl.h:

	HAVE_{SSL,OPENSSL,GNUTLS} -> CONFIG_{SSL,OPENSSL,GNUTLS}.  

Thu Apr 29 23:11:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/config/cmdline.c, src/lowlevel/connect.c,
	src/lowlevel/connect.h, src/lowlevel/dns.c, src/modules/version.c,
	src/osdep/getifaddrs.c, src/protocol/uri.c, src/protocol/ftp/ftp.c:

	IPV6 -> CONFIG_IPV6.  

Thu Apr 29 23:04:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/getifaddrs.c:

	Fix HAVE_IPV6 to be IPV6.  

Thu Apr 29 23:02:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, src/config/kbdbind.c,
	src/config/options.h, src/modules/version.c, src/osdep/stub.h,
	src/protocol/http/codes.c, src/util/color.c, src/util/error.h,
	src/util/fastfind.h, src/util/memory.c, src/util/memory.h,
	src/util/snprintf.h:

	FASTMEM -> CONFIG_FASTMEM, USE_OWN_LIBC -> CONFIG_OWN_LIBC,
	ELINKS_SMALL -> CONFIG_SMALL.  

Thu Apr 29 17:04:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	The color mapping seems to work fine now.  

Thu Apr 29 16:01:25 2004  Laurent Monin <zas@norz.org>:

	* src/util/: color.c, color.inc:

	Fix colors stuff: always include color_s.inc before (optionnal)
	color.inc, which was stripped down. It should fix the white ->
	0xFFFFFF -> gray100 issue reported by Jonas.  

Thu Apr 29 15:06:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Thu Apr 29 15:03:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/tools/help2doc:

	More help2doc tool fixing.  

Thu Apr 29 14:24:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/tools/help2doc:

	Fix elinks version extraction.  

Thu Apr 29 14:17:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* Makefile.base:

	Tidyup.  

Thu Apr 29 14:11:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* Makefile.base:

	Yay .. get rid of that `dirname ...` hack and just include .  

Thu Apr 29 14:07:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/Makefile.in:

	Apply last chunk of Harold L Hunt II's patch fixing bug 353.  

Thu Apr 29 13:52:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/Makefile.am:

	Try to improve builddir != srcdir situation.  

Thu Apr 29 13:30:00 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: parser.c, parser/forms.c, parser/forms.h:

	Do not export struct form, introduce and use done_form() instead,
	use enum form_method as type for struct form method field.  

Thu Apr 29 13:15:31 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	get_html_form():  char *ax -> unsigned char *enctype, tidy up.  

Thu Apr 29 13:09:38 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/forms.c:

	do_html_select(): @val -> @values, tidy up.  

Thu Apr 29 12:40:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	EL_DEFINE() a few variables.  

Thu Apr 29 12:17:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_CHECK_TYPE() -> EL_CHECK_CODE(). Use it for variadic macro
	checking.  

Thu Apr 29 11:50:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_CHECK_SPECIAL_TYPE() -> EL_CHECK_INT_TYPE().  

Thu Apr 29 11:49:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h:

	Whoops forgot to remove HAVE_SA_STORAGE declaration.  

Thu Apr 29 11:48:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Add EL_CHECK_NET_TYPE() for all the sockaddr_* and addrinfo struct
	checking.  

Thu Apr 29 11:41:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	Use EL_CHECK_SYS_TYPE() for regex_t and HAVE_REGEX_H config.  

Thu Apr 29 11:37:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Add EL_CHECK_SYS_TYPE() which #includes <sys/types.h> and tries to
	do sizeof(type).  

Thu Apr 29 11:32:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Use EL_CHECK_TYPE() for typeof() checking.  

Thu Apr 29 11:28:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_CHECK_TYPE(): Takes care of the messaging an type checking.  

Thu Apr 29 11:23:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	EL_DEFINE(): Wraps AC_DEFINE() to shorten lines.  

Thu Apr 29 11:18:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Group macros.  

Thu Apr 29 00:37:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Use EL_* namespace for own macros.  

Wed Apr 28 19:54:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Define macro for testing gpm, zlib and bzlib.  

Wed Apr 28 19:27:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Fix size check of long long.  

Wed Apr 28 19:22:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in:

	Define macro for testing 'exotic' types. It also takes care of
	registering the config variable.  

Wed Apr 28 18:43:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/gettext.c:

	Fix compilation with --disable-nls. Patch by Felix von Leitner.  

Wed Apr 28 18:09:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	We don't use these GUILE_* make variables so why substitute them? 

Wed Apr 28 18:05:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Doh, first search for guile-config in user supplied path.  

Wed Apr 28 18:01:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Improve guile configuration by first checking guile-config (using
	possible supplied path). If guile-config is not found simply emit
	failure notice else emit the incomplete message.  

Wed Apr 28 17:31:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Simplify guile autoconf.  

Wed Apr 28 17:17:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/guile/core.c:

	A little tidyup.  

Wed Apr 28 17:15:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/guile/core.c:

	Make it possible to start elinks with guile compiled in without
	~/.elinks/internal-hooks.scm available.  

Wed Apr 28 16:34:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	I should have known not to trust autoconf. Setup prefix and
	exec_prefix before usage. Should make find it's .mo files.  

Wed Apr 28 10:58:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	AC_{SAVE,RESTORE}_FLAGS: Add ending comma.  

Wed Apr 28 08:45:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/Makefile.am:

	Fix archive name.  

Tue Apr 27 23:12:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	AC_{SAVE,RESTORE}_FLAGS introduced.  

Tue Apr 27 22:30:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	Cleanup LOCALEDIR and LIBDIR exporting. This is the way other
	packages do and I think we should trust autoconf or who ever to set
	up the variables for us. Oh yes and remove debug echo.  

Tue Apr 27 17:46:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/Makefile.am:

	More fine tuning. Only dist clean charset.alias. Use
	install-data-local for installing it.  

Tue Apr 27 17:06:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, src/intl/gettext/Makefile.am:

	Define and export LIBDIR via config.h to get rid of special build
	rules for gettext.  

Tue Apr 27 16:28:25 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Fix corrupted display on terminals that to not have
	"eat_newline_glitch (xn)", ie. cons25 family of terminals, and
	cygwin terminal.  

Tue Apr 27 16:23:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/.cvsignore:

	Ignore Makefile.in 

Tue Apr 27 16:23:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/Makefile.am:

	Remove generated charset.alias when cleaning. Remove autogenerated
	files from EXTRA_DIST.  

Tue Apr 27 16:05:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in, src/intl/gettext/Makefile.am,
	src/intl/gettext/Makefile.in, src/intl/gettext/ref-add.sed.in,
	src/intl/gettext/ref-add.sin, src/intl/gettext/ref-del.sed.in,
	src/intl/gettext/ref-del.sin:

	Try to use Makefile.am for building int/gettext .. will be
	interesting if it works ;P 

Tue Apr 27 14:11:58 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Minor optimization: only call strstr() if needed.  

Tue Apr 27 13:48:08 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Use an enum for @type, minor tidyup.  

Tue Apr 27 13:29:59 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/smb/smb.c:

	Code simplification and optimization: find_strs() function was
	introduced to match sequence of strings.  

Mon Apr 26 16:46:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Fix bug 431 and make underlining work properly when splitting lines
	(in table cells).  

Mon Apr 26 15:56:11 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Apr 26 15:48:28 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/download.c, util/file.c, util/file.h:

	Pop up an error message if attempting to save a file which is a fact
	a directory. file_is_dir() function was added to util/file.{c,h}, it
	tests if its argument is a readable directory.  

Mon Apr 26 13:30:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Untangle mem_free_set() casting pointer code.  

Mon Apr 26 13:18:53 2004  Laurent Monin <zas@norz.org>:

	* src/intl/gettext/: loadmsgcat.c, localealias.c:

	Workaround compilation failure under cygwin and debian stable, when
	using --with-perl: alloca() is not detected at configure time but
	still included from some perl headers files.  

Mon Apr 26 12:51:29 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/hooks.c:

	Perl-specific code was moved to appropriate local functions, @err
	was renamed to non-misleading @count, dSP and PUSHMARK are needed
	even if no parameter is passed (hook_quit case, conform to perlcall
	doc), tidyup.  

Mon Apr 26 11:38:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	query_file(): Check only the URI passed and not ses->download_uri.
	Maybe the checking should be moved back to start_download() but it
	shouldn't hurt the other users. Besides I like the fact that we not
	check URI _before_ users have provided a filename so they don't
	waste their time. FIXME added. Somebody please act as to what is
	best because I don't know. ;) 

Mon Apr 26 09:05:46 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	An assertion was added: for now, this one is triggered when saving a
	preformatted document. This was reported by Stephen Stocker. Jonas
	please have a look at this one.  

Mon Apr 26 08:49:10 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser/parse.c:

	Fix wrapping of lines due to a change introduced in
	document/html/parser.c 1.385 -> 1.386: we want to match only space
	char. It restores correct rendering of freshmeat.net index page.  

Mon Apr 26 03:37:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/leds.c:

	Fix and improve led option handling.  

Sun Apr 25 17:32:44 2004  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/backend/xbel.c, document/document.c,
	document/html/parser.c, document/html/parser/forms.c,
	document/html/parser/link.c, document/html/parser/parse.c,
	sched/action.c, sched/connection.c, sched/download.c,
	sched/history.c, sched/task.c, viewer/text/search.c:

	Miscelleanous trivial tidyups: indentation, whitespaces fixes,
	hacking document conformance.  

Sun Apr 25 16:28:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cookies/dialogs.c:

	Microscopic tidyup.  

Sun Apr 25 09:52:34 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Apr 25 09:49:44 2004  Laurent Monin <zas@norz.org>:

	* src/sched/error.c:

	Typo fix: external -> external programs.  

Sun Apr 25 05:58:17 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/scripting/perl/hooks.c:

	Maybe we should C++. Use dSP only when Perl is initialized.  

Sat Apr 24 23:48:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	parse_html(): Commit unput data to the document upon reaching @eof
	only if we really want to commit them (therefore cycle with
	@noupdate set). This fixes random tags shown inside of <table>s and
	possibly other weirdness. Introduced by me, pinpointed by Jonas,
	fixed it together :).  

Sat Apr 24 22:22:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/hooks.c:

	Reverted witekfl's 1.5 (movind dSP). This breaks compilation
	(declaration not at the start of block).  

Sat Apr 24 16:15:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	First check content-type of Content-Disposition filename. Problem is
	we still fall back to also checking the content type of the filename
	in the URI and thus the what-to-do dialog will still report wrong
	content type.  

Sat Apr 24 16:13:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/mime.c:

	Move extension content type checking to separate function.  

Sat Apr 24 16:03:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, mime/mime.h, protocol/uri.c:

	Move Content-Disposition extraction to separate function in mime/.  

Sat Apr 24 15:39:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, sched/download.c:

	Fix problems regarding servers sending empty Content-Type values
	which means the extension is never checked.  

Sat Apr 24 15:31:00 2004  Laurent Monin <zas@norz.org>:

	* src/intl/gettext/l10nflist.c:

	Awful hack to make cygwin happy, it has no impact on other
	environments.  

Sat Apr 24 14:51:41 2004  Laurent Monin <zas@norz.org>:

	* configure.in:

	AC_PREREQ(2.13) was added, it prevents issues on systems having both
	autoconf2.13 and 2.5x or more (debian, cygwin).  

Sat Apr 24 14:44:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	process_element() and family now returns new value of html, because
	it can shift it forth.  

Sat Apr 24 14:39:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: Makefile.am, html/internal.h, html/parser.c,
	html/parser/Makefile.am, html/parser/forms.c, html/parser/forms.h,
	html/parser/parse.c:

	Factored out forms parser from document/html/parser.c to
	document/html/parser/forms.*.  

Sat Apr 24 14:36:13 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/scripting/perl/hooks.c:

	Moved "dSP;". Now dSP is called only when Perl interpreter is
	properly initialized. The crash should disappear.  

Sat Apr 24 12:21:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, sched/connection.h, sched/download.c,
	sched/error.c:

	Fix bug 440 by checking for external hanlders in query_file()
	through where all downloads are routed. S_EXTERNAL_PROTOCOL
	introduced for the error message mapping.  

Sat Apr 24 11:50:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Update documentation of addBookmark().  

Sat Apr 24 11:46:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Documented the rest of struct element_info.  

Sat Apr 24 11:41:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, sched/session.c, sched/session.h:

	Rename -remote bookmark() method to addBookmark(). enum also updated
	to reflect this change.  

Sat Apr 24 11:39:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	end_element(): Minor XMP handling simplification.  

Sat Apr 24 11:31:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	start_element(): @ali -> @restore_format, @pa -> @old_format 

Sat Apr 24 11:29:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Reindented start_element().  

Sat Apr 24 11:27:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Separated start_element() and end_element() from process_element().  

Sat Apr 24 10:59:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, mime/mime.h, sched/download.c:

	Pass the cache entry to get_content_type().  

Sat Apr 24 10:35:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	process_element(): Make links work again by breaking like the old
	code did instead of returning so we end up at the killing spree
	below.  

Sat Apr 24 02:52:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser/parse.c:

	Compile fix for the currently fubar'd html parser ;) 

Sat Apr 24 02:13:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Shorten examples in the -remote description.  

Sat Apr 24 02:11:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, sched/session.c, sched/session.h:

	Add support for -remote 'bookmark(URL)'. Let the bloating begin.
	Dunno if xfeDoCommand(bookmark, URL) would be a better way? 

Sat Apr 24 01:43:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Fix leak when passing unknown openurl() parameter.  

Sat Apr 24 01:39:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Unify openurl() remote_url allocation.  

Sat Apr 24 01:35:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Use strstr() to scan openURL() args.  

Sat Apr 24 01:31:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Tidyup.  

Sat Apr 24 01:30:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Use strcspn() to simplify.  

Sat Apr 24 01:25:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	@inv -> @endingtag in parse_html() and process_element().  

Sat Apr 24 01:23:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	In parse_html() merged set_lt to the main loop.  

Sat Apr 24 01:20:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Comments in process_element() reformatted.  

Sat Apr 24 01:19:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Moved element processing off parse_html() to process_element().  

Sat Apr 24 01:13:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Cleanup.  

Sat Apr 24 01:10:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): If no remote session flags was applied it can only
	mean the method is not supported. This nicely centralizes error
	returning.  

Sat Apr 24 01:07:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	parse_html(): @lt -> @base_pos 

Sat Apr 24 01:07:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Add missing break.  

Sat Apr 24 01:05:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	More tidyup of parse_html().  

Sat Apr 24 01:05:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	I'm a sucker for this data driven thing so make -remote method
	parsing data driven and use switch.  

Sat Apr 24 01:00:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Removed some ancient commented out relicts.  

Sat Apr 24 00:57:23 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: Makefile.am, html/internal.h, html/parser.c,
	html/parser/Makefile.am, html/parser/link.c, html/parser/link.h,
	html/parser/parse.c:

	Moved link-related functions from document/html/parser.c to
	document/html/parser/link.*.  

Sat Apr 24 00:51:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Emit 'Remote method not supported' instead of 'Command
	not supported'. Should hopefully be less confusing.  

Sat Apr 24 00:38:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/parse.c:

	Restored get_num() which got... lost in an accident.  

Sat Apr 24 00:36:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Removed idiotic static inline from html_*().  

Sat Apr 24 00:33:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/: parse.c, parse.h:

	Separated core parser stuff from document/html/parser.* to
	document/html/parser/parse.*.  

Sat Apr 24 00:32:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/core.c:

	Use PERL_EXIT_DESTRUCT_END only if it's defined, I don't have it in
	my pet perl-5.6.1.  

Sat Apr 24 00:31:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, sched/session.c:

	Fix -remote 'openurl()' so it again prompt for URL in current tab.  

Sat Apr 24 00:28:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Oops it is @comma that should be strimmed from ending
	space.  

Sat Apr 24 00:25:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/core.c:

	Fix include modules/module.h.  

Sat Apr 24 00:25:24 2004  Petr Baudis <pasky@ucw.cz>:

	* Makefile.base:

	Remove CPPFLAGS usage. That shouldn't hurt anything and it's all
	mostly redundant anyway.  

Sat Apr 24 00:24:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Improve -remote long-help description. Fix incorrect description of
	openurl(). Take 4.  

Sat Apr 24 00:23:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	skipback_whitespace(): Don't go off by one.  

Sat Apr 24 00:20:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	remote_cmd(): Cleanup looping. Introduce skipback_whitespace().  

Sat Apr 24 00:20:09 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in, src/document/html/Makefile.am:

	Connect document/html/parser/ to the build infrastructure.  

Sat Apr 24 00:18:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: Makefile.am, document.c, css/apply.c,
	html/internal.h, html/parser.c, html/parser.h, html/renderer.c,
	html/tables.c, html/parser/Makefile.am:

	Separated core parser stuff from document/html/parser.* to
	document/html/parser/parse.*.  

Sat Apr 24 00:18:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Added missing util/conv.h.  

Sat Apr 24 00:03:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/internal.h:

	parser/stack.c needs ln_break().  

Fri Apr 23 23:56:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, util/error.c:

	usrerror() now prefixes error messages with 'elinks: '. Change
	-remote 'ping()' to be more mozilla compliant and in the spirit of
	Unix and only emit error message when ping failed.  

Fri Apr 23 23:30:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Emit error message when -remote failed to connect.  

Fri Apr 23 23:23:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Trim down includes.  

Fri Apr 23 23:23:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/internal.h:

	Declare @ff and @line_break_f as extern.  

Fri Apr 23 23:22:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/internal.h:

	@ff and @line_break_f are needed by parser/stack.c.  

Fri Apr 23 23:18:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Cleanup the gotos a little.  

Fri Apr 23 23:16:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	kill_html_stack_until(): Reindentation.  

Fri Apr 23 23:14:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Tidyup.  

Fri Apr 23 23:12:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: parser.c, parser/stack.c, parser/stack.h:

	Removed debug_stack(), dump_html_stack() is now the official HTML
	stack debugging dumper.  

Fri Apr 23 23:10:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.c:

	Enhanced dump_html_stack().  

Fri Apr 23 23:08:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/stack.h:

	Removed redundant struct html_element declaration.  

Fri Apr 23 23:08:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/: stack.c, stack.h:

	search_html_stack() prototype: (char *) -> (unsigned char *) 

Fri Apr 23 23:06:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: parser.c, parser/stack.c, parser/stack.h:

	kill_until() -> kill_html_stack_until() 

Fri Apr 23 23:05:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Improve -remote long-help description. Take 3. Please stop me ;) 

Fri Apr 23 23:05:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: Makefile.am, html/parser.c,
	html/parser/Makefile.am, html/parser/stack.c, html/parser/stack.h:

	Moved HTML stack related functions from document/html/parser.c to
	document/html/parser/stack.*.  

Fri Apr 23 23:04:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser/: .cvsignore, .vimrc:

	Fairies.  

Fri Apr 23 22:58:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Improve -remote long-help description. Take 2 

Fri Apr 23 22:54:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Improve -remote long-help description.  

Fri Apr 23 22:48:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Small parse_html() tidyup.  

Fri Apr 23 22:43:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Attempt to at least roughly document element_info.nopair.  

Fri Apr 23 22:30:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Moved process_head() and skip_comment() above the elements list.  

Fri Apr 23 22:28:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Few strategically placed blank lines.  

Fri Apr 23 22:24:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	elinks -version now prints out the full version string - including
	build date and features list.  

Fri Apr 23 22:21:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/modules/version.c:

	In case @more isn't set but we're debugging still show (built on),
	but on the same line as ELinks VERSION_STRING.  

Fri Apr 23 22:05:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/cmdline.c, sched/session.h:

	Remove -ping and only provide -remote 'ping()'.  

Fri Apr 23 22:04:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Check element type by relational operators now, so that ELEMENT_WEAK
	is considered as ELEMENT_KILLABLE in various considerations. This
	should fix the <head><title>moo</head>.  

Fri Apr 23 22:01:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: parser.c, parser.h:

	_The_ definitive fix for any and all <title> problems which could
	ever occur. Removed the weak'n'hackish <title /> workaround, instead
	ELEMENT_WEAK element type was introduced with the special property
	that any attempt to put new element inside will terminate the
	element (<title>foo<body> will do the right thing), even for
	invisible elements where we do not normally permit other elements to
	nest. <head> also owns own dummy stack level so that
	<head><title>foo</head> does the right thing as well. You can't get
	any better than *that* ;).  

Fri Apr 23 20:44:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: elinks.h, bfu/button.c, bfu/dialog.c, bfu/dialog.h,
	bfu/group.c, bfu/inpfield.c, bfu/inphist.c, bfu/listbox.c,
	bfu/listmenu.c, bfu/menu.c, bfu/text.c, bfu/widget.c,
	bookmarks/backend/default.c, config/kbdbind.c, config/opttypes.c,
	dialogs/download.c, dialogs/menu.c, dialogs/options.c,
	dialogs/status.c, document/refresh.c, document/css/scanner.c,
	document/css/value.c, document/html/frames.c,
	document/html/parser.c, document/html/renderer.c,
	document/html/tables.c, document/plain/renderer.c,
	osdep/getifaddrs.c, protocol/auth/auth.c, protocol/http/http.c,
	sched/event.c, sched/session.c, terminal/draw.c, terminal/screen.h,
	util/math.h, util/scanner.c, util/snprintf.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c, viewer/text/vs.c:

	#include util/math.h back in elinks.h. Its whole *point* was to be
	around and available everytime. Besides, it includes a system
	header.  

Fri Apr 23 20:39:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/math.h:

	Blank lines.  

Fri Apr 23 20:30:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/error.c:

	Fixed usrerror() mindtwist, I forgot to derive @params first :).
	Noticed by Jonas.  

Fri Apr 23 19:42:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.c:

	Trivial decode_session_info() tidyup.  

Fri Apr 23 19:38:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/main.c:

	Exclaim appropriate messages when create_session_info() or
	attach_terminal() failed.  

Fri Apr 23 19:37:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/main.c:

	Report -ping outcome to stderr.  

Fri Apr 23 19:32:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Try to honour the 80 chars boundary where it makes sense.  

Fri Apr 23 19:30:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	_parse_options() -> parse_options_() 

Fri Apr 23 19:30:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Cleaned up _parse_options() - reduced level of indentation and
	moving error handling.  

Fri Apr 23 19:26:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: main.c, bookmarks/backend/xbel.c, config/cmdline.c,
	intl/gettext/libintl.h, lowlevel/home.c, lowlevel/interlink.c,
	lowlevel/select.c, mime/backend/mailcap.c, terminal/kbd.c,
	viewer/dump/dump.c:

	Introduced convenience G_() -> gettext() alias for use in
	multi-level printing statements when we don't have a terminal
	around.  

Fri Apr 23 19:20:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bookmarks/backend/xbel.c, config/cmdline.c,
	lowlevel/home.c, mime/backend/mailcap.c, scripting/lua/core.c,
	terminal/event.c, util/error.c, util/error.h, viewer/dump/dump.c:

	Introduced usrerror() which acts for ERROR() in the cases where user
	can trigger the error. It doesn't sleep, it doesn't beep and it
	doesn't contain information about where in the source the error
	occured, which could be quite confusing for the user (and she
	doesn't care anyway).  

Fri Apr 23 18:57:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_filename_to_string(): Use get_filename_position(). I rule!
	;P 

Fri Apr 23 18:44:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: util/file.c, util/file.h, viewer/text/form.c:

	Move strip_file_name() and rename to get_filename_position(). ;) 

Fri Apr 23 18:40:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	strip_file_name(): Cleanup.  

Fri Apr 23 18:23:46 2004  Laurent Monin <zas@norz.org>:

	* src/intl/gettext/: bindtextdom.c, dcgettext.c, dcigettext.c,
	dcngettext.c, dgettext.c, dngettext.c, explodename.c, finddomain.c,
	gettext.c, intl-compat.c, l10nflist.c, loadmsgcat.c,
	localcharset.c, localealias.c, ngettext.c, textdomain.c:

	Fix wrong inclusion of header. We want "config.h" not <config.h>.  

Fri Apr 23 18:04:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_filename_to_string(): Use parse_http_header_param().  

Fri Apr 23 16:42:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Improve Content-Disposition handling by trimming any following
	fields.  

Fri Apr 23 16:29:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_filename_to_string(): Use strstr() to find 'filename='
	substring.  

Fri Apr 23 15:52:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/core.c:

	Generic tidyup and some more includes.  

Fri Apr 23 15:51:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/scripting/perl/core.h:

	Remove some strange irrelevant includes.  

Fri Apr 23 15:45:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memdebug.c:

	Ensure the main pointer is aligned (otherwise we go nuts on some
	archs) and put the XFLOW underflow mark to the alloc_header aligned
	reserved space.  

Fri Apr 23 15:28:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libgnuintl.h:

	Compile fix.  

Fri Apr 23 15:11:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libgnuintl.h:

	#define _LIBINTL_H to avoid including system <libintl.h>. Last patch
	will hopefully still fix issue with including <locale.h> in main.c 

Fri Apr 23 15:08:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libgnuintl.h:

	Standardize header file include guard.  

Fri Apr 23 15:02:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/libgnuintl.h:

	Since libgnuintl.h is not included directly simplify LC_MESSAGE
	#define.  

Fri Apr 23 14:25:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/getifaddrs.c:

	More SunOS compile fixes. #include <sys/socket.h> and <sys/types.h>
	before <net/if.h>.  

Fri Apr 23 14:20:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.h:

	I''n psaky./ O"m fxiing ytops.  

Fri Apr 23 14:19:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.h:

	Me pasky. I be fixed error grammars.  

Fri Apr 23 14:11:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/intl/gettext/: bindtextdom.c, dcgettext.c, dcigettext.c,
	dcngettext.c, dgettext.c, finddomain.c, gettext.c, intl-compat.c,
	ngettext.c, textdomain.c:

	Always include own libintl.h instead of own libgnuintl.h. Fixes
	building on sparc when the include magic will make system
	<libintl.h> include our own libintl.h instead.  

Fri Apr 23 13:55:15 2004  Laurent Monin <zas@norz.org>:

	* src/ssl/connect.c:

	Cast @sock to (gnutls_transport_ptr) type, as indicated in recent
	gnutls documentation.  

Fri Apr 23 13:48:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/file.c:

	Trivial file_exists() tidyup.  

Fri Apr 23 13:47:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: scripting/lua/core.c, util/file.c, util/file.h:

	Introduced file_can_read() similiar in spirit to file_exists(). Use
	that instead of the hyperweird Lua5 Debianish bugfix using fopen()
	(while assimiliating that for fallback unless HAVE_ACCESS).  

Fri Apr 23 13:21:10 2004  Laurent Monin <zas@norz.org>:

	* src/: sched/session.c, protocol/uri.c:

	Use int type instead of size_t, preventing warnings on some
	platforms.  

Fri Apr 23 12:29:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: Makefile.am, vernum.c, vernum.h, modules/version.c:

	Introduce vernum.* which contains currently build date/time
	information. It is rebuilt everytime to ensure we have the latest
	data for this. In the future I'd like to invent some CVS trigger
	which also keeps the latest commit date/time there (which is
	somewhat more useful and accurate than just build time info).  

Fri Apr 23 12:27:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/modules/version.c:

	Simplify the condition for inclusion of the build date/time and make
	explicit that it is date/time of the build.  

Fri Apr 23 11:44:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/file.h:

	Restored a removed newline. Evil zas! 

Fri Apr 23 11:39:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	SOME PEOPLE here should be taught the alphabet properly (moved
	-no-numbering, -config-help, -localhost to their proper place).  
	CCMAIL: pasky@ucw.cz CCMAIL: zas@norz.org 

Fri Apr 23 11:36:47 2004  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	Further weeding out and slight tuning of the items, plus reordering.  

Fri Apr 23 11:31:09 2004  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	Adjust some items and weed out some (IMHO) too unimportant ones.  

Fri Apr 23 11:23:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/action.c:

	Unrolled ACT_MAIN_TAB_MOVE* handling.  

Fri Apr 23 11:22:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/action.c:

	Reverted Jonas' 1.56 (Group similar action handler calling using a
	magic variable.). We agreed that it's not so clever as it might
	seem...  

Fri Apr 23 10:28:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.c, download.c, session.c, task.c:

	More is_in_progress_state() usage.  

Fri Apr 23 08:41:56 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Apr 22 23:56:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	doc_end_load(): Yay digging into the cvsweb archive showed that a
	little too clever cleanup broke -auto-submit handling. Readd the
	first form grabbing and improve error handling if get_form_url()
	fails.  

Thu Apr 22 23:50:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Pointing out brokeness of -auto-submit handling.  

Thu Apr 22 22:51:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_filename_to_string(): Strip extracted filename of any
	directories so only the clean filename is added. Fallback to old
	filename resolving if whole extracted filename is stripped.  

Thu Apr 22 22:37:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_filename_to_string(): It is only used by query_file() and
	do_type_query() dialog functions for local saving so add naive
	support for Content-Disposition by checking the associated
	cache_entry's header. I hope add_shell_safe* will make up for any
	security issues.  

Thu Apr 22 22:09:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	More is_in_progress_state() usage.  

Thu Apr 22 21:32:45 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Compile fix: done_pre_format_html_hook -> preformatted. Jonas forgot
	this one... ;) 

Thu Apr 22 21:14:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Fix last patch. Don't initialize cache_entry->preformatted to one.
	;) 

Thu Apr 22 21:12:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, sched/session.c:

	cache_entry->done_pre_format_html_hook -> cache_entry->preformatted.
	Now always a member since it is boolean and should be padded nicely
	with the other of it's kind.  

Thu Apr 22 21:04:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.h:

	Try to describe struct cache_entry.  

Thu Apr 22 21:02:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Tidyup.  

Thu Apr 22 19:53:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Document the possible 'System' value of various codepage/charset
	options.  

Thu Apr 22 19:50:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/charsets.c:

	get_cp_index(): @n -> @name 

Thu Apr 22 19:50:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/charsets.c:

	Fixed get_cp_index() so that it falls back to us-ascii when you
	abuse it by using System charset while locale has some exotic
	charset unknown to ELinks set.  

Thu Apr 22 19:46:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/intl/charsets.c:

	Unroll the fastfind get_cp_index()'s return statement.  

Thu Apr 22 19:40:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Sanitized a (boolean < 1) relict.  

Thu Apr 22 19:38:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Tidyup.  

Thu Apr 22 19:36:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/http/http.c:

	Reverted zas' 1.239 (Fix: copy http_version structure contents not
	structure pointer.). I'm probably stupid but I can't see any
	pointers there and the old code is fine.  CCMAIL: zas@norz.org 

Thu Apr 22 18:50:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/dump/dump.c:

	More tidy. XXX comment also added.  

Thu Apr 22 18:45:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Revert patch by Christian Haggstrom and add proper detection of
	these internal directory redirects.  

Thu Apr 22 18:14:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/dump/dump.c:

	Tidyup.  

Thu Apr 22 18:09:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/leds.c, config/options.inc:

	Move the ui.clock options to the leds module.  

Thu Apr 22 18:07:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.h:

	Describe struct menu_item.  

Thu Apr 22 18:05:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/leds.c:

	Precompute a base X position for the clock.  

Thu Apr 22 18:04:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Changed ui.clock.format default value to also contain the angle
	brackets like all other statusbar items.  

Thu Apr 22 18:02:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/leds.c, config/options.inc:

	Options subtree rename: ui.timer.clock -> ui.clock. This has nothing
	to do with the timer at all.  

Thu Apr 22 17:48:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	display_status_bar(): Add FIXME regarding progress bar being drawn
	on top of the digital clock.  

Thu Apr 22 17:47:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/leds.c:

	@l -> @timerlen 

Thu Apr 22 17:46:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/leds.c:

	Include <time.h> only when it's available and also try <sys/time.h>.
	Should enhance portability. Somehow.  CCMAIL:
	witekfl@poczta.gazeta.pl 

Thu Apr 22 16:13:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.c, sched/session.c,
	sched/session.h:

	ses->tq => ses->type_queries.  

Thu Apr 22 16:10:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.c, sched/download.h,
	sched/session.c:

	tq -> type_query, type_query() -> do_type_query().  

Thu Apr 22 16:08:11 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	scan_http_equiv(): free memory as soon it is no more needed.  

Thu Apr 22 16:06:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_element(): drop useless ().  

Thu Apr 22 16:05:25 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	element_has_implicit_end(): minor optimization.  

Thu Apr 22 16:00:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.h, sched/session.h:

	Move struct tq to more central header.  

Thu Apr 22 15:44:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Fix <title /> handling so pasky can enjoy
	http://cia.navi.cx/historical/first-24-hours.html 

Thu Apr 22 15:03:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	done_tq(): Fix tq->download teardown by calling change_connection().  

Thu Apr 22 12:51:30 2004  Laurent Monin <zas@norz.org>:

	* src/dialogs/document.c:

	Make headers info dialog scrollable.  

Thu Apr 22 12:39:46 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	Assert absence of POST_CHAR before appending post data, may be
	useless.  

Thu Apr 22 12:38:10 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	Bug fix proposed by Christian Haggstrom for issue related to POST +
	Location: / was applied.  

Wed Apr 21 22:43:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	destroy_session(): Use done_tq() when freeing ses->tq list.  

Wed Apr 21 22:39:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, download.h:

	tp_free() -> done_tq() to complete init/done interface. Maybe we
	should s/tq/type_query/.  

Wed Apr 21 22:35:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Move tq initialization to init_tq(). Removes goto and reduces the
	ses_chktype() confusion.  

Wed Apr 21 22:19:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, download.h:

	Make subst_file() static.  

Wed Apr 21 22:15:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	|V|4|{3 6070_U|21_}{0/\/\3 57471(.  

Wed Apr 21 13:27:15 2004  Petr Baudis <pasky@ucw.cz>:

	* Makefile.am:

	Remove configure-do relict from EXTRA_DIST. It looks like this was
	breaking -current tarballs build for some three months... :( 

Wed Apr 21 09:21:31 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/core.c:

	Minor cleanup.  

Wed Apr 21 09:07:41 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/core.c:

	Let preprocessor do the job: snprintf() is useless to concatenate
	constant strings.  

Wed Apr 21 08:59:29 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/core.c:

	Fix usage of PERL_SYS_INIT3() and PERL_SYS_TERM() macros, prevent
	unused variables warnings, cleanup + comments.  

Wed Apr 21 01:10:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_mouse_handler(): Specialize loop to only care if the item
	has left text.  

Wed Apr 21 00:42:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_mouse_handler(): fubar'ed patch that rewrites the menu item
	loop moving testing of whether mouse button was pressed so we should
	scroll out of the loop. Comments should hopefully make it more
	clear.  

Wed Apr 21 00:21:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_mouse_handler(): Use foreach_menu_item.  

Wed Apr 21 00:00:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_mouse_handler(): Decrease indentation.  

Tue Apr 20 23:54:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	Use minor hacked scroll_menu() for mainmenus.  

Tue Apr 20 23:32:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	Menu drawing cleanups.  

Tue Apr 20 23:23:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	draw_menu_left_text(): Use draw_text().  

Tue Apr 20 17:02:49 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	Use int_max() for overlap() macro.  

Tue Apr 20 15:53:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	That hack was a bad idea. It forces too much rerendering ;).  

Tue Apr 20 15:31:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	doc_end_load(): Use ugly hack to force rerendering of document when
	a requested stylesheet has been loaded.  

Tue Apr 20 15:03:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Make 3 functions static.  

Tue Apr 20 13:48:12 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hotkey.c:

	Fix compilation due to field name changes made by Jonas in menu
	stuff. Reported by Stephen Stocker.  

Tue Apr 20 07:45:48 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	do_lookup(): remove two goto and a label -> code simplification.  

Tue Apr 20 07:35:32 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	end_dns_lookup(): @q -> @query, already used in other related
	functions.  

Mon Apr 19 15:56:44 2004  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/dialogs.c, cache/cache.c, config/options.c,
	cookies/dialogs.c, dialogs/status.c, document/html/parser.c,
	document/html/renderer.c, document/html/tables.c,
	globhist/dialogs.c, globhist/globhist.c, lowlevel/connect.c,
	lowlevel/dns.c, protocol/uri.c, protocol/auth/auth.c,
	protocol/file/file.c, protocol/http/codes.c, protocol/http/http.c,
	sched/connection.c, sched/download.c, sched/event.c,
	sched/history.c, sched/task.c, terminal/terminal.c, util/memory.h,
	viewer/text/form.c, viewer/text/link.c, viewer/text/search.c,
	viewer/text/textarea.c, viewer/text/view.c:

	mem_free_set_if(x, v) -> mem_free_set(&x, v) as proposed on irc,
	mem_free_if() do not set pointer to NULL anymore since this is a
	bloat, programmers just have to change  #if 0 to #if 1 in memory.h
	to force pointers nullification (for debugging purposes only).  

Mon Apr 19 14:39:40 2004  Laurent Monin <zas@norz.org>:

	* src/: bookmarks/dialogs.c, config/options.c, cookies/dialogs.c,
	dialogs/status.c, document/html/parser.c, document/html/renderer.c,
	document/html/tables.c, globhist/globhist.c, lowlevel/connect.c,
	protocol/file/file.c, protocol/http/codes.c, protocol/http/http.c,
	sched/task.c, terminal/terminal.c:

	Use mem_free_set_if() where applicable.  

Mon Apr 19 09:41:16 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	Unify read/write loops style, shorten lines by introducing @todo,
	initialize @done just before loops, tidy up.  

Mon Apr 19 08:58:15 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	end_dns_lookup(): assert dnsentry before it is used, use mem_alloc()
	instead of mem_calloc() where zeroing is useless, cleanup.  

Mon Apr 19 08:50:03 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/dns.c:

	find_host(): assert dnsentry before using it, assert
	dnsentry->addrno is positive, remove a goto and a label, and use
	mem_alloc() since zeroing is useless due to memcpy() few lines
	later.  

Sun Apr 18 14:24:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	Compile fix.  

Sun Apr 18 14:01:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Fix possible bug I encountered yesterday by caching
	old stack_size.  

Sun Apr 18 13:52:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Move menu item adding at the stack bottom case up
	front.  

Sun Apr 18 07:13:34 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation update.  

Sun Apr 18 01:35:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	menu_kbd_handler(): Cleanup home/end handling.  

Sun Apr 18 01:30:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	menu_kbd_handler(): Cleanup.  

Sun Apr 18 01:27:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	do_menu_selected(): Use mem_calloc().  

Sun Apr 18 01:24:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: menu.c, menu.h:

	Unify the menu->view and menu->first_displayed members to
	menu->first and rename menu->last_displayed to menu->last. Hope it
	is not too short.  

Sun Apr 18 01:18:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.h:

	Describe members of struct menu.  

Sun Apr 18 00:59:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Handle more actions. It might be of use for
	some people and is really not a lot of code.  

Sun Apr 18 00:44:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Cleanup usage of temp. variables. @fwd now
	simply means select_menu() 

Sun Apr 18 00:41:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Move hotkey checking and window deletion
	under the default switch label.  

Sun Apr 18 00:31:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Group more left and right action stuff.  

Sun Apr 18 00:28:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Handle right and left action together.  

Sun Apr 18 00:22:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	mainmenu_kbd_handler(): Use switch statement for action.  

Sun Apr 18 00:10:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: listmenu.c, menu.h:

	Revert the latest listmenu patch introducing usage of FREE_* flags.
	We only need to free the member when freeing the form control which
	I overlooked.  

Sat Apr 17 18:56:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, form.h:

	Remove unused member submitted_value->file_content.  

Sat Apr 17 18:06:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: listmenu.c, menu.h:

	Introduce FREE_RECURSIVE_DATA and make free_menu() check the flags.  

Sat Apr 17 18:01:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Use new_menu() and add_to_menu(). There are
	probably some issues with the fact that allocation failure in
	add_to_menu() will result in leak and add_to_menu() enables hotkeys
	I think.  

Sat Apr 17 17:52:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Decrease indentation by returning if data != -1 and
	stack size is zero.  

Sat Apr 17 17:49:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Group data == -1 code and improve error handling.  

Sat Apr 17 17:04:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/optgroup.html:

	Add test for <optgroup> handling.  

Sat Apr 17 16:26:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.h, dialogs/menu.c, viewer/text/link.c:

	add_separator_to_menu() -> add_menu_separator().  

Sat Apr 17 15:35:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	count_menu_size(): Use foreach_menu_item().  

Sat Apr 17 15:11:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Use @size for updating @item after reallocation of
	top.  

Sat Apr 17 14:54:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	Kill line.  

Sat Apr 17 14:50:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Use foreach_menu_item() to make code look more
	normal.  

Sat Apr 17 14:37:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	do_select_submenu(): Get rid of goto by asigning @sel if
	menu_contains() the item.  

Sat Apr 17 14:35:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	do_select_submenu(): Use int_min() for @def < 0.  

Sat Apr 17 14:29:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	Apparently menu_labels() is the only place this MENU_FULLNAME flag
	is used and it only actually means anything for ordinary items and
	not submenu items.  

Sat Apr 17 14:20:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	menu_labels(): Cleanup base label allocation.  

Sat Apr 17 14:17:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	menu_labels(): Rename m -> item. We should consider what name to use
	for menu_item through out the code.  

Sat Apr 17 14:15:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	More foreach_menu_item usage.  

Sat Apr 17 14:14:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: menu.c, menu.h:

	Introduce foreach_menu_item iterator.  

Sat Apr 17 11:58:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hotkey.c, menu.c, menu.h:

	Ni wtf is ni ;) ahh it is the number of items. Renamed menu->ni to
	menu->size for shortness and descriptive value.  

Sat Apr 17 11:52:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hotkey.c, hotkey.h, menu.c, menu.h:

	Blast menu_head.  

Sat Apr 17 11:47:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	Use select_menu() and remove select_mainmenu().  

Sat Apr 17 11:39:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: menu.c, menu.h:

	Add struct mainmenu member to struct menu. The little extra added
	memory usage is on temporary dialog code. Now we can remove some of
	that stupid code duplication and it will be needed anyway when we
	introduce tabs for dialogs.  

Sat Apr 17 11:36:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memory.h:

	Warn about mem_free_*if() possibly obfuscating their users.  

Sat Apr 17 11:34:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memory.h:

	Always set freed pointer to NULL, as was discussed on #elinks.  

Sat Apr 17 11:28:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	struct main_menu's sp member is only asigned to which much mean it
	is bloat of the evil kind.  

Sat Apr 17 11:19:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	new_menu_item(): Handle name is NULL case up front.  

Sat Apr 17 03:07:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/event.c:

	Doh. realloc_event() off by one error :|.  

Sat Apr 17 02:48:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/listmenu.c:

	Fix mem_free_set_if_leak_debug() bug. We test @name right after so
	it should not be cleared.  

Sat Apr 17 02:39:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.c, bfu/text.c, document/docdata.h,
	document/html/parser.c, document/html/renderer.c,
	document/html/tables.c, sched/event.c, util/memory.h,
	util/string.h, viewer/text/form.c, viewer/text/search.c,
	viewer/text/textarea.c:

	Make the mem_align_alloc() macro apply the sizeof() to the object.  

Sat Apr 17 02:20:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: newwin.c, newwin.h:

	Describe this little piece of code.  

Sat Apr 17 02:09:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, osdep/newwin.c, osdep/newwin.h,
	util/memory.h:

	This is a good example of how abstractions can make code harder to
	work with. Expose _const_ open_in_new so no copy allocation is
	needed. It is just another example of my if-it-works-$(do)-it-anyway
	where $(do) could be try-to or even play-with.  

Sat Apr 17 01:52:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	oinw -> open_in_new.  

Sat Apr 17 01:37:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	Make them open_in_new data static.  

Sat Apr 17 01:35:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	open_new_window(): Inline exec_new_elinks().  

Sat Apr 17 01:30:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: newwin.c, newwin.h, beos/beos.c, os2/os2.c,
	win32/win32.c:

	Centralize all them open in new functions by putting the default
	command in the open_in_new structure.  

Sat Apr 17 01:19:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	Let the code breathe a bit.  

Sat Apr 17 01:13:15 2004  Laurent Monin <zas@norz.org>:

	* src/util/memory.h:

	When LEAK_DEBUG is defined, mem_free_if(p) set p to NULL after
	freeing it. This will cause some issues ;).  

Sat Apr 17 01:10:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, osdep/newwin.c,
	osdep/newwin.h, sched/session.c:

	Don't pass callbacks around but term_env_type for open in new window
	functions.  

Fri Apr 16 23:39:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	do_action() was moved so include obsolete.  

Fri Apr 16 17:41:01 2004  Karsten Schlzel <kuser@gmx.de>:

	* src/protocol/uri.c:

	Fix a bug in normalize_uri triggered if you enter
	"javascript:gourl('../../../');" as new url.  

Fri Apr 16 16:36:59 2004  Laurent Monin <zas@norz.org>:

	* src/: terminal/kbd.c, terminal/screen.c, terminal/tab.c,
	terminal/terminal.c, terminal/window.c, mime/dialogs.c,
	mime/backend/mailcap.c, mime/backend/mimetypes.c,
	scripting/lua/core.c, formhist/formhist.c:

	Populate with mem_free_if() and mem_free_set_if().  

Fri Apr 16 16:33:27 2004  Laurent Monin <zas@norz.org>:

	* src/: cache/cache.c, globhist/dialogs.c, globhist/globhist.c,
	lowlevel/connect.c, lowlevel/dns.c, lowlevel/home.c,
	lowlevel/interlink.c, protocol/proxy.c, protocol/uri.c,
	protocol/user.c, protocol/auth/auth.c, protocol/file/file.c,
	protocol/http/codes.c, protocol/http/http.c, sched/connection.c,
	sched/download.c, sched/event.c, sched/history.c, sched/session.c,
	sched/task.c, ssl/connect.c, util/fastfind.c, util/file.c,
	util/secsave.c, viewer/dump/dump.c, viewer/text/form.c,
	viewer/text/link.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c, viewer/text/vs.c:

	Populate with mem_free_if() and mem_free_set_if().  

Fri Apr 16 16:29:58 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/listmenu.c, bfu/menu.c,
	bfu/style.c, bookmarks/bookmarks.c, bookmarks/dialogs.c,
	bookmarks/backend/xbel.c, config/cmdline.c, config/dialogs.c,
	config/options.c, cookies/cookies.c, cookies/dialogs.c,
	dialogs/info.c, dialogs/status.c, document/document.c,
	document/css/stylesheet.c, document/html/parser.c,
	document/html/renderer.c, document/html/tables.c:

	Populate with mem_free_if() and mem_free_set_if().  

Fri Apr 16 16:27:01 2004  Laurent Monin <zas@norz.org>:

	* src/util/memory.h:

	mem_free_if_set() -> mem_free_set_if(), idea by Pasky.  

Fri Apr 16 16:26:39 2004  Karsten Schlzel <kuser@gmx.de>:

	* src/: document/html/parser.c, viewer/text/search.c:

	Compile fix.  

Fri Apr 16 16:16:43 2004  Laurent Monin <zas@norz.org>:

	* src/util/memory.h:

	mem_free_if(pointer) and mem_free_if_set(pointer, newpointer) were
	introduced.  

Fri Apr 16 11:10:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Minor simplification: use memacpy() instead of mem_alloc() +
	sprintf().  

Fri Apr 16 10:16:53 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	A minor compilation warning was fixed, using explicit type casting.  

Fri Apr 16 10:09:43 2004  Laurent Monin <zas@norz.org>:

	* src/: cache/cache.c, sched/session.c, sched/task.c:

	Trailing whitespaces were removed.  

Fri Apr 16 10:02:06 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/button.c, bfu/dialog.c, bfu/group.c, bfu/inpfield.c,
	bfu/inphist.c, bfu/listbox.c, bfu/text.c, bfu/widget.c,
	bookmarks/backend/default.c, config/kbdbind.c, config/opttypes.c,
	dialogs/download.c, dialogs/menu.c, dialogs/options.c,
	dialogs/status.c, osdep/getifaddrs.c, protocol/http/http.c,
	sched/session.c, util/scanner.c, util/snprintf.c,
	viewer/text/form.c, viewer/text/search.c, viewer/text/textarea.c,
	viewer/text/view.c:

	Include util/math.h where it is needed (last bits).  

Fri Apr 16 09:44:12 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/dialog.h, bfu/menu.c, document/refresh.c,
	document/css/scanner.c, document/css/value.c,
	document/html/frames.c, document/html/parser.c,
	document/html/renderer.c, document/html/tables.c,
	document/plain/renderer.c, protocol/auth/auth.c, sched/event.c,
	terminal/draw.c, terminal/screen.h, viewer/text/link.c,
	viewer/text/vs.c:

	Include util/math.h where it is needed.  

Fri Apr 16 09:42:13 2004  Laurent Monin <zas@norz.org>:

	* src/: elinks.h, util/Makefile.am, util/math.h:

	int_bounds() family was moved to new util/math.h.  

Fri Apr 16 09:23:40 2004  Laurent Monin <zas@norz.org>:

	* src/scripting/perl/: core.c, hooks.c:

	Perl scripting module compilation issues were fixed.  

Fri Apr 16 09:20:52 2004  Laurent Monin <zas@norz.org>:

	* src/: elinks.h, osdep/generic.h:

	Include system headers before redefining macros, it fixes some
	compilation failures on some systems.  

Thu Apr 15 17:30:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Fix assertion failure.  

Thu Apr 15 16:57:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Make everybody use open_url_in_new_window() as backend.  

Thu Apr 15 16:44:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, viewer/text/link.c:

	Hmm try to centralize newwin.h usage a bit more.  

Thu Apr 15 16:32:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, viewer/text/link.c,
	viewer/text/view.c, viewer/text/view.h:

	Move all the nice open in new window code.  

Thu Apr 15 16:16:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, viewer/text/view.c, viewer/text/view.h:

	Fully support the -remote 'openurl(..., new-win)' thing.  

Thu Apr 15 16:13:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	Damn zas was right. I did break something :(.  

Thu Apr 15 15:35:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	foreach_oinw(): Everything to save a line of code. ;) .. fix bug
	from last patch.  

Thu Apr 15 15:28:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/: newwin.c, newwin.h:

	Gross memory waste by adding term_env_type to open_in_new struct.
	But it simplifies a lot.  

Thu Apr 15 15:25:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/newwin.c, osdep/newwin.h, viewer/text/view.c:

	get_open_in_new(): Take term arg and do one allocation by getting
	size from can_open_in_new().  

Thu Apr 15 14:58:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/newwin.c:

	can_open_in_new(): No need to allocate when a simple loop will do.  

Thu Apr 15 14:31:25 2004  Laurent Monin <zas@norz.org>:

	* src/util/fastfind.c:

	Make debugging code more obviously separated from true code, got rid
	of awful and misleading accif() macro, all debuggung macros are now
	prefixed with FF_DBG_. It improves readibility of non-debugging
	code.  

Thu Apr 15 14:27:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/backend/default.c, osdep/osdep.c, protocol/user.c:

	get_system_str(): Return static string and shrink using code.  

Thu Apr 15 14:21:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/user.c:

	get_user_program(): Use temp instead of wrapping funny code.  

Thu Apr 15 09:29:40 2004  Laurent Monin <zas@norz.org>:

	* NEWS:

	New options -remote and -ping were added.  

Thu Apr 15 09:18:57 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Apr 15 08:32:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.h:

	Whoops bug in binary flag.  

Thu Apr 15 08:28:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/cmdline.c, sched/session.c, sched/session.h:

	-remote-session was replaced by lazy mozilla compliant -remote
	handling. elinks -remote <urls> will just open <urls> in new
	backgrounded tabs and elinks -remote openURL(<url>, ...) will make
	it possible to do more finegrained control. Open in new window is
	still not supported.  

Thu Apr 15 02:39:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Move session info comments.  

Thu Apr 15 02:24:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, main.h, config/cmdline.c, sched/session.c,
	sched/session.h:

	Add support for -remote-session that will connect to an already
	running ELinks (or bail out) and open all the provided URIs. Again
	the intension is to support -remote argument similar to that of
	mozilla and either this can be a backend for that or just be a
	starting point for it.  

Thu Apr 15 00:55:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, main.h, config/cmdline.c, terminal/event.c:

	Implement a -ping command line argument that will hopefully help to
	make -remote handling easier. Else we can remove it later when
	-remote is running.  

Thu Apr 15 00:36:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.c, terminal.c:

	Improve the term->spec reference counting by also locking the
	default one. Else assertion failure can appear if the connecting
	ELinks exists immediately.  

Wed Apr 14 23:35:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: osdep/osdep.c, osdep/osdep.h, terminal/terminal.c,
	terminal/terminal.h:

	Move get_cwd() and set_cwd() to osdep department.  

Wed Apr 14 22:59:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	in_term(): The joy of switch statements. Decrease indentation.  

Wed Apr 14 22:55:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	Ctrl+L should now be a RESIZE event in order to always force
	redrawing.  

Wed Apr 14 22:50:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	term_send_event():Move comment.  

Wed Apr 14 22:47:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: event.c, terminal.c, terminal.h:

	redraw_terminal_ev(): Use term_send_event() as backend an removing
	code duplication.  
	
	redraw_terminal_cls(): Was the only user of redraw_terminal_all()
	and is now the defined as the old redraw_terminal_all which just
	calls redraw_terminal_ev() and lets term_send_event() handle screen
	erasing and resizing.  

Wed Apr 14 22:35:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	term_send_event(): Only resize and erase screen when handling INIT
	and RESIZE events. Inspired by redraw_terminal_ev().  

Wed Apr 14 22:30:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	term_send_event(): Handle INIT, RESIZE and REDRAW events by sending
	them to all windwows.  

Wed Apr 14 22:10:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Evil hacks to restore appearance of input field lines.  

Wed Apr 14 22:03:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: dialog.c, dialog.h, inphist.c:

	tab_compl_n(): Use redraw_terminal() instead of lowlevel terminal
	event sending. It bypasses any possible dialog->handle_event() by
	that should not be a problem with the current usage. Makes it
	possible to make dialog_func() static.  

Wed Apr 14 21:53:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/terminal.c:

	redraw_terminal_ev(): Propagate EV_RESIZE even to inactive tabs like
	we do in in_term().  

Wed Apr 14 21:38:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/event.c:

	in_term(): Use switch statement and breaks to get rid of ifs and
	gotos.  

Wed Apr 14 21:17:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, main.h, scripting/perl/core.c:

	Look mama I'm coding perl. Make ac ang av static. WTF are they
	handed to PERL_SYS_INIT() we don't support perl args on the command
	line anyway and the day we do I will fork my own ELinks ;).  

Wed Apr 14 21:01:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Update comment and more usage of connection state macros.  

Wed Apr 14 20:51:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Use add_string_to_stirng().  

Wed Apr 14 20:50:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Cleanup.  

Wed Apr 14 20:21:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_end(): Group -dump specific stuff.  

Wed Apr 14 20:14:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_start(): Maybe do it some other way but show which one (of
	multiple URLs) is the problem.  

Wed Apr 14 20:12:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_start(): Error reporting now handles unknown protocols.  

Wed Apr 14 20:11:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_start(): Show error for unsupported URI protocols.  

Wed Apr 14 20:07:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Cleanup.  

Wed Apr 14 20:02:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	dump_formatted(): No need to return anything.  

Wed Apr 14 19:46:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: select.c, select.h:

	@terminate belongs to main.h 

Wed Apr 14 19:43:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, main.h:

	Make init() static.  

Wed Apr 14 19:40:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): More comments.  

Wed Apr 14 19:04:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, sched/session.c, sched/session.h:

	create_session_info(): Take string argument.  

Wed Apr 14 19:03:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/string.c:

	done_string(): Make it possible to call it multiple times on a
	string by only checking the magic if free()ing something.  

Wed Apr 14 18:55:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	create_session_info(): Use string utils.  

Wed Apr 14 06:30:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Improve signal handling logic.  

Wed Apr 14 06:08:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Replace obsolete FIXME with comment.  

Wed Apr 14 06:06:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Code duplication forever. Gotos never.  

Wed Apr 14 05:55:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Make distant goto users duplicate the code.  

Wed Apr 14 05:50:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, terminal/terminal.c, terminal/terminal.h:

	Unify signal setup and session info freeing in init().
	attach_terminal() now returns the created terminal.  

Wed Apr 14 05:44:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Cleanup2.  

Wed Apr 14 05:35:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Cleanup.  

Wed Apr 14 05:31:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Cleanup variable usage.  

Wed Apr 14 05:25:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Rearrange the connecting to an already running instance so
	it is grouped together with the -no-connect part.  

Wed Apr 14 05:12:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	init(): Use no-connect option for storing no connect info.  

Wed Apr 14 03:14:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/select.c:

	Uhh I love that funky code. Iterate while timer list is not empty
	and interval is less than or equal to zero.  

Wed Apr 14 03:04:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/select.c:

	Ehm .. cache_entry != timer.  

Wed Apr 14 02:35:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/: select.h, signals.c:

	Fix includes? 

Wed Apr 14 02:21:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.h:

	Fix is_system_error() logic.  

Wed Apr 14 00:42:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	Add stop member to file_download struct and remove stop arg from
	abort_download.  

Wed Apr 14 00:35:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.c, sched/connection.h, sched/download.c,
	viewer/dump/dump.c:

	Last batch of state macros.  

Wed Apr 14 00:11:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, task.c:

	More is_in_result_State() usage.  

Wed Apr 14 00:09:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.c, connection.h, error.c:

	Move connection state macros and add/use is_system_error().  

Tue Apr 13 23:43:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	Goto return madness. Sorry I couldn.t resist. ;) 

Tue Apr 13 23:15:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	Make get_real_opt() take care of all the option name translation.  

Tue Apr 13 22:47:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_add_ext(): Group @fcp dependant code.  

Tue Apr 13 22:42:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_add_ext(): Them string can never be empty if we have the
	extension option.  

Tue Apr 13 22:38:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_add_ext(): Move option name translation and simplify error
	handling.  

Tue Apr 13 22:36:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_add_ext(): Cleanup.  

Tue Apr 13 22:31:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_add_ext(): Simplify dialog data initialization by making the
	struct extension strings be MAX_STR_LEN.  

Tue Apr 13 22:27:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/options.c:

	charset_list(), menu_language_list(): Cleanup.  

Tue Apr 13 18:58:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	read_file(): Use string utils for reallocation and avoid nasty
	hacks.  

Tue Apr 13 18:44:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Remove old comment.  

Tue Apr 13 18:38:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, protocol/file/file.c:

	Fix bug 377 by allowing reading from /dev/stdin when it is a pipe.  

Tue Apr 13 18:27:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	read_encoded_file(): Abuse switch noddle to handle errors.  

Tue Apr 13 18:11:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	read_encoded_file(): Minor simplification removing saved_errno.  

Tue Apr 13 16:36:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/dialogs.c, config/dialogs.c:

	Fix text before input fields with floating labels bottom padding.  

Tue Apr 13 16:30:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Right align floating labels up against the input field.  

Tue Apr 13 16:20:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Bitpicking.  

Tue Apr 13 16:17:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, protocol/auth/dialogs.c:

	Fix the input field floating label thing and convert last user.  

Tue Apr 13 16:00:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/file.h, document/css/css.c:

	Remove unused header and fix side fx.  

Tue Apr 13 15:59:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	More isspace() usage.  

Tue Apr 13 10:15:40 2004  Laurent Monin <zas@norz.org>:

	* src/: lowlevel/connect.c, osdep/getifaddrs.h:

	System headers should be included before any local headers, this is
	fixing bug 439 reported by Victor Sahlstedt.  

Tue Apr 13 10:10:09 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation: typo fixes.  

Tue Apr 13 10:06:47 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Apr 12 23:28:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_url(): Cleanup.  

Mon Apr 12 23:01:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Check if the @rel[ative] parameter contains a protocol
	name and use translate_url() to 'set it up'.  

Mon Apr 12 22:49:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, config/dialogs.c, cookies/dialogs.c:

	By default add ': ' string to floating input field labels to reduce
	memory usage and needed error hanling.  

Mon Apr 12 21:38:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	check_number(): Make the error message guide the user.  

Mon Apr 12 08:22:43 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Apr 11 23:06:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	Cleanups.  

Sun Apr 11 22:58:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/dialogs.c:

	menu_del_ext(): Make better usage of printf format.  

Sun Apr 11 21:11:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/conf.c:

	write_config_file(): Final cleanup.  

Sun Apr 11 20:46:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: conf.c, dialogs.c, dialogs.h:

	Rename write_config_error() -> write_config_dialog().  

Sun Apr 11 20:44:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: dialogs.c, dialogs.h:

	Merge write_config_success() into write_config_error().  

Sun Apr 11 20:41:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: conf.c, dialogs.c, dialogs.h:

	Move write config dialog message composing.  

Sun Apr 11 20:13:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: conf.c, dialogs.c, dialogs.h:

	Avoid allocating args to msg_text() for the write_config_* dialogs.
	Also fixes potential leak when term was NULL for successfull writes.  

Sun Apr 11 17:24:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, viewer/text/form.c, sched/download.c:

	Avoid allocating args to msg_text().  

Sun Apr 11 17:23:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, mime/dialogs.c, protocol/user.c:

	Free args to msg_text() instead of adding them to getml().  

Sun Apr 11 16:10:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	download_error_dialog(): Decrease indentation.  

Sun Apr 11 16:08:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	download_error_dialog(): With msg_text() there is no need to
	stracpy() stuff.  

Sun Apr 11 15:47:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Remove useless test.  

Sun Apr 11 15:32:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, protocol/protocol.h, protocol/uri.c,
	sched/connection.c, sched/task.c:

	Introduce an unknown_protocol_backend that will pop up an unknown
	protocol dialog as the external handler.  

Sun Apr 11 14:38:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	continue_download_do(): Fix access of free()d memory.  

Sun Apr 11 14:35:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	continue_download_do(): Remove useless file_download cleanup. We
	only ever go there if i is NULL.  

Sun Apr 11 14:34:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	continue_download_do(): Move tq initialization up so it can be used
	to shorten lines in the whole function.  

Sun Apr 11 14:28:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	common_download_do(): Cleanup and remove goto usage by extracting
	members from and freeing cmdw_hop early.  

Sun Apr 11 14:22:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Cleanup and remove double check of resume to get last_pos.  

Sun Apr 11 14:18:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Unify file_download initialization.  

Sun Apr 11 12:43:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	save_as(): Cleanup error handling.  

Sun Apr 11 12:42:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	common_download_do(): Cleanup error handling.  

Sun Apr 11 03:03:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Don't allow exmode when anonymous.  

Sun Apr 11 00:59:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, protocol/auth/dialogs.c:

	Fix bug 392 (badly formatted HTTP auth dialog) properly.  

Sun Apr 11 00:40:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Fix bug 390 caused by incompatibility in session info after support
	for multiple URIs on the commandline was added. This is done by
	introducing some basic session magic data that should make it
	possible in the future to detect what version the client is using
	and decode the session info appropriate. With this patch a new
	ELinks will not be able to pass URIs when connecting to an old
	ELinks however it will work the other way around. It is not perfect
	but I see no other clean way to fix this bug.  

Fri Apr  9 16:42:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Add FIXME about problems reading stuff from stdin to be viewed in
	text viewer (and not dump viewer) because of not allowing special
	files.  

Fri Apr  9 16:33:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Like if !isatty(stdin) also check if !isatty(stdout) and make -dump
	implicit.  This should fix debian bug #231663 "-dump 0 to stdout
	doesn't dump; -dump 0 to pager segfaults". The segfault was by Out
	of memory error that was fixed by previous patch setting x and y
	vars before calling get_terminal_size(). This will further fix it by
	improving usability of elinks in UNIX environment.  

Fri Apr  9 13:34:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Use STDIN_FILENO macro instead of just 0. Don't know if it is
	something we should test for in configure.  

Fri Apr  9 13:33:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/kbd.c:

	get_terminal_size() might not actually assign anything to the
	referenced arguments but will still return 0. This is a bit safer
	when stdout is a pipe.  

Fri Apr  9 04:37:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Proper fix for the unchecked allocated variable freeing.  

Fri Apr  9 03:43:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Use same procedure for sending same URI as referrer as sanding true
	URI. It is alreay the proxied URI so why all the fuzz.  

Fri Apr  9 03:40:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	The data member of URI is always set.  

Fri Apr  9 03:39:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, http/http.c:

	Proposed fix for bug 436 leaking auth data through true referrer.  

Fri Apr  9 03:20:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Format enum members properly.  

Fri Apr  9 03:19:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.h, auth/auth.c, http/http.c:

	Add HTTP URI formatting classes.  

Fri Apr  9 03:13:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.h, scripting/lua/core.c:

	Introduce URI_ORIGINAL formatting class.  

Fri Apr  9 03:10:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/dialogs.c, dialogs/document.c, dialogs/download.c,
	dialogs/menu.c, document/renderer.c, protocol/uri.h,
	protocol/file/cgi.c, sched/download.c, viewer/text/link.c:

	Introduce URI_PUBLIC formatting class that should be used for all
	the URIs showed in dialogs an stuff. Is that too strict or should it
	maybe be configurable whether to show password in public URIs? It is
	even used for CGI referrer altho' I don't if that is too strict.  

Fri Apr  9 03:05:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Revert URI component strangeness. Classes will be introduced
	shortly.  

Fri Apr  9 03:03:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Move unchecked allocated var passed to getml() to the end so it
	won't keep the other ml args from being registered and cause a leak.  

Fri Apr  9 02:19:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Decrease indentation.  

Thu Apr  8 19:47:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	add_url_to_http_string(): Rewrite to not allocate no post url copy.  

Thu Apr  8 19:36:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Small workaround for URI_DEFAULT_PORT adding. Hmm I will have to
	figure out something better.  

Thu Apr  8 19:21:48 2004  Varga Balzs <vinnui@ent.hu>:

	* po/hu.po:

	Translation updated.  

Thu Apr  8 14:38:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h, http/http.c:

	Add support for adding default port if the URI has no port specified
	using new URI_DEFAULT_PORT component.  

Thu Apr  8 14:14:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.c, task.c:

	Fix bug in URI reference counting and add assertion about
	ses->loading_uri. Thanks to iSteve for his irc presence that lead to
	triggering the bug.  

Thu Apr  8 13:17:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	Initialize option lock.  

Thu Apr  8 13:05:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Comment out is_object_used(file_download) assertion and describe why
	we need to make it not fail when the time comes.  

Thu Apr  8 04:33:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix assertion failure when calling protocol function with unknown
	protocol.  

Thu Apr  8 02:52:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c:

	More download consistency checking. Should fix bug 399 (pasting crap
	into goto url dialog) caused by the input to start downloads and
	aborting them (using bottom halves) and then deleting before the
	bottom half gets called. Well we already know how racy the whole
	download code is so ...  

Thu Apr  8 02:00:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, util/types.h:

	Remove gross INFO_LIST hack.  

Wed Apr  7 22:24:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/dialogs.c:

	Show proxy URI info for cache entries.  

Wed Apr  7 22:14:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	parse_uri(): Remove useless test. If the protocol is unknown we bail
	out after skipping the '//'s.  

Wed Apr  7 22:10:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Improve and add comments.  

Wed Apr  7 21:53:15 2004  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	.po files were resynced, if anyone cares.  

Wed Apr  7 21:45:25 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS:

	Style fix.  

Wed Apr  7 21:15:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Add support for translating proxied URIs so even
	proxy://proxy.stuff/elinks.or.cz will work. And this proxy patch is
	even reasonably well tested. ;-) 

Wed Apr  7 21:05:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/ecmascript/core.c:

	What the hell does it here?!? 

Wed Apr  7 20:06:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Assert it is file:// URI that is past to transform_file_url().
	Update comment.  

Wed Apr  7 20:01:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Remove TODO/FIXME about first trying file:// since we infact do
	that.  

Wed Apr  7 19:58:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup.  

Wed Apr  7 19:53:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Clearify why we default to file:// when finding protocol.  

Wed Apr  7 19:44:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Add FIXME about translating proxied URIs.  

Wed Apr  7 19:34:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, protocol/uri.h, sched/connection.c:

	Add support for proxy:// URIs on the command line. Before it caused
	an assertion failure and it is really not that much code.  

Wed Apr  7 19:12:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix need slash after host checking introduced a few patches ago.  

Wed Apr  7 16:15:43 2004  Laurent Monin <zas@norz.org>:

	* AUTHORS:

	Kalle Olavi Niemitalo was added to AUTHORS, for its Accept-Charset
	bug fix.  

Wed Apr  7 16:11:28 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Bug #242524(Debian) was fixed. Accept-Charset header was incorrect
	with protocol.http.bugs.accept_charset = 0. Thanks to Kalle Olavi
	Niemitalo and Peter Gervai.  

Wed Apr  7 15:46:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Add FIXME about handling of irc. and other common protocol specific
	hostnames.  

Wed Apr  7 15:43:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	find_uri_protocol(): Cleanup and remove unneeded gotos.  

Wed Apr  7 15:40:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Move and properly indent find_uri_protocol().  

Wed Apr  7 15:38:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Move protocol detection to separate find_uri_protocol() function.  

Wed Apr  7 15:32:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_url(): Maintain which protocol name to add using enum
	protocol.  

Wed Apr  7 15:22:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Work on the allocated URI string. All tho' the protocol name finding
	will most certainly be run first you never know.  

Wed Apr  7 15:15:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Simplify tilde_expansion by doing it on entering translate_url().  

Wed Apr  7 15:06:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup.  

Wed Apr  7 15:03:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix detection of protocol name for URIs like www.sunpoint.net?k=1.
	Don't brainlesly add ending '/' but handle it using the
	URI_ERRNO_NO_HOST_SLASH.  

Wed Apr  7 14:24:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Improve host after slash handling by changing parse_uri() to assign
	URI host members before checking if slash is missing and
	translate_url() will now use URI host members to insert missing
	slash at the right position. http://www.sunpoint.net?k=1 will be
	translated to http://www.sunpoint.net/?k=1 and squid should be happy
	as well.  

Wed Apr  7 14:09:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/dialogs.c:

	Fix redirect info.  

Wed Apr  7 13:57:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix dir normalization for URIs like http://elinks.or.cz//bla to
	normalize to http://elinks.or.cz/bla 

Wed Apr  7 13:29:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Hrmpfh. Fix normalize dir example.  

Wed Apr  7 13:04:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Describe the dir nomalization loop. Simplify ending logic.  

Wed Apr  7 12:50:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	A little simplification and optimization. Move end_of_dir() check
	inside loop so we don't do it both in the loop invariant? and after
	it.  

Wed Apr  7 12:46:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Rewrite the direcory normalization loop without use of gotos. Fixes
	bug reported by lindi- and zas.  

Tue Apr  6 12:29:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix bug triggered on FreeBSD. Safeguarding against passing the wrong
	URI string to normalize_uri() by simplifying noparse macro.  

Tue Apr  6 11:13:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/refresh.c:

	This should fix bug 434 another sf download using document
	refreshing related thing. At least downloading w3m no longer spawns
	an extra type query box.  

Tue Apr  6 10:35:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c:

	Revert buggy insert_in_string() usage in form fields and areas.  

Tue Apr  6 09:50:42 2004  Laurent Monin <zas@norz.org>:

	* src/util/string.c:

	Assert add_to_string_list() and free_string_list() parameters.  

Tue Apr  6 09:36:10 2004  Laurent Monin <zas@norz.org>:

	* src/main.c:

	Redundant test was removed: free_string_list() checks for empty
	list.  

Tue Apr  6 07:59:48 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/viewer/dump/dump.c:

	elinks -dump did not finish.  

Tue Apr  6 07:46:30 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/viewer/dump/dump.c:

	Fix for bug 433 (unknown protocol or bad uri with -dump).  

Tue Apr  6 07:07:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix directory normalization bug by handling // used by
	translate_file_url().  

Tue Apr  6 07:04:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	First part of directory normalization loop sanification.  

Tue Apr  6 01:35:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_url(): Fix leak.  

Tue Apr  6 01:34:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Rename translate_directories() to normalize_uri() since it now does
	more work. Macros are used for controlling whether to reparse or
	not. I am aware that directory translation is currently broken and
	intent to rewrite it in a sane way ASAP.  

Tue Apr  6 01:20:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	m33p.  

Tue Apr  6 01:20:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c:

	Use insert_in_string() for text fields and areas.  

Tue Apr  6 01:13:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_url(): Make @expanded the new URI string as soon as
	possible to simplyfy.  

Tue Apr  6 01:08:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix some strange double free error.  

Tue Apr  6 00:30:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, util/string.c, util/string.h:

	Rename insert_in_uri()  to insert_in_string() and move to string
	utils.  

Tue Apr  6 00:08:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	translate_directories(): Always pass URI struct as argument and
	instead use uristring arg to signal whether to reparse.  

Mon Apr  5 17:41:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_send_header(): Don't modify the URI. Should hopefully fix bug
	with webmail posting that rely on getting content-type header. part
	3.  

Mon Apr  5 17:38:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_send_header(): Don't modify the URI. Should hopefully fix bug
	with webmail posting that rely on getting content-type header. part
	2 

Mon Apr  5 17:35:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	http_send_header(): Don't modify the URI. Should hopefully fix bug
	with webmail posting that rely on getting content-type header.  

Mon Apr  5 16:58:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.h, sched/connection.c:

	Disallow NULL args to get_uri_reference().  

Mon Apr  5 16:06:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	init_connection(): Assert that proxied_uri is not PROTOCOL_PROXY.  

Mon Apr  5 10:02:40 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Apr  5 05:35:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Shorten code by returning uristring from translate_directories().  

Mon Apr  5 05:31:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	join_urls(): Use uri_errno switch.  

Mon Apr  5 05:22:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	A few assertions.  

Mon Apr  5 05:18:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Try to optimize away some of the calls to parse_uri() by making it
	possible to hand an already parse URI to translate_directories().  

Mon Apr  5 05:06:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Pass uri struct to translate_file_url().  

Mon Apr  5 04:57:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup translate_file_url() by using insert_in_uri().  

Mon Apr  5 04:44:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Move up insert_in_uri().  

Mon Apr  5 04:33:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup transform_file_url() calling.  

Mon Apr  5 04:27:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	All that inlining is no good.  

Mon Apr  5 03:33:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Scary stuff. Complete (eek!) rewrite (Eek!) of translate_url()
	(EEK!). It now goto-loops (ehm since using a while loop would indent
	things too much? ;) a parse_uri() call + switch (the returned
	uri_errno) saving the previous uri_errno to check that progress is
	actually being made. The core part of translate_url() that figures
	out how to handle URIs without protocols is only changed to make use
	of new allocation scheme. Lots of duplicate code is removed and now
	even I can understanding what it does.  

Mon Apr  5 01:17:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, protocol/uri.c, protocol/uri.h,
	protocol/user.c, util/conv.h:

	Add support for case insensitive protocol and hostnames in the URI
	cache. It should be pretty cheap meaning no additional allocation
	needed. The basic idea is to ``prepare'' all URI strings before they
	are handed to get_uri().  
	
	It abuses that all URI composing ends up in translate_directories()
	which already mangles the string and now also lowercases the
	protocol and hostname part of the URI. The remaining part is that
	get_protocol() has been changed to use case insensitive comparing
	against known protocol names and get_user_program() will do an
	option lookup using the lowercased protocol name.  Strings handed to
	get_uri() is sanity checked before the URI is returned.  

Sun Apr  4 22:30:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/plain/renderer.c, protocol/uri.c, protocol/uri.h:

	Make parse_uri() return new uri_errno that will hopefully make
	translate_url() more efficient by pinpointing the error.  

Sun Apr  4 22:00:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	object_nolock() cached URIs.  

Sun Apr  4 22:00:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Fix bad URI reference taking in -dump redirects. Thanks to lindi-.  

Sun Apr  4 22:00:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Fix bad URI reference taking in -dump redirects. Thanks to lindi-.  

Sun Apr  4 20:51:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix bug introduced in the struct uri introduction in translate_url()
	when it lived in src/protocol/url.c, revision 1.89->1.90 change.  

Sun Apr  4 17:42:01 2004  Laurent Monin <zas@norz.org>:

	* src/sched/session.c:

	Compilation fix: @url -> @uri in maybe_pre_format_html().  

Sun Apr  4 17:31:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, http/http.c:

	Make add_uri_to_string() only add slash after host if URI_DATA or
	URI_POST was specified. This makes it possible to use it instead of
	add_uri_host_to_string() in the HTTP code. I hope the it's not a
	security problem sending the real protocol string of the referrer.  

Sun Apr  4 17:04:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Fix bug in ses_goto() TASK_IMGMAP case where the new
	ses->goto_position would be point to free()d memory. Instead
	ses_goto() now allocates it.s own position pointer.  

Sun Apr  4 16:38:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	destroy_vs(): Takes care of free()ing the goto_position member.  

Sun Apr  4 16:26:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Cleanup and remove dead code.  

Sun Apr  4 16:05:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	More sanity checking before requesting frame.  

Sun Apr  4 16:02:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Check length of URI string before + assert() string. Reported by
	lindi-.  

Sun Apr  4 07:40:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	I mean now cleanup and fix leak in get_uri_string().  

Sun Apr  4 07:34:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup get_uri_port().  

Sun Apr  4 07:19:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Cleanup get_protocol_length().  

Sun Apr  4 06:15:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Move extract_fragment() up and static inline it.  

Sun Apr  4 06:12:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, protocol/uri.h, sched/session.c:

	Turn get_translated_uri() into a Swiss army knife that can also just
	extract fragment and return URI from cache.  

Sun Apr  4 05:55:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.c, protocol/uri.h, sched/task.c,
	viewer/dump/dump.c, viewer/text/view.c:

	Introduce get_translated_uri() which get_uri() from translate_url()s
	and possibly extract_fragment().  

Sun Apr  4 05:22:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/http/http.c, sched/connection.c,
	sched/connection.h:

	Like for the cache entry store both (proxy) uri and proxied uri for
	connections. The new member is named proxied_uri. It should
	hopefully not cost more than an extra reference and it simplifies
	the HTTP code a bit.  

Sun Apr  4 04:49:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Optimize the common case where there is no fragment in the requested
	frame uri.  

Sun Apr  4 04:44:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.c, document/html/frames.c,
	document/html/frames.h, sched/session.c:

	Make the frame description struct reference an URI.  

Sun Apr  4 04:28:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	do_follow_url(): Cleanup useless test if protocol is invalid. It can
	never be at this point.  

Sun Apr  4 04:24:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	parse_uri(): Cleanup. get_protocol_end() is now
	get_protocol_length() to save lines.  

Sun Apr  4 04:15:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h, uri.c, uri.h:

	Cleanup the uri <-> protocol interface. Since the uri parsing is the
	only user of known_protocol() it allows us to make the URI parser
	figure out the protocol part first and then query whether it is a
	known protocol. And then why not rename known_protocol() to
	get_protocol().  

Sun Apr  4 03:51:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Fix leading spaces.  

Sun Apr  4 03:46:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, protocol/uri.c, protocol/uri.h,
	sched/download.c:

	add_string_uri_filename_to_string() -> add_uri_filename_to_string()
	and take URI arg.  

Sun Apr  4 03:41:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/download.c,
	viewer/text/view.c:

	query_file(): Take URI as arg.  

Sun Apr  4 03:37:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/download.c, sched/session.c, sched/session.h,
	viewer/text/view.c:

	Rename ses->dn_url to ses->download_uri and make it an URI struct
	pointer.  

Sun Apr  4 03:18:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Fix last patch.  

Sun Apr  4 03:15:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	download_link(): Change code layout.  

Sun Apr  4 03:09:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: util/conv.c, util/conv.h, viewer/text/view.c:

	I hope this is correct. send_open_in_new_window() now adds
	-base-session and -session-ring args to the parameter string.
	encode_shell_safe_url() renamed to add_encoded_shell_safe_url() and
	now works directly on the parameter string it gets passed.  

Sun Apr  4 02:56:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_open_in_new_window(): Change code layout.  

Sun Apr  4 02:50:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_open_in_new_window(): Same as for send_open_new_window(). Do
	not use ses->dn_url to store parameters. The new elinks instance
	will request the URI we could ofcourse preload it already but that
	is not the case anyway but added as a possible TODO.  

Sun Apr  4 02:44:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Introduce init_session_info_string() to initialize string and add
	-base-session and -session-ring parameters to it.  

Sun Apr  4 02:34:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_open_new_window(): dn_url -> parameters.  

Sun Apr  4 02:31:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_open_new_window(): Hmm puzzling why we assign the parameters of
	the new elinks instance to ses->dn_url. It makes no sense and let.s
	see what will happen if we simply remove that. The only sane usage
	of dn_url is for query_file() calls as a way to keep the string
	around for possible callbacks.  

Sun Apr  4 02:07:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	do_follow_url(): Unify error handling.  

Sun Apr  4 01:48:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, sched/connection.h, sched/error.c:

	We might as well use the print_error_dialog() function for the
	javascript-not-supported popup.  

Sun Apr  4 01:40:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/error.c:

	More nglish? 

Sun Apr  4 01:40:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: connection.h, download.c, error.c, session.c,
	session.h, task.c:

	Introduce S_UNKNOWN_PROTOCOL and use it to substitute
	print_unknown_protocol_dialog() with print_error_dialog(..,
	S_UNKNOWN_PROTOCOL, ..).  

Sun Apr  4 01:26:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, sched/task.c,
	viewer/text/view.c:

	Simplify the error dialog interface so only the state and priority
	needs to be passed. If retry should be supported an additional URI
	arg can be passed as well.  

Sat Apr  3 20:26:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/history.c:

	Fix redirect comparison.  

Sat Apr  3 17:42:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/object.h:

	Make lock debug output more human readable.  

Sat Apr  3 17:40:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, bookmarks/bookmarks.h,
	cache/cache.c, cache/cache.h, cache/dialogs.c, config/options.h,
	cookies/cookies.c, cookies/cookies.h, document/document.c,
	document/document.h, formhist/formhist.c, formhist/formhist.h,
	globhist/globhist.c, globhist/globhist.h, protocol/uri.c,
	protocol/uri.h, sched/download.c, sched/download.h, util/object.h:

	Improve object refcount debugging by introducing an object struct
	that holds the counter and if debugging is enabled also the type
	name of the object.  

Sat Apr  3 14:54:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Indentation fixes.  

Sat Apr  3 14:51:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/: cache.c, cache.h:

	Maintain the proxy URI in the cache entry. It should not cost
	anything but a reference and a little extra when deleting but cleans
	and speeds ups things quite nicely.  

Sat Apr  3 14:32:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, protocol/finger.c, protocol/file/cgi.c,
	protocol/file/file.c, protocol/ftp/ftp.c, protocol/http/http.c,
	protocol/smb/smb.c, sched/connection.c, sched/connection.h,
	sched/download.c, sched/history.c, sched/session.c, sched/task.c,
	viewer/dump/dump.c:

	Rename download->ce to download->cached and connection->cache to
	conneciton->cached.  

Sat Apr  3 14:13:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, dialogs/status.c, document/document.c,
	document/document.h, document/renderer.c, document/css/css.c,
	document/html/frames.c, document/html/renderer.c,
	document/html/renderer.h, document/plain/renderer.c,
	document/plain/renderer.h, lowlevel/select.c, protocol/finger.c,
	protocol/file/file.c, sched/connection.c, sched/download.c,
	sched/session.c, sched/task.c, scripting/lua/core.c,
	viewer/dump/dump.c:

	Re-rename cache entry variables to cached to improve grepability.  

Sat Apr  3 13:51:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/dialogs.c:

	Re-rename cache entry variables to cached to improve grepability.  

Sat Apr  3 13:49:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/: cache.c, cache.h:

	Rename-rename cache entry variables to cached to improve
	grepability.  

Sat Apr  3 13:41:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, session.c, session.h:

	Rename cache entry variables to cached to improve grepability.  

Sat Apr  3 13:32:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 13:29:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: viewer/dump/dump.c, scripting/lua/core.c, sched/task.c:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 13:25:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: lowlevel/select.c, protocol/finger.c, sched/connection.c,
	sched/download.c, sched/download.c:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 13:14:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: html/renderer.c, html/renderer.h, document.c,
	html/renderer.c, plain/renderer.c, plain/renderer.h:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 13:10:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/dialogs.c, dialogs/document.c,
	document/html/frames.c:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 13:08:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Rename cache -> cache_entries.  

Sat Apr  3 13:06:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/document.c:

	Rename cache entry variables to cache to improve grepability.  

Sat Apr  3 12:58:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/conf.c:

	Fix assertion failure when trying to save config file an -no-home
	was specified.  

Sat Apr  3 12:33:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.h, document/html/renderer.c, sched/download.c,
	sched/session.c, sched/task.c, viewer/dump/dump.c:

	get_cache_uri_struct() is more used so rename it to get_cache_uri()
	which is then renamed to get_cache_uri_string().  

Sat Apr  3 12:20:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/: cache.c, cache.h:

	redirect_cache(): Return URI being redirected to and document it.  

Sat Apr  3 12:11:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Fix assertion failure reported by Stephen Stocker.  

Sat Apr  3 07:43:23 2004  Laurent Monin <zas@norz.org>:

	* src/cache/cache.c:

	Compilation fix: return 0 instead of NULL pointer.  

Sat Apr  3 03:06:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/history.c:

	Whoopsy .. missing part of last patch.  

Sat Apr  3 03:04:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Make ses_goto() take its own URI reference.  

Sat Apr  3 02:24:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/frames.c:

	Removing an assertion that is clearly useless.  

Sat Apr  3 02:21:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, document/html/frames.c,
	sched/download.c, sched/task.c, viewer/dump/dump.c:

	Make cache_entry->redirect point to an URI struct. This nicely
	cleans things up.  

Sat Apr  3 02:11:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, protocol/http/http.c:

	Change cache redirecting to resolve the URI being redirected to at
	the redirection time meaning either when the HTTP Location header is
	handled or when appending "/" to the directory path. Hopefully it is
	clear from the patch that it is just the body of
	get_cache_redirect_uri() that has been hacked a bit to behave.  

Sat Apr  3 01:35:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, document/html/frames.c,
	sched/download.c, sched/task.c, viewer/dump/dump.c:

	Always resolve redirects relative to the cache entry. Assertions
	added to see if this is not always the case .. well anyway next
	patch (that will be quite a treat) will make it all more clear I
	hope. ;-) 

Sat Apr  3 01:22:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, protocol/file/file.c,
	protocol/ftp/ftp.c, protocol/smb/smb.c:

	Redo the cache redirection interface to be more generic. Now it is
	all relative to the cache entry which makes sense because the
	connection uri is used anyway for creating the cache entry.  

Sat Apr  3 00:13:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	request_additional_file(): URI can never be invalid so remove that
	test.  

Sat Apr  3 00:10:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	request_additional_file(): Take URI arg.  

Fri Apr  2 23:52:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/frames.c, sched/session.c, sched/session.h,
	sched/task.c:

	ses_change_frame_url(): Rename to ses_change_frame_url() and take
	URI struct arg.  

Fri Apr  2 23:43:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/frames.c:

	format_frame(): Use the cache redirect URI facility. It should be
	more correct.  

Fri Apr  2 23:38:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Fix compile error from last patch and get rid of stupid @head
	assertions.  

Fri Apr  2 23:33:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Cleanup connection cache assignment.  

Fri Apr  2 23:30:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, protocol/file/file.c,
	protocol/ftp/ftp.c, protocol/smb/smb.c:

	Unify cache redirects to directories by appending /.  

Fri Apr  2 22:51:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Remove unused post_data_start().  

Fri Apr  2 22:48:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	Remove useless post char mangling.  

Fri Apr  2 22:35:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Remove unparse_uri().  

Fri Apr  2 22:31:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Remove dead code that is getting really outdated.  

Fri Apr  2 22:27:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Oops more forgotten find_in_cache() calls this time in led land.  

Fri Apr  2 22:18:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/lua/core.c:

	Oops forgotten find_in_cache() call in lua land.  

Fri Apr  2 22:16:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	A little cleanup to improve readability by passing URI struct to
	rewrite_uri().  

Fri Apr  2 22:04:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/protocol.c, protocol/protocol.h, protocol/user.c,
	sched/task.c:

	A nicish patch that should hopefully make the last one all worth it.
	Pass URI struct to external protocol handler. Makes the job easier
	for user protocol handlers.  

Fri Apr  2 21:55:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	do_follow_url(): Cleanup protocol usage.  

Fri Apr  2 21:52:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Another patch which is a bit fishy but it will all make sence in a
	moment. Move URI struct registering up before anything else in in
	do_follow_url() it is hopefully also more correct since any external
	handler will be passed the translated URI with all the file://,
	http:// etc crap (or will break some user protocol settings?).  

Fri Apr  2 21:36:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Is it probably not so nice either but 'if you have said A ...'
	anyways try to make better usage of URI struct in find_in_cache().  

Fri Apr  2 21:21:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, dialogs/document.c,
	document/document.c, document/renderer.c, document/css/css.c,
	document/html/frames.c, protocol/http/codes.c, sched/connection.c,
	sched/task.c:

	find_in_cache(): Take URI arg.  

Fri Apr  2 21:10:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	It might look stupid and pointless at this stage but once we have
	CSS cache it will be less I hope, anyway aquire URI struct in CSS
	import handler.  

Fri Apr  2 18:58:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: protocol.c, protocol.h:

	Merge check_protocol() into known_protocol().  

Fri Apr  2 18:41:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Removing path expansion from option parsing in the client. The bug
	is else where and it works perfectly without on FreeBSD.  

Fri Apr  2 18:15:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, document/refresh.c, protocol/proxy.c,
	protocol/uri.c, protocol/uri.h, sched/download.c, sched/session.c,
	sched/task.c, viewer/dump/dump.c:

	get_uri(): Take URI string length as arg. If -1 strlen() will be
	used.  

Fri Apr  2 18:07:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/smb/smb.c:

	Oops. Forgotten get_cache_entry(struri(..)) call.  

Fri Apr  2 18:03:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	Describe the URI cache interface.  

Fri Apr  2 17:58:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, protocol/uri.h:

	get_cache_entry(): Make proper use of URI struct arg by calling new
	macro get_proxied_uri().  

Fri Apr  2 17:45:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, dialogs/document.c,
	protocol/finger.c, protocol/file/file.c, protocol/ftp/ftp.c,
	protocol/http/codes.c, protocol/http/http.c:

	get_cache_entry(): Take URI arg.  

Fri Apr  2 17:30:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, protocol/uri.c, protocol/uri.h,
	protocol/http/http.c, sched/download.c:

	get_extension_from_url(): Rename to get_extension_from_uri() and
	take URI arg. Also we now start searching for the extension at the
	uri->data position.  

Fri Apr  2 17:17:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, mime/mime.h, sched/download.c:

	get_content_type(): Take URI arg.  

Fri Apr  2 17:13:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	get_temp_name(): Take URI arg.  

Fri Apr  2 16:58:03 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/uri.c:

	Check range of port, and let display an invalid syntax error message
	if provided one is out of range.  

Fri Apr  2 16:53:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: history.c, task.c, task.h:

	ses_goto(): Take URI struct as arg.  

Fri Apr  2 16:50:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	A few fixes of accessing free()d memory and useless checking.  

Fri Apr  2 16:39:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Oops .. fix return value.  

Fri Apr  2 16:38:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	A little preparing.  

Fri Apr  2 16:35:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, sched/download.c,
	sched/task.c, viewer/dump/dump.c:

	get_cache_redirect_uri(): Return URI struct.  

Fri Apr  2 16:16:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Add TODO about lowercasing scheme and hostname part in the URI
	cache.  

Fri Apr  2 15:03:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: refresh.c, refresh.h:

	Use URI struct for document refreshing.  

Fri Apr  2 07:27:00 2004  Laurent Monin <zas@norz.org>:

	* src/: config/conf.c, document/html/tables.c,
	scripting/perl/hooks.c, terminal/kbd.c, viewer/dump/dump.c:

	Trailing spaces fixes.  

Thu Apr  1 18:34:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/proxy.c, protocol/proxy.h, sched/connection.c:

	Make get_proxy() return URI struct. Move proxy_uri validation to
	load_uri() and thus closer to the let-me-get-the-hell-out-of-here
	handler. Fix a few possible leaks in the error paths.  

Thu Apr  1 17:13:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	Make the task struct use URIs.  

Thu Apr  1 16:42:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/task.c, viewer/dump/dump.c,
	viewer/text/vs.c, viewer/text/vs.h:

	Pass URI struct to init_vs() so it can never fail.  

Thu Apr  1 16:31:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Cleanup.  

Thu Apr  1 16:21:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Cleanup dead code.  

Thu Apr  1 16:19:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Remove useless allocation.  

Thu Apr  1 16:01:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	More crazy stuff.  

Thu Apr  1 15:59:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/location.c, sched/location.h, sched/session.c,
	sched/session.h, sched/task.c, viewer/dump/dump.c,
	viewer/text/marks.c, viewer/text/vs.c, viewer/text/vs.h:

	Blast vs.url and vs.url_len and flush out all the crazy code that
	made it work.  

Thu Apr  1 15:45:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	Improve zas' fix and just allow current_url to be NULL if we are
	lost.  

Thu Apr  1 15:29:38 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/rewrite/rewrite.c:

	Use have_location() to prevent segfault in goto_url_hook().  

Thu Apr  1 15:05:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/scripting/lua/core.c:

	Muddle up.  

Thu Apr  1 14:56:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, scripting/lua/core.c,
	scripting/lua/hooks.c, scripting/perl/hooks.c, viewer/text/view.c:

	XPUSHs(sv_2mortal(newSVpvn(struri(cur_loc(ses)->vs.uri),
	strlen(struri(cur_loc(ses)->vs.uri))))); 

Thu Apr  1 14:45:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, protocol/rewrite/rewrite.c,
	sched/history.c:

	Convert a few vs.url to struri(vs.uri).  

Thu Apr  1 14:44:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: renderer.c, plain/renderer.c:

	If no document title set it to the current URI.  

Thu Apr  1 14:35:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/renderer.c, document/html/frames.c,
	scripting/guile/core.c, viewer/text/view.c:

	Convert all vs->url to struri(vs->uri).  

Thu Apr  1 07:56:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/proxy.c:

	Cleanup.  

Thu Apr  1 07:53:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Pass URI struct to get_proxy().  

Thu Apr  1 06:22:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: proxy.c, proxy.h:

	get_proxy() and friends using URI structs.  

Thu Apr  1 06:08:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	ALittleCleanup.  

Thu Apr  1 06:06:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.c, sched/connection.h, sched/download.c,
	sched/session.c, sched/task.c, viewer/dump/dump.c:

	load_url() -> load_uri() and take URI struct as arg.  

Thu Apr  1 05:57:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/smb/smb.c:

	Compile fixes. Thanks to Zardoz.  

Thu Apr  1 05:18:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Translate real_url to an URI struct.  

Thu Apr  1 05:09:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, document.h, renderer.c:

	Pass vs->uri to get_cached_document() and init_document().  

Thu Apr  1 05:03:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, dialogs/menu.c, scripting/lua/core.c:

	Tune a few view state URI composing.  

Thu Apr  1 05:02:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/history.c, viewer/text/view.c:

	View state comparing optimizations.  

Thu Apr  1 05:01:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: viewer/text/vs.c, viewer/text/vs.h, sched/session.c:

	Add URI struct member to view_state.  

Thu Apr  1 04:15:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/dialogs.c, protocol/ftp/ftp.c, protocol/smb/smb.c:

	More get_uri_string() usage.  

Thu Apr  1 04:09:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	Rename http_error_info->url to ->uri and change to point to an URI
	struct.  

Thu Apr  1 03:56:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	No good patch.  

Thu Apr  1 03:22:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Fix the leak introduced in file:/// fallback for non existing files
	fix.  

Thu Apr  1 02:59:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, sched/download.c,
	sched/task.c, viewer/dump/dump.c:

	get_cache_redirect_uri(): Take URI struct.  

Thu Apr  1 02:48:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, sched/download.c, sched/history.c,
	sched/session.c, sched/session.h, sched/task.c:

	Change session->loading_uri to point to an URI struct.  

Thu Apr  1 01:51:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Cleanup return type checking.  

Thu Apr  1 01:47:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.c, sched/session.c,
	sched/session.h:

	type_query->url -> type_query->uri 

Thu Apr  1 01:30:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.c, sched/session.c,
	sched/session.h:

	type_query->url -> type_query->uri 

Thu Apr  1 01:25:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Change file_to_load->uri to point to an URI struct.  

Thu Apr  1 01:20:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	file_to_load->url -> file_to_load->uri 

Thu Apr  1 01:09:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, sched/download.c, sched/history.c,
	sched/session.c, sched/session.h, sched/task.c:

	session->loading_url -> session->loading_uri 

Thu Apr  1 01:01:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, sched/download.c,
	sched/task.c, viewer/dump/dump.c:

	get_cache_redirect_uri(): Generalized redirect URI composer.  

Thu Apr  1 00:37:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	Change file_download->uri to point to an URI struct. BTW there seem
	to have sneaked in a leak when aborting downloads. Well well 

Thu Apr  1 00:13:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	file_download->url -> file_download->uri 

Thu Apr  1 00:09:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/plain/renderer.c, protocol/file/cgi.c:

	get_no_post_url() -> get_uri_string(..., ~URI_POST) 

Wed Mar 31 23:47:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/cgi.c, protocol/http/http.c,
	sched/connection.c, sched/connection.h:

	Change connection referrer to point to an URI struct.  

Wed Mar 31 23:40:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	get_uri_reference(): Be lazy and handle NULL URIs too.  

Wed Mar 31 23:38:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/cgi.c, protocol/http/http.c,
	sched/connection.c, sched/connection.h:

	connection->ref_url -> connection->referrer 

Wed Mar 31 23:33:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/connection.c, sched/connection.h, sched/download.c,
	sched/session.c, viewer/dump/dump.c:

	load_url(): Take referrer as URI struct.  

Wed Mar 31 23:32:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: session.c, session.h:

	Change session referrer to point to an URI struct.  

Wed Mar 31 23:17:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: download.c, session.c, session.h, task.c:

	session->ref_url -> session->referrer 

Wed Mar 31 22:42:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/status.c, document/document.c, document/document.h,
	document/refresh.c, document/renderer.c, document/plain/renderer.c,
	sched/session.c, sched/session.h, sched/task.c:

	Use URI cache for documents. set_session_referrer() now takes URI
	struct.  

Wed Mar 31 22:39:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.h:

	Add macro to get the cache entry URI struct.  

Wed Mar 31 22:00:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/status.c, document/document.c, document/document.h,
	document/refresh.c, document/renderer.c, document/plain/renderer.c,
	sched/session.c, sched/task.c, viewer/text/view.c:

	document->url -> document->uri 

Wed Mar 31 21:50:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.h:

	get_uri_reference(): Returned the locked URI.  

Wed Mar 31 20:31:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	lowlevel/connect.c, protocol/finger.c, protocol/uri.c,
	protocol/uri.h, protocol/user.c, protocol/file/cgi.c,
	protocol/file/file.c, protocol/ftp/ftp.c, protocol/http/http.c,
	protocol/smb/smb.c, sched/connection.c, sched/connection.h,
	sched/session.c:

	Make the connection struct use the URI cache. Make struri() take URI
	pointer.  

Wed Mar 31 20:29:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, document/renderer.c,
	protocol/http/codes.c, sched/task.c:

	Fix URI utility includes.  

Wed Mar 31 16:53:54 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/uri.c:

	Assert parameters in get_uri_cache_entry(), safer for now, imho.  

Wed Mar 31 16:47:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	protocol/uri.c, protocol/uri.h, viewer/dump/dump.c:

	Reintroduce the URI cache. Used for cache entries only.  

Wed Mar 31 00:11:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* AUTHORS, src/scripting/lua/core.c:

	Test file existence to avoid Lua error reporting (under version
	5.x).  Fixes debian bug #231760 ('dbug 231760' using URI rewrite).  
	Patch by Kevin B. McCarty. Untested.  

Tue Mar 30 23:05:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/history.c, sched/session.c, sched/session.h,
	sched/task.c, viewer/text/view.c:

	set_referrer(): Move to C file and rename to set_session_referrer().  

Tue Mar 30 15:42:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	detach_formatted(): Use free_link().  

Tue Mar 30 10:14:49 2004  Laurent Monin <zas@norz.org>:

	* test/underline.html:

	Underline tests.  

Tue Mar 30 00:50:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	We don.t support string escape seqs, yet.  

Tue Mar 30 00:47:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Temporary fix for inf. loop reported by pasky.  

Tue Mar 30 00:36:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Make background property value parsing loop look more sane.  

Tue Mar 30 00:22:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	More garbage. You can thank pasky for this.  

Tue Mar 30 00:10:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Simplify/optimize token skipping.  

Tue Mar 30 00:10:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fix typo.  

Mon Mar 29 23:03:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	In translate_url(), if file_exists() returns false setting not_file
	to true is a bad assumption since @prefix is not changed which again
	causes any URI that is not recognized as being some other protocol
	to fallback to file:///.  Changing the @prefix is also not good
	since it gives the error message "Bad URI syntax". Leaving it like
	this will give a "No such file or directory" error.  Was introduced
	in 1.83 -> 1.84. A potential memleak of expanded is still there but
	I can.t figure this messy function.  
	
	Thanks to lindi- for helping to debug this thing. ;) 

Mon Mar 29 17:42:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Expand relative filenames in the client so they will always work
	when handled in the master. Idea by lindi-.  

Sun Mar 28 19:01:48 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/file/file.c:

	Fix: do not show .. for / directory.  

Sun Mar 28 18:37:01 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	One more use for table_frames stuff.  

Sun Mar 28 18:29:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Use bitfields in struct table_frames.  

Sun Mar 28 18:25:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	@tf -> @table_frames.  

Sun Mar 28 18:23:31 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Assert @result too in get_table_frames().  

Sun Mar 28 18:21:39 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Struct table_frames was introduced, it helps to get frames info from
	table frame fields through new get_table_frames() function.  

Sun Mar 28 18:00:41 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Minor code cleanup.  

Sun Mar 28 17:58:22 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Table frames related calculations cleanup.  

Sun Mar 28 17:48:47 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/tables.c:

	Unwanted background color appearing at left of tables was fixed (bug
	398). Patch by Jonas.  

Sat Mar 27 16:31:21 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/bfu/hierbox.c:

	Brainless workaround for bug 397. Real fix is needed.  

Fri Mar 26 18:15:02 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Minor tidyup. A useless FIXME was removed.  

Fri Mar 26 18:05:45 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Do not call safe_hard_write() if there is no byte to write.  

Fri Mar 26 17:56:53 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Label fr was renamed free_and_return.  

Fri Mar 26 17:55:50 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/signals.c:

	Fix wrong #include: kbd.c -> kdb.h.  

Fri Mar 26 17:49:52 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	@c -> @bytes_read 

Fri Mar 26 17:46:10 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	RD() macro was moved near the place where it is used.  

Fri Mar 26 17:42:05 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Code redundancy was slightly reduced by introducing
	safe_hard_write().  

Thu Mar 25 17:34:59 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* contrib/elinks.spec.in:

	A lot of bconds. Added hooks.pl.  

Thu Mar 25 17:33:57 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* contrib/Makefile.am:

	Stubs for perl scripting engine.  

Wed Mar 24 19:35:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Revert wrong encoding optimization. I must be getting out of shape.  

Wed Mar 24 15:10:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Minor optimization of file encoding guessing.  

Tue Mar 23 20:44:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/task.c:

	ses_forward(): A little clarity and optimization of why we lower
	bound the URL length of the created location.  

Tue Mar 23 20:33:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cache/cache.c:

	Tidyup.  

Tue Mar 23 13:50:54 2004  Laurent Monin <zas@norz.org>:

	* test/tablebg.html:

	Table bgcolor test.  

Mon Mar 22 14:35:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	cookies/cookies.c, dialogs/document.c, dialogs/download.c,
	dialogs/menu.c, dialogs/status.c, document/document.c,
	document/document.h, document/refresh.c, document/renderer.c,
	document/html/frames.c, document/plain/renderer.c,
	lowlevel/connect.c, mime/mime.c, mime/mime.h, protocol/finger.c,
	protocol/uri.c, protocol/uri.h, protocol/user.c,
	protocol/auth/auth.c, protocol/file/cgi.c, protocol/file/file.c,
	protocol/ftp/ftp.c, protocol/http/blacklist.c,
	protocol/http/blacklist.h, protocol/http/codes.c,
	protocol/http/http.c, protocol/rewrite/rewrite.c,
	sched/connection.c, sched/connection.h, sched/download.c,
	sched/download.h, sched/history.c, sched/location.c,
	sched/location.h, sched/session.c, sched/session.h, sched/task.c,
	util/string.h, viewer/dump/dump.c, viewer/text/marks.c,
	viewer/text/view.c, viewer/text/vs.c, viewer/text/vs.h:

	Revert the lot of struct uri changes. Pasky warned me that it
	sounded scary and the very first bug report plus the fact that it
	was all made in a proof of concept manner was too convincing. We
	should still persue the idea tho' because they rock.  

Mon Mar 22 04:51:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: document.c, document.h, renderer.c:

	Pass URI directly to init_document() to avoid error handling.  

Mon Mar 22 04:32:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	done_uri(): Optimize to only lookup in the map when releasing URIs.  

Mon Mar 22 04:15:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	Use URI struct for http error code handling.  

Mon Mar 22 04:03:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/location.c, sched/session.c, sched/task.c,
	viewer/text/marks.c:

	Cleanup and don't allocate extra memory for the URI string.  

Mon Mar 22 04:00:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Oops clear local view state variable.  

Mon Mar 22 03:59:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: location.h, session.h:

	Remove deprecated comments.  

Mon Mar 22 03:58:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Cleanup and use local view state variable.  

Mon Mar 22 03:47:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, dialogs/menu.c, document/renderer.c,
	document/html/frames.c, sched/location.h, sched/session.c,
	sched/task.c, viewer/dump/dump.c, viewer/text/view.c,
	viewer/text/vs.c, viewer/text/vs.h:

	Use struct URI for view states. Removing lots of dangerous code and
	simplifying things.  

Mon Mar 22 03:23:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, protocol/rewrite/rewrite.c,
	sched/history.c, sched/location.h, sched/session.c, sched/task.c:

	Use get_location_url() macro when dealing with view states.  

Mon Mar 22 03:01:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/document.c, document/renderer.c,
	document/html/frames.c, viewer/text/vs.h:

	Use get_vs_cache_entry() macro when dealing with view states.  

Mon Mar 22 02:51:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/location.c, sched/session.c, viewer/dump/dump.c,
	viewer/text/marks.c:

	Getting ready for a hostile take over. Use mem_calloc() when dealing
	with view states.  

Mon Mar 22 02:44:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Tidy up.  

Mon Mar 22 02:43:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/history.c, sched/session.c, viewer/text/view.c,
	viewer/text/vs.h:

	get_vs_url_copy(): Wrap the world.  

Mon Mar 22 01:18:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, protocol/uri.c, protocol/uri.h,
	protocol/http/http.c, sched/download.c:

	get_extension_from_url(): Take struct URI and rename to
	get_uri_extension().  

Mon Mar 22 01:08:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.c, mime/mime.h, sched/download.c:

	Pass URI to get_content_type().  

Mon Mar 22 01:04:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/refresh.c, sched/download.c, sched/session.c,
	sched/session.h:

	Use struct URI for type queries.  

Sun Mar 21 23:55:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/file/cgi.c, protocol/http/http.c,
	sched/connection.c, sched/connection.h, sched/download.c,
	sched/session.c, sched/session.h, sched/task.c, viewer/dump/dump.c:

	Change both session->ref_url and connection->ref_url to use URI
	struct and rename to referrer.  

Sun Mar 21 23:26:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Use URI for file_to_load struct.  

Sun Mar 21 23:18:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	Use URI for file downloads.  

Sun Mar 21 22:57:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/renderer.c, document/plain/renderer.c,
	protocol/file/cgi.c:

	With the handy URI struct we can use get_uri_string() instead of
	get_no_post_url().  

Sun Mar 21 22:48:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Only maintain URI cache reference counter over the number of entries
	in the cache so it will be easier to reference URIs from outside.  

Sun Mar 21 22:43:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.h, sched/session.c, sched/session.h,
	sched/task.c, viewer/text/view.c:

	set_session_referrer(): Take URI struct.  

Sun Mar 21 22:26:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/history.c, sched/session.c, sched/session.h,
	sched/task.c, viewer/text/view.c:

	Move set_referrer() to .c file and rename it to
	set_session_referrer().  

Sun Mar 21 16:30:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/status.c, document/document.c, document/document.h,
	document/refresh.c, document/renderer.c, document/plain/renderer.c,
	sched/session.c, sched/task.c, viewer/text/view.c:

	Add real URI to the document struct.  

Sun Mar 21 16:16:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Move URI refcounting to the URI struct.  

Sun Mar 21 15:58:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	lowlevel/connect.c, protocol/finger.c, protocol/uri.c,
	protocol/uri.h, protocol/user.c, protocol/file/cgi.c,
	protocol/file/file.c, protocol/ftp/ftp.c, protocol/http/http.c,
	sched/connection.c, sched/connection.h, sched/session.c:

	Use URI cache for connection->uri. A lot of
	s/conn->uri\./conn->uri->/. We now always free the get_proxy() URI
	when initializing a connection.  

Sun Mar 21 15:39:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, document/plain/renderer.c,
	protocol/uri.c, protocol/uri.h, protocol/file/cgi.c,
	protocol/ftp/ftp.c, protocol/http/http.c, sched/session.c:

	Last more or less trivial users of the URI data string. Blast old
	data string members. Boooooring. But now the fun can begin. :) 

Sun Mar 21 15:29:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Use the URI data string for the HTTP protocol stuff.  

Sun Mar 21 15:23:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Use the URI data string for the cookie stuff. Plus little cleanup.
	Eek 

Sun Mar 21 15:10:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/: cgi.c, file.c:

	Use the URI data string for the file protocol stuff.  

Sun Mar 21 15:08:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/user.c:

	Use the URI data string for the user protocol stuff.  

Sun Mar 21 14:59:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Add URI data string struct and use internally in URI land.  

Sun Mar 21 14:41:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/cgi.c:

	Don't search for POST_CHAR that is the job of parse_uri().  

Sun Mar 21 14:30:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, protocol/uri.c, protocol/uri.h,
	protocol/user.c, protocol/file/cgi.c, protocol/file/file.c,
	protocol/ftp/ftp.c, protocol/http/http.c, sched/session.c:

	uri->data -> uri->datastr 

Sun Mar 21 13:39:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cache/cache.c, cache/cache.h, cache/dialogs.c,
	protocol/uri.c, protocol/uri.h, viewer/dump/dump.c:

	Introducing an URI cache.  

Sun Mar 21 02:22:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Blast old URI host nonstrings.  

Sun Mar 21 02:21:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/http/http.c, sched/connection.c:

	Convert last users in connection land to use URI host string.  

Sun Mar 21 02:21:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	Convert last users in cookie land to use URI host string.  

Sun Mar 21 02:10:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/connection.c:

	Use the URI host string for the host connection stuff.  

Sun Mar 21 02:04:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	is_in_domain(): Take server as string struct.  

Sun Mar 21 01:56:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/cookies/cookies.c:

	check_domain_security(): Take server as string struct.  

Sun Mar 21 01:49:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	More URI host string trivial usage.  

Sun Mar 21 01:45:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/plain/renderer.c, protocol/uri.h:

	Use URI host string.  

Sun Mar 21 01:41:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	add_uri_to_string(): Use host string.  

Sun Mar 21 01:39:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/lowlevel/connect.c:

	Bleh.  

Sun Mar 21 01:37:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: blacklist.c, blacklist.h, http.c:

	Change the blacklist interface to use host strings.  

Sun Mar 21 01:31:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/uri.c:

	Make the URI host string usable.  

Sun Mar 21 00:32:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/user.c:

	Cleanup subst_cmd() by unifying adding of shell safe chars.  

Sun Mar 21 00:21:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h, user.c, http/http.c:

	Store URI port info in a string struct.  

Sun Mar 21 00:04:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h:

	Add ipv6 member to struct uri.  

Sat Mar 20 23:53:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, http/http.c:

	Remove add_uri_host_to_string() and make it possible to use
	add_uri_to_string() instead.  

Sat Mar 20 23:35:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/uri.h, protocol/user.c, sched/connection.c:

	A little cleanup of the URI host sequence capturing.  

Sat Mar 20 21:01:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, lowlevel/connect.c, protocol/uri.c,
	protocol/uri.h, protocol/user.c, protocol/http/http.c,
	sched/connection.c:

	uri->host -> uri->hoststr 

Sat Mar 20 21:01:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/string.h:

	More (yet unused) utils.  

Sat Mar 20 21:01:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/string.h:

	More (yet unused) utils.  

Sat Mar 20 18:55:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: uri.c, uri.h, auth/auth.c, ftp/ftp.c:

	Store protocol password info in a string struct.  

Sat Mar 20 18:32:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: protocol/finger.c, protocol/uri.c, protocol/uri.h,
	protocol/user.c, protocol/auth/auth.c, protocol/ftp/ftp.c,
	sched/connection.c, util/string.h:

	Store protocol user info in a string struct. Add a few handy string
	struct macros.  

Sat Mar 20 14:39:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/frames.c:

	Check end pointer when using strto[u]l() to parse frame dimensions.
	Idea by Christian Haggstrom <c00chm@cs.umu.se> 

Fri Mar 19 16:10:20 2004  Petr Baudis <pasky@ucw.cz>:

	* Makefile.base:

	Polished and fixed grammar.  

Fri Mar 19 08:45:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/frames.c:

	Fix non portable use of strtoul() that caused frames not to be
	rendered. Reported by Daniel E. Macks <dmacks@netspace.org> 

Wed Mar 17 09:08:22 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	A segfault occuring while navigating through main menu was fixed
	(bug 394). It was a missing break statement.  

Tue Mar 16 09:14:39 2004  Laurent Monin <zas@norz.org>:

	* src/util/: conv.c, conv.h:

	Take care of - char that may indicate a command line option, patch
	by Solar Designer.  

Sun Mar 14 06:22:01 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/cookies/dialogs.c:

	Removed draw_cookie. Set cookie->box_item->text instead.  

Sat Mar 13 17:57:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	IFrame-like handling for the <applet> tag (show alt and link to
	code).  

Sat Mar 13 17:27:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/: garbage.html, styletags.html:

	A few test cases.  

Sat Mar 13 15:17:03 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/auth/dialogs.c:

	Block auth dialog after all memory allocation tests, safer.  

Sat Mar 13 15:12:23 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/auth/dialogs.c:

	Auth dialog layout was improved a bit by using floating labels, and
	a workaround for bug 392 was provided, by using maximum width for
	dialog.  

Fri Mar 12 10:13:28 2004  Laurent Monin <zas@norz.org>:

	* NEWS:

	NEWS update: cookies creation and modification 

Thu Mar 11 13:54:09 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/dialogs.c:

	Tidy up.  

Thu Mar 11 13:43:09 2004  Laurent Monin <zas@norz.org>:

	* src/cookies/dialogs.c:

	Do proper check for expires and secure cookies values using
	strtol().  

Thu Mar 11 04:44:23 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/cookies/: cookies.c, cookies.h, dialogs.c:

	Possibility adding new cookies, but only for "old" servers.  
	Introduced listbox draw op: draw_cookie.  

Tue Mar  9 17:44:18 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/cookies/dialogs.c:

	New feature: editing cookies.  

Tue Mar  9 15:24:46 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/inphist.c, bookmarks/backend/default.c,
	cookies/cookies.c, formhist/formhist.c, globhist/globhist.c,
	util/file.c, util/file.h:

	Get rid of weird/useless safe_fgets(), just use fgets().  

Tue Mar  9 15:05:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Add note about broken text alignment in CSS apllier.  

Tue Mar  9 14:09:13 2004  Laurent Monin <zas@norz.org>:

	* src/formhist/formhist.c:

	Minor tidy up.  

Tue Mar  9 12:24:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, src/elinks.h, src/bfu/hotkey.c,
	src/bfu/menu.c, src/cache/dialogs.c, src/config/options.c,
	src/config/options.h, src/dialogs/menu.c, src/document/document.c,
	src/modules/version.c, src/osdep/stub.h,
	src/protocol/rewrite/rewrite.c, src/sched/connection.c,
	src/util/error.c, src/util/error.h, src/util/lists.h,
	src/util/memlist.h, src/util/object.h, src/util/profile.h,
	src/util/string.h:

	DEBUG -> CONFIG_DEBUG .. it seems that perl is a namespace polluter
	.. like we didn't know that already! ;-) 

Tue Mar  9 05:32:09 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Translation update.  

Fri Mar  5 17:58:53 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/config/dialogs.c:

	Allow to add again previously deleted option.  

Fri Mar  5 10:41:10 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/config/: conf.c, options.h, options.c:

	Support for saving deleted options. Heavy use of watermarks.  
	Prevented unsetting builtin options.  

Fri Mar  5 01:05:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* NEWS:

	Summarize new stuff for those too lazy to read the ChangeLog file.
	Please help keeping it updated (although some of the entries added
	with this patch might be to unimportant?) 

Thu Mar  4 10:57:27 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Mar  3 18:12:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: view.c, link.c:

	Cleanup and use get_current_link().  

Wed Mar  3 18:10:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: form.c, textarea.c:

	Use get_current_link() and shorten lines.  

Wed Mar  3 18:07:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	Cleanup and use get_current_link().  

Wed Mar  3 18:03:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/view.h:

	Better checking before looking up the current link.  

Wed Mar  3 17:42:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/view.h, sched/session.c:

	Introduce get_current_link() macro.  

Wed Mar  3 17:27:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, sched/session.h, scripting/lua/core.c:

	get_current_link() -> get_current_session_link().  

Wed Mar  3 17:08:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Cleanup and remove goto usage.  

Wed Mar  3 16:34:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Fix wrong width and height in comparison. Fixes bug 388.  

Wed Mar  3 12:00:05 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: config/options.inc, protocol/http/http.c:

	Information how many bars is displayed by ELinks is sent in
	User-Agent header field. Note, that this information will be
	accurate for new instances only when they run with -no-connect
	option.  

Wed Mar  3 08:21:27 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* acconfig.h, configure.in:

	Missing commit.  

Tue Mar  2 17:06:15 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: Makefile.am, main.c, main.h, scripting/Makefile.am,
	scripting/scripting.c:

	Support for Perl scripting. Scripts are read from file 'hooks.pl'.  
	Example hooks.pl will be available later.  

Mon Mar  1 19:17:51 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: config/options.inc, intl/charsets.c:

	Support for System codepage.  

Sat Feb 28 06:25:18 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Spelling fixes.  

Fri Feb 27 16:22:40 2004  Laurent Monin <zas@norz.org>:

	* src/intl/: charsets.c, charsets.h:

	Make get_entity_string() static since it is only used by charsets.c
	for now.  

Fri Feb 27 11:30:15 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Fix: copy http_version structure contents not structure pointer. How
	did it remain unnoticed until now ? 

Fri Feb 27 11:20:08 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/: http.c, http.h:

	Provide and use macros to check http version, some FIXME were added.  

Fri Feb 27 10:46:27 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	Minor tidyup: useless goto is gone, a typo in a comment was fixed,
	minor style changes.  

Fri Feb 27 09:27:52 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Feb 27 06:18:43 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Translation update.  

Thu Feb 26 23:47:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/tab.c:

	Select the clicked tab when the last character of the tab is
	clicked. Really this time. Quazgaa promises.  

Thu Feb 26 17:35:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Compile fix. Reported by Zardoz.  

Thu Feb 26 16:48:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Group similar action handler calling using a magic variable. Don't
	know if this kind of optimization is stupid.  

Thu Feb 26 16:12:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c,
	terminal/tab.c, terminal/tab.h:

	Add support for moving the current tab back and forth. Requested by
	Zellner.  

Thu Feb 26 01:13:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/status.c:

	In display_tab_bar, increment |tab->width| if it is the last tab so
	that the space at the end of the tab bar is counted as part of the
	last tab.  

Thu Feb 26 01:02:59 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/status.c:

	Preparatory clean-up: In display_tab_bar, store the actual tab width
	in |actual_tab_width|.  

Thu Feb 26 00:59:39 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/status.c:

	Trivial clean-up: In display_tab_bar, use @tab_ses instead of
	tab->data, as the latter has previously been assigned to the former.  

Thu Feb 26 00:50:56 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/tab.c:

	Fix behaviour when clicking on the tab-bar: ignore clicks on
	separators, and select the correct tab when clicking on the first
	character of a tab. Thanks to Quazgaa for taking my initial attempt
	at fixing this and making it work correctly when I was too stupid.
	This fixes bug 389.  

Mon Feb 23 11:20:33 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: main.c, config/cmdline.c, config/cmdline.h:

	Fixed elinks --version.  

Sun Feb 22 13:30:21 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Feb 21 06:29:27 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/uri.c:

	Expand tilde first, then test if file exists.  

Fri Feb 20 16:32:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	Gettextize HTTP error document.  

Fri Feb 20 16:03:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/codes.c:

	Oops fix TODOer.  

Fri Feb 20 16:01:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/: codes.c, codes.h, http.c:

	Use question_queuing to make it straight forward to i10n HTTP error
	messages. TODO: Freeing of http_error_info when freeing
	question_queue.  

Fri Feb 20 15:19:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.h, protocol/http/http.c:

	Fix do_auth_dialog() prototyping.  

Fri Feb 20 14:41:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: cookies/cookies.c, protocol/auth/dialogs.c,
	protocol/auth/dialogs.h, protocol/http/http.c, sched/session.c,
	sched/session.h:

	Make the question_queue more bottomhalf like taking data pointer.  

Fri Feb 20 14:24:48 2004  Varga Balzs <vinnui@ent.hu>:

	* po/hu.po:

	Updated hungarian translation.  

Fri Feb 20 10:56:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h:

	Disable exmode by default. It is not useful bloat.  

Fri Feb 20 06:26:12 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/uri.c:

	file_exists used instead of access.  

Thu Feb 19 20:43:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/dns.c:

	Make addrno writing/reading capable of dealing of partial
	write()s/read()s, this should fix random DNS failures on some
	systems with not-so-smooth-linux-glibc-like buffering.  

Thu Feb 19 17:48:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/dns.c:

	Be more paranoid about passing data from the async resolver.  

Thu Feb 19 15:43:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/stub.c:

	Fixed dangling 'unsigned'. Damn, people, this stuff has some given
	order ;-).  

Thu Feb 19 14:39:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/: stub.c, stub.h:

	Use strictly (char *) instead of (unsigned char *) in the stubs,
	because that's how these functions are defined in the system.
	Otherwise you will run into problems like different problems in
	conditional expressions on systems not having these, like fissie
	just reported.  

Thu Feb 19 14:30:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/stub.h:

	util/stub.h -> osdep/stub.h. Happenned on Jan 28 but Jonas didn't
	commit it.  

Wed Feb 18 21:52:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/tables.c:

	Remove bogus compiler bug notice, the bug is in me.  

Wed Feb 18 21:46:22 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS, src/document/html/tables.c:

	Prevent a crash caused by a compiler bug (?) on OS X 10.3.2/XCode
	1.1/gcc3.3, reported by Daniel Macks <dmacks@netspace.org>.  

Wed Feb 18 18:56:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/bookmarks.c:

	Try to fix session auto saving by using ses->loading_url if
	get_current_url() fails.  

Wed Feb 18 18:46:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix typeahead text drawing so the matched chars are properly
	highlighted.  

Wed Feb 18 14:03:10 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Feb 18 06:27:47 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/uri.c:

	When url is without protocol use file:// if file with filename ==
	url exist.  

Tue Feb 17 19:17:36 2004  Laurent Monin <zas@norz.org>:

	* src/protocol/http/http.c:

	ETag comparaison was fixed. We now take in account weakness or
	strongness of ETags, and compare them case-sensitively, compliance
	with RFC2616 section 3.11 and 13.3.3 was improved.  

Tue Feb 17 06:03:08 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/dialogs/menu.c:

	Added "Wrap text" menu entry.  

Mon Feb 16 06:33:19 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation update.  

Sun Feb 15 16:35:21 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Feb 15 16:33:40 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.inc:

	"\%u" -> "%u". Prevent i18n issues in Info box of these options.  

Sun Feb 15 12:49:30 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/uri.c:

	Do not decode %7E in filenames.  

Sun Feb 15 12:48:48 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: config/options.inc, viewer/dump/dump.c:

	Added configuration options:
	document.dump.{header,footer,separator}.  

Sun Feb 15 12:14:19 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/: renderer.c, renderer.h, tables.c:

	Add support for table bordercolor attribute. To keep this patch as
	simple as possible we do not honour bordercolor attributes in tr/td
	tags (yet). Table bgcolor applies to all cell borders.  

Sun Feb 15 06:57:09 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/main.c:

	ELinks should no connect to previous instances when act as a pager.  

Sat Feb 14 13:56:11 2004  Laurent Monin <zas@norz.org>:

	* src/util/color.inc:

	Some notes of where this color list comes from where added. It is
	unclear if there is any copyright on it. Let me know if it is the
	case. Suggested by Pasky.  

Sat Feb 14 00:53:04 2004  Laurent Monin <zas@norz.org>:

	* src/util/: color.inc, color_s.inc:

	cvs Id were added.  

Fri Feb 13 20:33:31 2004  Laurent Monin <zas@norz.org>:

	* src/util/: Makefile.am, color.c, color.inc, color_s.inc,
	fastfind.c:

	Color names <-> rgb was improved. ELinks now understands almost all
	color names, old and small color table was moved to
	src/util/color_s.inc and will be used if ELINKS_SMALL is defined,
	new extended one is in src/util/color.inc and is used by default.
	Fastfind stuff was changed to handle up to 1024 keys (needed).
	"gray" color value was changed from 0x808080 to correct 0xBEBEBE.  

Fri Feb 13 18:33:12 2004  Peter Samek <samek@upc.uniba.sk>:

	* po/sk.po:

	Slovak translation update.  

Fri Feb 13 18:08:21 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Feb 13 17:52:47 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/parser.c, intl/charsets.c, util/color.c,
	util/fastfind.c, util/fastfind.h:

	FastFind debugging features were improved: support for a comment,
	more stats. Tidy up.  

Fri Feb 13 17:11:30 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: bfu/leds.c, config/options.inc:

	Digital clock. Enable LEDs, timer and clock to make it work.  

Fri Feb 13 08:02:47 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: config/cmdline.c, config/cmdline.h, main.c:

	Removed obsolete option -stdin and stuff related with single url.  

Thu Feb 12 17:51:38 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/main.c:

	From now ELinks can act as pager.  

Thu Feb 12 17:11:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: link.c, search.c:

	Fix link typeahead fixups so current links will never be under the
	input line.  

Thu Feb 12 12:00:34 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Real translation update.  

Thu Feb 12 06:52:21 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Translation update.  

Wed Feb 11 11:44:24 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po, src/config/options.inc:

	A note about rename() on OS/2 and Win32 systems was added to
	secure_file_saving option description, french translation was
	updated.  

Wed Feb 11 11:22:21 2004  Laurent Monin <zas@norz.org>:

	* configure.in, src/util/secsave.c:

	Test for fflush() and fsync() presence, and act accordingly in
	secure_close().  

Wed Feb 11 10:19:31 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Feb 11 10:12:34 2004  Laurent Monin <zas@norz.org>:

	* src/: main.c, config/cmdline.c, config/options.c,
	lowlevel/connect.c:

	Useless spaces were trimmed.  

Wed Feb 11 09:53:31 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/search.c:

	Compilation fix: Define _GNU_SOURCE to have strcasestr() with glibc.  

Tue Feb 10 23:40:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, viewer/dump/dump.c:

	Restore the old handling of the url list in init(). dump_pre_start()
	just steals all the url strings and manages it's own queue.  

Tue Feb 10 20:29:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.h:

	struct list_head is expanded to list_head_elinks and we need to
	include the lists.h file or it could lead to bad things.  

Tue Feb 10 20:25:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Cleanup.  

Tue Feb 10 20:15:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Use strstr() for link typeahead matching so we don't only match from
	the start of the link text. It is a bit buggy for wrapped links
	though. Hmm.  

Tue Feb 10 19:15:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Reintroduce usage of link->name for typeahead search because it is
	so neat and it should be made to work.  

Tue Feb 10 18:45:46 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: protocol/file/file.c, osdep/osdep.c:

	Fixed reading from stdin.  

Tue Feb 10 17:17:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Trim leading spaces from the link text. Visible at the software map
	at sf.net and making it harder to link typeahead.  

Tue Feb 10 06:35:44 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: main.c, viewer/dump/dump.c, viewer/dump/dump.h:

	Support for many urls in dump mode.  

Mon Feb  9 12:06:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	input_line_event_handler(): Catch redraw events from the history tab
	completion so new buffer data is propagated to the line handlers.  

Mon Feb  9 11:51:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/file.c:

	get_unique_name(): Replace sprintf() with longcat().  

Mon Feb  9 11:33:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inphist.c:

	Cl33nup.  

Mon Feb  9 11:13:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inphist.c:

	A little almost-spring cleaning.  

Mon Feb  9 09:29:24 2004  Laurent Monin <zas@norz.org>:

	* src/util/secsave.c:

	Cleanup and simplification of secure_close(), error handling was
	improved and a potential file-not-closed-on-flush-errore was fixed.  

Mon Feb  9 02:59:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: inpfield.c, inphist.c, inphist.h:

	Minor simplification to make history completion functions work on
	dialog_data so it looks a bit higher level.  

Mon Feb  9 01:41:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inphist.c:

	Minor simplification.  

Mon Feb  9 01:33:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Add input line buffer to history when cycling next and previous
	item.  

Mon Feb  9 01:25:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Fight badly written spaghetti code with gotos.  

Sun Feb  8 20:36:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Expand the switch noodling to make it easy to add handlers for other
	terminal events. Yes I know it is not properly indented the elinks
	hacking.txt way, but I think that the extra indentation is just
	plain stupid and punishes the use of switch statments.  

Sun Feb  8 20:29:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, viewer/text/search.c:

	Remove the prompt member of the input_line struct. All we need is
	the data member.  

Sun Feb  8 20:20:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Remove stupid test.  

Sun Feb  8 20:15:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Use local widget_data variable to shorten lines.  

Sun Feb  8 17:37:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	No need to allocate another cache entry header. Just use existing
	one or empty string.  

Sun Feb  8 00:17:09 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/config/options.inc:

	s/ELINKS_LOCAL_CGI/CONFIG_CGI/ 

Sat Feb  7 10:58:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/download.c:

	Drawin the download notification dialog when having the download
	browser open is apparently a little racy. Deleting the box item will
	update the download browser _after_ the notification dialog has been
	drawn whereby it will be hidden. This should make the download
	browser update before launcing any notification by removing the list
	box item.  

Sat Feb  7 01:39:49 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/interlink.c:

	Use stricter mask for local socket creation, so socket is only
	readable/writable by its user on systems honouring unix sockets
	permissions (see unix(7)).  

Sat Feb  7 01:04:52 2004  Laurent Monin <zas@norz.org>:

	* src/util/secsave.c:

	Comments about secure_file_saving were updated.  

Sat Feb  7 00:58:56 2004  Laurent Monin <zas@norz.org>:

	* src/util/secsave.c:

	Use fflush()/fsync()/fclose() sequence to ensure data is written to
	disk when using secure saving. This is needed since fclose() only
	calls fflush() which only flush libc buffers, so while fclose() may
	have returned, data may still be in kernel buffers. See fclose(2),
	fflush(2) and fsync(2) man pages for more information.  

Fri Feb  6 22:41:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inphist.h, config/urlhist.c, dialogs/exmode.c,
	dialogs/menu.c, globhist/globhist.c, scripting/lua/core.c,
	viewer/text/search.c:

	Use macros for input history initialization.  

Fri Feb  6 18:38:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: renderer.c, html/renderer.c, plain/renderer.c:

	Move cache entry defragmentation checking to render_document().  

Fri Feb  6 15:58:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Make sort_links() static.  

Fri Feb  6 13:03:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, config/opttypes.c, util/color.c,
	util/color.h:

	get_color_name() -> get_color_string(), and take a hex color buffer
	as arg that will be filled and returned if no color name is found.  

Fri Feb  6 12:49:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, config/opttypes.c, util/color.c,
	util/color.h:

	get_color_name(): Don't allocate the returned color name.  

Fri Feb  6 12:47:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	Cleanup.  

Fri Feb  6 12:31:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, config/options.h, globhist/dialogs.c:

	I was reading through some old patches and it reminded me that it
	would maybe be better to let the option value union have a
	big_number member of type long.  

Thu Feb  5 23:19:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix assert() failure in documents without links. Reported by Miciah.  

Thu Feb  5 23:17:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/tables.c:

	Fix assertm() reported by Daniel Macks <dmacks@netspace.org>.  

Thu Feb  5 19:47:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Make text searching also honour the show_not_found option. So
	browsing search history in typeahead mode is actually useful.  

Thu Feb  5 19:43:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Minor cleanup.  

Thu Feb  5 19:33:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Add to history if we receive an ACT_EDIT_ENTER and the widget has
	history.  

Thu Feb  5 19:26:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Minimize the (now pretty useless) mode change hacks to just call
	search_typeahead().  

Thu Feb  5 19:20:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Then of course there is this thing called search history that text
	typeahead should have.  

Thu Feb  5 19:18:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c,
	viewer/text/search.c:

	Make the various typeahead directly accessible via actions (-link,
	-text and -text-back). Fixes some of bug 378 atleast.  

Thu Feb  5 16:46:25 2004  Laurent Monin <zas@norz.org>:

	* src/formhist/Makefile.am:

	Do not add formhist.o twice to libformhist.a. Reported by Daniel
	Macks.  

Thu Feb  5 15:46:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Thou shall always check if get_next_scanner_token() returns NULL.
	Fixes reappearing of bug 372 'crashes if <style> tag is cut off in
	fragment/file'.  

Thu Feb  5 12:52:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: dialogs/exmode.c, protocol/rewrite/rewrite.c,
	protocol/rewrite/rewrite.h:

	Removed URI prefixes availability in exmode. It is wrong from the
	design standpoint, you have the goto url dialog for that (or just
	goto-url action arguments, for that matter).  

Thu Feb  5 11:03:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	fixup_typeahead_match(): Scrolling might update the current link but
	we don't want that so reset it to the matched one.  

Thu Feb  5 10:29:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix typeahead link text coloring. If something already were typed we
	need to redraw in order to remove the coloring of the link text.  

Thu Feb  5 10:18:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: search.c, view.c, view.h:

	A nice little hack that will scroll the document view if the matched
	link is under the typeahead input line.  

Thu Feb  5 10:03:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Color the typeahead text of the current link.  

Thu Feb  5 00:22:31 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* src/bookmarks/backend/xbel.c:

	Avoid crash when saving files with encoding != UTF-8.  

Wed Feb  4 23:13:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/conf.c, config/conf.h, dialogs/exmode.c:

	parse_config_command()'s @file updates propagate. This should fix
	the on-startup infinite loop.  

Wed Feb  4 16:24:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/cmdline.c:

	Command line options for redirects should not be listed with -help.
	Besides it looks hella ugly.  

Wed Feb  4 14:12:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/osdep/getifaddrs.c:

	max()? What max()? 

Wed Feb  4 13:58:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/exmode.c:

	Include the needed files.  

Wed Feb  4 13:58:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/conf.c, dialogs/exmode.c:

	Compilation fix.  

Wed Feb  4 13:57:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/conf.c, config/conf.h, dialogs/exmode.c:

	Allow config file commands (set, bind) to be executed from exmode.
	This involves exporting of parse_config_command() and enum
	parse_error.  

Wed Feb  4 13:27:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Random tidyup.  

Wed Feb  4 13:00:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Simplification of parse_config_file() --- removed the test_end label
	+ goto.  

Wed Feb  4 12:59:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Surged out the very command parsing multiplexer from
	parse_config_file() to parse_config_command().  

Wed Feb  4 12:51:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/exmode.h:

	Trailing whitespaces police strikes.  

Tue Feb  3 20:37:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Fix leak when viewing empty files.  

Tue Feb  3 20:31:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/search.c, viewer/text/search.h:

	Make the third arg of find_next() mean the direction. Thus making it
	possible to remove find_next_back().  

Tue Feb  3 20:12:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Try to make the @a arg to find_next() a bit more clear and remove
	the use for it.  

Tue Feb  3 20:04:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Cleanup.  

Tue Feb  3 19:28:04 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Feb  3 19:20:01 2004  Laurent Monin <zas@norz.org>:

	* configure.in, src/config/cmdline.c, src/lowlevel/connect.c,
	src/osdep/Makefile.am, src/osdep/getifaddrs.c,
	src/osdep/getifaddrs.h:

	Option -localhost now matches against all local addresses, gathered
	by getifaddrs() function, either from system or if not available
	from the new osdep/getifaddrs.{c,h} files. Please test heavily for
	cross platforms issues.  

Tue Feb  3 18:59:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/: search.c, search.h:

	Make search_for and search_for_back static.  

Tue Feb  3 18:56:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/search.c, viewer/text/search.h:

	search_dlg(): Now both initiates forward and backward search dialogs
	depending on @a.  

Tue Feb  3 18:38:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Use document->nsearch as counter to get rid of disturbing macro.  

Tue Feb  3 16:00:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fix leak of selector list when the syntax is all wrong.  

Tue Feb  3 10:12:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Fix some swappage that led to an internal error when one selected
	extended regexes in the search box and searched.  

Mon Feb  2 16:20:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	detach_formatted() should already take care of these.  

Mon Feb  2 16:11:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/document.h:

	Describe tags and nodes and then move things a bit.  

Mon Feb  2 15:58:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/document.h:

	Cleanup.  

Mon Feb  2 15:40:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Typeahead is not a hack anymore.  

Mon Feb  2 15:32:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	search_link_text(): Spit and polish.  

Mon Feb  2 15:24:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	search_link_text(): Cleanup initialisation of variables.  

Mon Feb  2 15:19:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Decrease indentation level.  

Mon Feb  2 15:12:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Move link text searching to separate function.  

Mon Feb  2 15:04:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Rename charpos -> textlen, typeahead -> text, doc_view->document ->
	document.  

Mon Feb  2 13:54:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.h:

	Make dump_scanner() available if SCANNER_DEBUG is defined. Fix typo.
	Add state member to struct scanner useful for SGML scanner.  

Mon Feb  2 09:52:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Don't show error dialogs for missing CSS stylesheets.  

Sun Feb  1 16:43:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Try to fix precedence checking for background property parsing.  

Sun Feb  1 16:42:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Some more checks needed for supporting NUL chars in cache data.  

Sun Feb  1 15:56:25 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	check_if_local_address6() is only if IPV6 is defined.  

Sun Feb  1 15:11:53 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	Wrap tests for local addresses to functions.  

Sun Feb  1 13:35:29 2004  Laurent Monin <zas@norz.org>:

	* src/lowlevel/connect.c:

	Save first errno to display proper error message. Use
	@at_least_one_remote_ip to clarify things.  

Sun Feb  1 05:52:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Some more checks needed for supporting NUL chars in cache data.  

Sun Feb  1 00:13:13 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was improved a bit.  

Sun Feb  1 00:07:22 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Jan 31 14:10:41 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Translation update.  

Sat Jan 31 06:00:05 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/file/cgi.c:

	First parameter should be basename not full path.  

Sat Jan 31 00:58:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	Cleanup.  

Sat Jan 31 00:43:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: css.c, stylesheet.h:

	Ensure that the CSS @import can only be nested < MAX_REDIRECTS.  

Sat Jan 31 00:40:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/connect.c:

	Dropped @not_local_count, instead fail with S_LOCAL_ONLY only if the
	last attempt was local, because we do not have errno of previous
	non-local attempts.  

Sat Jan 31 00:37:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/connect.c:

	Tidyup.  

Sat Jan 31 00:36:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/connect.c:

	Do all the @local-testing things only if @only_local.  

Sat Jan 31 00:30:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/dialog.c:

	ACT_MENU_PREVIOUS_ITEM support, instead of the previous horrid
	ev->y+ACT_MENU_NEXT_ITEM hack.  

Sat Jan 31 00:29:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/search.c:

	ACT_EDIT_PREVIOUS_ITEM support.  

Sat Jan 31 00:28:37 2004  Laurent Monin <zas@norz.org>:

	* src/: config/cmdline.c, lowlevel/connect.c, sched/connection.h,
	sched/error.c:

	A new commandline option was introduced: -localhost, it limits
	elinks connections to loopback addresses for now, and with your help
	will limit to local addresses soon.  

Sat Jan 31 00:23:08 2004  Laurent Monin <zas@norz.org>:

	* src/config/: kbdbind.c, kbdbind.h:

	Compilation fix....  

Fri Jan 30 23:01:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Added default keybinding to previous-(item|frame) to alt-tab, idea
	by Miciah.  

Fri Jan 30 22:38:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Use option 'cache' for search dialog checkbox values.  

Fri Jan 30 19:54:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, config/options.h, dialogs/options.c:

	Generalize the terminal option cache thingy.  

Fri Jan 30 19:25:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Fix page down, scroll and end handling by using document view height
	and _not_ ... ;-) 

Fri Jan 30 19:13:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/inpfield.c,
	bfu/listbox.c, bfu/menu.c, terminal/event.h, terminal/kbd.c,
	viewer/text/view.c:

	Wrap mouse bit magic in macros. Actions too.  

Fri Jan 30 19:01:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/button.c, bfu/checkbox.c, bfu/inpfield.c,
	bfu/listbox.c, bfu/menu.c, bfu/text.c, terminal/event.h,
	terminal/kbd.c, viewer/text/view.c:

	Wrap mouse bit magic in macros.  

Fri Jan 30 18:36:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Minor cleanup.  

Fri Jan 30 18:28:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Always compare to the current document view height and width and
	_not_ document options height or width. Fixes detection of links
	from mouse clicks when the terminal has been resized after the first
	rendering. Reported by zas.  

Fri Jan 30 18:16:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Compile fix.  

Fri Jan 30 15:25:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: css.c, parser.c, parser.h:

	css_parse_stylesheet() now takes @end variable. BTW idea by Zardoz.  

Fri Jan 30 15:15:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/apply.c, document/css/parser.c,
	document/css/scanner.c, util/scanner.c, util/scanner.h:

	Add end member to the scanner struct so we can start to support NUL
	chars in cache data.  

Fri Jan 30 10:14:25 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jan 30 08:22:23 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Standardization.  

Fri Jan 30 07:35:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Now with proper header comments and new options.  

Fri Jan 30 07:33:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/tools/help2doc:

	Out put proper .\" comments.  

Thu Jan 29 13:32:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Make the selector mirroring function take only the property list of
	the original selector so that the ruleset parser can use an empty
	list. Should fix properties of already known selectors being added
	to others in the grouping.  

Thu Jan 29 13:21:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/parser.c, util/scanner.h:

	Some lame way of skipping current token.  

Thu Jan 29 13:10:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h:

	Eh .. revert feature.h change.  

Thu Jan 29 13:08:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/document/css/parser.c, test/css/styletags.html:

	Add testing of the handling of selector groupings. It should that we
	need to pass css_parse_properties() an empty list head so that
	previous values do not end up being added to all other selectors.  

Thu Jan 29 13:02:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	Add selector grouping without block.  

Thu Jan 29 12:58:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Always check the returned value of get_scanner_token(). Don't check
	whether we skip to next ',' since the check at the start of the loop
	should catch it for us.  

Thu Jan 29 12:47:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Make the selector parsing a little less ambitious (don't allocate
	anything) and more tolerant.  

Thu Jan 29 12:16:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Raise the document.dump.width/-dump-width limits from 40/512 to
	1/65536.  

Thu Jan 29 11:09:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Only check if control char for the first char that is typed ahead.  

Thu Jan 29 07:54:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	'#?' now means search back.  

Thu Jan 29 07:49:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Make '##' mean that no more control chars should be checked .. so
	that '/' can be typed as first char in link typeahead.  

Thu Jan 29 07:31:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: inpfield.c, inpfield.h:

	Add prompt member to struct input_line.  

Thu Jan 29 07:21:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Move text_typeahead_handler() up before link_typeahead_handler.  

Thu Jan 29 07:18:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, dialogs/exmode.c,
	viewer/text/search.c:

	Add data member to struct input_line.  

Thu Jan 29 07:15:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, dialogs/exmode.c,
	viewer/text/search.c:

	(Re)introduce a struct for maintaining input line data.  

Thu Jan 29 04:19:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Move selector lookup to end of loop so we don.t have to handle
	allocation if there is a syntax error.  

Thu Jan 29 04:16:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Make selector variable local.  

Thu Jan 29 04:13:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Use while loop instead of gotos so a lot of indenting.  

Thu Jan 29 04:05:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Don.t use static list head but simple pass it from the ruleset
	parser.  

Wed Jan 28 22:03:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/main.c:

	Fixed memory leak in case of wrong option.  

Wed Jan 28 20:06:50 2004  Varga Balzs <vinnui@ent.hu>:

	* po/hu.po:

	Translation update.  

Wed Jan 28 19:38:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Experimental support for the 'unset' command. It is useful in order
	to be able to get rid of the default external protocol handlers.  

Wed Jan 28 18:41:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/textarea.c:

	Fixed a hole in the anonymous mode - user could launch the external
	editor and obviously then do whatever he wants there. Discovered by
	Solar Designer <solar@openwall.com>.  

Wed Jan 28 13:35:07 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation update.  

Wed Jan 28 10:39:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	A happy hacking verion of typeahead for text searches. Type '#/' and
	pray that you will never have to typeahead to a link text starting
	with /. :P 

Wed Jan 28 09:18:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c:

	Add a toggle-css action so it is easier to see what it actually adds
	to the rendering. By default bound to '_' but maybe it shouldn't
	have one.  

Wed Jan 28 08:23:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix backspacing when typing ahead.  

Wed Jan 28 08:13:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, dialogs/exmode.c,
	viewer/text/search.c:

	Use enum for return values of input line handlers.  

Wed Jan 28 07:57:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	A few comments. Thanks for cheering Quazgaa ;) 

Wed Jan 28 07:53:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, viewer/text/search.c:

	Move error function calling to typeahead input event handler.  

Wed Jan 28 07:39:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Check if there is typeahead text in the input handler.  

Wed Jan 28 07:35:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	When backspacing we just stay with the current link so let.s not
	waste any effort on it.  

Wed Jan 28 07:32:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Minor cleanup.  

Wed Jan 28 07:30:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Remove some more events that kbd_field() takes care of.  

Wed Jan 28 07:28:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, dialogs/exmode.c, viewer/text/search.c:

	Handle ACT_EDIT_CANCEL at top level.  

Wed Jan 28 07:24:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Bail out earlier if there is no chars to search for.  

Wed Jan 28 07:18:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, dialogs/exmode.c:

	Handle basic input line events. We have to do them before calling
	kbd_field().  

Wed Jan 28 06:43:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/status.c, sched/session.h, viewer/text/search.c,
	viewer/text/search.h, viewer/text/view.c:

	Use input line interface for link typeahead. Removing all the cheap
	hacks and nicely encapsulates typeahead functions. Basicly the code
	from frame_ev() is now the input line handler that just grabs
	current doc_view and uses do_typeahead() as backend. All buffer
	management was purged from do_typeahead() but it should still be
	cleaned up and fine tuned.  

Wed Jan 28 06:34:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inpfield.c:

	Fix logic.  

Wed Jan 28 06:16:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Revert typeahead part of last patch.  

Wed Jan 28 06:14:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, dialogs/exmode.c,
	viewer/text/search.c:

	Make the input line dialog inteface handle the low level event
	stuff.  

Wed Jan 28 05:44:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, bfu/inpfield.h, dialogs/exmode.c:

	Move generic input line stuff to bfu/.  

Wed Jan 28 05:40:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Also pass the event handler to the input line initializer.  

Wed Jan 28 05:30:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	A few exmode -> input_line renames.  

Wed Jan 28 05:22:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Move generic input line stuff to separate function which
	exmode_start() wraps.  

Wed Jan 28 05:18:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Get rid of the exmode_data struct and just allocate like all other
	dialogs.  

Wed Jan 28 05:07:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Make exmode_exec() take only session and command buffer.  

Wed Jan 28 05:05:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Remove unused exmode data member.  

Wed Jan 28 02:56:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	add_document_node() now takes renderer as arg. Add compress as
	renderer member.  

Wed Jan 28 02:39:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Describe other plain_renderer members.  

Wed Jan 28 02:37:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Maintain current line number in struct plain_renderer.  

Wed Jan 28 02:32:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Make the template char part of struct plain_renderer.  

Wed Jan 28 02:29:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Pass renderer struct on to add_document_line().  

Wed Jan 28 02:25:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Bail out if there is no fragment data .. add_document_lines()
	asserts(!length).  

Wed Jan 28 02:18:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Add max_width member to struct plain_renderer used for doc_width
	calculation.  

Wed Jan 28 02:13:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Minor cleanups.  

Wed Jan 28 02:09:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Introduce a plain renderer struct.  

Wed Jan 28 01:34:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.c:

	Move init_scanner_info() to initializers and inline it.  

Wed Jan 28 01:32:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, util/scanner.c, util/scanner.h:

	map_scanner_string(): Now just takes the scanner as arg.  

Wed Jan 28 01:26:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/apply.c, document/css/parser.c,
	document/css/scanner.c, document/css/scanner.h, util/scanner.c,
	util/scanner.h:

	init_css_scanner() -> init_scanner() .. and move to util/.  

Wed Jan 28 01:23:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/apply.c, document/css/parser.c,
	document/css/scanner.c, document/css/scanner.h, util/scanner.h:

	Add initialized flag to struct scanner_info. Pass scanner_info to
	scanner initializer.  

Wed Jan 28 01:16:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, util/scanner.h:

	Make the scanner struct reference the scanner_info struct and move
	the scan() function to struct scanner_info.  

Wed Jan 28 01:12:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/scanner.h:

	Move scanner info stuff up before struct scanner.  

Wed Jan 28 00:57:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/scanner.c, document/css/scanner.h,
	util/Makefile.am, util/scanner.c, util/scanner.h:

	Give the generic scanner utilities a temporary home in util/.  

Wed Jan 28 00:42:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: elinks.h, osdep/Makefile.am, osdep/stub.c,
	util/Makefile.am, util/stub.c, util/stub.h:

	util/stub.* -> osdep/stub.* 

Wed Jan 28 00:38:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, protocol/http/Makefile.am,
	protocol/http/blacklist.c, protocol/http/http.h, util/Makefile.am,
	util/blacklist.c, util/blacklist.h:

	util/blacklist.* -> protocol/http/blacklist.* 

Wed Jan 28 00:35:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: osdep/stub.c, util/stub.c:

	Blank lines.  

Wed Jan 28 00:27:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Groups scanner c file in a generic part and a CSS part. Moving
	macros to header.  

Wed Jan 28 00:20:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Groups scanner head in a generic part and a CSS part.  

Wed Jan 28 00:15:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make the language specific token scanner part of the scanner struct
	so it is well hidden.  

Wed Jan 28 00:11:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h, value.c:

	css_token functions -> scanner_token.  

Wed Jan 28 00:04:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, parser.c, parser.h, property.h,
	scanner.c, scanner.h, value.c, value.h:

	css_scanner -> scanner.  

Wed Jan 28 00:00:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h, value.c:

	struct css_token -> struct scanner_token.  

Tue Jan 27 23:54:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	CSS_SCANNER_* -> SCANNER_*.  

Tue Jan 27 23:51:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make precedence checking more generalized. It is now a member of the
	token struct and should be passed to the skip function.  

Tue Jan 27 23:08:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Fixed an apparently missing break (Jonas?) in the atrule parser,
	reported by <M.Miroslaw@elka.pw.edu.pl>.  

Tue Jan 27 20:05:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Remove support for talking scanners. It has to be added in a saner
	way.  

Tue Jan 27 19:08:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Have @name of the selector extracted in the same way as everything
	else.  

Tue Jan 27 18:45:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Allow namelen==-1 for init_css_selector() ergo get_css_selector().  

Tue Jan 27 18:43:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	When parsing a selector, save id/class/pseudo to separate variables
	instead of @selector members.  

Tue Jan 27 10:37:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	Make it more clear how the action table in menu_keys() toggling is
	build.  

Tue Jan 27 02:28:33 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/selectors.html:

	Some simple selector support tests.  

Tue Jan 27 02:28:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Throw away id/class/pseudo selectors for now. They are just spoiling
	things by applying some specific styles to all the element instances
	etc. It is easy to reenable when we'll start really supporting them.  

Tue Jan 27 02:23:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	mem_free(pkg) properly even in the worst situation.  

Tue Jan 27 02:22:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Do not be so pathetic and do not free selector's id/class/pseudo
	upon syntax error... it's gonna bring us only trouble.  

Tue Jan 27 02:16:06 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/cascading.html:

	Trivial cascading testcase.  

Tue Jan 27 02:09:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Grm.  

Tue Jan 27 02:07:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Free up the selectors after we're done with them.  

Tue Jan 27 02:05:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Use kludgy wrapper struct selector_pkg to pass selectors around.  

Tue Jan 27 01:23:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Why it doesn't matter that we have multiple same properties in one
	selector.  

Tue Jan 27 01:15:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Misc. compilation fixes.  

Tue Jan 27 01:14:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Typo fix.  

Tue Jan 27 01:13:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: stylesheet.c, stylesheet.h:

	Erhm, fixed the hybridness of mirror_css_selector().  

Tue Jan 27 01:12:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Support for multi-selector rulesets (sel1,sel2,sel3{rule}).  

Tue Jan 27 01:05:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Way back, committed the wrong file. Sorry 'bout that.  

Tue Jan 27 01:03:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Fixed init_css_selector() call.  

Tue Jan 27 01:03:40 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c:

	Oops, clone_css_selector() is actually used.  

Tue Jan 27 00:54:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	CSS_TOKEN_HASH/HEX_COLOR already contain the token string of ident,
	as pointed out by Jonas.  

Tue Jan 27 00:52:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Disable the unused functions.  

Tue Jan 27 00:49:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: css/apply.c, css/stylesheet.c, css/stylesheet.h,
	html/parser.c:

	Mirror @default_stylesheet to @css_styles in
	init_html_parser_state() so that we will not need to let the cascade
	fall into two stylesheets but only one. The real benefits will show
	as we will start to support more complex selectors, and it should be
	faster (can you spare a bit of memory, bro'?).  

Tue Jan 27 00:42:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	If we're fixing memory leaks...  

Tue Jan 27 00:24:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Fixed init_css_stylesheet() to also initialize selectors list.  

Tue Jan 27 00:23:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, stylesheet.c, stylesheet.h:

	Support for proper styles cascading. Hopefully.  

Tue Jan 27 00:16:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Construct a virtual selector for the style attribute instead of just
	properties list.  

Tue Jan 27 00:14:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: stylesheet.c, stylesheet.h:

	Export (init|done)_css_selector().  

Tue Jan 27 00:13:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Moved (struct css_selector) destructor to done_css_selector().  

Tue Jan 27 00:11:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.c:

	Make it possible to have NULL @css and/or @name passed to
	get_css_selector().  

Tue Jan 27 00:07:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Use static inlines instead of macros for token getter.  

Mon Jan 26 23:56:17 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* src/document/css/parser.c:

	Prevent a memleak.  

Mon Jan 26 23:37:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Chop indent2type to pieces. One generic part now does the table look
	up and the table is now also part of the scanner_info .. for no good
	reason it seems.  

Mon Jan 26 23:37:08 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* src/document/css/parser.c:

	s/css/scanner in get_next_css_token() calls.  

Mon Jan 26 23:30:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	struct css_indentifier -> struct scanner_string_mapping.  

Mon Jan 26 23:23:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	Fixed init_css_stylesheet() decl.  

Mon Jan 26 23:22:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: stylesheet.c, stylesheet.h:

	Introduced init_css_stylesheet().  

Mon Jan 26 23:18:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/README:

	Removed the horrible uniform indentation ;-).  

Mon Jan 26 23:03:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c:

	get_css_selector() now has init_css_selector() as internal backend
	and first does find_css_selector() and then init() if that one was
	unsuccessful; similiar to cache_entry obtainers.  

Mon Jan 26 23:01:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Add '.' to char token group. It's needed for class selectors.  

Mon Jan 26 23:00:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	Group selector functions.  

Mon Jan 26 23:00:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, stylesheet.c, stylesheet.h:

	get_css_selector() -> find_css_selector(), init_css_selector() ->
	get_css_selector() 

Mon Jan 26 22:59:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Use scanner_info struct for holding the scanner's scan table and
	scan table initialization info.  

Mon Jan 26 22:57:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Added support for some parsing of id/class/pseudo selectors.  

Mon Jan 26 22:50:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Move CSS scan table info up after the char group enum.  

Mon Jan 26 22:44:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix last patch. Only generic scanner stuff. ;) 

Mon Jan 26 22:40:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Move generic scanner stuff to start of file.  

Mon Jan 26 22:36:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	More assertions for the scan table ranges.  

Mon Jan 26 21:54:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: options.h, css/apply.c, html/parser.c,
	html/renderer.c:

	Also check color_mode != MONO in the document color macros. Rename
	so their usage is a bit more clear to use_document_(fg|bg)_colors().  

Mon Jan 26 21:15:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Improve the use of use_document_colors and color_mode options.  

Mon Jan 26 20:21:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/stylesheet.h:

	Blank lines.  

Mon Jan 26 18:52:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/dialogs/exmode.c, src/dialogs/menu.c,
	src/sched/action.c:

	Plug exmode into the configuration system (CONFIG_EXMODE).  

Mon Jan 26 18:27:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Surge out the selector parser to css_parse_selector().  

Mon Jan 26 18:06:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Always assume it's ruleset if it's not @rule, not only if the token
	is CSS_TOKEN_IDENT. And couple of TODOs.  

Mon Jan 26 17:20:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.c, scanner.c, scanner.h:

	Prefix tokens based on CSS_TOKEN_AT_KEYWORD by AT_.  

Mon Jan 26 11:58:29 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jan 26 08:14:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Fix backspace quiting so it don't all backspaces.  

Mon Jan 26 08:11:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Map ACT_MAIN_QUIT to ACT_MAIN_REALLY_QUIT.  

Mon Jan 26 08:05:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Backspace in empty buffer now quits.  

Mon Jan 26 08:05:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Cleanup.  

Mon Jan 26 07:00:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Make exmode URI rewriting a little more powerful by checking a few
	control chars. ':fm&' or ':g elinks &' will open the rewritten URI
	in a new backgrounded tab while adding a '+' to the end will open in
	a new tab.  

Mon Jan 26 06:26:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Remove leading ':'s from the exmode command.  

Mon Jan 26 06:24:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Rename end -> args.  

Mon Jan 26 06:20:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/exmode.c, protocol/rewrite/rewrite.c,
	protocol/rewrite/rewrite.h:

	Make it possible to use URI rewrite prefixes from the exmode line.
	It involves a little exposing of URI rewrite internals.  

Mon Jan 26 06:07:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Call cancel_dialog() instead of delete_window().  

Mon Jan 26 06:04:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Move action handling to new exmode_handler 'interface'. This will
	make it easier to add more bloat.  

Mon Jan 26 05:50:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/: exmode.c, exmode.h, menu.c:

	Add exmode history.  

Mon Jan 26 05:45:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Complete make-over of the exmode handling. We now plug it directly
	into the dialog matrix making it possible to remove tons of
	duplicate code. Besides it will make it easier to get history up and
	running. I don.t expect anyone to read this big patch but understand
	that I think it is justified both because the exmode code is still
	pretty new and so major change should not be a threat to any kind of
	old features and finally "let the garbage man handle the garbage".
	;) 

Mon Jan 26 05:36:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: dialog.c, dialog.h:

	Make it possible to get rid of all that fancy dialog stuff and only
	draw widgets.  

Mon Jan 26 05:06:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/README:

	We handle import now as well.  

Mon Jan 26 04:47:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Allocate the exmode buffer with together with the data.  

Mon Jan 26 04:42:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Add dialog struct to exmode_data and make inpfield member reference
	the dialog widget.  

Mon Jan 26 04:16:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Make exmode_data->inpfield_data point to
	exmode_data->dlg_data->widget_data.  

Mon Jan 26 04:10:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/rewrite/rewrite.c:

	get_prefix() -> get_uri_rewrite_prefix(), substitute_url() ->
	rewrite_uri().  

Sun Jan 25 15:28:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/exmode.c:

	Get the exmode rolling by supporting action execution. Also
	':goto-url fm' should work.  

Sun Jan 25 14:43:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	Fix Help -> Keys toggling.  

Sun Jan 25 14:24:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c:

	Trim the main mappings. Only those currently in use remains.  

Sun Jan 25 14:10:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	Trim the menu mappings. Only those currently in use remains.  

Sun Jan 25 14:04:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Moved delete_keybinding() in front of add_keybinding().  

Sun Jan 25 14:03:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	delete_keybinding() now drops @kb's KBDB_DEFAULT flag before
	free_keybinding() so that it's really *always* deleted. However its
	only user add_keybinding() sets KBDB_DEFAULT for the new keybinding
	taking place of the original default keybinding, so that if the new
	one is removed by the user, it is written to the configfile. This
	should fix the tons of none-binds appearing in configfile now.  

Sun Jan 25 13:59:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: inphist.c, listmenu.c:

	Fix usage of ACT_MENU_NONE for menu entry actions. We should use
	main mapping everywhere for that.  

Sun Jan 25 13:57:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	I hope this is right. Use edit key map for exmode.  

Sun Jan 25 13:53:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	Trim the edit mappings. Only those currently in use remains.  

Sun Jan 25 13:52:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: kbdbind.c, kbdbind.h:

	Do not export delete_keybinding().  

Sun Jan 25 13:51:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Use ACT_EDIT_CANCEL for bailing out of exmode.  

Sun Jan 25 13:20:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Remove actions that are clearly not ACT_MAIN_.  

Sun Jan 25 13:17:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.h, bfu/text.c, config/dialogs.c, config/kbdbind.c,
	config/kbdbind.h, dialogs/info.c, dialogs/menu.c,
	dialogs/options.c, mime/dialogs.c, sched/action.c,
	viewer/text/link.c, viewer/text/view.c:

	s/ACT_/ACT_MAIN_/. Geronimooooo!! 

Sun Jan 25 13:09:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/dialogs.c:

	Swapped action/keymap guessing from item udata, therefore fixing
	adding a keybinding.  

Sun Jan 25 13:05:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	s/ACT_MENU_NONE/ACT_MAIN_NONE/ .. all menu entry actions are really
	main actions.  

Sun Jan 25 13:03:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/dialogs.c:

	Trivial tidyup.  

Sun Jan 25 13:03:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	assert() keymap when using it to lookup in action_table[].  

Sun Jan 25 12:52:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: inphist.c, listmenu.c, menu.c:

	Use ACT_MENU_NONE for menu actions.  

Sun Jan 25 12:47:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/exmode.c:

	Even more ACT_MENU_ usage.  

Sun Jan 25 12:44:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	More ACT_MENU_ usage.  

Sun Jan 25 12:38:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inpfield.c, viewer/text/form.c:

	s/ACT_/ACT_EDIT_/ 

Sun Jan 25 12:38:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	s/ACT_/ACT_MENU_/ 

Sun Jan 25 12:03:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Add 'Space' -> ' ' to @key_table and remove its special handling
	from make_keystroke().  

Sun Jan 25 10:19:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/kbdbind.c:

	Tiny whitespace fix.  

Sun Jan 25 10:18:48 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/kbdbind.c:

	In make_keystroke, if !escape, print '<space>' instead of ' '. This
	affects the keybinding manager and Help->Keys box.  

Sun Jan 25 09:55:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Don.t add CSS to globhist.  

Sun Jan 25 09:48:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/info.c:

	menu_keys() message box currently only have on button.  

Sun Jan 25 09:33:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.c, document/document.h,
	document/options.c, document/options.h, document/css/css.c,
	document/css/css.h, document/html/parser.c, document/html/parser.h,
	document/html/renderer.c, sched/connection.h, sched/session.c:

	Add support for importing external stylesheets. It is done using the
	import callback to add urls to a new document->css_imports string
	list via html_special(). The patch also introduces an option for
	controling whether external stylesheets should be imported
	(document.css.import). Downloading of stylesheets have special
	PRI_CSS priority that amongst other things is used to avoid any
	ses_chktype() calls from file_end_load() so atleast it is useful.  

Sun Jan 25 08:17:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Remove some pseudo code. It messes up the css import patch.  

Sun Jan 25 07:31:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	When reloading use the original priority for files to load and not
	the hardcoded PRI_FRAME. This is needed for importing CSS documents.  

Sun Jan 25 07:19:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Sort the many CSS options.  

Sun Jan 25 05:02:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/css.c, css/parser.c, css/stylesheet.c,
	css/stylesheet.h, html/parser.c:

	Use callback for imports. It seems more easy and straight forward
	now. Any import will then be loaded and added before the rest of the
	stylesheet it was imported from. For the html parser we will just
	check cache to see if we can go ahead and parse it or need to call
	special_f(). Oh an patch is loaded with fixes for last patch.  

Sun Jan 25 04:20:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Ok .. read_encodede_file() wants the filename in a MAX_STR_LEN
	buffer so let's give it just that so it doesn't cause memory
	corruptions in try_encoding_extensions().  

Sun Jan 25 03:42:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c:

	Support url() imports. It seems importing non existing files cases
	memory corruption.  

Sun Jan 25 03:16:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c:

	We now trim string and url() tokens so token->string and
	token->length only contains the information we are interested in.  

Sun Jan 25 02:35:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Generate url() tokens.  

Sun Jan 25 02:10:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Try to handle imports for the default stylesheet. Very inefficient.
	We need some merge_stylesheet() and some kind of rating to control
	what gets in and what not.  

Sun Jan 25 02:08:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Add string list import member to struct css_stylesheet.  

Sun Jan 25 01:33:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/css.c, css/stylesheet.h, html/parser.c:

	Use macro for static initialization of stylesheets.  

Sun Jan 25 01:27:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	css_parse_stylesheet(): Use a switch in the main loop so all @-rule
	tokens are routed to css_parse_atrule().  

Sun Jan 25 01:20:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, sched/session.c, terminal/tab.c,
	util/string.c, util/string.h:

	Make add_to_string_list() take length of added string. -1 means call
	strlen().  

Sun Jan 25 00:27:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/stylesheet.h:

	Describe stylesheet structs.  

Sun Jan 25 00:24:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/menu.c:

	Put a separator between the togglers and info/reload in the View
	menu.  

Sun Jan 25 00:23:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/menu.c:

	Moved ACT_RELOAD from File to View. This is maybe a little
	controversial, but well... ;) 

Sun Jan 25 00:21:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	sched/action.c:

	Added ACT_(MAIN_)RERENDER, by default not bound to anything, but
	available through the View menu. It rerenders the current document,
	thing useful in such a wide variety of scenarios.  

Sun Jan 25 00:11:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/info.c:

	Fixed more compilation problems.  

Sun Jan 25 00:09:50 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/info.c:

	Fixed misplaced #endif.  

Sun Jan 25 00:09:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Some other compilation fixes.  

Sun Jan 25 00:07:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Some compilation fixes.  

Sun Jan 25 00:04:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.h:

	...and also add the missed actions to the other keymap enums.  

Sun Jan 25 00:01:38 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.h:

	Reintroduced actions accidentally removed from enum main_action.  

Sat Jan 24 23:58:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/listbox.c, bfu/menu.c,
	viewer/text/search.c:

	Use keymap-specific enum names for non-main actions.  

Sat Jan 24 23:55:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Add TODO about updating format cache when default stylesheet has be
	reloaded.  

Sat Jan 24 23:50:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/listbox.c, bfu/menu.c,
	bfu/menu.h, config/kbdbind.h, dialogs/info.c, sched/action.c,
	sched/action.h, viewer/text/search.c, viewer/text/view.c:

	enum action -> enum {main,edit,menu}_action, edit,menu being just
	mindless clones of main now.  

Sat Jan 24 23:33:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/info.c:

	Removed KEYACTS, which has no business in the modern actions
	organization. This also means one dirty'n'quick hack for
	@action_box_items and temporarily disabling menu_keys() toggling
	until the water will be calm again.  

Sat Jan 24 23:25:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: dialogs.c, kbdbind.c, kbdbind.h:

	Since enum action is gonna be split, remove its usage on places
	where generic non-keymap-specific action number will be used.  

Sat Jan 24 23:14:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: kbdbind.c, kbdbind.h:

	Move ACT_SCRIPTING_FUNCTION up in the enum, so that it is grouped
	together with ACT_NONE as universal for all keymaps (by its very
	nature).  

Sat Jan 24 23:11:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/dialogs.c, config/kbdbind.c, config/kbdbind.h,
	sched/action.c:

	The action number is now keymap specific. From the outside the only
	change for now is that write_action() takes keymap along the action
	enum, from the inside the action_table was split into three yet
	identical copies (one for each keymap) and we carry enum keymap
	along enum action everywhere where we didn't yet for some reason.  

Sat Jan 24 22:52:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Fixed toggle_display_action_listboxes() to handle the new
	organization.  

Sat Jan 24 22:52:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Make document.css.stylesheet description more clear.  

Sat Jan 24 22:52:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Make document.css.stylesheet description more clear.  

Sat Jan 24 22:45:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/css/css.c, protocol/file/file.c,
	protocol/file/file.h:

	Purge all the crappy code I added yesterday in an attempt to import
	css and use read_encoded_file() for sucking in the default css file.  

Sat Jan 24 22:35:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Reorganized the keybinding manager - now the actions are grouped by
	keymap instead of vice versa.  

Sat Jan 24 22:32:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/file/file.c:

	Move file reading specific part of file_func() to separate function.  

Sat Jan 24 21:31:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.h:

	Removed trailing comma from the always-to-be-last enum members.  

Sat Jan 24 21:17:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Compilation fixes.  

Sat Jan 24 21:09:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/dialogs.c:

	When keybinding is associated with ACT_NONE, it is like it wouldn't
	exist at all so don't ask for confirmation.  

Sat Jan 24 21:07:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: kbdbind.c, kbdbind.h:

	Default keybindings are now flagged appropriatelly and are not
	deleted but just rebound to ACT_NONE, therefore also saved so to the
	configuration file. This should fix removed default keybindings
	reappearing after ELinks restart, reported by many people over the
	ELinks history.  

Sat Jan 24 20:37:54 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation updated.  

Sat Jan 24 20:28:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Split bind_config_string() core to single_bind_config_string().  

Sat Jan 24 20:08:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Split add_default_keybindings() to three
	add_keymap_default_keybindings().  

Sat Jan 24 20:05:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	The missing braces around for() body in bind_config_string() were
	making me nervous.  

Sat Jan 24 20:04:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	add_keybinding() reindentation.  

Sat Jan 24 20:03:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: kbdbind.c, kbdbind.h:

	add_keybinding() returns (struct keybinding *) 

Sat Jan 24 19:57:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/css.c:

	Terminate a sentence :-).  

Sat Jan 24 19:55:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Moved add_keystroke_to_string() and add_actions_to_string() from
	default kbdbinds neighbourhood near make_keystroke() where they seem
	to fit more naturally.  

Sat Jan 24 19:53:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Move config file tools at the end of file, particularily after
	default keybindings.  

Sat Jan 24 19:53:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Clarification.  

Sat Jan 24 19:20:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memdebug.c:

	Support for CHECK_DOUBLE_FREE, by default enabled. It reported
	xflows before, which was quite confusing.  

Sat Jan 24 19:08:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/memdebug.c:

	Minor tidyup.  

Sat Jan 24 18:24:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/Makefile.am,
	dialogs/exmode.c, dialogs/exmode.h, sched/action.c:

	Basic framework for ex-mode (command line) support, triggered by
	'exmode' action (':'). It does nothing now, some action
	parser/executer needs to be implemented, but that's already work for
	someone else ;-).  

Sat Jan 24 17:57:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/dialog.c:

	Simplify.  

Sat Jan 24 17:46:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	File style="{ ... }" testcase under garbage.  

Sat Jan 24 17:31:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Tidyup.  

Sat Jan 24 17:29:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fix infinite loop in property parser when handling style="{ ... }".
	Reported by Zas.  

Sat Jan 24 13:00:41 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	get_attr_val_(): simplify test_only mode, just return as soon we
	found matching atttribute.  

Sat Jan 24 12:52:17 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Jan 24 12:36:17 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	get_num(): use strtol() and a long variable @num, then check range
	and then only type cast to int. More correct, imho.  

Sat Jan 24 10:25:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Note one textmode User-Agent token user (OSNews.com) at least, shall
	someone even think about removing it.  

Sat Jan 24 10:25:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Describe the 'textmode' token.  

Sat Jan 24 10:09:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/error.c:

	Do not dump @full_static_version twice if CONFIG_BACKTRACE and
	segfault was forced by force_dump().  

Sat Jan 24 10:08:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/signals.c:

	Try to make the I-crashed epitaph more brief so that the actually
	useful info is less likely to scroll out of the screen.  

Sat Jan 24 03:35:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, stylesheet.c:

	Use free_list(). Hmm.  

Sat Jan 24 02:53:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, stylesheet.c, stylesheet.h:

	Move selector initialization to separate function.  

Sat Jan 24 02:41:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: Makefile.am, css/parser.c:

	Move style sheet and selector stuff to own file.  

Sat Jan 24 02:04:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/Makefile.am, css/apply.c, css/css.c,
	css/parser.c, css/parser.h, css/stylesheet.c, css/stylesheet.h,
	html/parser.c:

	Move style sheet and selector stuff to own file.  

Sat Jan 24 01:17:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Try to hint that document.css.stylesheet is relative to ELinks' home
	dir.  

Fri Jan 23 23:59:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: css.h, parser.h:

	Add some small meditations about cascading and default stylesheets.  

Fri Jan 23 22:31:05 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Less confusing comment.  

Fri Jan 23 22:25:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/README:

	English fixes, little more applier info.  

Fri Jan 23 22:13:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/css.h:

	Prototypes instead of #inculdes.  

Fri Jan 23 20:59:43 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jan 23 20:26:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Fix segfault when document.css.stylesheet couldn't be loaded. Always
	empty the default stylesheet before reloading.  

Fri Jan 23 20:12:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix comment eating so we do the @string testing inside first if ().  

Fri Jan 23 20:08:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/css.c:

	Make it possible to reimport default stylesheet. You still need to
	^R because css imports are async.  

Fri Jan 23 20:00:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, config/options.inc, document/css/css.c:

	Move CSS options and change hook to module definitions.  

Fri Jan 23 19:27:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, document/Makefile.am,
	document/css/Makefile.am, document/css/apply.c, document/css/css.c,
	document/css/css.h, modules/module.c:

	Add support for a default stylesheet from which to get info about
	HTML layout. It is still a bit buggy. E.g. don't set
	document.css.stylesheet to a file that doesn't exist. ;) 

Fri Jan 23 19:24:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Move main module initialization back. No initializer should use
	options.  

Fri Jan 23 19:18:18 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	get_attr_val() was slightly modified to be more efficient. It was
	renamed to get_attr_val_() which takes two new parameters
	@test_only, used by has_attr() and @eat_nl used by get_url_val(). In
	test_only mode, it just test for attribute existence, so it dont
	allocate any memory for value, nor it does useless parsing or string
	conversion. Global variable @get_attr_val_eat_nl is gone.  

Fri Jan 23 18:50:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	Init main modules after the option system has been booted so
	initializers can access options ;).  

Fri Jan 23 17:46:41 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Jan 23 17:33:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Assume sizeof(void *) == sizeof(long).  

Fri Jan 23 09:37:42 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation update.  

Fri Jan 23 06:26:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Introduce char group of other token start chars so we can bail out
	eailer if the token is garbage.  

Thu Jan 22 23:48:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	If we don't use smart checking there is no need for a smart value.  

Thu Jan 22 23:29:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Add support for URI rewriting from the command line.  

Thu Jan 22 22:55:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Put some use to the second member of scan_table_info.data.string.  

Thu Jan 22 22:26:17 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/garbage.html:

	Better garbage.  

Thu Jan 22 22:18:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Our current text-decoration parsing is invalid.  

Thu Jan 22 22:17:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: property.c, value.c, value.h:

	Introduced css_parse_text_decoration_value(). NEVER overload single
	function for disjunct properties! 

Thu Jan 22 22:01:04 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	English fix.  

Thu Jan 22 21:40:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	Make current->type token type checking against NONE/SKIP more
	explicit and also simpler.  

Thu Jan 22 21:38:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	English grammar fix.  

Thu Jan 22 21:37:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/inphist.c:

	Fixed memory leak in do_tab_compl() triggered when there were no
	completion possibilities.  

Thu Jan 22 21:26:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	FIXME about unbased sizeof() equivalence assumptions.  

Thu Jan 22 21:18:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Enabled document.css.enable by default. It is important to let the
	CSS support to be extensively tested by people.  

Thu Jan 22 21:14:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	In ident2type(), use strlcasecmp() for token matching so that ie.
	'me' won't match 'media' (or is that ok?).  

Thu Jan 22 21:11:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	Removed redundant identifiers2type record.  

Thu Jan 22 21:06:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.h:

	English grammar fixes.  

Thu Jan 22 20:53:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/property.c:

	Make sure someone won't pollute our nice clear simple code with
	fastfind too soon ;-).  

Thu Jan 22 20:47:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.h:

	Jonas is too French.  

Thu Jan 22 19:34:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Remove unneeded #includes.  

Thu Jan 22 19:32:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Tidyup comment.  

Thu Jan 22 19:31:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	The universal (match all) selector '*' is also a char token.  

Thu Jan 22 18:45:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Oops no revert plain render change from last patch. :/ 

Thu Jan 22 18:43:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/parser.c, css/parser.h, plain/renderer.c:

	Add comments to functions and one TODO.  

Thu Jan 22 18:34:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Add grammar info from ELusive as comments.  

Thu Jan 22 18:27:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	css_parse_selector() -> css_parse_ruleset().  

Thu Jan 22 18:19:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/osdep/osdep.c:

	Removed unused @display variable.  

Thu Jan 22 18:09:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Revert my two last patches to the renderer. The one adding link
	state enum to struct link_state_info and the one trying to remove
	link_state updating hacks from put_chars(). They broke numbered
	links.  

Thu Jan 22 17:46:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: frames.c, frames.h, parser.c:

	Moved parse_frame_widths() & co from document/html/parser.* to
	document/html/frames.*.  

Thu Jan 22 16:22:21 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS, src/osdep/osdep.c:

	Fixed xterm detection - except DISPLAY check also if either WINDOWID
	or KONSOLE_DCOP_SESSION env variable is present.  

Thu Jan 22 07:25:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Move up identifier scanning.  

Thu Jan 22 06:49:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Bug in SGML logic.  

Wed Jan 21 18:16:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/plain/renderer.c:

	Cleanup.  

Wed Jan 21 17:49:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Make the madness really end.  

Wed Jan 21 17:40:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Compile fix.  

Wed Jan 21 17:39:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Unify SGML tagsoup navigation and use native scanners to make it
	much more forgiving.  

Wed Jan 21 17:05:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Tidyup comments.  

Wed Jan 21 17:02:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Introduce a skip token and made CSS_TOKEN_NONE again mean stop
	scanning.  

Wed Jan 21 16:21:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Treat ".<number>%" as garbage so it is not broken up.  

Wed Jan 21 16:05:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Call update_link_state() those places that call put_chars(). Remove
	various hacks that did it before.  

Wed Jan 21 16:01:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Add link state enum to struct link_state_info and use that in
	put_chars(). get_link_state() is now simply an updater.  

Wed Jan 21 15:49:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Move link state information to a new struct link_state_info.  

Wed Jan 21 15:36:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Yuk .. another hack to solve memleaks because of changing link
	states. We have to globalize that thing somehow. Reported by lindi-
	and excellent test case by fabiob.  

Wed Jan 21 10:09:01 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/: config/kbdbind.c, config/kbdbind.h, document/options.h,
	document/renderer.c, document/plain/renderer.c, sched/action.c,
	viewer/text/view.c, viewer/text/view.h, viewer/text/vs.h:

	Wrapping plain text support switched by Shift+W.  

Wed Jan 21 06:19:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h, value.c:

	Check precedence of the current token so we do not skip '}' when
	looking for ';'. Fixes background property strangeness.  

Wed Jan 21 06:11:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Handle numbers starting with dots.  

Wed Jan 21 05:46:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	get_css_identifier_type(): Do length calculation + rename to
	ident2type() to minimize wrapping.  

Wed Jan 21 05:39:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix skipper that didn.t break out when getting to skipto char.  

Wed Jan 21 05:20:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	get_css_identifier_type(): Drop the inline. Cleanup.  

Wed Jan 21 05:17:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Ensure ending ')' even for rgb() function tokens. Use the ident2type
	table to check for known functions.  

Wed Jan 21 05:05:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Pass base type to identifier resolver. Fixes resolving and speeds up
	the lookup.  

Wed Jan 21 04:44:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h:

	Generate specific @-keyword tokens. Required a little renaming of
	number identifier to type mapping.  

Wed Jan 21 04:29:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Tidyup definitions.  

Wed Jan 21 04:25:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h:

	CSS_TOKEN_ATRULE -> CSS_TOKEN_AT_KEYWORD.  

Wed Jan 21 04:18:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Update comments and remove CSS_TOKEN_NAME.  

Wed Jan 21 04:17:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	There is no name token. It is only used for hashes.  

Wed Jan 21 04:03:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, parser.c, parser.h:

	Make css_parse_properties() take scanner as argument. This means the
	applier needs to know about the scanner but it is really a paint to
	debug when property parsing spawns a new scanner + it is less
	efficient of course.  

Wed Jan 21 03:54:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/README:

	Tidyup.  

Wed Jan 21 03:45:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Moved dumping of scanner to dump_css_scanner().  

Wed Jan 21 03:04:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Make the scanner debugging much more powerful showing both the
	generated tokens and compressed src position.  

Wed Jan 21 01:46:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Remove the used scanner function from debug info. It don.t work very
	well.  

Wed Jan 21 01:20:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make get_css_token_() into a macro.  

Wed Jan 21 01:00:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make get_next_css_token_() into a macro.  

Wed Jan 21 00:38:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	check_next_css_token(): Make it into a macro. With the amount of
	sanity checking we have now it should be safe.  

Wed Jan 21 00:27:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Move scanner sanity checking to exits of scan_css_tokens().  

Wed Jan 21 00:11:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	scan_css_tokens(): Return the current token.  

Wed Jan 21 00:02:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Unbytesize move_to_front. I was thinking about making
	scanner->tokens a pointer but that seems stupid now.  

Tue Jan 20 22:25:37 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: text.c, widget.h:

	Handling of mouse with text scrollbar was improved. Using right
	click will make it to scroll faster, and mouse wheel is now handled.  

Tue Jan 20 20:40:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make the scanners current a css_token pointer.  

Tue Jan 20 20:09:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	scan_css_tokens(): Make move_to_front byte sized.  

Tue Jan 20 20:00:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	scan_css_tokens(): Make current a css_token pointer.  

Tue Jan 20 18:25:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Make scan table initialization data driven. It is very generic and
	more readable (I hope). A bit slower but I am really a sucker for
	data driven coding. ;) 

Tue Jan 20 18:18:40 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Italian translation update.  

Tue Jan 20 17:49:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h, value.c:

	Rearrange token types to group them better. Add comments. Rename
	CSS_TOKEN_IDENTIFIER to CSS_TOKEN_IDENT. It wouldn.t be C without
	abbreviations. ;) 

Tue Jan 20 17:28:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Generate hash tokens.  

Tue Jan 20 17:15:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Take precedence and string args into considerations when skipping
	functions.  

Tue Jan 20 17:12:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	More garbage.  

Tue Jan 20 16:40:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Improve precedence checking.  

Tue Jan 20 16:13:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Oops revert part from last patch and fix rgb comparison.  

Tue Jan 20 16:12:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Try to skip comments.  

Tue Jan 20 15:59:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h, value.c:

	Use smarter scanning of functions skipping to ')' if it is unknown
	so tokens are not generated for every arg.  

Tue Jan 20 15:18:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/README:

	m33p.  

Tue Jan 20 15:12:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/README:

	Update.  

Tue Jan 20 14:57:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Don't remove garbage token as they might be used for some kind of
	recovery. 'None token' can now be used for tokens we want to skip
	plus it should now be more obvious that scanner->position could have
	become NULL.  

Tue Jan 20 07:05:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Make link type parser more data driven.  

Tue Jan 20 06:25:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Alphabetise css token types.  

Tue Jan 20 06:22:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Treat SGML comments as garbage.  

Tue Jan 20 05:11:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fix assertion failure reported by Zardoz. It concerned string like
	"property:" with no expressions meaning skipping could not get next
	token.  

Tue Jan 20 04:54:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/garbage.html:

	Test case for the bug Zardoz pointed out.  

Tue Jan 20 04:37:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser.c:

	Tidy-up: Wrap before &&, not after, and join a hanging ')' with the
	line above.  

Tue Jan 20 04:33:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser.c:

	Drop some double-negation in look_for_tag and html_option.  

Tue Jan 20 02:37:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Add more TODOs. Will we ever be done? 

Tue Jan 20 02:30:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Handle scanning of number identifiers.  

Tue Jan 20 02:12:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Use strn* .. Doh! 

Tue Jan 20 02:09:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	First scan the number then the kind of number.  

Tue Jan 20 02:00:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.c, scanner.h:

	In order to handle end of tags when getting style info from <style>
	tags we need better signaling of whether to keep scanning since the
	CSS source doesn't end at the string end. We now recognize SGML tag
	ends in the scanner and generate a CSS_TOKEN_NONE while also setting
	scanner->position to NULL.  

Tue Jan 20 01:42:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	scan_css_token(): Don't return anything.  

Tue Jan 20 01:05:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Two optimizations: never scan token if the scanner positon is at the
	end, never put garbage tokens in the token table.  

Tue Jan 20 00:56:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Make token types default to CSS_TOKEN_GARBAGE.  

Tue Jan 20 00:44:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix off by one error in SGML comment scanning.  

Tue Jan 20 00:43:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Scan !important tokens.  

Tue Jan 20 00:37:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Add types for all kinds of token we have to support. If not for
	usage it will make the scanning more efficient.  

Tue Jan 20 00:23:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Handle scanning of floating point numbers.  

Tue Jan 20 00:16:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Fix SGML comment scanning.  

Tue Jan 20 00:13:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h, value.c:

	CSS_TOKEN_DIGIT -> CSS_TOKEN_NUMBER 

Tue Jan 20 00:11:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Move css_token_type enum out of the css_token struct and describe
	tokens using patterns.  

Mon Jan 19 23:52:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make scan_css_tokens() static.  

Mon Jan 19 23:48:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Cleanup scanner validation.  

Mon Jan 19 23:31:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	More paranoia checking. Make sure never to return CSS_TOKEN_NONE
	typed token.  

Mon Jan 19 23:21:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	More usage of css_scanner_has_tokens() before accessing the scanners
	table.  

Mon Jan 19 23:10:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Be more paranoid and don't count in CSS_TOKEN_NONE tokens.  

Mon Jan 19 22:37:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Use macros in checks.  

Mon Jan 19 22:36:15 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jan 19 22:04:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/styletags.html:

	<b> tag is not also red.  

Mon Jan 19 21:56:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/styletags.html:

	E&nbsp;L&nbsp;i&nbsp;n&nbsp;k&nbsp;s 

Mon Jan 19 21:35:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Disable CSS by default. It is highly experimental and Zardoz pointed
	out that http://blogs.law.harvard.edu/tech/2004/01/19 caused a
	strange assertion failure.  

Mon Jan 19 21:33:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, document/document.c, document/document.h,
	modules/module.c, modules/module.h:

	Add a main_modules table. First entry is a module for the document
	subsystem. It will make it easy to move document options to
	document/options or even separate document/subdir file.  

Mon Jan 19 21:17:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Added assertions to check that the scanner token table is properly
	aligned, meaning checking the next token will be safer and will
	never force a rescan.  

Mon Jan 19 20:35:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, modules/module.c, modules/module.h:

	Module table handlers now take the table as arg.  

Mon Jan 19 19:58:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.c, config/options.inc, document/options.c,
	document/options.h, document/html/parser.c:

	Make it possible to disable CSS support. Enabled by default.  

Mon Jan 19 19:26:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Support for adding properties to already defined selectors.  

Mon Jan 19 19:25:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/styletags.html:

	Add test for adding properties to an already known selector.  

Mon Jan 19 19:20:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Revert bad part of last patch.  

Mon Jan 19 19:19:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, parser.c:

	Minor optimization if no selectors have been added.  

Mon Jan 19 19:18:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fix scary macros and loopings not enclosed in brackets.  

Mon Jan 19 19:01:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, parser.c, parser.h:

	Move CSS selector lookup to separate function.  

Mon Jan 19 18:53:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Try to handle precedens of special char tokens when skipping.  

Mon Jan 19 18:52:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	We need to stop at '}' tokens when parsing properties of selectors.  

Mon Jan 19 18:48:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/styletags.html:

	More <style> tests.  

Mon Jan 19 17:05:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Describe why to use @props and now @properties.  

Mon Jan 19 17:03:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/apply.h, css/parser.c,
	css/parser.h, html/parser.c:

	Minimal support for grabbing CSS properties from <style> tags. Only
	clean html element selectors are handled.  

Mon Jan 19 17:00:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Fix last patch.  

Mon Jan 19 16:55:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Use list_head pointers preparing for the invasion of <style>
	handling. Uh oh and some renaming too. ;P 

Mon Jan 19 16:51:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/styletags.html:

	Add a test for using properties from <style> tags.  

Mon Jan 19 16:17:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make the CSS scanner generate tokens for SGML comments.  

Mon Jan 19 14:43:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Make the scanner generate atrule tokens containtin @<ident>.  

Mon Jan 19 13:35:02 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* src/document/css/apply.c:

	Don't apply colors from styles if
	document.colors.use_document_colors is 0.  

Mon Jan 19 07:05:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Set string token type.  

Mon Jan 19 06:29:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	We cannot get rid of string delimiters because token->length is set
	later in the function .. but it should not matter.  

Mon Jan 19 06:25:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Cleanup.  

Mon Jan 19 06:10:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Fix comments.  

Mon Jan 19 06:05:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Tidy up.  

Mon Jan 19 06:03:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Store debug related info in the scanner struct so they do not have
	to be passed to the functions even when CSS scanner debug is
	disabled.  

Mon Jan 19 05:52:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Update scanner comments.  

Mon Jan 19 05:49:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Remove garbage macro.  

Mon Jan 19 01:02:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Remove old TODO.  

Mon Jan 19 01:00:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/: simplefont.html, simpletext.html:

	Add text-decoration: underline tests.  

Mon Jan 19 00:56:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: apply.c, property.c, property.h, value.c:

	Add support for text-decoration: underline.  

Mon Jan 19 00:43:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Add comments to the rbg() parsers loop.  

Mon Jan 19 00:30:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Even use scanner for background property expression parsing.  

Mon Jan 19 00:24:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	css_parse_color_value(): Use the scanner for parsing. This partly
	introduces spaghetti code in the rbg() handling. But we use a loop
	so it should be easy to move things to separate function if we want
	maybe even some generic function arg scanner.  

Mon Jan 19 00:20:24 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	Yes .. ermh buffer overflows .. that should be my apartment. This
	one got fixed tho' ;/ 

Mon Jan 19 00:02:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Also skip the % when scanning percentage tokens.  

Sun Jan 18 23:54:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Add comma to char token list. Needed for function scanning.  

Sun Jan 18 22:59:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/simplecolors.html:

	Add test cases for short hex colors.  

Sun Jan 18 22:58:26 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	No need to touch slen.  

Sun Jan 18 22:57:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/color.c:

	Add support for handling the short hexcolor format used by CSS.  

Sun Jan 18 22:48:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Check that hexcolors have the correct length. And disable debug
	flags.  

Sun Jan 18 22:38:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Add support for scanning CSS strings.  

Sun Jan 18 22:25:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Add CSS_TOKEN_FUNCTION that contains '<ident>(' string.  

Sun Jan 18 21:31:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Remove unused macro.  

Sun Jan 18 21:29:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Add position member for maintaining where in the string the scanner
	should start scanning next. Well make it easier to debug and also
	simplifies code.  

Sun Jan 18 21:04:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Ensure that move_to_front in non negative.  

Sun Jan 18 20:51:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Be a little less buggy in scan_css_tokens(). I really hate
	memmove()s and this lowlevel coding.  

Sun Jan 18 20:15:38 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Italian translation update.  

Sun Jan 18 20:11:05 2004  Varga Balzs <vinnui@ent.hu>:

	* po/hu.po:

	Translation update.  

Sun Jan 18 18:21:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, scanner.h, value.c:

	Introduce macro to calculate the length of 'static' strings. They
	can cause bugs + we are lazy and like simple code.  

Sun Jan 18 18:11:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Utilize the scanner when parsing font-style values.  

Sun Jan 18 18:06:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Utilize the scanner when parsing font-* weight values. We should
	maybe have some get_css_token_number() that can handle both
	CSS_TOKEN_DIGIT and CSS_TOKEN_PERCENTAGE.  

Sun Jan 18 18:01:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Utilize the scanner when parsing font-* identifier values.  

Sun Jan 18 17:57:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	css_parse_font_weight_value(): Use token types to see what to do.  

Sun Jan 18 17:54:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Digits can be part of name tokens so check if digit first when
	scanning.  

Sun Jan 18 17:48:11 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	Utilize the scanner when parsing text-align values.  

Sun Jan 18 17:43:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: property.h, value.c, value.h:

	Pass the scanners along to the value parsers that will yet only work
	on the string of the first token. Had to backend color value
	parsing.  

Sun Jan 18 17:24:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/value.c:

	The scanner is so kind to skip whitespace for us so obsolete
	skip_whitespace() call.  

Sun Jan 18 17:20:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, value.c, value.h:

	Make css_parse_value() take scanner arg instead of string.  

Sun Jan 18 17:14:03 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): code simplication.  

Sun Jan 18 17:13:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Move CSS_SCANNER_DEBUG macro to c file.  

Sun Jan 18 17:12:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Group function and macro definitions with the various structs.  

Sun Jan 18 17:09:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.c, scanner.h:

	Don't use inlined scan table accessors and mutators.  

Sun Jan 18 17:09:03 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	foreach_values() macro was dropped. Reindentation.  

Sun Jan 18 17:02:39 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simplecolors.html:

	This is a descriptive commit message.  

Sun Jan 18 17:00:50 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	extract_rows_or_cols_values(): check for @number greater than 100 if
	in percentage.  

Sun Jan 18 16:59:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Fixed superfluous @string shifting in rgb_component_parser(),
	spotted by Jonas.  

Sun Jan 18 16:59:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c:

	Sort alphabetically, spotted by Jonas.  

Sun Jan 18 16:47:42 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.c:

	Minor cleanup and fix of scan table initialization.  

Sun Jan 18 16:45:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/property.c:

	Bound css_property_info by CSS_PT_LAST.  

Sun Jan 18 16:44:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.c, src/document/css/property.c,
	src/document/css/property.h, src/document/css/value.c,
	src/document/css/value.h, test/css/simplecolors.html:

	Support for background property. It is broken in certain testcases
	but maybe it's scanner bug, I don't know, I'm not in the mood of
	tracing through 100 inlined scan_css_token() calls.  

Sun Jan 18 16:44:00 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	extract_rows_or_cols_values(): check for abnormally large @number
	values and prevent bad things by falling back to wildcard value.  

Sun Jan 18 16:35:09 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	extract_rows_or_cols_values(): initialize val to -1, use @number
	directly.  

Sun Jan 18 16:29:44 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Some now useless initializations were dropped.  

Sun Jan 18 16:26:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Trailing whitespaces cleanup.  

Sun Jan 18 16:25:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: scanner.h, scanner.h:

	Improve comment.  

Sun Jan 18 16:24:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Fix typo.  

Sun Jan 18 16:24:14 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): part of it was moved to
	extract_rows_or_cols_values(). Use static for these new functions.  

Sun Jan 18 16:22:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Describe (as pasky so gracefully suggested) css_scanner.  

Sun Jan 18 16:12:13 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): handle returned value as it should, and fix a
	typo.  

Sun Jan 18 16:12:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Comment struct css_token.  

Sun Jan 18 16:08:22 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): a part of it was moved to
	distribute_rows_or_cols_that_left().  

Sun Jan 18 15:59:38 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/scanner.h:

	Try to make it more clear the difference between char tokens and non
	char tokens. Non char tokens now start at 256.  

Sun Jan 18 15:59:04 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): a part of it was moved to
	distribute_rows_or_cols().  

Sun Jan 18 15:53:49 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.h:

	Moved CSS_TOKEN_NON_ASCII_END (*shudder*) to the end of the enum,
	therefore all the other tokens will have sane enum values.  

Sun Jan 18 15:52:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.h:

	CSS_TOKENS makes no sense in arbitrarily-numbered enum, therefore
	better remove it or it will confuse someone.  

Sun Jan 18 15:47:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/scanner.c:

	#include elinks.h 

Sun Jan 18 15:46:16 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): shorter lines by using a macro as @values
	iterator.  

Sun Jan 18 15:41:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: Makefile.am, css/Makefile.am, css/parser.c,
	css/scanner.c, css/scanner.h:

	Introduce a CSS token scanner.  It maintains up to 10 tokens at a
	time to minimize the number of scans.  For scanning a scan table is
	used (idea by mozilla).  Only used in css_parse_properties() to
	minimize the impact.  

Sun Jan 18 15:38:07 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): localize @tmp_val.  

Sun Jan 18 15:34:54 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): fastmem mode minor optimization, let use
	alloca() here if possible.  

Sun Jan 18 15:32:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Removed unused variables.  

Sun Jan 18 15:32:33 2004  Petr Baudis <pasky@ucw.cz>:

	* Makefile.am:

	Removed the circular dependency hack, it results in a circular
	dependency even here now (dunno what happenned), so maybe it was
	silently resolved...  

Sun Jan 18 15:32:13 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): code flow cleanup.  

Sun Jan 18 15:30:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Assert for value_type in value parsers.  

Sun Jan 18 15:29:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: property.c, value.c, value.h:

	font-style and font-weight now uses separate value parsers.  

Sun Jan 18 15:28:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): localize and assert @divisor.  

Sun Jan 18 15:25:47 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: property.c, value.c, value.h:

	css_property_info.parser is now used instead of css_value_parsers[],
	which evaporated. Therefore the value parsers are now exported.  

Sun Jan 18 15:25:01 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): Use a loop instead of a goto, localize @number
	and @tmp_values.  

Sun Jan 18 15:19:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	css_value_parser_t is now redundant to css_property_value_parser 

Sun Jan 18 15:19:40 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): Use @tmp variable to cache calculations
	result.  

Sun Jan 18 15:18:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	css_value_parser_t now takes (struct css_property_info *) as its
	first argument.  

Sun Jan 18 15:14:43 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @nn -> @flag, local.  

Sun Jan 18 15:12:32 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): some comments were added.  

Sun Jan 18 15:10:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/.vimrc, src/bfu/.vimrc, src/bookmarks/.vimrc,
	src/bookmarks/backend/.vimrc, src/cache/.vimrc, src/config/.vimrc,
	src/cookies/.vimrc, src/dialogs/.vimrc, src/document/.vimrc,
	src/document/html/.vimrc, src/document/plain/.vimrc,
	src/encoding/.vimrc, src/formhist/.vimrc, src/globhist/.vimrc,
	src/intl/.vimrc, src/intl/gettext/.vimrc, src/lowlevel/.vimrc,
	src/mime/.vimrc, src/mime/backend/.vimrc, src/modules/.vimrc,
	src/osdep/.vimrc, src/osdep/beos/.vimrc, src/osdep/os2/.vimrc,
	src/osdep/riscos/.vimrc, src/osdep/unix/.vimrc,
	src/osdep/win32/.vimrc, src/protocol/.vimrc,
	src/protocol/auth/.vimrc, src/protocol/file/.vimrc,
	src/protocol/ftp/.vimrc, src/protocol/http/.vimrc,
	src/protocol/rewrite/.vimrc, src/protocol/smb/.vimrc,
	src/sched/.vimrc, src/scripting/.vimrc, src/scripting/guile/.vimrc,
	src/scripting/lua/.vimrc, src/ssl/.vimrc, src/terminal/.vimrc,
	src/terminal/graphics/.vimrc, src/terminal/text/.vimrc,
	src/util/.vimrc, src/viewer/.vimrc, src/viewer/dump/.vimrc,
	src/viewer/graphics/.vimrc, doc/.vimrc, src/viewer/text/.vimrc,
	doc/book/.vimrc, doc/book/config/.vimrc, doc/book/info/.vimrc,
	doc/book/intro/.vimrc, doc/book/manpages/.vimrc, doc/man/.vimrc,
	doc/man/man1/.vimrc, doc/man/man5/.vimrc, doc/tools/.vimrc,
	po/.vimrc, m4/.vimrc:

	. is now appended to 'runtimepath' instead of setting 'runtimepath'
	to .,$VIMRUNTIME, therefore evading ~/.vimrc etc.  

Sun Jan 18 15:07:51 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @m -> @maxval, @mj -> @maxpos.  

Sun Jan 18 15:06:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: .vimrc, parser.c, value.c, value.h:

	css_parse_value() now takes (struct css_property_info *) instead of
	{enum css_property_value_type}.  

Sun Jan 18 15:05:43 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @q -> @val, @qq -> @tmp_val.  

Sun Jan 18 15:03:41 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @oo -> @tmp_values, @n -> @number.  

Sun Jan 18 15:01:28 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @o -> @values, @ol -> @values_count.  

Sun Jan 18 14:58:36 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @op -> @new_values, @olp -> @new_values_count.  

Sun Jan 18 14:55:01 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @ww -> @max_value, @www -> @pixels_per_chars.  

Sun Jan 18 14:53:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/property.h:

	Introduced css_property_info.(parser|parser_data). Unused yet.  

Sun Jan 18 14:52:55 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @a -> @str, @aa -> @tmp_str.  

Sun Jan 18 14:50:12 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	parse_frame_widths(): @d -> @divisor.  

Sun Jan 18 14:43:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, property.c, property.h, value.c:

	CSS_DP_* -> CSS_PT_*, CSS_DV_* -> CSS_VT_* 

Sun Jan 18 14:41:02 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/property.h:

	Clarify {struct css_property} description.  

Sun Jan 18 14:37:56 2004  Petr Baudis <pasky@ucw.cz>:

	* .cvsignore, autogen.sh, configure:

	Removed ./configure and ./configure-do -> ./configure, therefore
	restoring the original situation. This solution is not going to fly,
	./configure gets overwritten by automake rules.  

Sun Jan 18 14:25:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, property.h:

	css_property*.property -> .type 

Sun Jan 18 14:23:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: value.c, value.h:

	Tidyup.  

Sun Jan 18 14:23:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, parser.h:

	css_parse_decl -> css_parse_properties 

Sun Jan 18 14:22:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, property.h, value.c, value.h:

	css_decl_value -> css_property_value, css_decl_valtype ->
	css_property_value_type -> css_decl_property -> css_property_type 

Sun Jan 18 14:18:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/property.h:

	Try to clarify more css_property_info.value_type.  

Sun Jan 18 12:54:45 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.h:

	Update css_parse_decl() description.  

Sun Jan 18 12:50:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Trivial clarification.  

Sun Jan 18 03:01:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, property.c, property.h:

	Remove @namelen from property info struct. It will be useles when we
	switch to fast find and we do not use it for other string to data
	mapping structs.  

Sun Jan 18 02:55:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: Makefile.am, css/Makefile.am, css/parser.c,
	css/property.c, css/property.h:

	Move CSS property info to own file and expose css_property_info[].  

Sun Jan 18 02:40:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	css_parse_decl(): Localize loop variables.  

Sun Jan 18 02:38:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.h:

	css_parse_decl(): Update comment.  

Sun Jan 18 02:36:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Minor cleanup.  

Sun Jan 18 02:33:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	css_parse_decl(): Use while loop. Nothing changed other than
	indentation and removal of again label.  

Sun Jan 18 02:28:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Fun with gotos so we don't parse declarations recursively anymore.  

Sun Jan 18 01:57:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Add css value type info to property_info struct. ObsoletesM
	prop2valtype.  

Sun Jan 18 01:50:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: parser.c, parser.h:

	css_parse_decl(): Don't return anything. Caller can check
	list_empty() to see if anything was added.  

Sun Jan 18 01:48:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/parser.c:

	Remove function comment that is also in the header file.  

Sun Jan 18 00:59:10 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/cmdline.c, config/conf.c, lowlevel/home.c:

	Use the new confdir/conffile option names (config-dir/config-file).  

Sun Jan 18 00:56:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Fixed -confdir/-conffile.  

Sun Jan 18 00:29:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	-confdir -> -config-dir, -conffile -> -config-file, idea by Doug
	Kearns <djkea2@mugca.its.monash.edu.au>.  

Sun Jan 18 00:17:15 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	I'm sorry Zas, but you *knew* this is coming. Please split it up.  

Sun Jan 18 00:16:11 2004  Petr Baudis <pasky@ucw.cz>:

	* .cvsignore, Makefile.am, autogen.sh, configure:

	autoconf ./configure -> ./configure-do. ./configure is for now a
	trivial wrapper but will do some automagic feature.h rewriting and
	so. You will need to rm ./configure && cvs up && ./autogen.sh after
	this commit.  

Sun Jan 18 00:10:04 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Complete parse_frame_widths() cleanup. Changes made do not affect
	behavior. Among them, explicit variables names, minor trivial
	optimizations, got rid of a goto, comments. Sorry, this patch is
	quite big but concerns only this function, and i did not want to
	flood with cvs commits ;).  

Sat Jan 17 23:20:52 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update.  

Sat Jan 17 23:16:19 2004  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	.po files were resynced.  

Sat Jan 17 23:05:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Converted Jonas' strlcasecmp()s to strncasecmp()s, which actually
	make sense :^). Should fix 'text-align: right;' bug reported by
	Jonas.  

Sat Jan 17 22:49:40 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Hotkey conflicts fixes.  

Sat Jan 17 22:12:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Fixed string shufflink in TEXT_ALIGN value parser.  

Sat Jan 17 22:11:32 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simpletext.html:

	Jonas' div right; testcase.  

Sat Jan 17 22:04:49 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simpletext.html:

	Also a <div> test.  

Sat Jan 17 21:22:41 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simpletext.html:

	Added text-align tests.  

Sat Jan 17 21:18:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Compilation fix.  

Sat Jan 17 21:17:22 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, parser.c, property.h, value.c:

	Added support for text-align property.  

Sat Jan 17 20:24:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, property.h, value.c:

	Fixed support for lighter and normal values of font-* properties.  

Sat Jan 17 19:59:17 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simplefont.html:

	Enhance the font-weight: normal testing.  

Sat Jan 17 19:53:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Added support for font-weight lighter, bolder and normal.  

Sat Jan 17 19:52:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/README:

	About current big design problems.  

Sat Jan 17 19:43:25 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Removed redundant skip_whitespace() from FONT_ATTRIBUTE parser.  

Sat Jan 17 19:40:26 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simplefont.html, src/document/css/apply.c,
	src/document/css/parser.c, src/document/css/property.h,
	src/document/css/value.c:

	font-style property support.  

Sat Jan 17 17:35:34 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/parser.c:

	Alphabetize.  

Sat Jan 17 16:46:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/Makefile.am:

	Fixed linking of the CSS code.  

Sat Jan 17 16:46:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/apply.c:

	Sort CSS appliers like the css_decl_propery enum.  

Sat Jan 17 16:46:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Removed obsolete TODOs.  

Sat Jan 17 16:45:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.c:

	Cleaned up the spaghetti rgb() parsing code by moving the color
	component extraction to rgb_component_parser().  

Sat Jan 17 16:36:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: Makefile.am, apply.c, apply.h, parser.c,
	property.h, value.c, value.h:

	Moved {struct css_property} from apply.h to property.h.  

Sat Jan 17 16:26:21 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/apply.h:

	Moved generic stuff from parser.h to README.  

Sat Jan 17 16:23:36 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.h:

	Removed redundant struct list_head.  

Sat Jan 17 16:23:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: parser.h, README, Makefile.am:

	Moved generic stuff from parser.h to README.  

Sat Jan 17 16:01:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: css/Makefile.am, css/apply.c, css/apply.h,
	css/css.c, css/css.h, html/parser.c:

	document/css/css.* -> document/css/apply.* 

Sat Jan 17 15:54:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: Makefile.am, apply.c, css.c, parser.c,
	parser.h:

	Moved the current stub of future CSS parser from document/css/css.*
	to document/css/parser.*.  

Sat Jan 17 15:46:31 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/value.h:

	Typo fix.  

Sat Jan 17 15:45:48 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: Makefile.am, apply.c, css.c, value.c, value.h:

	Moved CSS value parser from document/css/css.* to
	document/css/value.*.  

Sat Jan 17 15:40:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Removed already obsolete TODO.  

Sat Jan 17 15:36:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.h, css.h:

	Update the _H define.  

Sat Jan 17 15:32:33 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Oops, include document/css/css.h.  

Sat Jan 17 15:32:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Moved value parsing to separate functions.  

Sat Jan 17 15:25:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Statify the appliers.  

Sat Jan 17 15:22:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.h, css.h:

	Include some stuff required by {struct css_property}.  

Sat Jan 17 15:21:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/document.c, document/css/apply.c,
	document/css/css.c, document/html/parser.c,
	document/html/renderer.c, document/html/tables.c, sched/session.c,
	viewer/text/form.c, viewer/text/link.c, viewer/text/textarea.c:

	Moved document/html/parser.h inclusion to the usual place, since it
	should be safe now.  

Sat Jan 17 15:18:27 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/: Makefile.am, internal.h, parser.c, parser.h,
	renderer.c, tables.c:

	Moved the aggressive format/par_format #defines (together with
	html_top and html_stack) from document/html/parser.h to
	document/html/internal.h.  

Sat Jan 17 15:05:43 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, apply.h, css.c, css.h:

	Export {struct css_property}.  

Sat Jan 17 14:59:26 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Compilation fix.  

Sat Jan 17 14:57:55 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Moved proprety applying to separate functions.  

Sat Jan 17 14:49:07 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/idnes_mail.html:

	This is a nice test for font-weight, color, background-color on body
	etc. And it's all inlined in the style attributes.  

Sat Jan 17 14:44:56 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Make sure that background-color property on body element gets
	handled properly. Well, it's a mess.  

Sat Jan 17 14:38:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c:

	Compilation fix.  

Sat Jan 17 14:33:43 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/: simplecolors.html, simplefont.html:

	Separated font-related tests to simplefont.html, making them also
	more elaborate.  

Sat Jan 17 14:26:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/css/: apply.c, css.c, apply.h, css.h:

	css_apply() now returns void instead of int because we do not use
	the return value anywhere anyway. Proposed by Jonas.  

Sat Jan 17 14:18:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/conf.c, config/opttypes.c, cookies/parser.c,
	document/html/parser.c, document/html/tables.c,
	protocol/http/header.c, protocol/smb/smb.c, util/string.h:

	Removed the WHITECHAR() macro, we use the standard builtin isspace()
	macro instead which should be completely equivalent.  

Sat Jan 17 14:16:28 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/css/apply.c, document/css/css.c, util/string.h:

	Make util/string.h directly include its prerequisite <ctype.h>.  

Sat Jan 17 14:12:34 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simplecolors.html:

	Made the bold tests a little more explicit.  

Sat Jan 17 14:09:39 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS, src/dialogs/document.c:

	Made the Document info msgbox scrollable, usable ie. for long
	titles/urls (test/longtitle.html). Patch by David A. Capello
	<dacap@users.sourceforge.net>.  

Sat Jan 17 14:06:22 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in, src/document/Makefile.am,
	src/document/html/Makefile.am, src/document/html/css.c,
	src/document/html/css.h, src/document/html/parser.c,
	src/document/css/Makefile.am:

	document/html/css.* -> document/css/css.* 

Sat Jan 17 07:49:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/css.c, html/css.c:

	Make the font-weight evaluation correct. Values pointed out by
	Miciah.  

Sat Jan 17 07:43:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/css.c, html/css.c:

	Make property name to property enum data driven.  

Sat Jan 17 07:23:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/css.c, html/css.c:

	Add support for font-weight (bold) support.  

Sat Jan 17 07:22:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* test/css/simplecolors.html:

	Add background-color and font-weight tests.  

Sat Jan 17 06:45:38 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation update.  

Sat Jan 17 02:24:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/css.c, html/css.c:

	Handle the background-color property.  

Sat Jan 17 02:09:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: css/apply.c, css/css.c, html/css.c:

	Use skip_whitespace() macro.  

Sat Jan 17 01:56:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	open_current_link_in_new_tab(): Merge in get_tab_link_url(). Fix
	leak related to url list introduction previous today.  

Sat Jan 17 01:53:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, terminal/tab.c, terminal/tab.h,
	viewer/text/view.c:

	Specialize open_in_new_tab() to open current link in new tab. Rename
	to open_current_link_in_new_tab().  

Sat Jan 17 01:50:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Call open_url_in_new_tab() directly.  

Sat Jan 17 01:48:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	Merge backend for 'tab openers' with open_url_in_new_tab().  

Sat Jan 17 01:43:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, terminal/tab.c, terminal/tab.h,
	viewer/text/view.c:

	Make open_in_new_tab() more generic to also handle backgrounded
	tabs.  

Sat Jan 17 01:29:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/Makefile.am:

	We actually don't use libhtml.a anywhere, so it'd be good to say so.  

Sat Jan 17 01:26:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/: Makefile.am, css/apply.c, css/apply.h, css/css.c,
	css/css.h, html/Makefile.am, html/css.c, html/css.h, html/parser.c:

	Very trivial CSS support introducted. It includes mostly the most
	basic framework for the style managment (basically just a temporary
	properties list), bunch of ideas in comments, and the initial
	css_apply(), which now just orders parsing of the element's style
	attribute (no real stylesheet yet, therefore). Oh and only 'color'
	property is supported for now, however it should be easy to
	introduce more. Have fun.  

Sat Jan 17 01:21:15 2004  Petr Baudis <pasky@ucw.cz>:

	* test/css/simplecolors.html:

	Very simple test case for the 'color' property specified in the
	'style' attribute of an element.  

Sat Jan 17 01:20:11 2004  Petr Baudis <pasky@ucw.cz>:

	* test/Makefile.am:

	New css/ directory.  

Sat Jan 17 01:09:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Rename @i to @current_frame_number and initialize it to 0 if it is
	-1 (no frame has been chosen yet). This fixes drawing of title for
	backgrounded tabs containing frame documents.  

Sat Jan 17 00:27:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/session.c, util/string.c, util/string.h:

	Define a string item struct for string lists moving list members out
	of struct string. Requested by pasky.  

Sat Jan 17 00:11:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: util/color.c, util/color.h, config/options.c,
	document/html/parser.c, config/opttypes.c:

	decode_color() now takes the source string length as an additional
	argument.  

Sat Jan 17 00:05:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/color.c:

	Make more use of @slen in decode_color().  

Fri Jan 16 23:49:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/cmdline.c, sched/session.c, sched/session.h,
	terminal/tab.c:

	Use string lists instead of url_list structure and remove lot of
	trivial boring code.  

Fri Jan 16 23:48:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/: string.c, string.h:

	Add support for string lists. This adds list members to struct
	string but since we mostly use it via local variables it should not
	have a big impact.  

Fri Jan 16 22:31:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	do_open_in_new_tab(): Only add an url to list if it is non NULL
	since we test !list_empty() in process_session_info().  

Fri Jan 16 20:30:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Skip the 'MAP@' part of uris when dumping link references.  

Fri Jan 16 20:26:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/dump/dump.c:

	Only dump link titles which are not empty.  

Fri Jan 16 20:08:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: main.c, config/cmdline.c, config/cmdline.h:

	Simplify the composing of the @url_list by using function variable
	and passing the list_head pointer to parse_option(). Let
	parse_option() return the first url again to simplify @url setup.  

Fri Jan 16 19:50:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/main.c:

	No empty @url in the case where the url list returned from
	parse_options() is empty is also a fatal error.  

Fri Jan 16 18:51:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Minor fastmem mode optimization in parser.  

Fri Jan 16 18:21:05 2004  Laurent Monin <zas@norz.org>:

	* src/: main.c, config/cmdline.c, config/cmdline.h,
	sched/session.c, sched/session.h, terminal/tab.c:

	Support for more than one url on command line. ELinks will open new
	tabs for them. For now, -dump and -source will only consider first
	url given (ideas?). Patch by Witold Filipczyk, slightly modified by
	me.  

Fri Jan 16 18:09:59 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	We the normal people put system include to other system includes. We
	do not want to end up again like Links or some other software
	packages, do we? 

Fri Jan 16 17:49:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/css/: .cvsignore, .vimrc:

	Add control files.  

Fri Jan 16 16:30:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Update link_state using get_link_state() safer since there might be
	some corner cases.  

Fri Jan 16 16:29:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Fix the leak related to <sub> and <sup> the Right Way[tm].  

Fri Jan 16 16:18:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Revert last patch. It broke link numbering.  

Fri Jan 16 15:35:34 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Make the HTML renders link_state variable global so recursive calls
	to put_chars() also updates the outer put_chars() link_state. Should
	fix leaks related to links in <sub> and <sup> tags.  

Fri Jan 16 14:49:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/renderer.c:

	Add some temporary assertions for detecting leak in the renderer.  

Thu Jan 15 22:51:52 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/document.c:

	Use directly @doc_view when gettin current link for globhist.  

Thu Jan 15 22:51:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/: session.c, session.h:

	Introduced get_current_link_in_view() which is same as
	get_current_link() but takes directly struct document_view as an
	argument.  

Thu Jan 15 22:51:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/: session.c, session.h:

	Introduced get_current_link_in_view() which is same as
	get_current_link() but takes directly struct document_view as an
	argument.  

Thu Jan 15 22:36:11 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Italian translation update.  

Thu Jan 15 21:44:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/document.c:

	Use get_current_link() to get @historyitem, instead of copy of the
	code.  

Thu Jan 15 21:30:54 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	A missing header inclusion was added.  

Thu Jan 15 17:34:27 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Simplify and fix scroll_menu(). It now behaves like it should when
	paging down in View menu.  

Thu Jan 15 17:02:24 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Simplify menu_page_(up|down)().  

Thu Jan 15 16:11:18 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Move menu page up/down code to separated functions.  

Thu Jan 15 16:04:19 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Fix a segfault occuring when pressing page down on empty Link
	submenu of main menu.  

Thu Jan 15 05:01:00 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	Rename a few functions' parameters and local variables from @down to
	@file_download 

Thu Jan 15 04:41:22 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/download.c, sched/download.c, sched/download.h:

	Create a new function, is_in_downloads_list, to check whether the
	passed struct file_download * is in @downloads (the global variable
	that points into the list of running file downloads).  
	
	Replace the equivalent code in display_download with a call to this
	function.  
	
	In common_download_do and continue_download_do, only add
	@file_download to the download manager _after_ calling load_url or
	change_connection, respectively, and only if
	is_in_downloads_list(file_download).  
	
	This fixes a bug reported by dacap on IRC whereby ELinks would crash 
	when one attempted to download a file while the download manager was
	open.  

Wed Jan 14 19:54:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Add temporary fix for redrawing after calling find_next*(). It broke
	during do_action() generalization.  

Wed Jan 14 18:22:44 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/sched/download.c:

	Swap two lines. This should fix bug 366.  

Wed Jan 14 18:00:06 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Minor fix.  

Wed Jan 14 17:40:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/renderer.c:

	Bug 231 (memory corruption in html renderer) should be fixed now.
	Patch by Miciah and me.  

Wed Jan 14 17:10:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/dialog.c, bfu/hierbox.c, bfu/listbox.c, bfu/menu.c,
	bfu/menu.h, config/dialogs.c, config/kbdbind.c, config/kbdbind.h,
	dialogs/info.c, sched/action.c, sched/action.h,
	viewer/text/search.c, viewer/text/view.c:

	Rename keyact enum to action. Function names changed to reflect
	this.  

Wed Jan 14 16:53:06 2004  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	Binding keys to ACT_NONE is useful to get rid of default
	keybindings. Suggested by Jonas.  

Wed Jan 14 12:25:21 2004  Peter Samek <samek@upc.uniba.sk>:

	* po/sk.po:

	Slovak translation update.  

Tue Jan 13 18:46:57 2004  Varga Balzs <vinnui@ent.hu>:

	* po/hu.po:

	Translation updated.  

Tue Jan 13 16:13:24 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Italian translation update.  

Tue Jan 13 15:37:41 2004  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	Do not display ACT_NONE action in keybinding manager, bind keys to
	this action is useless.  

Tue Jan 13 15:05:32 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Fix mouse click detection on main menu (introduced by main menu
	previous patch).  

Tue Jan 13 14:54:39 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/menu.c, bfu/menu.h, mime/dialogs.c:

	FREE_ANY macro is now used to shorten lines, it is equivalent to
	(FREE_LIST|FREE_TEXT|FREE_RTEXT|FREE_DATA).  

Tue Jan 13 14:48:51 2004  Laurent Monin <zas@norz.org>:

	* src/mime/dialogs.c:

	No need to pass @xxx to do_menu(), just use NULL instead. Safer
	imho.  

Tue Jan 13 14:41:41 2004  Laurent Monin <zas@norz.org>:

	* src/sched/download.c:

	Some assertions were added (related to bug 366).  

Tue Jan 13 14:26:48 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Fix handling of various spacing in main menu.  

Tue Jan 13 14:22:55 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/listmenu.c:

	Use macros to check end of menu.  

Tue Jan 13 14:13:15 2004  Laurent Monin <zas@norz.org>:

	* src/config/: kbdbind.c, kbdbind.h:

	Move ACT_NONE at start of enum keyact and use zero as value for it.
	It was breaking contextual menus display and perhaps other stuff.  

Tue Jan 13 08:45:53 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Jan 12 18:23:07 2004  Fabio Bonelli <fabiobonelli@libero.it>:

	* po/it.po:

	Updated italian translation.  

Sun Jan 11 22:16:17 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update.  

Sun Jan 11 18:18:42 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/info.c:

	GPLv2 only. Reminded by Jonas.  

Sun Jan 11 18:13:57 2004  Petr Baudis <pasky@ucw.cz>:

	* COPYING:

	Removed ELusive part for the foreseeable future.  

Sun Jan 11 17:48:25 2004  Petr Baudis <pasky@ucw.cz>:

	* COPYING:

	GPLv2, not any future version.  

Sun Jan 11 05:41:30 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: dialogs/status.c, sched/task.c:

	Instead of zeroing the session's 'visited' flag in display_tab_bar, 
	zero it in ses_forward.  
	
	This is more logical and efficient, as we now zero the flag once, 
	when we finish loading the page, instead of repeatedly, once every
	time we update the tab bar, from when we first start trying to load
	the page to when we finish or fail.  
	
	More importantly, it fixes a bug whereby we would leave the tab
	highlighted as freshly loaded even if the page failed to load.  

Sat Jan 10 11:16:27 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Jan 10 11:03:58 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/cmdline.c:

	Made -confdir/-conffile captions more consistent and fixed -confdir
	description. Idea by Doug Kerans <djkea@mugca.its.monash.edu.au>.  

Sat Jan 10 06:10:36 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Fri Jan  9 21:30:58 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Explode count_menu_size() in 4 functions.  

Fri Jan  9 21:04:19 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Got rid of @s, and initialize mx to zero.  

Fri Jan  9 20:48:01 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	count_menu_size() was cleaned and fixed. Next step will be to cache
	text and rtext widths, as well as display-related infos, it will
	simplify things a lot (we currently make and remake many useless
	calculations) 

Fri Jan  9 15:20:59 2004  Laurent Monin <zas@norz.org>:

	* src/: setup.h, bfu/menu.c:

	Use constants and make calculations explicit, code simplification,
	MENU_HOTKEY_SPACE disappears, locally defined macros replace it,
	improving code clarity.  

Fri Jan  9 14:14:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	...except this little mistake. Fixed segfaults when opening menu
	thru kbd.  

Fri Jan  9 14:14:08 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Reverted bogus Miciah' fix, what we did previously was ok...  

Fri Jan  9 14:07:03 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Fix segfaults resulting from pasky's menu-handler butchering.
	(@win->data->win is _not_ the same as @win.) 

Fri Jan  9 13:12:12 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/backend/xbel.c:

	In the XBEL bookmark code, when adding a folder, do not bother to
	set ->root or ->box_item->type, as add_bookmark does that for us.  

Fri Jan  9 13:07:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/leds.c:

	Itty-bitty whitespace fix.  

Fri Jan  9 12:57:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	#undef macros once we're done with them.  

Fri Jan  9 12:38:30 2004  Petr Baudis <pasky@ucw.cz>:

	* Makefile.am:

	Added feature.h. Oops.  

Fri Jan  9 11:08:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Pass @fwd to mainmenu_kbd_handler().  

Fri Jan  9 11:08:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Moved @s from mainmenu_handler() to mainmenu_kbd_handler().  

Fri Jan  9 11:00:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Readded DIST macro, which got chopped most of it off during
	reindentation.  

Fri Jan  9 10:56:14 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	In draw_menu_left_text_hk, rename the @len parameter to @hotkey_pos.  

Fri Jan  9 10:51:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Remove an inaccurate comment.  

Fri Jan  9 10:44:35 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Moved menu/kbd event handling from mainmenu_handler() to
	mainmenu_(mouse|kbd)_handler().  

Fri Jan  9 10:40:07 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Blanklines.  

Fri Jan  9 10:39:17 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/menu.c:

	Moved menu/kbd event handling from menu_handler() to
	menu_(mouse|kbd)_handler().  

Fri Jan  9 10:38:37 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	#undef macros once we're done with them.  

Fri Jan  9 10:36:44 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Remove useless test. Spotted by Miciah.  

Fri Jan  9 10:27:57 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/file/file.c:

	In stat_user and stat_group, don't check for the case where a
	successful stat(2) call gives a uid or gid of -1. If it ever does,
	why not humour the system and proceed to use the values it has
	provided to us? 

Fri Jan  9 10:25:54 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Use @menu->selected instead of @s. Spotted by Miciah.  

Fri Jan  9 10:22:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Fixed the Jonas' strangeness.  

Fri Jan  9 10:09:31 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Revert last patch, it was correct. Sorry, Miciah ;).  

Fri Jan  9 09:52:55 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Start on first main menu item displayed. Suggested by Miciah.  

Fri Jan  9 09:42:25 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/dialogs.c:

	Do not give the B_ENTER flag to the 'Do not show anymore' button in
	the 'Write config success' box.  

Fri Jan  9 09:36:45 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/tab.c:

	When closing the current tab, switch to the previous tab _first_, so
	that the next tab doesn't lose its 'unvisited' highlighting.  

Fri Jan  9 09:31:55 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Fix session saving to bookmark tabs from left to right.  

Fri Jan  9 09:27:58 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/bookmarks.c:

	Remove an obsolete comment.  

Fri Jan  9 09:26:25 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.c:

	Update a comment: s/item_free/flags/ 

Fri Jan  9 09:14:21 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/terminal/tab.c:

	Remove the @link parameter from get_tab_link_url. The parameter only
	says whether to return NULL or to actually do something, so move
	that check to the callers.  

Fri Jan  9 07:20:11 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bookmarks/dialogs.c:

	Include util/ttime.h for ttime.  

Fri Jan  9 01:22:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	I hope this is strange enough.  

Fri Jan  9 01:10:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Remove a few ending action description dots.  

Fri Jan  9 01:08:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Minor cleanup of action listbox initialization. No longer gettext
	action names but only the descriptions.  

Fri Jan  9 01:06:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Add description to 'none' action.  

Fri Jan  9 00:43:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Don't add listbox for ACT_SCRIPTING_FUNCTION since we hide it anyway
	and the current generic hierbox handling always unhides all root
	level boxes.  

Fri Jan  9 00:21:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Fix off by one error, which is really not my fault because we
	skipped 'none' before.  

Fri Jan  9 00:14:28 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/: kbdbind.c, kbdbind.h:

	Alphabetise action_table and keyact enum. Hmm 

Thu Jan  8 23:36:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Fix startup goto dialog. Patch by Zardoz.  

Thu Jan  8 23:26:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/cmdline.c, config/options.h, config/options.inc,
	mime/backend/mailcap.c:

	We only use alias description and captions for commandlines so no
	need to store them for 'regular' options.  

Thu Jan  8 22:26:04 2004  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	automatic session saving/restoring support 

Thu Jan  8 22:22:23 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	0.9.CVS. Please backport all the relevant bugfixes to REL_0_9_1rc1
	branch. Expected 0.9.1-final release: Sunday. What a mess.  

Thu Jan  8 22:15:46 2004  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	0.9.1rc1 

Thu Jan  8 22:14:57 2004  Laurent Monin <zas@norz.org>:

	* src/document/renderer.c:

	Revert extra patch made by Jonas. It has nothing to do there.  

Thu Jan  8 22:14:44 2004  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	now: feature.h and <object>.  

Thu Jan  8 22:08:11 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Typo fix.  

Thu Jan  8 22:03:15 2004  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, da.po, de.po, el.po, es.po, et.po,
	fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po, leet.po,
	lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po, sk.po,
	sv.po, tr.po, uk.po:

	.po files were resynced.  

Thu Jan  8 22:03:08 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update.  

Thu Jan  8 22:00:01 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Typo fix.  

Thu Jan  8 21:58:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Thu Jan  8 21:54:48 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Jan  8 21:54:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, document/options.c,
	document/renderer.c:

	Hmm or was it document.browse.forms.input_size. :-P 

Thu Jan  8 21:51:12 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update.  

Thu Jan  8 21:48:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	'Twas document.browse.forms.input_size.  

Thu Jan  8 21:43:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	document.html.default_forms_input_size ->
	document.browse.frames.input_size. It wasn't introduced that long
	ago so I think it doesn't deserve an alias ;-).  

Thu Jan  8 21:26:00 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	get_bgcolor() now again bails out when it smells mono color_mode.
	Zas removed this, but he didn't mention it in the log message so I
	believe it was just a mistake.  

Thu Jan  8 21:17:29 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/conf.c:

	Add the ELinks VERSION header only when we are writing the file from
	scratch.  

Thu Jan  8 21:07:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Sort Document :: Cache options.  

Thu Jan  8 21:00:37 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/view.c:

	Punct. fix.  

Thu Jan  8 18:37:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/info.c,
	dialogs/info.h, dialogs/menu.c, sched/action.c:

	Add resource-info action and cleanup res_info() renaming it to
	resource_info() and trimming args.  

Thu Jan  8 17:58:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/: man/man5/elinks.conf.5, tools/help2doc:

	Update elinks.conf.5 copyright and sync with current option tree.  

Thu Jan  8 17:53:06 2004  Peter Samek <samek@upc.uniba.sk>:

	* po/sk.po:

	Slovak translation update.  

Thu Jan  8 17:49:00 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Various fixes and cleanups.  

Thu Jan  8 17:24:37 2004  Varga Balzs <vinnui@ent.hu>:

	* po/hu.po:

	Hungarion translation update.  

Thu Jan  8 17:17:36 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Remove ending dots in captions.  

Thu Jan  8 17:14:41 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.c:

	Extend caption test to i18n captions.  

Thu Jan  8 16:58:17 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French grammar fixes.  

Thu Jan  8 16:53:04 2004  Laurent Monin <zas@norz.org>:

	* src/config/conf.c:

	ELinks version is now written at top of configuration file.  

Thu Jan  8 16:07:48 2004  Laurent Monin <zas@norz.org>:

	* src/config/conf.c:

	Only add a slash to config file name when needed, it prevents double
	slashes in filename displayed in message boxes.  

Thu Jan  8 15:41:21 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Jan  8 15:25:18 2004  Laurent Monin <zas@norz.org>:

	* src/config/dialogs.c:

	Touch option when toggling, suggested by Jonas, and test for term in
	write_config_success().  

Thu Jan  8 14:59:53 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Jan  8 14:57:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, sched/session.c:

	Rename ui.sessions.homepage_url to ui.session.homepage, and change
	the behaviour so that "" means use getenv(WWW_HOME) instead. Also
	restore the fallback to WWW_HOME_URL.  

Thu Jan  8 14:56:35 2004  Laurent Monin <zas@norz.org>:

	* src/config/: conf.c, dialogs.c:

	Test for ui.success_msgbox was moved to write_config_success(). A
	new button [ Do not show anymore ] permits to toggle
	ui.success_msgbox from the message box.  

Thu Jan  8 14:25:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Do a little wrapping to make it possible to call enter() through
	do_frame_action().  

Thu Jan  8 14:19:24 2004  Laurent Monin <zas@norz.org>:

	* src/document/: options.h, html/parser.c, html/renderer.c:

	Use macros to wrap comparaisons of use_document_colors.  

Thu Jan  8 13:47:05 2004  Laurent Monin <zas@norz.org>:

	* src/document/: options.c, options.h, html/parser.c,
	html/renderer.c:

	Use "colors" instead of "colours" since it seems the first one is
	the most used in ELinks code.  

Thu Jan  8 13:37:08 2004  Laurent Monin <zas@norz.org>:

	* src/: document/options.c, viewer/text/marks.c:

	Trailing spaces fixes.  

Thu Jan  8 13:32:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Thu Jan  8 13:28:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/action.c:

	Normalise exit_prog(). It now takes a @query argument inverting the
	previous meaning.  

Thu Jan  8 13:13:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, lowlevel/signals.c:

	Don't call exit_prog() but queue terminal destruction directly.
	exit_prog() is a high level ui function and should not be called
	from a signal handler.  

Thu Jan  8 10:04:05 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Thu Jan  8 09:53:06 2004  Laurent Monin <zas@norz.org>:

	* src/: config/options.inc, sched/action.c, sched/session.c,
	sched/session.h:

	As requested by Jonas, ui.sessions.homepage_url option now controls
	default homepage. And ui.sessions.ignore_www_home permits to force
	use of ui.sessions.homepage_url value instead of env. var. WWW_HOME.
	Note that WWW_HOME_URL still exists in setup.h and is used as
	default value for ui.sessions.homepage_url 

Thu Jan  8 09:09:35 2004  Laurent Monin <zas@norz.org>:

	* src/sched/action.c:

	Typo fixes.  

Thu Jan  8 03:48:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Fix action for submit-form-reload.  

Thu Jan  8 03:44:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c,
	viewer/text/form.c, viewer/text/form.h, viewer/text/link.c:

	Introduce submit-form and submit-form-reload actions mostly to use
	them for menus and simplify submit_form_do() [renamed to
	submit_form()] by calling it through do_frame_action().  

Thu Jan  8 03:28:06 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, sched/action.c,
	viewer/text/form.c, viewer/text/form.h, viewer/text/link.c:

	Introduce reset-form action and handle it in do_action() making it
	possible to handle form reseting entries in the link menu via the
	action object model and frontend reset form via do_frame_action().  

Thu Jan  8 03:15:02 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/link.c, viewer/text/view.c,
	viewer/text/view.h:

	do_action(): Handle enter and enter-reload for menu code. Nuke
	send_enter_reload().  

Thu Jan  8 02:50:21 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Cleanup double up on action kbd_action() call.  

Thu Jan  8 02:48:19 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Complete merging of send_event() stuff with do_action(). Quit.  

Thu Jan  8 02:34:46 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, sched/action.c, viewer/text/view.c:

	do_action(): Handle quit and lua-console actions.  

Thu Jan  8 02:23:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Woopsi, forgot to check whether !anonymous before downloading link.  

Thu Jan  8 02:20:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/view.c:

	Another adventures simplification. Merge frm_download() goodies into 
	download_link().  We do not need the link->type checking parts since 
	get_link_url() will take care of those for us. Instead of passing
	some new enum the action enum is passed to download_link(), much
	simpler. As for the "MAP@" checking it should hopefully not harm
	anything else we could surround it in ACT_DOWNLOAD or something.  

Thu Jan  8 02:02:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/link.c, viewer/text/view.c,
	viewer/text/view.h:

	Another big simplification possible by using do_frame_action() as
	front end.  It is now used to handle download and download-image
	actions.  send_download() is now equivalent to download_link().  

Thu Jan  8 01:50:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Make it possible to pass magic numbers to the do_frame_action()
	@func handler.  

Thu Jan  8 01:34:13 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	Rename send_image() to view_image() and use it through
	do_frame_action().  

Thu Jan  8 01:26:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/link.c, viewer/text/view.c:

	do_action(): Handle image and link menu actions. Eh patch is bloated
	by a few cleanups.  

Thu Jan  8 01:09:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Backend the goto url bi'nez using the get_current_*url() functions.  

Thu Jan  8 00:57:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/view.c:

	do_action(): Handle the rest of the goto url actions.  

Thu Jan  8 00:39:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Move goto home page code to separate function to keep the switch
	noodle clean.  

Thu Jan  8 00:29:58 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/view.c:

	Move lots of action handling from send_event() to do_action().  

Wed Jan  7 23:53:30 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.c:

	Bug when trying to get_opt_*() an alias.  

Wed Jan  7 23:26:12 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Jan  7 23:24:29 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.c:

	Debug mode helper to detect ending dot in option captions. It will
	emit a debug message in this case.  

Wed Jan  7 22:55:37 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.inc:

	Ending dot was removed in option caption.  

Wed Jan  7 21:24:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, viewer/text/search.c:

	Move typeahead options to document.browse.search.* and make them
	more generic so they might even be used for other search actions.  

Wed Jan  7 20:02:11 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	html_iframe() now handles id as a synonymum to name attribute.  

Wed Jan  7 20:01:14 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/html/parser.c:

	Implemented very simplistic, quick'n'dirty <object> element support.
	Now it just wraps either html_iframe() or html_img() or it just does
	nothing. You can test it ie. at http://digitasaru.net/ (the
	navbar.html is an object of type text/html).  

Wed Jan  7 19:32:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/action.c:

	menu_save_url_as() -> save_url_as() and drop some args.  

Wed Jan  7 19:27:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	Use local term variable.  

Wed Jan  7 19:18:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, sched/action.c,
	terminal/terminal.c, terminal/terminal.h:

	Rename menu_shell() to exec_shell() and move to terminal files.  

Wed Jan  7 19:11:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/action.c:

	do_frame_action(): Assert the view state.  

Wed Jan  7 19:08:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	Rename menu_save_formatted() to save_formatted_dlg() and use
	do_frame_action() as backend (or is it front end ;).  

Wed Jan  7 18:57:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	More #include fixes related to the recent action patches.  

Wed Jan  7 18:52:59 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, dialogs/menu.h, terminal/tab.c,
	viewer/text/view.c:

	Remove / fix #includes related to the recent action patches.  

Wed Jan  7 18:26:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* po/README:

	Mention what '~' in string mean that hotkeys should be unique.  

Wed Jan  7 17:02:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, sched/action.c, viewer/text/view.c:

	do_action(): Handle save-* actions. Saving formatted should always
	be interactive so we hardcode that in menu_save_formatted() now.  

Wed Jan  7 16:46:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Update the anonymous setup menu to use the new *buzz* action object
	model *buzz ;-) 

Wed Jan  7 16:42:27 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, sched/action.c, viewer/text/view.c:

	do_action(): Save option and open terminal option dialog was added.  

Wed Jan  7 16:29:00 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, sched/action.c, viewer/text/view.c:

	Move some frame related action handling to do_action(). It uses
	do_frame_action() as a backend which is just a moved version of
	menu_for_frame().  

Wed Jan  7 15:23:16 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.h, dialogs/menu.c:

	Introduce INIT_MENU_ACTION() to decrease the noise of unused
	arguments.  

Wed Jan  7 14:53:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	Use add_menu_action() in link_menu().  

Wed Jan  7 14:47:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.h, dialogs/menu.c, viewer/text/link.c:

	Make add_menu_action() reflect that no data can be passed. Also
	purge the flag arg since it is not used.  

Wed Jan  7 14:44:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.c, sched/action.c, sched/action.h,
	viewer/text/view.c:

	do_action(): Don't take any data arg. We handle that in the
	function.  

Wed Jan  7 14:41:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, sched/action.c, viewer/text/link.c,
	viewer/text/view.c:

	Move bookmark adding action handling to do_action().  

Wed Jan  7 12:13:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, sched/action.c, viewer/text/link.c,
	viewer/text/view.c:

	Move ACT_OPEN_* handlers to do_action().  

Wed Jan  7 08:44:27 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Jan  7 03:49:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/dialogs.c, bookmarks/dialogs.h, dialogs/menu.c,
	sched/action.c:

	Handle ACT_BOOKMARK_TABS in do_action(). Normalise the dialog to
	only take the terminal.  

Wed Jan  7 03:47:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/terminal.c:

	Ensure we are not in anonynous mode before autosaving.  

Wed Jan  7 03:42:43 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Don.t add bookmark entries when running in anonymous mode.  

Wed Jan  7 03:18:18 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/dialogs.c, bookmarks/dialogs.h, cache/dialogs.c,
	cache/dialogs.h, config/dialogs.c, config/dialogs.h,
	cookies/dialogs.c, cookies/dialogs.h, dialogs/download.c,
	dialogs/download.h, formhist/dialogs.c, formhist/dialogs.h,
	globhist/dialogs.c, globhist/dialogs.h, sched/action.c:

	Normalise manager functions. They are nolonger menu functions so
	there is no need to pass bogus arguments to them.  

Wed Jan  7 03:02:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Presenting the missing good parts from last patch. Removing
	#includes. I sense a small break in the moaning from paskys build
	box.  

Wed Jan  7 02:57:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Oops forgot to remove menu functions so do_action() is used.  

Wed Jan  7 02:53:30 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/renderer.c:

	Remove a superfluous |continue| introduced in
	src/document/html/renderer.c:1.254->1.255.  

Wed Jan  7 02:50:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: globhist/dialogs.c, sched/action.c, viewer/text/view.c:

	do_action(): Handle the manager actions. Also drop the anonymous
	checking since unwanted buttons will not be shown. For globhist
	manager it basicly becomes more like the cache manager, and
	option/keybinding manager will only let the user read descriptions
	and do we really want to deprive anonymous users this educational
	experience? ;-) 

Wed Jan  7 02:01:45 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/view.c:

	Move the rest of the document option toggling in send_event() to
	do_action().  

Wed Jan  7 01:57:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: sched/action.c, viewer/text/view.c, viewer/text/view.h:

	Ahh the joy of generalization. Toggling document option that is.  

Wed Jan  7 01:22:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.c, dialogs/menu.c, dialogs/menu.h,
	sched/Makefile.am, sched/action.c, sched/action.h,
	viewer/text/view.c:

	Move do_action() to separate file.  

Wed Jan  7 01:09:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	send_event(): Use do_action().  

Wed Jan  7 00:58:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.c, dialogs/menu.c, dialogs/menu.h:

	Optionalize whether to bug or not when the action was not handled
	and also return the action if it handled or ACT_NONE. This should
	make it usable for send_event() later.  

Wed Jan  7 00:40:47 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/document.c, document/document.h,
	document/renderer.c, viewer/text/link.c, viewer/text/link.h:

	Finish the moving of sort_links() by also moving done_link_members()
	used by it and others only in document/. Fix #include of stdlib.h
	for qsort (on FreeBSD atleast).  

Wed Jan  7 00:38:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Instead of defining a wrapper function for each sub menu define
	do_submenu() and pass the sub menu items as the data.  

Wed Jan  7 00:21:48 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, terminal/tab.c, terminal/tab.h,
	viewer/text/view.c:

	do_action(): Handle close all tabs but current action and normalize
	the function since it no longer needs to be a menu function.  

Wed Jan  7 00:12:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	do_action(): Handle most used toggling actions.  

Wed Jan  7 00:06:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	do_action(): Handle ACT_DOCUMENT_INFO, ACT_HEADER_INFO and
	ACT_KILL_BACKGROUNDED_CONNECTIONS.  

Tue Jan  6 23:59:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c:

	It was unanimously decided to use minimize instead of shrink.  

Tue Jan  6 23:39:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	do_action(): Insert all unhandled actions so it will be easier to
	muddle on.  

Tue Jan  6 23:26:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c:

	Add ACT_CACHE_SHRINK action and use it for do_action(). The concept
	is muddled so I chose shrink since to me it only indicates some best
	effort kind of thing but the action description should be quite
	clear.  

Tue Jan  6 23:02:39 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	do_action(): Add ACT_RELOAD handling.  

Tue Jan  6 22:55:22 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	do_action(): Add ACT_GOTO_URL and sort actions alphabetically for
	now.  

Tue Jan  6 22:47:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Blast menu wrappers in favour of do_action() handling.  

Tue Jan  6 21:48:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: document/renderer.c, viewer/text/link.c,
	viewer/text/link.h:

	Moved sort_links() from viewer/text/link.c to document/renderer.c.
	It really operates on {struct document} exclusively, so it really
	belongs to document/.  

Tue Jan  6 21:43:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/error.c:

	Add a notice to the force_dump() that what happenned is not a
	regular segfault but rather an internal error, and therefore users
	shouldn't report it as a segfault but internal error. Really tired
	of those 'ELinks segfaulted' reports, being just assertion failures
	in disguise.  

Tue Jan  6 21:00:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.c, bfu/menu.h, dialogs/menu.c, dialogs/menu.h:

	Introduce do_action() for handling session oriented actions. It can
	hopefully gradually evolve into some backend for frame_ev() or
	send_event(). To start with it is used for menus since - after Zas'
	menu action hacking - we begin to use generic action event handlers.
	It is called when the menu function is NULL and the action !=
	ACT_NONE. A macro add_menu_action() ease the dynamic adding of such
	menu entries.  

Tue Jan  6 19:35:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/session.c:

	Fix bookmark adding from plain document (where link->name is NULL)
	and improve the 'name' by checking if globhist can provide us with a
	title.  

Tue Jan  6 06:28:15 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/dialogs/status.c:

	Displaying of received after resume was broken.  

Mon Jan  5 19:47:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/globhist/globhist.c:

	Fix compiling globhist with warnings. The write timer is unused.  

Mon Jan  5 19:44:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/hierbox.c:

	Add missing #include <stdarg.h> 

Mon Jan  5 16:55:30 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/download.c:

	Removed ancient FIXME, I'm not gonna fix anything anymore :-).  

Mon Jan  5 13:33:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/dump/dump.c:

	Use tab instead of bunch of spaces to indent link target.  

Mon Jan  5 13:32:53 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/dump/dump.c:

	Fixed an off-by-one overflow when iterating through links.  

Mon Jan  5 11:29:40 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inphist.c:

	Remove unused menu macro.  

Mon Jan  5 11:11:19 2004  Laurent Monin <zas@norz.org>:

	* configure.in:

	gcc flag -fno-inline was removed (--enable-debug mode). It causes
	compilation failure with old gcc/glibc. Errors like undefined
	reference to __strcpy_small are shown, and linking fails.  

Mon Jan  5 08:51:15 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/dump/dump.c:

	Print the title with each link when a title is available.  

Mon Jan  5 08:42:27 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/dump/dump.c:

	In the dump output, when printing the link footnotes below the
	document, include the first link.  

Mon Jan  5 06:14:10 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/view.c:

	In page_down, remove some useless assignments to @newpos, which were
	introduced in src/viewer/text/view.c:1.302->1.303.  

Mon Jan  5 05:51:08 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/renderer.c:

	Remove do_format, which was made a pretty well useless wrapper in
	src/document/html/renderer.c:1.344->1.345, and instead call
	parse_html directly from format_html_part.  

Mon Jan  5 04:54:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: osdep/os2/os2.c, viewer/text/view.c, util/error.h:

	Update a few occurrences of the error(), debug(), wdebug(), and
	internal() macros (now ERROR(), DBG(), WDBG(), and INTERNAL(),
	respectively) in comments and commented-out code.  

Sun Jan  4 23:40:49 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/inphist.c:

	Use dynamic menu interface for tab completion menus.  

Sun Jan  4 20:57:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/hierbox.c:

	Fix the is-that-a-folder check introduced by zas.  

Sun Jan  4 20:54:09 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/dialogs.c:

	Removed some seemingly forgotten condition if (range) in the middle
	of source.  

Sun Jan  4 20:36:26 2004  Petr Baudis <pasky@ucw.cz>:

	* SITES:

	pasky.ji.cz -> pasky.or.cz 

Sun Jan  4 20:18:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hierbox.c, hierbox.h, listbox.h:

	Name the listbox item type enum so we can use exact type in
	functions.  

Sun Jan  4 20:02:42 2004  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	.po files were resynced.  

Sun Jan  4 18:56:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/: download.c, status.c, status.h:

	Move download_is_progressing() to header (that is now included in
	the .c file) so it can be used by the download dialog code.  

Sun Jan  4 18:13:04 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/globhist/globhist.h:

	Declare input_history now used for global_history.  

Sun Jan  4 17:53:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/backend/: mailcap.c, mimetypes.c:

	Update copyright.  

Sun Jan  4 17:42:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Sync with current option tree.  

Sun Jan  4 16:54:03 2004  Petr Baudis <pasky@ucw.cz>:

	* src/document/refresh.c:

	Removed some funny semicolons.  

Sun Jan  4 16:47:32 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Jan  4 16:22:24 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/: conf.c, options.inc:

	Introduced ui.success_msgbox which controls displaying of the
	file-was-saved-successfully msgbox. Like it would be so difficult,
	Jonas and Zas.  

Sun Jan  4 16:20:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/conf.c, config/dialogs.c, config/dialogs.h,
	dialogs/options.c:

	Moved options saving success reporting from individual save button
	handlers to write_config_file().  

Sun Jan  4 15:56:43 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Jan  4 15:41:15 2004  Laurent Monin <zas@norz.org>:

	* src/: config/conf.c, config/conf.h, config/dialogs.c,
	dialogs/options.c:

	A success message is now displayed when options and terminal options
	are sucessfully saved through UI.  

Sun Jan  4 15:40:54 2004  Petr Baudis <pasky@ucw.cz>:

	* src/sched/session.c:

	display_timer() tidyup.  

Sun Jan  4 15:05:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/inphist.c, bfu/inphist.h, globhist/globhist.c:

	Use macros to add to and delete from input_history.  

Sun Jan  4 15:04:40 2004  Laurent Monin <zas@norz.org>:

	* src/config/dialogs.c:

	Option modify/info dialogs now shows valid range for boolean,
	integer, and long types.  

Sun Jan  4 15:03:03 2004  Laurent Monin <zas@norz.org>:

	* src/config/options.h:

	Use long type for struct option min and max fields since value may
	be long.  

Sun Jan  4 14:53:36 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/globhist/globhist.c:

	Cleanup and unify finalizers.  

Sun Jan  4 14:40:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/globhist/globhist.c:

	Cleanup.  

Sun Jan  4 14:11:22 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/hierbox.c:

	Show a simple message when pressing Info on a folder in an hierbox
	browser. "Press space to expand this folder." is now displayed in
	this case. It works in Cookies manager. Jonas please check if it is
	done as it should or not.  

Sun Jan  4 11:57:35 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/globhist/: dialogs.c, globhist.c, globhist.h:

	Replace global_history_list with input_history. 'One struct to rule
	them all ..' Well maybe we should s/input_history/history_list/ but
	it makes good sense .. also in the perspective of history modules.  

Sun Jan  4 11:42:10 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/globhist/globhist.c:

	Remove usage of struct globhist_cache_entry that only takes up extra
	memory since struct hash_item does all the work.  

Sun Jan  4 06:21:29 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Sun Jan  4 01:47:56 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Jan  4 01:42:29 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/: history.c, history.h:

	Comment out the definition and use of compress_history (introduced
	in src/sched/history.c:1.59->1.60 and src/sched/history.h:1.23->1.24
	to fix bug 309) as they were preventing session items from beng
	added when one follows a link in a frame or a link to a fragment
	identifier on the current page.  

Sun Jan  4 01:40:36 2004  Laurent Monin <zas@norz.org>:

	* configure.in:

	Add -fno-inline to CFLAGS when gcc and --enable-debug are used. It
	permits to get more meaningfull backtrace.  

Sun Jan  4 00:56:29 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/listmenu.c:

	Some TODO were added.  

Sun Jan  4 00:44:15 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Test was simplified.  

Sun Jan  4 00:40:45 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Testing against NULL is done in strlcasecmp(), extra test was
	removed.  

Sun Jan  4 00:38:08 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Prevent useless computation of constant string length by caching its
	value. Test with strlcasecmp() were simplified since now NULL string
	is correctly handled. An assertion was added to check name and
	*name.  

Sun Jan  4 00:20:31 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/draw.c:

	draw_text() will now simply return on negative length case, when
	assertions are disabled.  

Sun Jan  4 00:17:42 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	An assertion failure was fixed. It was triggered by resizing
	download dialog in progress to a very low width: negative length for
	text, badly accepted by draw_text().  

Sun Jan  4 00:07:50 2004  Laurent Monin <zas@norz.org>:

	* src/terminal/screen.c:

	Some assertions were added to resize_screen(). Use size_t type
	instead of int for size and bsize variables.  

Sat Jan  3 23:43:05 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/terminal.c:

	Remove functions that are now macros.  

Sat Jan  3 16:04:42 2004  Laurent Monin <zas@norz.org>:

	* src/: bfu/listmenu.h, document/html/parser.h, viewer/text/form.c:

	Now useless header declarations were removed. bfu/listmenu.h is now
	included in viewer/text/form.c.  

Sat Jan  3 15:10:26 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	Include listmenu.h.  

Sat Jan  3 15:10:02 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Last bits of list menus changes.  

Sat Jan  3 15:08:46 2004  Laurent Monin <zas@norz.org>:

	* src/bfu/: Makefile.am, listmenu.c, listmenu.h:

	List menu functions were moved from parser.c to separate files.  

Sat Jan  3 15:07:43 2004  Laurent Monin <zas@norz.org>:

	* src/util/: conv.c, conv.h:

	clr_spaces() was moved from document/html/parser.c to conv.c. It is
	needed since next patch will move list menu functions to
	bfu/listmenu.{c,h}.  

Sat Jan  3 13:59:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, cookies/dialogs.c:

	Make it possible to remove cookie folders.  

Sat Jan  3 13:12:15 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/hierbox.h, cookies/cookies.c,
	cookies/dialogs.c:

	Cookies are now grouped by server. Patch contains some changes to
	make clearing work. It is still not possible to delete a server
	folder.  

Sat Jan  3 13:08:46 2004  Petr Baudis <pasky@ucw.cz>:

	* src/terminal/palette.inc:

	Compilation fix for CONFIG_256_COLORS.  

Sat Jan  3 11:56:08 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hierbox.c, hierbox.h:

	Backend add_listbox_item().  

Sat Jan  3 11:07:32 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hierbox.c, listbox.h:

	Add free_empty_folder member to listbox_item.  

Sat Jan  3 10:58:50 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hierbox.h, listbox.h:

	Move up the listbox_item depth member and define it to -1 for
	hierbox_browser root boxes.  

Sat Jan  3 06:53:19 2004  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* src/protocol/file/cgi.c:

	Now executables (when not in CGI path) are displayed as normal
	files.  Displaying of error dialog box was annoying.  

Sat Jan  3 01:11:57 2004  Petr Baudis <pasky@ucw.cz>:

	* src/cookies/Makefile.am:

	Fixed linking parsetst when having separate srcdir and builddir,
	patch by Harold L Hunt II <huntharo@msu.edu>.  

Sat Jan  3 01:11:31 2004  Petr Baudis <pasky@ucw.cz>:

	* AUTHORS, Makefile.base:

	Fixed make testutils when having separate srcdir and builddir, patch
	by Harold L Hunt II <huntharo@msu.edu>.  

Fri Jan  2 22:06:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/bookmarks.c:

	Remove unused variables left untouched from last patch. BTW Miciah
	pointed out the suspicious code that lead to the fix.  

Fri Jan  2 21:58:53 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/bookmarks.c:

	Whoops major bookmark corruption since we do smarter text management
	and this part was not updated.  

Fri Jan  2 20:05:44 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Fixed hotkey conflict.  

Fri Jan  2 19:54:51 2004  Petr Baudis <pasky@ucw.cz>:

	* src/: config/cmdline.c, util/color.c:

	Better cast the color to (unsigned long), to stay safe on 16-bit
	systems.  

Fri Jan  2 19:33:09 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/hierbox.h, cache/cache.c,
	cookies/cookies.c, formhist/formhist.c, globhist/globhist.c,
	sched/download.c:

	init_listbox_item() -> add_listbox_item().  

Fri Jan  2 18:37:56 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, bfu/hierbox.h, bfu/listbox.c,
	bookmarks/bookmarks.c, bookmarks/bookmarks.h, bookmarks/dialogs.c,
	cache/cache.c, cache/cache.h, cache/dialogs.c, config/dialogs.c,
	config/kbdbind.c, config/kbdbind.h, config/options.c,
	cookies/dialogs.c, dialogs/download.c, formhist/dialogs.c,
	globhist/dialogs.c, globhist/globhist.c, globhist/globhist.h:

	Add a root listbox item to the hierbox_browser struct. It will ease
	hierarchic cookies and other stuff.  

Fri Jan  2 17:53:20 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Remove default keybinding for tab-close-all-but-current action.  

Fri Jan  2 17:51:23 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.h, bookmarks/dialogs.c, cache/dialogs.c,
	config/dialogs.c, cookies/dialogs.c, dialogs/download.c,
	formhist/dialogs.c, globhist/dialogs.c:

	Use macros to intialize hierbox_browser structs.  

Fri Jan  2 16:19:52 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Revert last patch. It breaks wraparound.  

Fri Jan  2 16:14:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Use link->name if available to compare with in typeahead searching.  

Fri Jan  2 15:47:20 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Fixed indentation of ACT_SAVE_AS.  

Fri Jan  2 15:39:41 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.c:

	It's ok to pass NULL strings to strl*cmp() now. Suggested by zas.  

Fri Jan  2 15:38:06 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/: string.c, string.h:

	Reverted useless same_*str(), I explicitly said no to them before
	their introduction.  

Fri Jan  2 15:35:19 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.h:

	strl*cmp() non-zero return value meaning is undefined.  

Fri Jan  2 15:29:38 2004  Laurent Monin <zas@norz.org>:

	* src/util/: string.c, string.h:

	same_str() and same_casestr() were introduced. Their behavior is
	similar (and in most cases) to strlcmp() and strlcasecmp() but well
	defined. They return 1 if strings match (regarding rules we defined)
	and 0 in all others case, they accept NULL pointers as strings, but
	returns always 0 in that case. If passed string length is negative,
	then nul char is used to detect end of comparaison. In near future,
	almost all occurrences of strl[case]cmp() will be replaced by those,
	and trashed. Feel free to propose better names, but not *strcmp*
	since it may be confusing.  

Fri Jan  2 14:42:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/util/string.c:

	Fixed missspeling.  

Fri Jan  2 13:29:18 2004  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/dump/dump.c:

	Show references list header only when we have some links to print.  

Fri Jan  2 12:42:52 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Test against NULL strings before calling strlcasecmp(), it prevents
	assertions failure.  

Thu Jan  1 23:40:56 2004  Laurent Monin <zas@norz.org>:

	* src/: elinks.h, util/string.h:

	empty_string_or_() and null_or_stracpy() macros were moved to
	util/string.h.  

Thu Jan  1 23:36:44 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/parser.c, document/html/tables.c,
	util/string.h:

	is_same_str() -> !strlcasecmp(). Idea by Jonas and Pasky ;).  

Thu Jan  1 22:02:12 2004  Laurent Monin <zas@norz.org>:

	* src/: document/html/parser.c, document/html/tables.c,
	util/string.h:

	is_same_str(name, namelen, what, whatlen) was introduced. It
	shortens lines and is equivalent to ((namelen) == (whatlen) &&
	!strncasecmp((name), (what), (whatlen))), especially in parser.c.  

Thu Jan  1 20:08:47 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.c:

	Update the comment for the <ctype.h> inclusion to mention that we
	now also use isprint().  

Thu Jan  1 19:18:46 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* doc/events.txt:

	Improve the description of the goto-url event.  

Thu Jan  1 18:52:05 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/kbdbind.c:

	Move Alt-< (beginning-of-buffer) and Alt-> (end-of-buffer) to the
	edit keymap, as suggested by pasky and Jonas.  

Thu Jan  1 18:50:31 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/status.c:

	s/if/ifdef/ so that ELinks can compile with CONFIG_LEDS enabled.  

Thu Jan  1 18:21:55 2004  Laurent Monin <zas@norz.org>:

	* src/: elinks.h, config/options.c, document/html/frames.c,
	document/html/parser.c, document/html/renderer.c, sched/task.c,
	viewer/text/link.c:

	Macro null_or_stracpy() was introduced to shorten lines. It is
	equivalent to (str ? stracpy(str) : NULL).  

Thu Jan  1 16:56:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/mime/backend/common.c:

	foreach_(mime backend_module () ...  

Thu Jan  1 16:42:31 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/modules/module.c:

	Sort #includes.  

Thu Jan  1 16:34:41 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, feature.h, src/lowlevel/signals.c,
	src/modules/version.c, src/util/error.c, src/util/error.h:

	BACKTRACE -> CONFIG_BACKTRACE.  

Thu Jan  1 16:15:16 2004  Petr Baudis <pasky@ucw.cz>:

	* src/protocol/smb/smb.c:

	Glum glum.  

Thu Jan  1 15:54:37 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/bfu/dialog.c, src/bfu/listbox.c, src/bfu/menu.c,
	src/bfu/text.c, src/modules/version.c, src/osdep/osdep.c,
	src/osdep/os2/sysinfo.h, src/osdep/unix/unix.c,
	src/terminal/event.c, src/terminal/kbd.c, src/viewer/text/view.c:

	USE_MOUSE -> CONFIG_MOUSE.  

Thu Jan  1 15:50:29 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/dialogs/options.c, src/terminal/color.c,
	src/terminal/color.h, src/terminal/draw.c, src/terminal/draw.h,
	src/terminal/screen.c:

	USE_256_COLORS -> CONFIG_256_COLORS.  

Thu Jan  1 15:47:25 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/mime/mime.c, src/mime/backend/common.c,
	src/mime/backend/mailcap.c, src/mime/backend/mailcap.h,
	src/mime/backend/mimetypes.c, src/mime/backend/mimetypes.h,
	src/modules/module.c, src/protocol/rewrite/rewrite.c,
	src/protocol/rewrite/rewrite.h, src/sched/task.c:

	URI_REWRITE, MAILCAP and MIMETYPES was prefixed with CONFIG_.  

Thu Jan  1 15:38:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/terminal/terminal.c:

	Removed close(p) from exec_thread(). We do that later and better in
	the caller (by Mikulas; from 0.99pre15).  

Thu Jan  1 15:36:17 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/cookies/cookies.c, src/cookies/dialogs.c,
	src/cookies/parser.c, src/cookies/parsetst.c, src/dialogs/menu.c,
	src/modules/module.c, src/protocol/file/cgi.c,
	src/protocol/http/http.c, src/viewer/text/view.c:

	COOKIES -> CONFIG_COOKIES. More code is now excluded when cookies
	are disabled.  

Thu Jan  1 15:24:44 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/signals.c:

	Fixed delayed signal delivery, or so ;) (by Mikulas; from
	0.99pre15).  

Thu Jan  1 15:20:32 2004  Petr Baudis <pasky@ucw.cz>:

	* src/lowlevel/: signals.c, signals.h:

	Volatilize @critical_section and @pending_alarm (by Mikulas; from
	0.99pre15).  

Thu Jan  1 15:16:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/protocol.c:

	check_protocol(): Handle NULL backends and insert NULL backend if we
	are not supporting SMB.  

Thu Jan  1 15:14:47 2004  Petr Baudis <pasky@ucw.cz>:

	* feature.h:

	Normalize anti-recursive #define.  

Thu Jan  1 15:14:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bookmarks/backend/xbel.c:

	Use CONFIG_XBEL_BOOKMARKS.  

Thu Jan  1 15:12:12 2004  Petr Baudis <pasky@ucw.cz>:

	* src/bookmarks/backend/: common.c, xbel.c:

	Reverted part of the CONFIG_XBEL_BOOKMARKS introduction, which was
	already vetoed by me before introduction, didn't undergo discussion
	and the usual overloaded-patch stuff. I feel touchy now, too little
	sleep, so better don't do these things to me today.  

Thu Jan  1 15:04:32 2004  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated and some hotkeys conflict were fixed.  

Thu Jan  1 14:51:00 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Fixed invalid translation.  

Thu Jan  1 14:50:06 2004  Laurent Monin <zas@norz.org>:

	* test/imgmap.html:

	A test file for image map was added.  

Thu Jan  1 14:47:33 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/bookmarks/bookmarks.c,
	src/bookmarks/backend/common.c, src/bookmarks/backend/xbel.c:

	HAVE_LIBEXPAT usage converted to use CONFIG_XBEL_BOOKMARKS 

Thu Jan  1 14:34:58 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Code simplification, i variable is uneeded.  

Thu Jan  1 14:34:57 2004  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Rather desperate attempt to try to clarify translation of Toggle
	display.  

Thu Jan  1 14:33:13 2004  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Fixed accidentally swapped colors of .tabs.univisited.  

Thu Jan  1 14:28:07 2004  Laurent Monin <zas@norz.org>:

	* src/document/html/parser.c:

	Regression bug was fixed. USEMAP should now work as it should and
	show all map entries.  

Thu Jan  1 14:24:07 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/bfu/hierbox.c, src/bookmarks/bookmarks.c,
	src/bookmarks/bookmarks.h, src/bookmarks/dialogs.c,
	src/bookmarks/dialogs.h, src/bookmarks/backend/common.c,
	src/bookmarks/backend/default.c, src/bookmarks/backend/xbel.c,
	src/dialogs/menu.c, src/globhist/dialogs.c, src/modules/module.c,
	src/sched/session.c, src/terminal/terminal.c,
	src/viewer/text/link.c, src/viewer/text/view.c:

	BOOKMARKS -> CONFIG_BOOKMARKS.  

Thu Jan  1 14:03:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/bfu/leds.c, src/bfu/leds.h, src/dialogs/status.c,
	src/modules/module.c, src/sched/session.c, src/sched/session.h:

	USE_LEDS -> CONFIG_LEDS.  

Thu Jan  1 13:58:44 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/: file/cgi.c, smb/smb.c:

	Exclude even more includes.  

Thu Jan  1 13:54:57 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/protocol/file/cgi.c, src/protocol/file/file.c:

	ELINKS_LOCAL_CGI -> CONFIG_CGI.  

Thu Jan  1 13:54:14 2004  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/smb/: smb.c, smb.h:

	Exclude more includes.  

Thu Jan  1 13:38:36 2004  Laurent Monin <zas@norz.org>:

	* configure.in:

	ELINKS_SMB -> CONFIG_SMB 

Thu Jan  1 11:53:36 2004  Petr Baudis <pasky@ucw.cz>:

	* feature.h:

	s/myself/pasky/, noticed by Jonas.  

Thu Jan  1 10:12:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/main.c:

	ELINKS_ROOT_EXEC -> CONFIG_NO_ROOT_EXEC + move dependencies. Now it
	should be correct and not the inverted behaviour.  

Thu Jan  1 10:04:03 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, feature.h, src/protocol/protocol.c,
	src/protocol/smb/smb.c, src/protocol/smb/smb.h:

	ELINKS_SMB -> CONFIG_SMB + make it possible to not compile in the
	smb code when disabled.  

Thu Jan  1 09:56:01 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/dialogs/document.c, src/dialogs/menu.c,
	src/document/html/parser.c, src/globhist/dialogs.c,
	src/globhist/globhist.c, src/modules/module.c, src/sched/session.c,
	src/viewer/text/view.c:

	GLOBHIST -> CONFIG_GLOBHIST.  

Thu Jan  1 09:52:51 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h, src/dialogs/menu.c, src/formhist/formhist.c,
	src/modules/module.c, src/util/base64.c, src/viewer/text/form.c,
	src/viewer/text/view.c:

	FORMS_MEMORY -> CONFIG_FORMHIST.  

Thu Jan  1 09:42:54 2004  Jonas Fonseca <fonseca@diku.dk>:

	* feature.h:

	A few glitches, a few fixes.  

Thu Jan  1 07:21:24 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/kbdbind.c:

	Add default bindings of Alt-< to beginning-of-buffer and Alt-> to
	end-of-buffer.  

Thu Jan  1 07:16:48 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/kbdbind.c, config/kbdbind.h, viewer/text/form.c,
	viewer/text/textarea.c, viewer/text/textarea.h:

	Add beginning-of-buffer and end-of-buffer actions. This closes bug
	147.  

Thu Jan  1 07:03:49 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: config/conf.c, protocol/http/header.c:

	Improve some comments: s/whitespaces/whitespace/, and clarify
	skip_white's description.  

Thu Jan  1 04:17:56 2004  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/encoding/encoding.c:

	Add .tbz to bzip2_extensions.  

Thu Jan  1 03:40:10 2004  Petr Baudis <pasky@ucw.cz>:

	* acconfig.h:

	Reintroduced ELINKS_SMB.  

Thu Jan  1 03:27:48 2004  Laurent Monin <zas@norz.org>:

	* src/viewer/text/marks.c:

	index_from_char() was added to marks.c, it permits to reduce size of
	array used by converting valid chars to an index in the marks array.
	Some macros were added to clarify the code.  

Thu Jan  1 03:25:48 2004  Petr Baudis <pasky@ucw.cz>:

	* acconfig.h, configure.in, feature.h:

	Featurized ELINKS_SMB.  

Thu Jan  1 03:16:53 2004  Petr Baudis <pasky@ucw.cz>:

	* acconfig.h, configure.in, feature.h:

	Featurized Local CGI Support.  

Thu Jan  1 03:09:13 2004  Petr Baudis <pasky@ucw.cz>:

	* acconfig.h, configure.in, feature.h:

	Moved USE_MOUSE to feature.h.  

Thu Jan  1 02:53:39 2004  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/info.c:

	Updated copyright notice. Welcome to the year 2004! 

Thu Jan  1 02:53:00 2004  Petr Baudis <pasky@ucw.cz>:

	* feature.h:

	Capitalize captions.  

Thu Jan  1 02:22:21 2004  Petr Baudis <pasky@ucw.cz>:

	* acconfig.h, configure.in, feature.h:

	Featurized FORMS_MEMORY.  

Thu Jan  1 02:06:03 2004  Petr Baudis <pasky@ucw.cz>:

	* feature.h:

	Examples of the URI rewriting.  

Thu Jan  1 01:49:23 2004  Petr Baudis <pasky@ucw.cz>:

	* feature.h:

	Cleanup.  

Thu Jan  1 01:46:19 2004  Petr Baudis <pasky@ucw.cz>:

	* acconfig.h:

	Oops, BACKTRACE still must be here. Spotted by zas.  

Thu Jan  1 01:06:55 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, feature.h:

	Disable root user was featured.  

Thu Jan  1 00:47:12 2004  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, feature.h:

	URI rewriting was featured.  

Wed Dec 31 23:52:25 2003  Karsten Schlzel <kuser@gmx.de>:

	* po/de.po:

	German translation update.  

Wed Dec 31 23:26:34 2003  Karsten Schlzel <kuser@gmx.de>:

	* po/de.po:

	German translation update.  

Wed Dec 31 23:19:44 2003  Petr Baudis <pasky@ucw.cz>:

	* src/README:

	No ELusive yet. See the tireless army of ELinks hackers, not even
	taking their break for new year celebrations. Happy new one, btw.  

Wed Dec 31 22:15:38 2003  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	Removed now-obsolete --without-xbel.  

Wed Dec 31 22:02:40 2003  Petr Baudis <pasky@ucw.cz>:

	* feature.h:

	Fixed forced disabling of the xbel/backtrace.  

Wed Dec 31 22:01:24 2003  Petr Baudis <pasky@ucw.cz>:

	* acconfig.h, configure.in, feature.h:

	Move backtrace printing support enabling to feature.h.  

Wed Dec 31 21:52:31 2003  Petr Baudis <pasky@ucw.cz>:

	* feature.h:

	Added notice to developers about what to include in this file and
	how.  

Wed Dec 31 21:44:20 2003  Petr Baudis <pasky@ucw.cz>:

	* feature.h:

	Added details about what happens if disabled or why to enable it to
	features missing it.  

Wed Dec 31 21:35:10 2003  Petr Baudis <pasky@ucw.cz>:

	* feature.h:

	Cleanup of the MIME/256colors entries.  

Wed Dec 31 21:31:49 2003  Petr Baudis <pasky@ucw.cz>:

	* acconfig.h, configure.in, feature.h:

	Moved cookies and global history to features.h.  

Wed Dec 31 21:28:59 2003  Jonas Fonseca <fonseca@diku.dk>:

	* doc/man/man5/elinks.conf.5:

	Quite big update featuring the color cleanups and additions, auto
	save stuff and sorting changes.  

Wed Dec 31 21:26:15 2003  Jonas Fonseca <fonseca@diku.dk>:

	* acconfig.h, configure.in, feature.h:

	Move mailcap, mimetypes and 256 color configuration to feature.h
	file.  

Wed Dec 31 19:13:20 2003  Petr Baudis <pasky@ucw.cz>:

	* INSTALL, acconfig.h, configure.in, feature.h:

	Introduced feature.h, which should hold most of the fine-tuned
	compile-time features configuration. As an example case, leds and
	bookmarks were already moved there. Idea stolen from vim.  

Wed Dec 31 18:47:48 2003  Petr Baudis <pasky@ucw.cz>:

	* INSTALL:

	Whitespaces cleanup.  

Wed Dec 31 17:43:49 2003  Karsten Schlzel <kuser@gmx.de>:

	* po/de.po:

	German translation update.  

Wed Dec 31 14:26:50 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/modules/: module.h, version.c:

	Move builtin_modules declaration.  

Wed Dec 31 14:25:07 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Dec 31 13:32:12 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/modules/: module.c, module.h, version.c:

	Introduce module iterators to ease module hacking.  

Wed Dec 31 12:57:08 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/Makefile.am:

	.. and move libmime.a to link correctly.  

Wed Dec 31 12:53:39 2003  Petr Baudis <pasky@ucw.cz>:

	* src/: dialogs/Makefile.am, dialogs/menu.c, dialogs/mime.c,
	dialogs/mime.h, mime/Makefile.am, mime/dialogs.c, mime/dialogs.h:

	dialogs/mime.* -> mime/dialogs.*, suggested by Jonas.  

Wed Dec 31 10:44:11 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/util/snprintf.c:

	Remove MAX(). It is already defined.  

Wed Dec 31 10:42:00 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/backend/mailcap.c, mime/backend/mimetypes.c,
	util/string.h:

	Move skip_whitespace() macro.  

Wed Dec 31 08:50:39 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: mime/mime.h, mime/backend/common.c, mime/backend/common.h,
	mime/backend/default.c, mime/backend/mailcap.c, sched/download.c:

	Introduce mime handler initializer and allocate the program with the
	struct so freeing is easier.  

Wed Dec 31 08:37:14 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/smb/smb.c:

	Glum.  

Wed Dec 31 08:14:10 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/smb/smb.c:

	Small, untested optimisation.  

Wed Dec 31 07:53:39 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/formhist/dialogs.c:

	In push_login_button, allow the title of the "Form not saved"
	message box to be localised.  

Wed Dec 31 07:25:48 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/task.c:

	Whoops, bfu/style.h _does_ need to be included. Pointed out by
	Jonas.  

Wed Dec 31 06:20:40 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/protocol/rewrite/rewrite.c:

	Remove a superfluous test.  

Wed Dec 31 04:48:00 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/task.c:

	Remove an unnecessary #include.  

Wed Dec 31 02:57:51 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.c:

	Include terminal/terminal.h for cls_redraw_all_terminals(). This
	effectively reverts src/config/options.c:1.415->1.416. My first
	reversion, and it is a patch by pasky, too. How 'bout that.  

Wed Dec 31 02:49:38 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/task.h:

	Declare struct download instead of struct dowload, and include
	cache/cache.h for enum cache_mode.  

Wed Dec 31 00:34:14 2003  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Simplified tabs.unselected description.  

Tue Dec 30 22:44:36 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Tue Dec 30 22:20:42 2003  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	*INIT_OPT_COLORS(), more swapping due to pasky, it is an idiot.  

Tue Dec 30 21:49:26 2003  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	*INIT_OPT_COLORS(), has first f g coming well, then b g follows.
	Haiku is exciting.  

Tue Dec 30 21:37:47 2003  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Czech translation update. Hmm, a lot of new stuff, not finished yet.  

Tue Dec 30 21:28:50 2003  Petr Baudis <pasky@ucw.cz>:

	* po/: be.po, bg.po, ca.po, cs.po, da.po, de.po, el.po, es.po,
	et.po, fi.po, fr.po, gl.po, hr.po, hu.po, id.po, is.po, it.po,
	leet.po, lt.po, nl.po, no.po, pl.po, pt.po, pt_BR.po, ro.po, ru.po,
	sk.po, sv.po, tr.po, uk.po:

	.po files were resynced.  

Tue Dec 30 21:28:20 2003  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Default fg color for tabs.unvisited changed from green to darkblue.
	It _is_ the best choice, fullstop (green is totally unreadable).  

Tue Dec 30 19:58:19 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Fix hotkey.  

Tue Dec 30 19:37:16 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/: options.c, options.h, renderer.c, html/renderer.c:

	Reintroduce needs_width but be less optimistic and always set it to
	1 for HTML documents. A half way fix is added out commented but it
	will be non trivial to fix it for all cases.  

Tue Dec 30 18:45:27 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/hotkey.c:

	Hotkey conflict is now detected even for first menu item. It fixes
	bug 350.  

Tue Dec 30 18:44:55 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/menu.c, config/options.inc:

	Optionalize hotkey underlining (ui.dialogs.underline_hotkeys) off by
	default.  

Tue Dec 30 18:36:39 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/renderer.c:

	Rename document_view -> doc_view.  

Tue Dec 30 18:26:43 2003  Laurent Monin <zas@norz.org>:

	* src/document/: document.c, options.c, options.h, renderer.c,
	html/parser.c:

	Patches concerning plain text resizing issue and needs_width
	introduction were reverted. Jonas will fix that soon.  

Tue Dec 30 17:54:24 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/menu.c:

	Underline hotkey chars to make them more visible. Maybe it should be
	configurable anyway it is of course disabled if the terminal
	underline option is.  

Tue Dec 30 16:38:01 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/view.c:

	Fix up() and down() handling so they call page_up() and page_down()
	when link wraparound is disabled. I believe that is the old
	behaviour.  

Tue Dec 30 13:57:43 2003  Laurent Monin <zas@norz.org>:

	* src/: config/options.inc, document/options.c, document/options.h,
	document/html/parser.c:

	Default form input size is now configurable through
	document.html.default_form_input_size. It helps with textarea
	without cols attribute.  

Tue Dec 30 13:02:02 2003  Laurent Monin <zas@norz.org>:

	* src/document/: document.c, options.c, options.h, renderer.c:

	Separate document options comparaison functions to better handling
	terminal size changes, it should fix cache growing on height change.  

Tue Dec 30 12:45:14 2003  Laurent Monin <zas@norz.org>:

	* src/document/: options.c, options.h, renderer.c, html/parser.c:

	A field needs_width was added to struct document_options. We now use
	it as needs_height. It fixes non rerendering of plain text documents
	on width change. Please report any side-effect this patch may have.  

Tue Dec 30 11:22:43 2003  Laurent Monin <zas@norz.org>:

	* src/document/refresh.c:

	Compilation fix: include config/options.h header file needed for
	get_opt_int().  

Tue Dec 30 10:48:56 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	Always use the color mode set in the document options since the
	global one might have a color mode different from the current mode.
	Fixes wrong drawing of current link when changing back and forth
	between color modes.  

Tue Dec 30 08:17:31 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, document/refresh.c:

	Add option to control the minimum time used for document refreshing.
	By default set to 1 second (is this fair?). Fixes last part of bug
	309 (Broken go back).  

Tue Dec 30 00:25:20 2003  Laurent Monin <zas@norz.org>:

	* src/terminal/kbd.c:

	Add itrm queue debug code, and new escape sequences are now
	recognised, it fixes impossibility to bind some function keys under
	rxvt-like terminals, now Shift-F5 should work more often.  

Mon Dec 29 22:47:10 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Minor french grammar fix.  

Mon Dec 29 22:43:46 2003  Laurent Monin <zas@norz.org>:

	* src/config/: dialogs.c, kbdbind.c, kbdbind.h:

	Trivial cleanup: use enum keyact type for action, drop 2 useless
	variables in really_add_keybinding() and make it call
	really_really_add_keybinding() instead of add_keybinding().  

Mon Dec 29 22:36:23 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Typo fix.  

Mon Dec 29 21:10:00 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Mon Dec 29 21:02:02 2003  Laurent Monin <zas@norz.org>:

	* src/: config/options.inc, sched/session.c, terminal/terminal.c:

	ui.auto_save_restore_session tristate option was replaced by two
	boolean options ui.sessions.auto_save and ui.sessions.auto_restore.  
	Folder name is now configurable through
	ui.sessions.auto_save_foldername.  It fixes issues related to i18n
	of this folder name.  

Mon Dec 29 20:20:26 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	Minor translation fix.  

Mon Dec 29 20:15:43 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hierbox.c, hierbox.h, listbox.c:

	Redo the bogus fix for hierbox browser cursor position restoring
	(bug 36) by saving the complete box data and check it is till valid
	when initializing a new browser.  

Mon Dec 29 19:44:49 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Jonas told me about cvs admin -m <rev>:<msg> <file> and suddenly...  

Mon Dec 29 19:43:25 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Ooops twice the same message... Previous patch changed order of
	parameter in realloc_line() from y,x to x,y as other functions
	there. This commit is a dummy one i just added a new line.  

Mon Dec 29 19:38:59 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Order of parameters of realloc_line() was modified: y,x -> x,y.  

Mon Dec 29 19:35:02 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Move some code from add_document_lines() to new functions add_node()
	and init_template() and make them more generic.  

Mon Dec 29 19:04:33 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	We now call get_uri_length() only if we are at the start of line or
	we have two consecutive alpha chars.  

Mon Dec 29 18:27:06 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation cleanup.  

Mon Dec 29 17:54:11 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Code cleanup.  

Mon Dec 29 17:46:34 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Minor code simplification.  

Mon Dec 29 14:05:05 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/: history.c, history.h:

	A cleanuped up version of the history compression patch pasky
	attached to bug 309. It ensures that the added history location is
	unique and that redirects can be bypassed. It does not fix it for
	the bug URI tho' since it uses document refresh with time set to
	zero.  

Mon Dec 29 13:15:09 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/sched/history.h:

	Cleanup workaround.  

Mon Dec 29 12:24:31 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/: document/plain/renderer.c, intl/charsets.c,
	intl/charsets.h:

	Add CSM_NONE to enum convert_string_mode for the plain-text
	renderer. I hope that this works! 

Mon Dec 29 12:23:09 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In add_document_line, simplify to eliminate a variable.  

Mon Dec 29 11:59:44 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Optimizations and clean up. Now useless debug code was removed.  

Mon Dec 29 11:42:59 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Replace bad chars but tab before calling convert_string(). It
	preserves previous behavior.  

Mon Dec 29 11:33:21 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	Fix an off-by-one error in the plain-text renderer's linkyfying
	code.  

Mon Dec 29 11:28:44 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/plain/renderer.c:

	In the plain text renderer, perform character-set conversion on the
	input _before_ expanding tabs. Closes bug 351. Thanks to zas for
	finding the problem.  

Mon Dec 29 08:25:22 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/document/html/parser.c:

	Keep state of whether link lines was drawn. Only draw link lines if
	we actually put some and if the background color is different from
	the default one.  Fixes bug 326.  

Mon Dec 29 08:04:58 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/text.c:

	Whoops revert stupid part of last patch.  

Mon Dec 29 07:58:07 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/text.c:

	Improve forcing of current scaling to last position in the
	scrollbar.  

Mon Dec 29 07:43:16 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/text.c:

	Partly revert previous scollbar fixes and only adjust the offset of
	current (@step) to hit the last position.  

Mon Dec 29 07:34:28 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/screen.c:

	Use set_screen_dirty() macro.  

Sun Dec 28 20:56:54 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Use explicit constants instead of hardcoded numbers.  

Sun Dec 28 20:02:48 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Use a while loop instead of a goto.  

Sun Dec 28 20:01:26 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/text.c:

	Improve/fix scroll meter drawing by removing adjustment of widget
	height according to y set by dlg_format_text_do() and by scaling
	current to be last when it should be.  

Sun Dec 28 19:53:03 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Take in account space used by right scroll main menu indicator
	(appears when term width is insufficent to display all the main menu
	entries).  

Sun Dec 28 19:27:49 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/text.c:

	Even with minimum width for stuff like "\n\n" this line should be
	added. Also allow starting space needed when scrolling so we do not
	ignore empty lines. Fixes scrolling in text widget.  

Sun Dec 28 18:45:22 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/link.c:

	Use ACT_ENTER for 'Follow link' and ACT_ENTER_RELOAD for 'Follow
	link and reload' in the link menu. Could the actions also be used
	for submit form (and reload)? 

Sun Dec 28 15:44:41 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Assertions and debugging code were added to help to track down nul
	chars insertion in plain renderer output, an ssertion is triggered
	now for that. Help is welcomed here. Note previous patch fixed bug
	317.  

Sun Dec 28 13:58:57 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Use strlen() to gather true length of line after convert_string()
	call. It fixes trailing chars garbage in some cases.  

Sun Dec 28 10:42:43 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sun Dec 28 09:24:54 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Colors the status bar with white background, so the progress bar
	works.  

Sun Dec 28 06:25:40 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Sort protocol.file.cgi.*.  

Sun Dec 28 06:24:56 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.inc:

	Sort protocol.file.*.  

Sun Dec 28 06:12:26 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/osdep/osdep.c:

	Set window title in GNU Screen. (Backport from 1.81.2.1->1.81.2.2,
	ELUSION branch.) 

Sun Dec 28 06:11:19 2003  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation was updated.  

Sun Dec 28 06:11:19 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/osdep/osdep.c:

	Introduce is_gnuscreen(). (Backport from 1.81->1.81.2.1, ELUSION
	branch.) 

Sun Dec 28 05:58:35 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/dialogs/menu.c:

	Fix a hotkey conflict on the ~Help menu between ~ELinks homepage and
	~ELinks CvsWeb (now ~ELinks CvsWeb). See bug 350 for why this wasn't
	spotted long ago.  

Sun Dec 28 05:21:37 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/hotkey.c:

	In is_hotkey, declare and assign @key_pos outside the DEBUG code and
	eliminate the thus superfluous braces and duplicate return
	statement.  

Sun Dec 28 05:19:13 2003  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Improvements in Polish translation. Patch by Mikolaj Machowski.  

Sun Dec 28 05:05:57 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/config/options.c:

	Hook change_hook_html to the document.codepage option tree.  

Sun Dec 28 04:56:34 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/link.c:

	Give the "V~iew image" menu item the correct @action argument.  

Sun Dec 28 03:34:04 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Drop whitespaces on empty lines and trailing whitespaces before
	rendering plain text. It reduces memory usage a bit, please tell me
	if it has any other impact.  

Sun Dec 28 03:14:16 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/hierbox.c:

	Support for goto marked listbox_items. Fixes bug 123.  

Sun Dec 28 02:58:51 2003  Laurent Monin <zas@norz.org>:

	* src/config/kbdbind.c:

	ACT_TOGGLE_PLAIN_COMPRESS_EMPTY_LINES is now bind by default to "w"
	(like whitespaces/lines).  

Sun Dec 28 02:55:08 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Compress_empty_lines now handles line containing only whitespaces
	too. It gives obvious result on BZ source.  

Sun Dec 28 02:39:02 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Add mono/colors ui.color options together to ensure sync and slim
	code (removes ~300 lines of code. :-) 

Sun Dec 28 02:36:25 2003  Laurent Monin <zas@norz.org>:

	* src/config/options.inc:

	quiting ->quitting.  

Sun Dec 28 02:19:51 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Add mono trees together with the color one.  

Sun Dec 28 02:16:13 2003  Laurent Monin <zas@norz.org>:

	* src/: config/kbdbind.c, config/kbdbind.h, viewer/text/view.c:

	Keyact ACT_TOGGLE_PLAIN_COMPRESS_EMPTY_LINES was added. No default
	keystroke.  

Sun Dec 28 02:12:54 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Introduce INIT_OPT_COLOR_TREE() for adding relative color trees.  

Sun Dec 28 02:07:20 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Getting ready to unify colors/mono color option declaration.  

Sun Dec 28 02:00:58 2003  Laurent Monin <zas@norz.org>:

	* src/config/dialogs.c:

	Use a copy since first hop may be freed. It fixes a segfault when
	adding an already used keystoke.  

Sun Dec 28 01:58:17 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Simplify tab color options.  

Sun Dec 28 01:55:50 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Simplify status and searched color options.  

Sun Dec 28 01:53:17 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Simplify dialog color options.  

Sun Dec 28 01:45:21 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	Simplify menu bar color options.  

Sun Dec 28 01:34:54 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, bookmarks/bookmarks.h,
	config/options.inc, sched/session.c, terminal/terminal.c:

	A hackish prototype for auto save/restoring session (as in tabs)
	using ui.auto_save_restore_session option. 0 is off, 1 is save but
	no restore, 2 is save and restore if no URI is given.  

Sun Dec 28 01:31:47 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/bookmarks.c:

	Clean the folder where the terminal tabs should be bookmarked under.  

Sun Dec 28 01:31:12 2003  Laurent Monin <zas@norz.org>:

	* src/config/options.c:

	A change hook was added to document.plain. It prevents reload of
	document after changing document.plain.compress_empty_lines option.  

Sun Dec 28 01:06:12 2003  Laurent Monin <zas@norz.org>:

	* src/document/plain/renderer.c:

	Plain renderer was inserting useless nul chars in formatted
	document, these were invisible on screen but visible in a file
	generated by save formatted as. Jonas please review carefully.  

Sat Dec 27 23:33:39 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bfu/: hierbox.c, hierbox.h, listbox.c:

	Save state of the latest selected item in a browser.  

Sat Dec 27 23:06:07 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Dec 27 22:58:19 2003  Laurent Monin <zas@norz.org>:

	* src/: config/options.inc, document/options.c, document/options.h,
	document/plain/renderer.c:

	Option document.plain.compress_empty_lines was added. It makes
	successive empty lines appear as one. Try
	http://pasky.ji.cz/~pasky/dev/links/README for a demo. This option
	is off by default.  

Sat Dec 27 22:18:01 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, terminal/tab.c, terminal/tab.h:

	Confirm close also when attempting to close all tabs but the current
	one.  

Sat Dec 27 22:05:15 2003  Laurent Monin <zas@norz.org>:

	* src/util/color.c:

	Silent a possible warning under Cygwin.  

Sat Dec 27 22:03:43 2003  Laurent Monin <zas@norz.org>:

	* src/protocol/file/file.c:

	Use explicit type casting to quiet gcc 3.3.1 under Cygwin. It should
	not harm.  

Sat Dec 27 21:57:04 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	Use really_close_tab() function always.  

Sat Dec 27 21:56:08 2003  Laurent Monin <zas@norz.org>:

	* src/config/cmdline.c:

	Type cast color_t to unsigned int in order to prevent a compiler
	warning, notably on Cygwin. Reported by fredlwm.  

Sat Dec 27 21:51:07 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Horizontal main menu scrolling was fixed, now part of last visible
	option may be printed, it gives a smoother effect.  

Sat Dec 27 20:03:45 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/text.c:

	In display_text, eliminate a superfluous int_max().  

Sat Dec 27 19:35:27 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bfu/hierbox.c, terminal/tab.c, terminal/tab.h:

	Make the open in new tab take backend work on url strings and add
	open_url_in_new_tab().  

Sat Dec 27 18:21:07 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated. 1162 messages ;).  

Sat Dec 27 17:36:01 2003  Laurent Monin <zas@norz.org>:

	* src/config/dialogs.c:

	Do not show Description: in option info dialog if there is no
	description text.  

Sat Dec 27 17:31:36 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: bookmarks/bookmarks.c, bookmarks/bookmarks.h,
	bookmarks/dialogs.c, bookmarks/dialogs.h, config/kbdbind.c,
	config/kbdbind.h, dialogs/menu.c:

	Add support for bookmarking all tabs for a terminal. Entry was added
	to tab menu. ACT_ADD_BOOKMARK_TABS also added with no default value
	bound.  

Sat Dec 27 17:18:34 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Attempt to fix division by zero problem reported by zas caused by
	paskys 'wide' hacking using evil gotos to bypass essentiel tests.
	;-) 

Sat Dec 27 17:02:49 2003  Petr Baudis <pasky@ucw.cz>:

	* po/cs.po:

	Translation fix.  

Sat Dec 27 16:11:22 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/kbdbind.c:

	Fix tab-close-all-but-current action name.  

Sat Dec 27 15:52:44 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Dec 27 15:46:26 2003  Laurent Monin <zas@norz.org>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	viewer/text/view.c:

	ACT_SAVE_OPTIONS was added. No default keystroke.  

Sat Dec 27 15:38:22 2003  Laurent Monin <zas@norz.org>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	viewer/text/view.c:

	ACT_SHOW_TERM_OPTIONS was added. No default keystroke.  

Sat Dec 27 15:16:20 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/hotkey.c:

	Populate with menu_item macros, and correctly handle i18n regarding
	hotkeys. It fixes incorrect not so hot keys behavior in translated
	language menu.  

Sat Dec 27 14:59:43 2003  Laurent Monin <zas@norz.org>:

	* src/dialogs/options.c:

	Display iso639 code at right of language menu, as proposed by Jonas.
	As a side effect it displays which code is associated with the
	system language.  

Sat Dec 27 14:49:36 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Sat Dec 27 14:33:28 2003  Laurent Monin <zas@norz.org>:

	* src/config/: dialogs.c, kbdbind.c, kbdbind.h:

	A confirmation dialog was added when attempting to bind a keystroke
	which is already used elsewhere.  

Sat Dec 27 14:28:43 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	Oops we only need @term non NULL.  

Sat Dec 27 14:27:53 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: terminal/tab.c, viewer/text/view.c:

	close_all_tabs_but_current(): NULL current means look it up your
	damn self. ;) 

Sat Dec 27 14:14:51 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, viewer/text/view.c:

	Add close all but current tab action. By default bound to 'i'.  

Sat Dec 27 14:13:31 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, terminal/tab.c, terminal/tab.h:

	Move close all but current function to tab file.  

Sat Dec 27 13:55:46 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/kbdbind.c, config/kbdbind.h, viewer/text/view.c:

	Add ACT_TAB_MENU action bound to 'e' by default.  

Sat Dec 27 13:41:22 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/dialog.c:

	Dialog width takes now in account title length. Long dialog titles
	were displayed outside message box before (ie. in "Invalid
	keystroke" message box).  

Sat Dec 27 13:35:45 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Finally got the close all but current menu action working.  

Sat Dec 27 13:21:26 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/tab.c:

	Cleanup the naming. No need for two variables for the same thing.  

Sat Dec 27 13:08:44 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/: tab.c, tab.h:

	Introduce tab iterator macros.  

Sat Dec 27 12:50:35 2003  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/leds.h:

	Raised LEDS_COUNT to 6, so that the progress meter will look nicer.  

Sat Dec 27 12:50:06 2003  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/status.c:

	Now, if not @full, show ETT instead of elapsed time and ETA instead
	of estimated time.  

Sat Dec 27 12:47:08 2003  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/status.c:

	Swapped @wide and @full in get_stat_msg(). So now if @wide, we
	already show avg/cur, but we show the full strings only if @full.  

Sat Dec 27 12:44:12 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/bookmarks/: bookmarks.c, dialogs.c, backend/xbel.c:

	add_bookmark(): Set the box_item to BI_FOLDER if url is NULL or "".  

Sat Dec 27 12:36:48 2003  Petr Baudis <pasky@ucw.cz>:

	* src/dialogs/status.c:

	get_stat_msg()'s @full behaviour changed. Now, when showing it in
	the statusbar, it is set only if > 130 (empirical value) and it now
	prevents from displaying the current/average speed (it always
	displays just the speed) and elapsed time (it displays just the
	estimated time).  

Sat Dec 27 12:27:49 2003  Petr Baudis <pasky@ucw.cz>:

	* src/bfu/: leds.c, leds.h:

	Removed support for leds coloring. We'll do things like progress-bar
	on the background and this would interfere.  

Sat Dec 27 12:17:20 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated. Hotkeys conflict were fixed.  

Sat Dec 27 12:14:40 2003  Laurent Monin <zas@norz.org>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	dialogs/menu.h, viewer/text/view.c:

	ACT_OPEN_OS_SHELL was added. Minor changes to make it working. No
	default keystroke.  

Sat Dec 27 11:45:02 2003  Laurent Monin <zas@norz.org>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	dialogs/menu.h, viewer/text/view.c:

	ACT_SAVE_URL_AS was added. No default keystroke.  

Sat Dec 27 11:37:07 2003  Laurent Monin <zas@norz.org>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	viewer/text/view.c:

	ACT_SAVE_AS was added. No default key for now.  

Sat Dec 27 11:29:52 2003  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	Show kill all backgrounded connections keystroke in menu.  

Sat Dec 27 11:25:56 2003  Laurent Monin <zas@norz.org>:

	* src/: config/kbdbind.c, config/kbdbind.h, viewer/text/view.c:

	ACT_KILL_BACKGROUNDED_CONNECTIONS keyact was added. No default key
	for now (idea?).  

Sat Dec 27 08:13:30 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/download.c:

	Shift percentage text 1 to the right because it looks better.  

Sat Dec 27 07:41:38 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Only do progress stuff when size > 0.  

Sat Dec 27 04:34:33 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/msgbox.h:

	Include bfu/dialog.h for struct dialog_data.  

Sat Dec 27 04:29:58 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/menu.h:

	Declare struct window.  

Sat Dec 27 04:14:03 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/hierbox.h:

	Include bfu/widget.h for struct widget_data.  

Sat Dec 27 04:09:46 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/dialog.h:

	Declare struct term_event.  

Sat Dec 27 03:27:31 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/checkbox.h:

	Alphabetise those includes. (Whoops!) 

Sat Dec 27 03:21:16 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/bfu/checkbox.h:

	Include bfu/style.h for enum format_align.  

Sat Dec 27 03:12:12 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/sched/session.h:

	Declare struct link.  

Sat Dec 27 01:38:13 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Main menu horizontal scrolling was improved a bit. It still doesnt
	work very well when resizing terminal while menus are opened.  

Sat Dec 27 01:26:20 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/document/html/parser.h:

	Declare struct list_head and remove extra declarations of struct
	session and struct menu_item.  

Sat Dec 27 00:56:45 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Various calculations were tuned. Display is improved.  

Fri Dec 26 23:53:24 2003  Laurent Monin <zas@norz.org>:

	* src/: protocol/proxy.c, protocol/http/http.c, sched/download.c,
	terminal/kbd.c:

	Trailing spaces were removed.  

Fri Dec 26 23:16:42 2003  Miciah Dashiel Butler Masters <miciah@myrealbox.com>:

	* src/viewer/text/search.h:

	Declare struct terminal (forgotten when removing the #include for
	terminal/terminal.h in 1.9->1.10).  

Fri Dec 26 17:23:20 2003  Laurent Monin <zas@norz.org>:

	* src/viewer/text/link.c:

	Nullify rtext when possible.  

Fri Dec 26 17:14:27 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	DEBUG mode visual helper to detect useless rtext if an action is
	given.  

Fri Dec 26 17:06:09 2003  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	rtext can now be set to NULL instead of hardcoded string, since we
	use dynamic keybindings.  

Fri Dec 26 16:57:47 2003  Laurent Monin <zas@norz.org>:

	* src/dialogs/menu.c:

	Align antislashes in macro description to improved readibility.  

Fri Dec 26 16:43:33 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Fri Dec 26 16:28:41 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Main menu is now able to scroll horizontally, ever by keyboard or
	mouse actions. An indicator now appears when menu is truncated.
	Still need to tune up.  

Fri Dec 26 16:18:54 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, dialogs/status.c:

	Restore behavior and default values of loading tab color.  Make
	unvisited tab text color green by default so it is distinct.  Tab
	progress uses dialog.meter colors.  Ideas by pasky.  

Fri Dec 26 14:21:40 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Remove https_real_uri and use @uri instead. Proxy URIs should always
	contain data so assert it.  

Fri Dec 26 14:14:43 2003  Laurent Monin <zas@norz.org>:

	* src/: config/kbdbind.c, config/kbdbind.h, dialogs/menu.c,
	viewer/text/view.c:

	An action ACT_FORMHIST_MANAGER was added, associated default key is
	F.  

Fri Dec 26 14:10:42 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/protocol/http/http.c:

	Setup ssl connection establishment earlier .. improve error
	handling. Patch by Timo Lindfors.  

Fri Dec 26 14:08:07 2003  Petr Baudis <pasky@ucw.cz>:

	* src/config/kbdbind.c:

	Unbind ACT_COPY_CLIPBOARD from Ctrl-C.  

Fri Dec 26 14:02:14 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Don't be so optimistic we need atleast around 6 chars to make the
	meter usable.  

Fri Dec 26 13:57:44 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Add temporary status load progress meter next to leds.  

Fri Dec 26 13:40:09 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/menu.c:

	Empty rtext string was replaced by NULL.  

Fri Dec 26 13:37:17 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: dialogs/menu.c, viewer/text/search.c, viewer/text/search.h,
	viewer/text/view.c:

	Add typeahead search to menu.  

Fri Dec 26 13:17:29 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/options.inc:

	A minor taste of what macros can do to reduce trivial color option
	code.  

Fri Dec 26 13:15:43 2003  Laurent Monin <zas@norz.org>:

	* src/: bfu/inphist.c, bfu/menu.h, dialogs/menu.c,
	dialogs/options.c, document/html/parser.c, viewer/text/link.c,
	viewer/text/view.c:

	We do not need empty strings as rtext anymore, just use NULL.  

Fri Dec 26 13:08:32 2003  Laurent Monin <zas@norz.org>:

	* src/: bfu/menu.c, dialogs/menu.c:

	Display current keybinding in menus, if no key action, then provided
	right text is used.  

Fri Dec 26 12:55:10 2003  Laurent Monin <zas@norz.org>:

	* src/: bfu/inphist.c, bfu/menu.c, bfu/menu.h, dialogs/menu.c,
	dialogs/mime.c, dialogs/options.c, document/html/parser.c,
	viewer/text/link.c, viewer/text/view.c:

	Key actions were added to menu items.  

Fri Dec 26 12:20:54 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.h:

	@keyact -> @action in struct menu_item, since we use action
	elsewhere (in kbdbind.c).  

Fri Dec 26 12:18:37 2003  Laurent Monin <zas@norz.org>:

	* src/config/: kbdbind.c, kbdbind.h:

	add_keystroke_to_string() was introduced. It returns a string
	representing a keystroke, for @action and @map.  

Fri Dec 26 12:08:17 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.h:

	A field keyact of enum keyact type was added to struct menu_item.  

Fri Dec 26 12:01:16 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/: menu.c, menu.h:

	Right text is no more translated by default, a flag RIGHT_INTL was
	added to menu_item flags to force translation.  

Fri Dec 26 11:48:37 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Use draw_menu_left_text{,_hk}() for main menu.  

Fri Dec 26 11:11:31 2003  Laurent Monin <zas@norz.org>:

	* src/: bfu/menu.c, config/options.inc:

	Mainmenu specific-colors are not used anymore. Though they are not
	yet aliased in options.inc.  

Fri Dec 26 10:55:32 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	Do not add 1 to xbase, let the caller do it.  

Fri Dec 26 10:49:20 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	draw_menu_left_text_hk() and draw_menu_left_text() are now used to
	draw left text in menus.  

Fri Dec 26 10:19:10 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/menu.c:

	draw_menu_right_text() was introduced.  

Fri Dec 26 10:10:09 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, dialogs/download.c, dialogs/download.h,
	dialogs/status.c:

	Revive loading tab color so it is used for drawing progress bar in
	backgrounded tabs that are loading. We use unvisited color for the
	non progress part.  

Fri Dec 26 09:56:05 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Use macro to determine whether download is progressing.  

Fri Dec 26 09:55:26 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: config/options.inc, dialogs/status.c, sched/session.h:

	Add support for fresh color in unvisited or incomplete tabs.  

Fri Dec 26 09:54:38 2003  Laurent Monin <zas@norz.org>:

	* src/: bfu/menu.c, bfu/menu.h, dialogs/menu.c,
	document/html/parser.c, viewer/text/link.c:

	M_SUBMENU was dropped. Macro mi_is_submenu() is used, and m_submenu
	string is no more exported.  

Fri Dec 26 09:41:53 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/: menu.c, menu.h:

	mi_text_translate() macro is now used instead of direct flags
	comparaison against NO_INTL.  

Fri Dec 26 09:34:43 2003  Laurent Monin <zas@norz.org>:

	* src/bfu/: menu.c, menu.h:

	mi_is_submenu() is now used instead of direct flags comparaison.  

Fri Dec 26 09:26:14 2003  Laurent Monin <zas@norz.org>:

	* src/: bfu/menu.c, bfu/menu.h, dialogs/menu.c, dialogs/mime.c,
	viewer/text/link.c:

	M_BAR was dropped, horizontal separator is now marked by NO_SELECT
	flags, used for unselectable menu items too. Most tests were
	replaced by macros. More to come.  

Fri Dec 26 08:53:55 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/download.c:

	download_progress_bar(): Make it possible to pass the meter color
	again. NULL means use dialog.meter (and who says C doesn.t support
	default arg values ;-).  

Fri Dec 26 08:46:41 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/download.c:

	download_progress_bar(): Make it possible to pass strings that will
	be coloured. NULL means draw percentage string.  

Fri Dec 26 08:33:49 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/config/opttypes.c:

	Set ui.language to "System" if writing in conf file when configured
	--without-nls. Patch by Timo Lindfors <lindi@kurp.hut.fi>.  

Fri Dec 26 08:23:04 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/download.c:

	Make progress bar drawing more safe and prioritize drawing of the
	progress 'colouring' if width is small.  

Fri Dec 26 08:04:59 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/download.c:

	Move up the progress bar drawing.  

Thu Dec 25 17:59:33 2003  Petr Baudis <pasky@ucw.cz>:

	* NEWS:

	ELinks-0.5.0 -> ELinks-0.9.0, inspired by AnAnt.  

Thu Dec 25 15:09:21 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/download.c:

	Use new draw_text() when drawing the progress bar.  

Thu Dec 25 15:01:09 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/terminal/draw.c:

	draw_text(): NULL color now means only set the data parts.  

Thu Dec 25 14:02:09 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/download.c:

	download_progress_bar(): It is not a widget formatter (yet) and is
	used for other progress stuff so take @y as clean int.  

Thu Dec 25 13:57:04 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/form.c:

	Compile fix. Pasky please check.  

Thu Dec 25 13:10:17 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/dialogs/status.c:

	Use term instead of ses->tab->term.  

Thu Dec 25 12:11:35 2003  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	Pass directly ses->tab->term to field_op_do(), instead of just @ses.  

Thu Dec 25 12:10:37 2003  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	Separated the field_op() grand switch to field_op_do(), patch by
	Martin Bays <elinks-dev@zugzwang.port5.com>.  

Thu Dec 25 12:04:06 2003  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	Grand field_op() switch tidyup.  

Thu Dec 25 12:01:52 2003  Petr Baudis <pasky@ucw.cz>:

	* src/viewer/text/form.c:

	Removed the b label from the grand field_op() switch.  

Thu Dec 25 11:21:33 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix more infinit looping in some rare corner cases.  

Thu Dec 25 10:46:42 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	If there is no current link use 0. Fixes previous patch.  

Thu Dec 25 10:02:07 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix first bug introduced in 0.9.0
	(viewer/text/search.c:1.142->1.143) :/.  

Thu Dec 25 09:57:45 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/: document/html/renderer.c, terminal/draw.h,
	viewer/text/search.c:

	Fix link numbers prefixes matching search strings (bug 57).  

Thu Dec 25 08:29:11 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Make typeahead case sensitive using the document.browse.search.case
	option. Fixes 3rd part of bug 344.  

Thu Dec 25 08:17:23 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Minor cleanup of hit top/botton dialog calling.  

Thu Dec 25 08:09:05 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Fix typeahed so both inf. looping in some rare occasions and wrap
	around so it always works (also for the last link being matched). We
	now assert that anyone mangling the link position (@i) keeps it
	valid.  

Thu Dec 25 08:06:03 2003  Jonas Fonseca <fonseca@diku.dk>:

	* src/viewer/text/search.c:

	Move typeahead error handling to separate function to avoid evil
	gotos in next patch >:).  

Thu Dec 25 06:59:02 2003  Witold Filipczyk <witekfl@poczta.gazeta.pl>:

	* po/pl.po:

	Polish translation fixes.  

Wed Dec 24 22:06:30 2003  Petr Baudis <pasky@ucw.cz>:

	* src/config/options.inc:

	Removed compatibility aliases ui.shadow and config_saving_style,
	both added before 0.4.0.  

Wed Dec 24 18:40:23 2003  Laurent Monin <zas@norz.org>:

	* po/fr.po:

	French translation was updated.  

Wed Dec 24 18:14:34 2003  Jonas Fonseca <fonseca@diku.dk>:

	* configure.in:

	ELinks-0.9.0.CVS 

Wed Dec 24 18:04:32 2003  Petr Baudis <pasky@ucw.cz>:

	* configure.in:

	ELinks-0.9.0 
